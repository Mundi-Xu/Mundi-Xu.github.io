

<!DOCTYPE html>
<html lang="en" data-default-color-scheme=&#34;auto&#34;>



<head>
  <meta charset="UTF-8">
  <link rel="apple-touch-icon" sizes="76x76" href="https://cdn.jsdelivr.net/gh/Mundi-Xu/picture_resource@master/picture/links/favicon.png">
  <link rel="icon" href="https://cdn.jsdelivr.net/gh/Mundi-Xu/picture_resource@master/picture/links/favicon.png">
  <meta name="viewport"
        content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, shrink-to-fit=no">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  
  <meta name="theme-color" content="#2f4154">
  <meta name="description" content="基于 rust 开发的在线加解密系统与各类加密函数的简析。">
  <meta name="author" content="寒雨">
  <meta name="keywords" content="">
  
    <meta name="google-site-verification" content="8weHOmi2lqvnOxDE30WJFT51umo63nyCgfm8dXHNT5g" />
  
  <title>密码学初探-基于RUST的密码系统与算法简析 - Mundi&#39;s Space</title>

  <link  rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4.6.0/dist/css/bootstrap.min.css" />


  <link  rel="stylesheet" href="https://cdn.jsdelivr.net/npm/github-markdown-css@4.0.0/github-markdown.min.css" />
  <link  rel="stylesheet" href="/lib/hint/hint.min.css" />

  
    
    
      
      <link  rel="stylesheet" href="https://cdn.jsdelivr.net/npm/highlight.js@10.7.2/styles/github-gist.min.css" />
    
  

  
    <link  rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fancyapps/fancybox@3.5.7/dist/jquery.fancybox.min.css" />
  



<!-- 主题依赖的图标库，不要自行修改 -->

<link rel="stylesheet" href="//at.alicdn.com/t/font_1749284_ba1fz6golrf.css">



<link rel="stylesheet" href="//at.alicdn.com/t/font_1736178_kmeydafke9r.css">


<link  rel="stylesheet" href="/css/main.css" />

<!-- 自定义样式保持在最底部 -->


  <script id="fluid-configs">
    var Fluid = window.Fluid || {};
    var CONFIG = {"hostname":"mundi-xu.github.io","root":"/","version":"1.8.11","typing":{"enable":true,"typeSpeed":80,"cursorChar":"_","loop":false},"anchorjs":{"enable":true,"element":"h1,h2,h3,h4,h5,h6","placement":"right","visible":"hover","icon":""},"progressbar":{"enable":true,"height_px":3,"color":"#29d","options":{"showSpinner":false,"trickleSpeed":100}},"copy_btn":true,"image_zoom":{"enable":true,"img_url_replace":["",""]},"toc":{"enable":true,"headingSelector":"h1,h2,h3,h4,h5,h6","collapseDepth":0},"lazyload":{"enable":true,"loading_img":"/img/loading.gif","onlypost":true,"offset_factor":2},"web_analytics":{"enable":false,"baidu":null,"google":null,"gtag":"UA-146906922-1","tencent":{"sid":null,"cid":null},"woyaola":null,"cnzz":null,"leancloud":{"app_id":null,"app_key":null,"server_url":null}},"search_path":"/local-search.xml"};
  </script>
  <script  src="/js/utils.js" ></script>
  <script  src="/js/color-schema.js" ></script>
<meta name="generator" content="Hexo 5.4.0"><link rel="alternate" href="/atom.xml" title="Mundi's Space" type="application/atom+xml">
</head>


<body>
  <header style="height: 70vh;">
    <nav id="navbar" class="navbar fixed-top  navbar-expand-lg navbar-dark scrolling-navbar">
  <div class="container">
    <a class="navbar-brand"
       href="/">&nbsp;<strong>Mundi's Space</strong>&nbsp;</a>

    <button id="navbar-toggler-btn" class="navbar-toggler" type="button" data-toggle="collapse"
            data-target="#navbarSupportedContent"
            aria-controls="navbarSupportedContent" aria-expanded="false" aria-label="Toggle navigation">
      <div class="animated-icon"><span></span><span></span><span></span></div>
    </button>

    <!-- Collapsible content -->
    <div class="collapse navbar-collapse" id="navbarSupportedContent">
      <ul class="navbar-nav ml-auto text-center">
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/">
                <i class="iconfont icon-home-fill"></i>
                Home
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/archives/">
                <i class="iconfont icon-archive-fill"></i>
                Archives
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/tags/">
                <i class="iconfont icon-tags-fill"></i>
                Tags
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/atom.xml">
                <i class="iconfont icon-rss"></i>
                RSS
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/about/">
                <i class="iconfont icon-user-fill"></i>
                About
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/links/">
                <i class="iconfont icon-link-fill"></i>
                Links
              </a>
            </li>
          
        
        
          <li class="nav-item" id="search-btn">
            <a class="nav-link" target="_self" data-toggle="modal" data-target="#modalSearch">&nbsp;<i
                class="iconfont icon-search"></i>&nbsp;</a>
          </li>
        
        
          <li class="nav-item" id="color-toggle-btn">
            <a class="nav-link" target="_self">&nbsp;<i
                class="iconfont icon-dark" id="color-toggle-icon"></i>&nbsp;</a>
          </li>
        
      </ul>
    </div>
  </div>
</nav>

    <div class="banner" id="banner" parallax=true
         style="background: url('https://cdn.jsdelivr.net/gh/Mundi-Xu/picture_resource@master/picture/基于RUST的密码学系统/banner.jpg') no-repeat center center;
           background-size: cover;">
      <div class="full-bg-img">
        <div class="mask flex-center" style="background-color: rgba(0, 0, 0, 0.3)">
          <div class="page-header text-center fade-in-up">
            <span class="h2" id="subtitle" title="密码学初探-基于RUST的密码系统与算法简析">
              
            </span>

            
              <div class="mt-3">
  
  
    <span class="post-meta">
      <i class="iconfont icon-date-fill" aria-hidden="true"></i>
      <time datetime="2020-12-27 14:05" pubdate>
        December 27, 2020 pm
      </time>
    </span>
  
</div>

<div class="mt-1">
  
    
    <span class="post-meta mr-2">
      <i class="iconfont icon-chart"></i>
      7k 字
    </span>
  

  
    
    <span class="post-meta mr-2">
      <i class="iconfont icon-clock-fill"></i>
      
      
      113
       分钟
    </span>
  

  
  
</div>

            
          </div>

          
        </div>
      </div>
    </div>
  </header>

  <main>
    
      

<div class="container-fluid nopadding-x">
  <div class="row nomargin-x">
    <div class="d-none d-lg-block col-lg-2"></div>
    <div class="col-lg-8 nopadding-x-md">
      <div class="container nopadding-x-md" id="board-ctn">
        <div class="py-5" id="board">
          <article class="post-content mx-auto">
            <!-- SEO header -->
            <h1 style="display: none">密码学初探-基于RUST的密码系统与算法简析</h1>
            
              <p class="note note-info">
                
                  Last update：6 months ago
                
              </p>
            
            <div class="markdown-body">
              <h1 id="Introduction"><a href="#Introduction" class="headerlink" title="Introduction"></a>Introduction</h1><p>密码学（Cryptography）一般可分为古典密码学和现代密码学。</p>
<p>其中，古典密码学，作为一种实用性艺术存在，其编码和破译通常依赖于设计者和敌手的创造力与技巧，并没有对密码学原件进行清晰的定义。古典密码学主要包含以下几个方面：</p>
<ul>
<li>单表替换加密（Monoalphabetic Cipher）</li>
<li>多表替换加密（Polyalphabetic Cipher）</li>
<li>奇奇怪怪的加密方式</li>
</ul>
<p>而现代密码学则起源于 20 世纪中后期出现的大量相关理论，1949 年香农（C. E. Shannon）发表了题为《保密系统的通信理论》的经典论文标志着现代密码学的开始。现代密码学主要包含以下几个方面：</p>
<ul>
<li>对称加密（Symmetric Cryptography），以 DES，AES，RC4 为代表。</li>
<li>非对称加密（Asymmetric Cryptography），以 RSA，ElGamal，椭圆曲线加密为代表。</li>
<li>哈希函数（Hash Function），以 MD5，SHA-1，SHA-512 等为代表。</li>
<li>数字签名（Digital Signature），以 RSA 签名，ElGamal 签名，DSA 签名为代表。</li>
</ul>
<p>其中，对称加密体制主要分为两种方式：</p>
<ul>
<li>分组密码（Block Cipher），又称为块密码。</li>
<li>序列密码（Stream Cipher），又称为流密码。</li>
</ul>
<p>一般来说，密码设计者的根本目标是保障信息及信息系统的</p>
<ul>
<li>机密性（Confidentiality）</li>
<li>完整性（Integrity）</li>
<li>可用性（Availability）</li>
<li>认证性（Authentication）</li>
<li>不可否认性（Non-repudiation）</li>
</ul>
<p>其中，前三者被称为信息安全的 CIA 三要素 。</p>
<p>本文主要介绍了仿射密码，流密码（RC4,LFSR+JK)，分组密码（DES,AES），非对称加密（rsa）和密码协议（Diffie_Hellman）。<br>项目详细代码已于Github开源<sup id="fnref:1" class="footnote-ref"><a href="#fn:1" rel="footnote"><span class="hint--top hint--rounded" aria-label="https://github.com/Mundi-Xu/cipher_web_rocket
">[1]</span></a></sup>。</p>
<h1 id="仿射密码"><a href="#仿射密码" class="headerlink" title="仿射密码"></a>仿射密码</h1><h2 id="原理"><a href="#原理" class="headerlink" title="原理"></a>原理</h2><p>仿射密码的加密函数是 $E(x)=(ax+b)\pmod m$，其中</p>
<ul>
<li>$x$ 表示明文按照某种编码得到的数字</li>
<li>$a$ 和 $m$ 互质</li>
<li>$m$ 是编码系统中字母的数目。</li>
</ul>
<p>解密函数是 $D(x)=a^{-1}(x-b)\pmod m$，其中 $a^{-1}$ 是 $a$ 在 $\mathbb{Z}_{m}$ 群的乘法逆元。</p>
<p>下面我们以 $E(x) = (5x + 8) \bmod 26$ 函数为例子进行介绍，加密字符串为 <code>AFFINE CIPHER</code>，这里我们直接采用字母表26个字母作为编码系统</p>
<table>
<thead>
<tr>
<th>明文</th>
<th>A</th>
<th>F</th>
<th>F</th>
<th>I</th>
<th>N</th>
<th>E</th>
<th>C</th>
<th>I</th>
<th>P</th>
<th>H</th>
<th>E</th>
<th>R</th>
</tr>
</thead>
<tbody><tr>
<td>x</td>
<td>0</td>
<td>5</td>
<td>5</td>
<td>8</td>
<td>13</td>
<td>4</td>
<td>2</td>
<td>8</td>
<td>15</td>
<td>7</td>
<td>4</td>
<td>17</td>
</tr>
<tr>
<td>$y=5x+8$</td>
<td>8</td>
<td>33</td>
<td>33</td>
<td>48</td>
<td>73</td>
<td>28</td>
<td>18</td>
<td>48</td>
<td>83</td>
<td>43</td>
<td>28</td>
<td>93</td>
</tr>
<tr>
<td>$y\mod26$</td>
<td>8</td>
<td>7</td>
<td>7</td>
<td>22</td>
<td>21</td>
<td>2</td>
<td>18</td>
<td>22</td>
<td>5</td>
<td>17</td>
<td>2</td>
<td>15</td>
</tr>
<tr>
<td>密文</td>
<td>I</td>
<td>H</td>
<td>H</td>
<td>W</td>
<td>V</td>
<td>C</td>
<td>S</td>
<td>W</td>
<td>F</td>
<td>R</td>
<td>C</td>
<td>P</td>
</tr>
</tbody></table>
<p>其对应的加密结果是 <code>IHHWVCSWFRCP</code>。</p>
<p>对于解密过程，正常解密者具有a与b，可以计算得到 $a^{-1}$ 为 21，所以其解密函数是$D(x)=21(x-8)\pmod {26}$ ，解密如下</p>
<table>
<thead>
<tr>
<th>密文</th>
<th align="left">I</th>
<th align="left">H</th>
<th>H</th>
<th>W</th>
<th>V</th>
<th>C</th>
<th>S</th>
<th>W</th>
<th>F</th>
<th>R</th>
<th>C</th>
<th>P</th>
</tr>
</thead>
<tbody><tr>
<td>$y$</td>
<td align="left">8</td>
<td align="left">7</td>
<td>7</td>
<td>22</td>
<td>21</td>
<td>2</td>
<td>18</td>
<td>22</td>
<td>5</td>
<td>17</td>
<td>2</td>
<td>15</td>
</tr>
<tr>
<td>$x=21(y-8)$</td>
<td align="left">0</td>
<td align="left">-21</td>
<td>-21</td>
<td>294</td>
<td>273</td>
<td>-126</td>
<td>210</td>
<td>294</td>
<td>-63</td>
<td>189</td>
<td>-126</td>
<td>147</td>
</tr>
<tr>
<td>$x\mod26$</td>
<td align="left">0</td>
<td align="left">5</td>
<td>5</td>
<td>8</td>
<td>13</td>
<td>4</td>
<td>2</td>
<td>8</td>
<td>15</td>
<td>7</td>
<td>4</td>
<td>17</td>
</tr>
<tr>
<td>明文</td>
<td align="left">A</td>
<td align="left">F</td>
<td>F</td>
<td>I</td>
<td>N</td>
<td>E</td>
<td>C</td>
<td>I</td>
<td>P</td>
<td>H</td>
<td>E</td>
<td>R</td>
</tr>
</tbody></table>
<p>可以看出其特点在于只有 26 个英文字母。</p>
<p><img src="https://cdn.jsdelivr.net/gh/Mundi-Xu/picture_resource@master/picture/%E5%9F%BA%E4%BA%8ERUST%E7%9A%84%E5%AF%86%E7%A0%81%E5%AD%A6%E7%B3%BB%E7%BB%9F/%E4%BB%BF%E5%B0%84%E5%AF%86%E7%A0%81.png" srcset="/img/loading.gif" lazyload alt="仿射密码"></p>
<h2 id="Rust实现"><a href="#Rust实现" class="headerlink" title="Rust实现"></a>Rust实现</h2><figure class="highlight rust"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs rust"><span class="hljs-comment">// Encrypt</span><br><span class="hljs-keyword">let</span> <span class="hljs-keyword">mut</span> ans = <span class="hljs-built_in">String</span>::new();<br><span class="hljs-keyword">for</span> ch <span class="hljs-keyword">in</span> msg.chars() &#123;<br>    <span class="hljs-keyword">if</span> ch.is_ascii_alphabetic() &#123;<br>        <span class="hljs-keyword">if</span> ch.is_uppercase() &#123;<br>            <span class="hljs-comment">// 大写字母</span><br>            <span class="hljs-keyword">let</span> x = ch <span class="hljs-keyword">as</span> <span class="hljs-built_in">u32</span> - <span class="hljs-string">&#x27;A&#x27;</span> <span class="hljs-keyword">as</span> <span class="hljs-built_in">u32</span>;<br>            <span class="hljs-keyword">let</span> y = (upper_a * x + upper_b) % <span class="hljs-number">26</span>;<br>            <span class="hljs-keyword">let</span> target = <span class="hljs-string">&#x27;A&#x27;</span> <span class="hljs-keyword">as</span> <span class="hljs-built_in">u32</span> + y;<br>            <span class="hljs-keyword">let</span> new_ch = <span class="hljs-built_in">char</span>::try_from(target).unwrap();<br>            ans.push(new_ch);<br>        &#125; <span class="hljs-keyword">else</span> &#123;<br>            <span class="hljs-comment">// 小写字母</span><br>            <span class="hljs-keyword">let</span> x = ch <span class="hljs-keyword">as</span> <span class="hljs-built_in">u32</span> - <span class="hljs-string">&#x27;a&#x27;</span> <span class="hljs-keyword">as</span> <span class="hljs-built_in">u32</span>;<br>            <span class="hljs-keyword">let</span> y = (lower_a * x + lower_b) % <span class="hljs-number">26</span>;<br>            <span class="hljs-keyword">let</span> target = <span class="hljs-string">&#x27;a&#x27;</span> <span class="hljs-keyword">as</span> <span class="hljs-built_in">u32</span> + y;<br>            <span class="hljs-keyword">let</span> new_ch = <span class="hljs-built_in">char</span>::try_from(target).unwrap();<br>            ans.push(new_ch);<br>        &#125;<br>    &#125; <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> ch.is_ascii_digit() &#123;<br>        <span class="hljs-comment">// 数字</span><br>        <span class="hljs-keyword">let</span> x = ch <span class="hljs-keyword">as</span> <span class="hljs-built_in">u32</span> - <span class="hljs-string">&#x27;0&#x27;</span> <span class="hljs-keyword">as</span> <span class="hljs-built_in">u32</span>;<br>        <span class="hljs-keyword">let</span> y = (number_a * x + number_b) % <span class="hljs-number">26</span>;<br>        <span class="hljs-keyword">let</span> target = <span class="hljs-string">&#x27;0&#x27;</span> <span class="hljs-keyword">as</span> <span class="hljs-built_in">u32</span> + y;<br>        <span class="hljs-keyword">let</span> new_ch = <span class="hljs-built_in">char</span>::try_from(target).unwrap();<br>        ans.push(new_ch);<br>    &#125; <span class="hljs-keyword">else</span> &#123;<br>        ans.push(ch);<br>    &#125;<br>&#125;<br><span class="hljs-keyword">return</span> <span class="hljs-literal">Ok</span>(ans);<br><br><br><span class="hljs-comment">// Decrypt</span><br><span class="hljs-keyword">let</span> lower_a_ = exgcd(lower_a <span class="hljs-keyword">as</span> <span class="hljs-built_in">i32</span>, <span class="hljs-number">26</span>) <span class="hljs-keyword">as</span> <span class="hljs-built_in">u32</span>;<br><span class="hljs-keyword">let</span> upper_a_ = exgcd(upper_a <span class="hljs-keyword">as</span> <span class="hljs-built_in">i32</span>, <span class="hljs-number">26</span>) <span class="hljs-keyword">as</span> <span class="hljs-built_in">u32</span>;<br><span class="hljs-keyword">let</span> number_a_ = exgcd(number_a <span class="hljs-keyword">as</span> <span class="hljs-built_in">i32</span>, <span class="hljs-number">10</span>) <span class="hljs-keyword">as</span> <span class="hljs-built_in">u32</span>;<br><span class="hljs-keyword">let</span> <span class="hljs-keyword">mut</span> ans = <span class="hljs-built_in">String</span>::new();<br><span class="hljs-keyword">for</span> ch <span class="hljs-keyword">in</span> msg.chars() &#123;<br>    <span class="hljs-keyword">if</span> ch.is_ascii_alphabetic() &#123;<br>        <span class="hljs-keyword">if</span> ch.is_uppercase() &#123;<br>            <span class="hljs-comment">// 大写字母</span><br>            <span class="hljs-keyword">let</span> x = ch <span class="hljs-keyword">as</span> <span class="hljs-built_in">u32</span> - <span class="hljs-string">&#x27;A&#x27;</span> <span class="hljs-keyword">as</span> <span class="hljs-built_in">u32</span>;<br>            <span class="hljs-keyword">let</span> y = (upper_a_ * (x + <span class="hljs-number">26</span> - upper_b)) % <span class="hljs-number">26</span>;<br>            <span class="hljs-keyword">let</span> target = <span class="hljs-string">&#x27;A&#x27;</span> <span class="hljs-keyword">as</span> <span class="hljs-built_in">u32</span> + y;<br>            <span class="hljs-keyword">let</span> new_ch = <span class="hljs-built_in">char</span>::try_from(target).unwrap();<br>            ans.push(new_ch);<br>        &#125; <span class="hljs-keyword">else</span> &#123;<br>            <span class="hljs-comment">// 小写字母</span><br>            <span class="hljs-keyword">let</span> x = ch <span class="hljs-keyword">as</span> <span class="hljs-built_in">u32</span> - <span class="hljs-string">&#x27;a&#x27;</span> <span class="hljs-keyword">as</span> <span class="hljs-built_in">u32</span>;<br>            <span class="hljs-keyword">let</span> y = (lower_a_ * (x + <span class="hljs-number">26</span> - lower_b)) % <span class="hljs-number">26</span>;<br>            <span class="hljs-keyword">let</span> target = <span class="hljs-string">&#x27;a&#x27;</span> <span class="hljs-keyword">as</span> <span class="hljs-built_in">u32</span> + y;<br>            <span class="hljs-keyword">let</span> new_ch = <span class="hljs-built_in">char</span>::try_from(target).unwrap();<br>            ans.push(new_ch);<br>        &#125;<br>    &#125; <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> ch.is_ascii_digit() &#123;<br>        <span class="hljs-comment">// 数字</span><br>        <span class="hljs-keyword">let</span> x = ch <span class="hljs-keyword">as</span> <span class="hljs-built_in">u32</span> - <span class="hljs-string">&#x27;0&#x27;</span> <span class="hljs-keyword">as</span> <span class="hljs-built_in">u32</span>;<br>        <span class="hljs-keyword">let</span> y = (number_a_ * (x + <span class="hljs-number">10</span> - number_b)) % <span class="hljs-number">10</span>;<br>        <span class="hljs-keyword">let</span> target = <span class="hljs-string">&#x27;0&#x27;</span> <span class="hljs-keyword">as</span> <span class="hljs-built_in">u32</span> + y;<br>        <span class="hljs-keyword">let</span> new_ch = <span class="hljs-built_in">char</span>::try_from(target).unwrap();<br>        ans.push(new_ch);<br>    &#125; <span class="hljs-keyword">else</span> &#123;<br>        ans.push(ch);<br>    &#125;<br>&#125;<br><span class="hljs-keyword">return</span> <span class="hljs-literal">Ok</span>(ans);<br></code></pre></div></td></tr></table></figure>

<p><img src="https://cdn.jsdelivr.net/gh/Mundi-Xu/picture_resource@master/picture/%E5%9F%BA%E4%BA%8ERUST%E7%9A%84%E5%AF%86%E7%A0%81%E5%AD%A6%E7%B3%BB%E7%BB%9F/affine.png" srcset="/img/loading.gif" lazyload alt="Affine"></p>
<h2 id="破解"><a href="#破解" class="headerlink" title="破解"></a>破解</h2><p>首先，我们可以看到的是，仿射密码对于任意两个不同的字母，其最后得到的密文必然不一样，所以其也具有最通用的特点。当密文长度足够长时，我们可以使用频率分析的方法来解决。</p>
<p>其次，我们可以考虑如何攻击该密码。可以看出当$a=1$ 时，仿射加密是凯撒加密。而一般来说，我们利用仿射密码时，其字符集都用的是字母表，一般只有26个字母，而不大于26的与26互素的个数一共有 </p>
<p>$$<br>\phi(26)=\phi(2) \times \phi(13) = 12<br>$$</p>
<p>算上b的偏移可能，一共有可能的密钥空间大小也就是 </p>
<p>$$<br>12 \times 26 = 312<br>$$</p>
<p>一般来说，对于该种密码，我们至少得是在已知部分明文的情况下才可以攻击。下面进行简单的分析。</p>
<p>这种密码由两种参数来控制，如果我们知道其中任意一个参数，那我们便可以很容易地快速枚举另外一个参数得到答案。</p>
<p>但是，假设我们已经知道采用的字母集，这里假设为26个字母，我们还有另外一种解密方式，我们只需要知道两个加密后的字母 $y_1,y_2$ 即可进行解密。那么我们还可以知道</p>
<p>$$<br>y_1=(ax_1+b)\pmod{26} \<br>y_2=(ax_2+b)\pmod{26}<br>$$</p>
<p>两式相减，可得</p>
<p>$$<br>y_1-y_2=a(x_1-x_2)\pmod{26}<br>$$</p>
<p>这里 $y_1,y_2$ 已知，如果我们知道密文对应的两个不一样的字符 $x_1$ 与 $x_2$ ，那么我们就可以很容易得到 $a$ ，进而就可以得到 $b$ 了。</p>
<h1 id="流密码"><a href="#流密码" class="headerlink" title="流密码"></a>流密码</h1><p>流密码一般逐字节或者逐比特处理信息。一般来说</p>
<ul>
<li>流密码的密钥长度会与明文的长度相同。</li>
<li>流密码的密钥派生自一个较短的密钥，派生算法通常为一个伪随机数生成算法。</li>
</ul>
<p>需要注意的是，流加密目前来说都是对称加密。</p>
<p>伪随机数生成算法生成的序列的随机性越强，明文中的统计特征被覆盖的更好。</p>
<p>流密码加解密非常简单，在已知明文的情况下，可以非常容易地获取密钥流。</p>
<p>流密码的关键在于设计好的伪随机数生成器。一般来说，伪随机数生成器的基本构造模块为反馈移位寄存器。当然，也有一些特殊设计的流密码，比如 RC4。</p>
<h2 id="反馈移位寄存器"><a href="#反馈移位寄存器" class="headerlink" title="反馈移位寄存器"></a>反馈移位寄存器</h2><p>一般的，一个 n 级反馈移位寄存器如下图所示</p>
<p><img src="https://cdn.jsdelivr.net/gh/Mundi-Xu/picture_resource@master/picture/%E5%9F%BA%E4%BA%8ERUST%E7%9A%84%E5%AF%86%E7%A0%81%E5%AD%A6%E7%B3%BB%E7%BB%9F/n-fsr.png" srcset="/img/loading.gif" lazyload alt="n-fsr"></p>
<p>其中</p>
<ul>
<li>$a_0$，$a_1$，…，$a_{n-1}$ 为初态。</li>
<li>F 为反馈函数或者反馈逻辑。如果 F 为线性函数，那么我们称其为线性反馈移位寄存器（LFSR），否则我们称其为非线性反馈移位寄存器（NFSR）。</li>
<li>$a_{i+n}=F(a_i,a_{i+1},…,a_{i+n-1})$ 。</li>
</ul>
<p>一般来说，反馈移位寄存器都会定义在某个有限域上，从而避免数字太大和太小的问题。因此，我们可以将其视为同一个空间中的变换，即</p>
<p>$(a_i,a_{i+1},…,a_{i+n-1}) \rightarrow (a_{i+1},…,a_{i+n-1},a_{i+n})$<br>.<br>对于一个序列来说，我们一般定义其生成函数为其序列对应的幂级数的和。</p>
<h2 id="线性反馈移位寄存器-LFSR"><a href="#线性反馈移位寄存器-LFSR" class="headerlink" title="线性反馈移位寄存器 - LFSR"></a>线性反馈移位寄存器 - LFSR</h2><h3 id="介绍"><a href="#介绍" class="headerlink" title="介绍"></a>介绍</h3><p>线性反馈移位寄存器的反馈函数一般如下</p>
<p>$a_{i+n}=\sum\limits_{j=1}^{n}c_ja_{i+n-j}$</p>
<p>其中，$c_j$ 均在某个有限域 $F_q$ 中。</p>
<p>既然线性空间是一个线性变换，我们可以得知这个线性变换为</p>
<p>$$ \begin{align*}<br>&amp;\left[<br>  a_{i+1},a_{i+2},a_{i+3}, …,a_{i+n}<br>\right]\\ \\ =&amp;\left[<br>  a_{i},a_{i+1},a_{i+2}, …,a_{i+n-1}<br>\right]\left[ \begin{matrix} 0   &amp; 0      &amp; \cdots &amp; 0 &amp; c_n     \\ 1   &amp; 0      &amp; \cdots &amp; 0 &amp; c_{n-1}  \\ 0   &amp; 1      &amp; \cdots &amp; 0 &amp; c_{n-2} \\ \vdots &amp; \vdots &amp; \ddots &amp; \vdots \\ 0   &amp; 0      &amp; \cdots &amp; 1 &amp; c_1     \\ \end{matrix} \right] \\ \\ =&amp;\left[<br>  a_{0},a_{1},a_{2}, …,a_{n-1}<br>\right]\left[ \begin{matrix} 0   &amp; 0      &amp; \cdots &amp; 0 &amp; c_n     \\ 1   &amp; 0      &amp; \cdots &amp; 0 &amp; c_{n-1}  \\ 0   &amp; 1      &amp; \cdots &amp; 0 &amp; c_{n-2} \\ \vdots &amp; \vdots &amp; \ddots &amp; \vdots \\ 0   &amp; 0      &amp; \cdots &amp; 1 &amp; c_1     \\ \end{matrix} \right]^{i+1}<br>\end{align*} $$</p>
<p>进而，我们可以求得其特征多项式为</p>
<p>$f(x)=x^n-\sum\limits_{i=1}^{n}c_ix^{n-i}$</p>
<p>同时，我们定义其互反多项式为</p>
<p>$\overline f(x)=x^nf(\frac{1}{x})=1-\sum\limits_{i=1}^{n}c_ix^{i}$</p>
<p>我们也称互反多项式为线性反馈移位寄存器的联结多项式。</p>
<p>这里有一些定理需要我们记一下，感兴趣的可以自行推导。</p>
<h3 id="样例"><a href="#样例" class="headerlink" title="样例"></a>样例</h3><p><img src="https://cdn.jsdelivr.net/gh/Mundi-Xu/picture_resource@master/picture/%E5%9F%BA%E4%BA%8ERUST%E7%9A%84%E5%AF%86%E7%A0%81%E5%AD%A6%E7%B3%BB%E7%BB%9F/lfsr-1.png" srcset="/img/loading.gif" lazyload alt="lfsr-1"><br><img src="https://cdn.jsdelivr.net/gh/Mundi-Xu/picture_resource@master/picture/%E5%9F%BA%E4%BA%8ERUST%E7%9A%84%E5%AF%86%E7%A0%81%E5%AD%A6%E7%B3%BB%E7%BB%9F/lfsr-2.png" srcset="/img/loading.gif" lazyload alt="lfsr-2"></p>
<h3 id="特征多项式与生成函数"><a href="#特征多项式与生成函数" class="headerlink" title="特征多项式与生成函数"></a>特征多项式与生成函数</h3><p>已知某个 n 级线性反馈移位寄存器的特征多项式，那么该序列对应的生成函数为</p>
<p>$A(x)=\frac{p(x)}{\overline f(x)}$</p>
<p>其中，$p(x)=\sum\limits_{i=1}^{n}(c_{n-i}x^{n-i}\sum\limits_{j=1}^{i}a_jx^{j-1})$。可以看出 p(x) 完全由初始状态和反馈函数的系数决定。</p>
<h3 id="序列周期与生成函数"><a href="#序列周期与生成函数" class="headerlink" title="序列周期与生成函数"></a>序列周期与生成函数</h3><p>序列的的周期为其生成函数的既约真分式的分母的周期。</p>
<p>对于 n 级线性反馈移位寄存器，最长周期为 $2^{n}-1$（排除全零）。达到最长周期的序列一般称为 m 序列。</p>
<h3 id="特殊性质"><a href="#特殊性质" class="headerlink" title="特殊性质"></a>特殊性质</h3><ul>
<li>将两个序列累加得到新的序列的周期为这两个序列的周期的和。</li>
<li>序列是 n 级 m 序列，当且仅当序列的极小多项式是 n 次本原多项式。</li>
</ul>
<h3 id="B-M-算法"><a href="#B-M-算法" class="headerlink" title="B-M 算法"></a>B-M 算法</h3><p>一般来说，我们可以从两种角度来考虑 LFSR</p>
<ul>
<li>密钥生成角度，一般我们希望使用级数尽可能低的 LFSR 来生成周期大，随机性好的序列。</li>
<li>密码分析角度，给定一个长度为 n 的序列 a，如何构造一个级数尽可能小的 LFSR 来生成它。其实这就是 B-M 算法的来源。</li>
</ul>
<p>一般来说，我们定义一个序列的线性复杂度如下</p>
<ul>
<li>若 s 为一个全零序列，则线性复杂度为0。</li>
<li>若没有 LFSR 能生成 s，则线性复杂度为无穷。</li>
<li>否则，s 的线性复杂度为生成 L(s) 的最小级的 LFSR。</li>
</ul>
<p>BM 算法的要求我们需要知道长度为 2n 的序列。其复杂度</p>
<ul>
<li>时间复杂度：O(n^2) 次比特操作</li>
<li>空间复杂度：O(n) 比特。</li>
</ul>
<p>关于 BM 算法的细节，后续添加，目前处于学习过程中。</p>
<p>但是其实如果我们知道了长度为 2n 的序列，我们也可以一种比较笨的方法来获取原先的序列。不妨假设已知的序列为$a_1,…,a_{2n}$，我们可以令</p>
<p>$S_1=(a_1,…,a_n)$</p>
<p>$S_2=(a_2,…,a_{n+1})$</p>
<p>….</p>
<p>$S_{n+1}=(a_{n+1},…,a_{2n})$</p>
<p>那么我们可以构造矩阵 $X=(S_1,…,S_n)$，那么</p>
<p>$S_{n+1}=(c_n,…,c_1)X$</p>
<p>所以</p>
<p>$(c_n,…,c_1)=S_{n+1}X^{-1}$</p>
<p>进而我们也就知道了 LFSR 的反馈表达式，进而我们就可以推出初始化种子。</p>
<h2 id="非线性反馈移位寄存器"><a href="#非线性反馈移位寄存器" class="headerlink" title="非线性反馈移位寄存器"></a>非线性反馈移位寄存器</h2><h3 id="介绍-1"><a href="#介绍-1" class="headerlink" title="介绍"></a>介绍</h3><p>为了使得密钥流输出的序列尽可能复杂，会使用非线性反馈移位寄存器，常见的有三种</p>
<ul>
<li>非线性组合生成器，对多个 LFSR 的输出使用一个非线性组合函数</li>
<li>非线性滤波生成器，对一个 LFSR 的内容使用一个非线性组合函数</li>
<li>钟控生成器，使用一个（或多个）LFSR 的输出来控制另一个（或多个）LFSR 的时钟 </li>
</ul>
<h3 id="非线性组合生成器"><a href="#非线性组合生成器" class="headerlink" title="非线性组合生成器"></a>非线性组合生成器</h3><h4 id="简介"><a href="#简介" class="headerlink" title="简介"></a>简介</h4><p>组合生成器一般如下图所示。</p>
<p><img src="https://cdn.jsdelivr.net/gh/Mundi-Xu/picture_resource@master/picture/%E5%9F%BA%E4%BA%8ERUST%E7%9A%84%E5%AF%86%E7%A0%81%E5%AD%A6%E7%B3%BB%E7%BB%9F/combine-generator.png" srcset="/img/loading.gif" lazyload alt="combine-generator"></p>
<h4 id="JK触发器"><a href="#JK触发器" class="headerlink" title="JK触发器"></a>JK触发器</h4><p><img src="https://cdn.jsdelivr.net/gh/Mundi-Xu/picture_resource@master/picture/%E5%9F%BA%E4%BA%8ERUST%E7%9A%84%E5%AF%86%E7%A0%81%E5%AD%A6%E7%B3%BB%E7%BB%9F/JK-1.png" srcset="/img/loading.gif" lazyload alt="JK-1"></p>
<h4 id="利用J-K触发器的非线性序列生成器"><a href="#利用J-K触发器的非线性序列生成器" class="headerlink" title="利用J-K触发器的非线性序列生成器"></a>利用J-K触发器的非线性序列生成器</h4><p><img src="https://cdn.jsdelivr.net/gh/Mundi-Xu/picture_resource@master/picture/%E5%9F%BA%E4%BA%8ERUST%E7%9A%84%E5%AF%86%E7%A0%81%E5%AD%A6%E7%B3%BB%E7%BB%9F/JK-2.png" srcset="/img/loading.gif" lazyload alt="JK-2"></p>
<h4 id="样例-1"><a href="#样例-1" class="headerlink" title="样例"></a>样例</h4><p><img src="https://cdn.jsdelivr.net/gh/Mundi-Xu/picture_resource@master/picture/%E5%9F%BA%E4%BA%8ERUST%E7%9A%84%E5%AF%86%E7%A0%81%E5%AD%A6%E7%B3%BB%E7%BB%9F/JK-3.png" srcset="/img/loading.gif" lazyload alt="JK-3"></p>
<h4 id="Rust实现-1"><a href="#Rust实现-1" class="headerlink" title="Rust实现"></a>Rust实现</h4><figure class="highlight rust"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs rust"><span class="hljs-keyword">pub</span> <span class="hljs-class"><span class="hljs-keyword">struct</span> <span class="hljs-title">LfsrJk</span></span> &#123;<br>    j_state: <span class="hljs-built_in">u32</span>,<br>    k_state: <span class="hljs-built_in">u32</span>,<br>    j_state_c: <span class="hljs-built_in">u32</span>,<br>    k_state_c: <span class="hljs-built_in">u32</span>,<br>    data_state: <span class="hljs-built_in">u8</span>,<br>&#125;<br><span class="hljs-keyword">impl</span> LfsrJk &#123;<br>    <span class="hljs-keyword">pub</span> <span class="hljs-function"><span class="hljs-keyword">fn</span> <span class="hljs-title">new</span></span>(j_state: <span class="hljs-built_in">u32</span>, k_state: <span class="hljs-built_in">u32</span>, j_state_c: <span class="hljs-built_in">u32</span>, k_state_c: <span class="hljs-built_in">u32</span>, data_state: <span class="hljs-built_in">u8</span>) -&gt; <span class="hljs-keyword">Self</span> &#123;<br>        <span class="hljs-keyword">Self</span> &#123;<br>            j_state: <span class="hljs-number">0x12345678</span> - j_state,<br>            k_state: <span class="hljs-number">0x87654321</span> - k_state,<br>            j_state_c: <span class="hljs-number">0xffffffff</span> - j_state_c,<br>            k_state_c: <span class="hljs-number">0xffffffff</span> - k_state_c,<br>            data_state,<br>        &#125;<br>    &#125;<br>    <span class="hljs-keyword">pub</span> <span class="hljs-function"><span class="hljs-keyword">fn</span> <span class="hljs-title">crypt</span></span>(&amp;<span class="hljs-keyword">self</span>, data: &amp;<span class="hljs-keyword">mut</span> [<span class="hljs-built_in">u8</span>]) &#123;<br>        <span class="hljs-keyword">let</span> <span class="hljs-keyword">mut</span> j_state = <span class="hljs-keyword">self</span>.j_state;<br>        <span class="hljs-keyword">let</span> <span class="hljs-keyword">mut</span> k_state = <span class="hljs-keyword">self</span>.k_state;<br>        <span class="hljs-keyword">let</span> <span class="hljs-keyword">mut</span> data_state = <span class="hljs-keyword">self</span>.data_state;<br>        <span class="hljs-keyword">let</span> len = data.len();<br>        <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-number">0</span>..len &#123;<br>            <span class="hljs-keyword">let</span> j = Self::round(&amp;<span class="hljs-keyword">mut</span> j_state, <span class="hljs-keyword">self</span>.j_state_c);<br>            <span class="hljs-keyword">let</span> k = Self::round(&amp;<span class="hljs-keyword">mut</span> k_state, <span class="hljs-keyword">self</span>.k_state_c);<br>            data_state = j ^ (!(j ^ k) &amp; data_state);<br>            data[i] ^= data_state;<br>        &#125;<br>    &#125;<br>    <span class="hljs-meta">#[inline]</span><br>    <span class="hljs-function"><span class="hljs-keyword">fn</span> <span class="hljs-title">round</span></span>(state: &amp;<span class="hljs-keyword">mut</span> <span class="hljs-built_in">u32</span>, state_c: <span class="hljs-built_in">u32</span>) -&gt; <span class="hljs-built_in">u8</span> &#123;<br>        <span class="hljs-keyword">let</span> <span class="hljs-keyword">mut</span> output = <span class="hljs-number">0u8</span>;<br>        <span class="hljs-keyword">for</span> _ <span class="hljs-keyword">in</span> <span class="hljs-number">0</span>..<span class="hljs-number">8</span> &#123;<br>            <span class="hljs-keyword">let</span> t = *state &amp; state_c;<br>            <span class="hljs-keyword">let</span> new_out = t.count_ones() % <span class="hljs-number">2</span>;<br>            <span class="hljs-keyword">let</span> out = (<span class="hljs-number">0x80000000</span> &amp; t) &gt;&gt; <span class="hljs-number">31</span>;<br>            output = (output &lt;&lt; <span class="hljs-number">1</span>) + out <span class="hljs-keyword">as</span> <span class="hljs-built_in">u8</span>;<br>            *state = (*state &lt;&lt; <span class="hljs-number">1</span>) + new_out;<br>        &#125;<br>        output<br>    &#125;<br>&#125;<br></code></pre></div></td></tr></table></figure>

<p><img src="https://cdn.jsdelivr.net/gh/Mundi-Xu/picture_resource@master/picture/%E5%9F%BA%E4%BA%8ERUST%E7%9A%84%E5%AF%86%E7%A0%81%E5%AD%A6%E7%B3%BB%E7%BB%9F/lfsr-jk.png" srcset="/img/loading.gif" lazyload alt="lfsr-jk"></p>
<h2 id="RC4"><a href="#RC4" class="headerlink" title="RC4"></a>RC4</h2><h3 id="基本介绍"><a href="#基本介绍" class="headerlink" title="基本介绍"></a>基本介绍</h3><p>RSA 由 Ron Rivest 设计，加解密使用相同的密钥，因此也属于对称加密算法。它是面向字节的流密码，密钥长度可变，非常简单，但也很有效果。RC4 算法曾广泛应用于 SSL/TLS 协议和 WEP/WPA 协议，但由于RC4算法存在弱点，2015年2月所发布的 RFC 7465 规定禁止在TLS中使用RC4加密算法。</p>
<h3 id="基本流程"><a href="#基本流程" class="headerlink" title="基本流程"></a>基本流程</h3><p>RC4 主要包含三个流程</p>
<ul>
<li>初始化 S 和 T 数组。</li>
<li>初始化置换 S。</li>
<li>生成密钥流。</li>
</ul>
<h4 id="初始化-S-和-T-数组"><a href="#初始化-S-和-T-数组" class="headerlink" title="初始化 S 和 T 数组"></a>初始化 S 和 T 数组</h4><p>初始化 S 和 T 的代码如下</p>
<figure class="highlight c"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs c"><span class="hljs-keyword">for</span> i = <span class="hljs-number">0</span> to <span class="hljs-number">255</span> <span class="hljs-keyword">do</span><br>	S[i] = i<br>	T[i] = K[i mod keylen])<br></code></pre></div></td></tr></table></figure>

<p> <img src="https://cdn.jsdelivr.net/gh/Mundi-Xu/picture_resource@master/picture/%E5%9F%BA%E4%BA%8ERUST%E7%9A%84%E5%AF%86%E7%A0%81%E5%AD%A6%E7%B3%BB%E7%BB%9F/rc4_s_t.png" srcset="/img/loading.gif" lazyload alt="rc4_s_t"></p>
<h4 id="初始化置换-S"><a href="#初始化置换-S" class="headerlink" title="初始化置换 S"></a>初始化置换 S</h4><figure class="highlight c"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs c">j = <span class="hljs-number">0</span><br><span class="hljs-keyword">for</span> i = <span class="hljs-number">0</span> to <span class="hljs-number">255</span> <span class="hljs-keyword">do</span> <br>	j = (j + S[i] + T[i]) (mod <span class="hljs-number">256</span>) <br>	swap (S[i], S[j])<br></code></pre></div></td></tr></table></figure>

<p><img src="https://cdn.jsdelivr.net/gh/Mundi-Xu/picture_resource@master/picture/%E5%9F%BA%E4%BA%8ERUST%E7%9A%84%E5%AF%86%E7%A0%81%E5%AD%A6%E7%B3%BB%E7%BB%9F/rc4_s.png" srcset="/img/loading.gif" lazyload alt="rc4_s"></p>
<h4 id="生成流密钥"><a href="#生成流密钥" class="headerlink" title="生成流密钥"></a>生成流密钥</h4><figure class="highlight c"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs c">i = j = <span class="hljs-number">0</span> <br><span class="hljs-keyword">for</span> each message byte b<br>	i = (i + <span class="hljs-number">1</span>) (mod <span class="hljs-number">256</span>)<br>	j = (j + S[i]) (mod <span class="hljs-number">256</span>)<br>	swap(S[i], S[j])<br>	t = (S[i] + S[j]) (mod <span class="hljs-number">256</span>) <br>	print S[t]<br></code></pre></div></td></tr></table></figure>

<p><img src="https://cdn.jsdelivr.net/gh/Mundi-Xu/picture_resource@master/picture/%E5%9F%BA%E4%BA%8ERUST%E7%9A%84%E5%AF%86%E7%A0%81%E5%AD%A6%E7%B3%BB%E7%BB%9F/rc4_key.png" srcset="/img/loading.gif" lazyload alt="rc4_key"></p>
<p>我们一般称前两部分为 KSA ，最后一部分是 PRGA。</p>
<h3 id="Rust实现-2"><a href="#Rust实现-2" class="headerlink" title="Rust实现"></a>Rust实现</h3><figure class="highlight rust"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs rust"><span class="hljs-keyword">pub</span> <span class="hljs-class"><span class="hljs-keyword">struct</span> <span class="hljs-title">Rc4</span></span> &#123;<br>    s: [<span class="hljs-built_in">u32</span>; <span class="hljs-number">256</span>],<br>    key: <span class="hljs-built_in">Vec</span>&lt;<span class="hljs-built_in">u8</span>&gt;,<br>&#125;<br><br><span class="hljs-keyword">impl</span> Rc4 &#123;<br>    <span class="hljs-keyword">pub</span> <span class="hljs-function"><span class="hljs-keyword">fn</span> <span class="hljs-title">new</span></span>(key: <span class="hljs-built_in">Vec</span>&lt;<span class="hljs-built_in">u8</span>&gt;) -&gt; <span class="hljs-keyword">Self</span> &#123;<br>        <span class="hljs-keyword">let</span> <span class="hljs-keyword">mut</span> key = key;<br>        <span class="hljs-keyword">if</span> key.len() == <span class="hljs-number">0</span> &#123;<br>            key = <span class="hljs-built_in">vec!</span>[<span class="hljs-number">1</span>, <span class="hljs-number">2</span>, <span class="hljs-number">3</span>, <span class="hljs-number">4</span>, <span class="hljs-number">5</span>];<br>        &#125;<br>        <span class="hljs-keyword">let</span> <span class="hljs-keyword">mut</span> rc4 = <span class="hljs-keyword">Self</span> &#123;<br>            s: [<span class="hljs-number">0u32</span>; <span class="hljs-number">256</span>],<br>            key,<br>        &#125;;<br>        rc4.init();<br>        rc4<br>    &#125;<br>    <span class="hljs-keyword">pub</span> <span class="hljs-function"><span class="hljs-keyword">fn</span> <span class="hljs-title">init</span></span>(&amp;<span class="hljs-keyword">mut</span> <span class="hljs-keyword">self</span>) &#123;<br>        <span class="hljs-keyword">let</span> <span class="hljs-keyword">mut</span> k = <span class="hljs-built_in">vec!</span>[<span class="hljs-number">0u32</span>; <span class="hljs-number">256</span>];<br>        <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-number">0</span>..<span class="hljs-number">256</span> &#123;<br>            <span class="hljs-keyword">self</span>.s[i] = i <span class="hljs-keyword">as</span> <span class="hljs-built_in">u32</span>;<br>            k[i] = <span class="hljs-keyword">self</span>.key[i % <span class="hljs-keyword">self</span>.key.len()] <span class="hljs-keyword">as</span> <span class="hljs-built_in">u32</span>;<br>        &#125;<br>        <span class="hljs-keyword">let</span> <span class="hljs-keyword">mut</span> j = <span class="hljs-number">0</span>;<br>        <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-number">0</span>..<span class="hljs-number">256</span> &#123;<br>            j = (j + <span class="hljs-keyword">self</span>.s[i] + k[i]) % <span class="hljs-number">256</span>;<br>            <span class="hljs-keyword">let</span> tmp = <span class="hljs-keyword">self</span>.s[i];<br>            <span class="hljs-keyword">self</span>.s[i] = <span class="hljs-keyword">self</span>.s[j <span class="hljs-keyword">as</span> <span class="hljs-built_in">usize</span>];<br>            <span class="hljs-keyword">self</span>.s[j <span class="hljs-keyword">as</span> <span class="hljs-built_in">usize</span>] = tmp;<br>        &#125;<br>    &#125;<br>    <span class="hljs-keyword">pub</span> <span class="hljs-function"><span class="hljs-keyword">fn</span> <span class="hljs-title">crypt</span></span>(&amp;<span class="hljs-keyword">mut</span> <span class="hljs-keyword">self</span>, data: &amp;<span class="hljs-keyword">mut</span> [<span class="hljs-built_in">u8</span>]) &#123;<br>        <span class="hljs-keyword">let</span> <span class="hljs-keyword">mut</span> i = <span class="hljs-number">0</span>;<br>        <span class="hljs-keyword">let</span> <span class="hljs-keyword">mut</span> j = <span class="hljs-number">0</span>;<br>        <span class="hljs-keyword">let</span> <span class="hljs-keyword">mut</span> t = <span class="hljs-number">0</span>;<br>        <span class="hljs-keyword">let</span> <span class="hljs-keyword">mut</span> s = <span class="hljs-keyword">self</span>.s.clone();<br>        <span class="hljs-keyword">for</span> k <span class="hljs-keyword">in</span> <span class="hljs-number">0</span>..data.len() &#123;<br>            i = (i + <span class="hljs-number">1</span>) % <span class="hljs-number">256</span>;<br>            j = (j + s[i]) % <span class="hljs-number">256</span>;<br>            <span class="hljs-keyword">let</span> tmp = s[i];<br>            s[i] = s[j <span class="hljs-keyword">as</span> <span class="hljs-built_in">usize</span>];<br>            s[j <span class="hljs-keyword">as</span> <span class="hljs-built_in">usize</span>] = tmp;<br>            t = (s[i] + s[j <span class="hljs-keyword">as</span> <span class="hljs-built_in">usize</span>]) % <span class="hljs-number">256</span>;<br>            data[k] ^= s[t <span class="hljs-keyword">as</span> <span class="hljs-built_in">usize</span>] <span class="hljs-keyword">as</span> <span class="hljs-built_in">u8</span>;<br>        &#125;<br>    &#125;<br>&#125;<br></code></pre></div></td></tr></table></figure>

<p><img src="https://cdn.jsdelivr.net/gh/Mundi-Xu/picture_resource@master/picture/%E5%9F%BA%E4%BA%8ERUST%E7%9A%84%E5%AF%86%E7%A0%81%E5%AD%A6%E7%B3%BB%E7%BB%9F/rc4.png" srcset="/img/loading.gif" lazyload alt="rc4"></p>
<h1 id="块加密"><a href="#块加密" class="headerlink" title="块加密"></a>块加密</h1><h2 id="概述"><a href="#概述" class="headerlink" title="概述"></a>概述</h2><p>所谓块加密就是每次加密一块明文，常见的加密算法有</p>
<ul>
<li>IDEA 加密</li>
<li>DES 加密</li>
<li>AES 加密</li>
</ul>
<p>块加密也是对称加密。</p>
<p>其实，我们也可以把块加密理解一种特殊的替代密码，但是其每次替代的是一大块。而正是由于一大块，明文空间巨大，而且对于不同的密钥，我们无法做一个表进行对应相应的密文，因此必须得有 <strong>复杂</strong> 的加解密算法来加解密明密文。</p>
<p>而与此同时，明文往往可能很长也可能很短，因此在块加密时往往需要两个辅助</p>
<ul>
<li>padding，即 padding 到指定分组长度</li>
<li>分组加密模式，即明文分组加密的方式。</li>
</ul>
<h2 id="填充规则"><a href="#填充规则" class="headerlink" title="填充规则"></a>填充规则</h2><p>正如我们之前所说，在分组加密中，明文的长度往往并不满足要求，需要进行 padding，而如何 padding 目前也已经有了不少的规定。</p>
<p>常见的 <a target="_blank" rel="noopener" href="https://www.di-mgt.com.au/cryptopad.html">填充规则</a> 如下。<strong>需要注意的是，即使消息的长度是块大小的整数倍，仍然需要填充。</strong></p>
<p>一般来说，如果在解密之后发现 Padding 不正确，则往往会抛出异常。我们也因此可以知道 Paddig 是否正确。</p>
<h3 id="Pad-with-bytes-all-of-the-same-value-as-the-number-of-padding-bytes-PKCS5-padding"><a href="#Pad-with-bytes-all-of-the-same-value-as-the-number-of-padding-bytes-PKCS5-padding" class="headerlink" title="Pad with bytes all of the same value as the number of padding bytes (PKCS5 padding)"></a>Pad with bytes all of the same value as the number of padding bytes (PKCS5 padding)</h3><figure class="highlight tap"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs tap">DES INPUT BLOCK  = f  o  r  _  _  _  _  _<br>(IN HEX)          <span class="hljs-number"> 66 </span>6F<span class="hljs-number"> 72 </span>05<span class="hljs-number"> 05 </span>05<span class="hljs-number"> 05 </span>05<br>KEY              =<span class="hljs-number"> 01 </span>23<span class="hljs-number"> 45 </span>67<span class="hljs-number"> 89 </span>AB CD EF<br>DES OUTPUT BLOCK = FD<span class="hljs-number"> 29 </span>85 C9 E8 DF<span class="hljs-number"> 41 </span>40<br></code></pre></div></td></tr></table></figure>

<h3 id="Pad-with-0x80-followed-by-zero-bytes-OneAndZeroes-Padding"><a href="#Pad-with-0x80-followed-by-zero-bytes-OneAndZeroes-Padding" class="headerlink" title="Pad with 0x80 followed by zero bytes (OneAndZeroes Padding)"></a>Pad with 0x80 followed by zero bytes (OneAndZeroes Padding)</h3><figure class="highlight tap"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs tap">DES INPUT BLOCK  = f  o  r  _  _  _  _  _<br>(IN HEX)          <span class="hljs-number"> 66 </span>6F<span class="hljs-number"> 72 </span>80<span class="hljs-number"> 00 </span>00<span class="hljs-number"> 00 </span>00<br>KEY              =<span class="hljs-number"> 01 </span>23<span class="hljs-number"> 45 </span>67<span class="hljs-number"> 89 </span>AB CD EF<br>DES OUTPUT BLOCK = BE<span class="hljs-number"> 62 </span>5D 9F F3 C6 C8 40<br></code></pre></div></td></tr></table></figure>

<p>这里其实就是和 md5 和 sha1 的 padding 差不多。</p>
<h3 id="Pad-with-zeroes-except-make-the-last-byte-equal-to-the-number-of-padding-bytes"><a href="#Pad-with-zeroes-except-make-the-last-byte-equal-to-the-number-of-padding-bytes" class="headerlink" title="Pad with zeroes except make the last byte equal to the number of padding bytes"></a>Pad with zeroes except make the last byte equal to the number of padding bytes</h3><figure class="highlight tap"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs tap">DES INPUT BLOCK  = f  o  r  _  _  _  _  _<br>(IN HEX)          <span class="hljs-number"> 66 </span>6f<span class="hljs-number"> 72 </span>00<span class="hljs-number"> 00 </span>00<span class="hljs-number"> 00 </span>05<br>KEY              =<span class="hljs-number"> 01 </span>23<span class="hljs-number"> 45 </span>67<span class="hljs-number"> 89 </span>AB CD EF<br>DES OUTPUT BLOCK =<span class="hljs-number"> 91 </span>19 2C<span class="hljs-number"> 64 </span>B5 5C 5D B8<br></code></pre></div></td></tr></table></figure>

<h3 id="Pad-with-zero-null-characters"><a href="#Pad-with-zero-null-characters" class="headerlink" title="Pad with zero (null) characters"></a>Pad with zero (null) characters</h3><figure class="highlight tap"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs tap">DES INPUT BLOCK  = f  o  r  _  _  _  _  _<br>(IN HEX)          <span class="hljs-number"> 66 </span>6f<span class="hljs-number"> 72 </span>00<span class="hljs-number"> 00 </span>00<span class="hljs-number"> 00 </span>00<br>KEY              =<span class="hljs-number"> 01 </span>23<span class="hljs-number"> 45 </span>67<span class="hljs-number"> 89 </span>AB CD EF<br>DES OUTPUT BLOCK = 9E<span class="hljs-number"> 14 </span>FB<span class="hljs-number"> 96 </span>C5 FE EB 75<br></code></pre></div></td></tr></table></figure>

<h3 id="Pad-with-spaces"><a href="#Pad-with-spaces" class="headerlink" title="Pad with spaces"></a>Pad with spaces</h3><figure class="highlight tap"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs tap">DES INPUT BLOCK  = f  o  r  _  _  _  _  _<br>(IN HEX)          <span class="hljs-number"> 66 </span>6f<span class="hljs-number"> 72 </span>20<span class="hljs-number"> 20 </span>20<span class="hljs-number"> 20 </span>20<br>KEY              =<span class="hljs-number"> 01 </span>23<span class="hljs-number"> 45 </span>67<span class="hljs-number"> 89 </span>AB CD EF<br>DES OUTPUT BLOCK = E3 FF EC E5<span class="hljs-number"> 21 </span>1F<span class="hljs-number"> 35 </span>25<br></code></pre></div></td></tr></table></figure>

<h2 id="工作模式"><a href="#工作模式" class="headerlink" title="工作模式"></a>工作模式</h2><p>分组密码的工作模式是：根据不同的数据格式和安全性要求, 以一个具体的分组密码算法为基础构造一个分组密码系统的方法。分组密码的工作模式应当力求简单, 有效和易于实现，需要采用适当的工作模式来隐蔽明文的统计特性、数据的格式等，降低删除、重放、插入和伪造成功的机会。</p>
<p>分组密码的主要工作模式：</p>
<ol>
<li>电码本(ECB)模式</li>
<li>密码分组链接(CBC)模式</li>
<li>密码反馈(CFB)模式</li>
<li>输出反馈(OFB)模式</li>
<li>计数器(CTR)模式</li>
</ol>
<p><img src="https://cdn.jsdelivr.net/gh/Mundi-Xu/picture_resource@master/picture/%E5%9F%BA%E4%BA%8ERUST%E7%9A%84%E5%AF%86%E7%A0%81%E5%AD%A6%E7%B3%BB%E7%BB%9F/%E5%B7%A5%E4%BD%9C%E6%A8%A1%E5%BC%8F%E6%AF%94%E8%BE%83.png" srcset="/img/loading.gif" lazyload alt="分组密码的工作模式比较"></p>
<h2 id="基本策略"><a href="#基本策略" class="headerlink" title="基本策略"></a>基本策略</h2><p>在分组密码设计时，充分使用了 Shannon 提出的两大策略：混淆与扩散两大策略。</p>
<h3 id="混淆"><a href="#混淆" class="headerlink" title="混淆"></a>混淆</h3><p>混淆，Confusion，将密文与密钥之间的统计关系变得尽可能复杂，使得攻击者即使获取了密文的一些统计特性，也无法推测密钥。一般使用复杂的非线性变换可以得到很好的混淆效果，常见的方法如下</p>
<ul>
<li>S 盒</li>
<li>乘法</li>
</ul>
<h3 id="扩散"><a href="#扩散" class="headerlink" title="扩散"></a>扩散</h3><p>扩散，Diffusion，使得明文中的每一位影响密文中的许多位。常见的方法有</p>
<ul>
<li>线性变换</li>
<li>置换</li>
<li>移位，循环移位</li>
</ul>
<h2 id="常见加解密结构"><a href="#常见加解密结构" class="headerlink" title="常见加解密结构"></a>常见加解密结构</h2><p>目前块加密中主要使用的是结构是</p>
<ul>
<li>迭代结构，这是因为迭代结构便于设计与实现，同时方便安全性评估。</li>
</ul>
<h3 id="迭代结构"><a href="#迭代结构" class="headerlink" title="迭代结构"></a>迭代结构</h3><h4 id="概述-1"><a href="#概述-1" class="headerlink" title="概述"></a>概述</h4><p>迭代结构基本如下，一般包括三个部分</p>
<ul>
<li>密钥置换</li>
<li>轮加密函数</li>
<li>轮解密函数</li>
</ul>
<p><img src="https://cdn.jsdelivr.net/gh/Mundi-Xu/picture_resource@master/picture/%E5%9F%BA%E4%BA%8ERUST%E7%9A%84%E5%AF%86%E7%A0%81%E5%AD%A6%E7%B3%BB%E7%BB%9F/iterated_cipher.png" srcset="/img/loading.gif" lazyload alt="iterated_cipher"></p>
<h4 id="轮函数"><a href="#轮函数" class="headerlink" title="轮函数"></a>轮函数</h4><p>目前来说，轮函数主要有主要有以下设计方法</p>
<ul>
<li>Feistel Network，由 Horst Feistel 发明，DES 设计者之一。<ul>
<li>DES</li>
</ul>
</li>
<li>Substitution-Permutation Network(SPN)<ul>
<li>AES</li>
</ul>
</li>
<li>其他方案</li>
</ul>
<h4 id="密钥扩展"><a href="#密钥扩展" class="headerlink" title="密钥扩展"></a>密钥扩展</h4><p>目前，密钥扩展的方法有很多，没有见到什么完美的密钥扩展方法，基本原则是使得密钥的每一个比特尽可能影响多轮的轮密钥。</p>
<h2 id="DES"><a href="#DES" class="headerlink" title="DES"></a>DES</h2><h3 id="基本介绍-1"><a href="#基本介绍-1" class="headerlink" title="基本介绍"></a>基本介绍</h3><p>Data Encryption Standard(DES)，数据加密标准，是典型的块加密，其基本信息如下</p>
<ul>
<li>输入 64 位。</li>
<li>输出 64 位。</li>
<li>密钥 64 位，使用 64 位密钥中的 56 位，剩余的 8 位要么丢弃，要么作为奇偶校验位。</li>
<li>Feistel 迭代结构<ul>
<li>明文经过 16 轮迭代得到密文。</li>
<li>密文经过类似的 16 轮迭代得到明文。</li>
</ul>
</li>
</ul>
<h3 id="基本流程-1"><a href="#基本流程-1" class="headerlink" title="基本流程"></a>基本流程</h3><p>给出一张简单的 DES 流程图。</p>
<p><img src="https://cdn.jsdelivr.net/gh/Mundi-Xu/picture_resource@master/picture/%E5%9F%BA%E4%BA%8ERUST%E7%9A%84%E5%AF%86%E7%A0%81%E5%AD%A6%E7%B3%BB%E7%BB%9F/des.gif" srcset="/img/loading.gif" lazyload alt="des"></p>
<h4 id="加密"><a href="#加密" class="headerlink" title="加密"></a>加密</h4><p>我们可以考虑一下每一轮的加密过程</p>
<p>$L_{i+1}=R_i$</p>
<p>$R_{i+1}=L_i\oplus F(R_i,K_i)$</p>
<p>那么在最后的 Permutation 之前，对应的密文为$(R_{n+1},L_{n+1})$。</p>
<h4 id="解密"><a href="#解密" class="headerlink" title="解密"></a>解密</h4><p>那么解密如何解密呢？首先我们可以把密文先进行逆置换，那么就可以得到最后一轮的输出。我们这时考虑每一轮</p>
<p>$R_i=L_{i+1}$</p>
<p>$L_i=R_{i+1}\oplus F(L_{i+1},K_i)$</p>
<p>因此，$(L_0,R_0)$ 就是加密时第一次置换后的明文。我们只需要再执行逆置换就可以获得明文了。</p>
<p>可以看出，DES 加解密使用同一套逻辑，只是密钥使用的顺序不一致。</p>
<h3 id="核心部件"><a href="#核心部件" class="headerlink" title="核心部件"></a>核心部件</h3><p>DES 中的核心部件主要包括（这里只给出加密过程的）</p>
<ul>
<li>初始置换</li>
<li>F 函数<ul>
<li>E 扩展函数</li>
<li>S 盒，设计标准未给出。</li>
<li>P 置换</li>
</ul>
</li>
<li>最后置换</li>
</ul>
<p>其中 F 函数如下</p>
<p><img src="https://cdn.jsdelivr.net/gh/Mundi-Xu/picture_resource@master/picture/%E5%9F%BA%E4%BA%8ERUST%E7%9A%84%E5%AF%86%E7%A0%81%E5%AD%A6%E7%B3%BB%E7%BB%9F/f-function.png" srcset="/img/loading.gif" lazyload alt="f-function"></p>
<p>如果对 DES 更加感兴趣，可以进行更加仔细地研究。欢迎提供 PR。</p>
<h3 id="衍生"><a href="#衍生" class="headerlink" title="衍生"></a>衍生</h3><p>在 DES 的基础上，衍生了以下两种加密方式</p>
<ul>
<li>双重 DES</li>
<li>三种 DES</li>
</ul>
<h4 id="双重-DES"><a href="#双重-DES" class="headerlink" title="双重 DES"></a>双重 DES</h4><p>双重 DES 使用两个密钥，长度为 112 比特。加密方式如下</p>
<p>$C=E_{k2}(E_{k1}(P))$</p>
<p>但是双重 DES 不能抵抗中间相遇攻击，我们可以构造如下两个集合</p>
<p>$I={E_{k1}(P)}$</p>
<p>$J=D_{k2}(C)$</p>
<p>即分别枚举 K1 和 K2 分别对 P 进行加密和对 C 进行解密。</p>
<p>在我们对 P 进行加密完毕后，可以对加密结果进行排序，这样的复杂度为$2^nlog(2^n)=O(n2^n)$</p>
<p>当我们对 C 进行解密时，可以每解密一个，就去对应的表中查询。</p>
<p>总的复杂度为还是$O(n2^n)$。</p>
<h4 id="三重-DES"><a href="#三重-DES" class="headerlink" title="三重 DES"></a>三重 DES</h4><p>三重 DES 的加解密方式如下</p>
<p>$C=E_{k3}(D_{k2}(E_{k1}(P)))$</p>
<p>$P=D_{k1}(E_{k2}(D_{k3}(C)))$</p>
<p>在选择密钥时，可以有两种方法</p>
<ul>
<li>3 个不同的密钥，k1，k2，k3 互相独立，一共 168 比特。</li>
<li>2 个不同的密钥，k1 与 k2 独立，k3=k1，112 比特。</li>
</ul>
<h3 id="攻击方法"><a href="#攻击方法" class="headerlink" title="攻击方法"></a>攻击方法</h3><ul>
<li>差分攻击</li>
<li>线性攻击</li>
</ul>
<h2 id="AES"><a href="#AES" class="headerlink" title="AES"></a>AES</h2><h3 id="基本介绍-2"><a href="#基本介绍-2" class="headerlink" title="基本介绍"></a>基本介绍</h3><p>Advanced Encryption Standard（AES），高级加密标准，是典型的块加密，被设计来取代 DES，由 Joan Daemen 和 Vincent Rijmen 所设计。其基本信息如下</p>
<ul>
<li>输入：128 比特。</li>
<li>输出：128 比特。</li>
<li>SPN 网络结构。</li>
</ul>
<p>其迭代轮数与密钥长度有关系，如下</p>
<table>
<thead>
<tr>
<th align="center">密钥长度（比特）</th>
<th align="center">迭代轮数</th>
</tr>
</thead>
<tbody><tr>
<td align="center">128</td>
<td align="center">10</td>
</tr>
<tr>
<td align="center">192</td>
<td align="center">12</td>
</tr>
<tr>
<td align="center">256</td>
<td align="center">14</td>
</tr>
</tbody></table>
<h3 id="基本流程-2"><a href="#基本流程-2" class="headerlink" title="基本流程"></a>基本流程</h3><h4 id="基本概念"><a href="#基本概念" class="headerlink" title="基本概念"></a>基本概念</h4><p>在 AES 加解密过程中，每一块都是 128 比特，所以我们这里明确一些基本概念。</p>
<p><img src="https://cdn.jsdelivr.net/gh/Mundi-Xu/picture_resource@master/picture/%E5%9F%BA%E4%BA%8ERUST%E7%9A%84%E5%AF%86%E7%A0%81%E5%AD%A6%E7%B3%BB%E7%BB%9F/aes_data_unit.png" srcset="/img/loading.gif" lazyload alt="aes_data_unit"></p>
<p>在 AES 中，块与 State 之间的转换过程如下</p>
<p><img src="https://cdn.jsdelivr.net/gh/Mundi-Xu/picture_resource@master/picture/%E5%9F%BA%E4%BA%8ERUST%E7%9A%84%E5%AF%86%E7%A0%81%E5%AD%A6%E7%B3%BB%E7%BB%9F/aes_block2state.png" srcset="/img/loading.gif" lazyload alt="aes_block2state"></p>
<p>所以，可以看出，每一个 block 中的字节是按照列排列进入到状态数组的。</p>
<p>而对于明文来说，一般我们会选择使用其十六进制进行编码。</p>
<p><img src="https://cdn.jsdelivr.net/gh/Mundi-Xu/picture_resource@master/picture/%E5%9F%BA%E4%BA%8ERUST%E7%9A%84%E5%AF%86%E7%A0%81%E5%AD%A6%E7%B3%BB%E7%BB%9F/aes_plain2state.png" srcset="/img/loading.gif" lazyload alt="aes_plain2state"></p>
<h4 id="加解密过程"><a href="#加解密过程" class="headerlink" title="加解密过程"></a>加解密过程</h4><p>这里给个看雪上比较好的 <a target="_blank" rel="noopener" href="http://bbs.pediy.com/thread-90722.htm">图例</a> ，以便于介绍基本的流程，每一轮主要包括</p>
<ul>
<li>轮密钥加，AddRoundKey</li>
<li>字节替换，SubBytes</li>
<li>行移位，ShiftRows</li>
<li>列混淆，MixColumns</li>
</ul>
<p><img src="https://cdn.jsdelivr.net/gh/Mundi-Xu/picture_resource@master/picture/%E5%9F%BA%E4%BA%8ERUST%E7%9A%84%E5%AF%86%E7%A0%81%E5%AD%A6%E7%B3%BB%E7%BB%9F/aes_details.jpg" srcset="/img/loading.gif" lazyload alt="aes_details"></p>
<p>上面的列混淆的矩阵乘法等号左边的列向量应该在右边。</p>
<p>这里再给一张其加解密的全图，其解密算法的正确性很显然。</p>
<p><img src="https://cdn.jsdelivr.net/gh/Mundi-Xu/picture_resource@master/picture/%E5%9F%BA%E4%BA%8ERUST%E7%9A%84%E5%AF%86%E7%A0%81%E5%AD%A6%E7%B3%BB%E7%BB%9F/aes_enc_dec.png" srcset="/img/loading.gif" lazyload alt="aes_enc_dec"></p>
<p>我们这里重点关注一下以下。</p>
<h5 id="字节替换"><a href="#字节替换" class="headerlink" title="字节替换"></a>字节替换</h5><p>在字节替换的背后，其实是有对应的数学规则来定义对应的替换表的，如下</p>
<p><img src="https://cdn.jsdelivr.net/gh/Mundi-Xu/picture_resource@master/picture/%E5%9F%BA%E4%BA%8ERUST%E7%9A%84%E5%AF%86%E7%A0%81%E5%AD%A6%E7%B3%BB%E7%BB%9F/aes_subbytes.png" srcset="/img/loading.gif" lazyload alt="aes_subbytes"></p>
<p>这里的运算均定义在 $GF(2^8)$ 内。</p>
<h5 id="列混淆"><a href="#列混淆" class="headerlink" title="列混淆"></a>列混淆</h5><p>这里的运算也是定义在 $GF(2^8)$ 上，使用的模多项式为 $x^8+x^4+x^3+1$。</p>
<h5 id="密钥扩展-1"><a href="#密钥扩展-1" class="headerlink" title="密钥扩展"></a>密钥扩展</h5><p><img src="https://cdn.jsdelivr.net/gh/Mundi-Xu/picture_resource@master/picture/%E5%9F%BA%E4%BA%8ERUST%E7%9A%84%E5%AF%86%E7%A0%81%E5%AD%A6%E7%B3%BB%E7%BB%9F/aes_key_expansion.png" srcset="/img/loading.gif" lazyload alt="aes_key_expansion"></p>
<h3 id="等价解密算法"><a href="#等价解密算法" class="headerlink" title="等价解密算法"></a>等价解密算法</h3><p>简单分析一下，我们可以发现</p>
<ul>
<li>交换逆向行移位和逆向字节代替并不影响结果。</li>
<li>交换轮密钥加和逆向列混淆并不影响结果，关键在于<ul>
<li>首先可以把异或看成域上的多项式加法</li>
<li>然后多项式中乘法对加法具有分配率。</li>
</ul>
</li>
</ul>
<h3 id="攻击方法-1"><a href="#攻击方法-1" class="headerlink" title="攻击方法"></a>攻击方法</h3><ul>
<li>积分攻击</li>
</ul>
<h1 id="非对称加密"><a href="#非对称加密" class="headerlink" title="非对称加密"></a>非对称加密</h1><h2 id="介绍-2"><a href="#介绍-2" class="headerlink" title="介绍"></a>介绍</h2><p>在非对称密码中，加密者与解密者所使用的密钥并不一样，典型的有 RSA 加密，背包加密，椭圆曲线加密。</p>
<h2 id="RSA"><a href="#RSA" class="headerlink" title="RSA"></a>RSA</h2><p>RSA 加密算法是一种非对称加密算法。在公开密钥加密和电子商业中 RSA 被广泛使用。RSA 是 1977 年由罗纳德·李维斯特（Ron Rivest）、阿迪·萨莫尔（Adi Shamir）和伦纳德·阿德曼（Leonard Adleman）一起提出的。RSA 就是他们三人姓氏开头字母拼在一起组成的。</p>
<p>RSA 算法的可靠性由极大整数因数分解的难度决定。换言之，对一极大整数做因数分解愈困难，RSA 算法愈可靠。假如有人找到一种快速因数分解的算法的话，那么用 RSA 加密的信息的可靠性就肯定会极度下降。但找到这样的算法的可能性是非常小的。如今，只有短的 RSA 密钥才可能被强力方式解破。到 2020 年为止，还没有任何可靠的攻击 RSA 算法的方式。</p>
<h3 id="基本原理"><a href="#基本原理" class="headerlink" title="基本原理"></a>基本原理</h3><h4 id="公钥与私钥的产生"><a href="#公钥与私钥的产生" class="headerlink" title="公钥与私钥的产生"></a>公钥与私钥的产生</h4><ol>
<li>随机选择两个不同大质数 $p$ 和 $q$，计算 $N = p \times q$</li>
<li>根据欧拉函数，求得 $\varphi (N)=\varphi (p)\varphi (q)=(p-1)(q-1)$</li>
<li>选择一个小于 $\varphi (N)$ 的整数 $e$，使 $e$ 和 $\varphi (N)$ 互质。并求得 $e$ 关于 $\varphi (N)$ 的模反元素，命名为 $d$，有 $ed\equiv 1 \pmod {\varphi (N)}$</li>
<li>将 $p​$ 和 $q​$ 的记录销毁</li>
</ol>
<p>此时，$(N,e)$ 是公钥，$(N,d)$ 是私钥。</p>
<h4 id="消息加密"><a href="#消息加密" class="headerlink" title="消息加密"></a>消息加密</h4><p>首先需要将消息 以一个双方约定好的格式转化为一个小于 $N$，且与 $N$ 互质的整数 $m$。如果消息太长，可以将消息分为几段，这也就是我们所说的块加密，后对于每一部分利用如下公式加密：</p>
<p>$$<br>m^{e}\equiv c\pmod N<br>$$</p>
<h4 id="消息解密"><a href="#消息解密" class="headerlink" title="消息解密"></a>消息解密</h4><p>利用密钥 $d​$ 进行解密。</p>
<p>$$<br>c^{d}\equiv m\pmod N<br>$$</p>
<h4 id="正确性证明"><a href="#正确性证明" class="headerlink" title="正确性证明"></a>正确性证明</h4><p>即我们要证$m^{ed} \equiv m \bmod N$，已知$ed \equiv 1 \bmod \phi(N)$，那么 $ed=k\phi(N)+1$，即需要证明</p>
<p>$$<br>m^{k\phi(N)+1}  \equiv m \bmod N<br>$$</p>
<p>这里我们分两种情况证明</p>
<p>第一种情况 $gcd(m,N)=1​$，那么 $m^{\phi(N)} \equiv 1 \bmod N​$，因此原式成立。</p>
<p>第二种情况 $gcd(m,N)\neq 1$，那么 $m$ 必然是 $p$ 或者 $q$ 的倍数，并且 $n=m$ 小于 $N$。我们假设</p>
<p>$$<br>m=xp<br>$$</p>
<p>那么 $x$ 必然小于 $q$，又由于 $q$ 是素数。那么</p>
<p>$$<br>m^{\phi(q)} \equiv 1 \bmod q<br>$$</p>
<p>进而</p>
<p>$$<br>m^{k\phi(N)}=m^{k(p-1)(q-1)}=(m^{\phi(q)})^{k(p-1)} \equiv 1 \bmod q<br>$$</p>
<p>那么</p>
<p>$$<br>m^{k\phi(N)+1}=m+uqm<br>$$</p>
<p>进而</p>
<p>$$<br>m^{k\phi(N)+1}=m+uqxp=m+uxN<br>$$</p>
<p>所以原式成立。</p>
<h3 id="样例-2"><a href="#样例-2" class="headerlink" title="样例"></a>样例</h3><h4 id="例1"><a href="#例1" class="headerlink" title="例1"></a>例1</h4><h5 id="计算公钥和私钥"><a href="#计算公钥和私钥" class="headerlink" title="计算公钥和私钥"></a>计算公钥和私钥</h5><ol>
<li><p>p = 13 , q = 5</p>
<ul>
<li>N = pq = 65</li>
<li>r = (p-1)(q-1) = (13-1)(5-1) = 48</li>
</ul>
</li>
<li><p>计算模反元素<br>r=48，选择e=5，得到二元一次方程：5d-48k=1 , 获得一组解：d=29，k=3</p>
</li>
<li><p>因此，公钥是 (N, e) = (65, 5)，私钥是 (N, d) = (65, 29)。</p>
</li>
</ol>
<h5 id="加密信息"><a href="#加密信息" class="headerlink" title="加密信息"></a>加密信息</h5><ol>
<li><p>明文：m=3</p>
</li>
<li><p>计算: $ c \equiv 3^{5} \pmod 65 \equiv 48 $</p>
</li>
<li><p>因此：3被加密为48</p>
</li>
</ol>
<h5 id="解密信息"><a href="#解密信息" class="headerlink" title="解密信息"></a>解密信息</h5><ol>
<li><p>密文：c=48</p>
</li>
<li><p>计算：$ n \equiv 48^{29} \pmod 65 \equiv 3 $</p>
</li>
<li><p>因此：48被解密为3</p>
</li>
</ol>
<h4 id="例2"><a href="#例2" class="headerlink" title="例2"></a>例2</h4><p><img src="https://cdn.jsdelivr.net/gh/Mundi-Xu/picture_resource@master/picture/%E5%9F%BA%E4%BA%8ERUST%E7%9A%84%E5%AF%86%E7%A0%81%E5%AD%A6%E7%B3%BB%E7%BB%9F/rsa.png" srcset="/img/loading.gif" lazyload alt="rsa-1"></p>
<h1 id="密码协议"><a href="#密码协议" class="headerlink" title="密码协议"></a>密码协议</h1><h2 id="Diffie-Hellman-密钥交换"><a href="#Diffie-Hellman-密钥交换" class="headerlink" title="Diffie-Hellman 密钥交换"></a>Diffie-Hellman 密钥交换</h2><ul>
<li>密钥交换是实现安全通信的基础<ul>
<li>商用加密算法AES和DES需要在安全通信之前，实现通信双方的密钥共享。</li>
</ul>
</li>
<li>密钥交换的方法：<ul>
<li>基于RSA的密钥交换；</li>
<li>基于KDC技术 (Key Distributed Center，密钥分发中心)；</li>
<li><strong>Diffie-Hellman密钥交换</strong>（简称：DH算法）；</li>
<li>基于物理层的密钥交换。</li>
</ul>
</li>
</ul>
<p>DH算法是不安全信道下实现安全密钥共享的一种方法，由 W. Diffie 和 M.Hellman 在1976年提出的第一个公开的<strong>公钥密码算法</strong>。</p>
<p><img src="https://cdn.jsdelivr.net/gh/Mundi-Xu/picture_resource@master/picture/%E5%9F%BA%E4%BA%8ERUST%E7%9A%84%E5%AF%86%E7%A0%81%E5%AD%A6%E7%B3%BB%E7%BB%9F/DH-1.png" srcset="/img/loading.gif" lazyload alt="DH-1"></p>
<h2 id="DH协议案例"><a href="#DH协议案例" class="headerlink" title="DH协议案例"></a>DH协议案例</h2><p><img src="https://cdn.jsdelivr.net/gh/Mundi-Xu/picture_resource@master/picture/%E5%9F%BA%E4%BA%8ERUST%E7%9A%84%E5%AF%86%E7%A0%81%E5%AD%A6%E7%B3%BB%E7%BB%9F/DH-3.png" srcset="/img/loading.gif" lazyload alt="DH-3"><br><img src="https://cdn.jsdelivr.net/gh/Mundi-Xu/picture_resource@master/picture/%E5%9F%BA%E4%BA%8ERUST%E7%9A%84%E5%AF%86%E7%A0%81%E5%AD%A6%E7%B3%BB%E7%BB%9F/DH-2.png" srcset="/img/loading.gif" lazyload alt="DH-2"></p>
<h1 id="参考"><a href="#参考" class="headerlink" title="参考"></a>参考</h1><section class="footnotes"><div class="footnote-list"><ol><li><span id="fn:1" class="footnote-text"><span><a target="_blank" rel="noopener" href="https://github.com/Mundi-Xu/cipher_web_rocket">https://github.com/Mundi-Xu/cipher_web_rocket</a>
<a href="#fnref:1" rev="footnote" class="footnote-backref"> ↩</a></span></span></li><li><span id="fn:2" class="footnote-text"><span><a target="_blank" rel="noopener" href="https://ctf-wiki.github.io/ctf-wiki/">ctf-wiki</a>
<a href="#fnref:2" rev="footnote" class="footnote-backref"> ↩</a></span></span></li><li><span id="fn:3" class="footnote-text"><span><a target="_blank" rel="noopener" href="https://github.com/yuankeyang/python/blob/master/%E3%80%8A%E6%B7%B1%E5%85%A5%E6%B5%85%E5%87%BA%E5%AF%86%E7%A0%81%E5%AD%A6%E2%80%94%E2%80%94%E5%B8%B8%E7%94%A8%E5%8A%A0%E5%AF%86%E6%8A%80%E6%9C%AF%E5%8E%9F%E7%90%86%E4%B8%8E%E5%BA%94%E7%94%A8%E3%80%8B.pdf">深入浅出密码学——常用加密技术原理与应用</a>
<a href="#fnref:3" rev="footnote" class="footnote-backref"> ↩</a></span></span></li></ol></div></section>
            </div>
            <hr>
            <div>
              <div class="post-metas mb-3">
                
                
                  <div class="post-meta">
                    <i class="iconfont icon-tags"></i>
                    
                      <a class="hover-with-bg" href="/tags/crypto/">crypto</a>
                    
                      <a class="hover-with-bg" href="/tags/rsa/">rsa</a>
                    
                      <a class="hover-with-bg" href="/tags/rust/">rust</a>
                    
                      <a class="hover-with-bg" href="/tags/%E4%BB%BF%E5%B0%84%E5%AF%86%E7%A0%81/">仿射密码</a>
                    
                      <a class="hover-with-bg" href="/tags/%E6%B5%81%E5%AF%86%E7%A0%81/">流密码</a>
                    
                      <a class="hover-with-bg" href="/tags/%E5%88%86%E7%BB%84%E5%AF%86%E7%A0%81/">分组密码</a>
                    
                      <a class="hover-with-bg" href="/tags/%E5%AF%86%E7%A0%81%E5%8D%8F%E8%AE%AE/">密码协议</a>
                    
                      <a class="hover-with-bg" href="/tags/RC4/">RC4</a>
                    
                      <a class="hover-with-bg" href="/tags/des/">des</a>
                    
                      <a class="hover-with-bg" href="/tags/aes/">aes</a>
                    
                  </div>
                
              </div>
              
                <p class="note note-warning">
                  
                    本站所有文章除特别声明外，均采用 <a target="_blank" href="https://creativecommons.org/licenses/by-nc-sa/4.0/deed.zh" rel="nofollow noopener noopener">CC BY-NC-SA 4.0 协议</a> ，转载请注明出处！
                  
                </p>
              
              
                <div class="post-prevnext">
                  <article class="post-prev col-6">
                    
                    
                      <a href="/2020/12/28/%E5%8B%92%E7%B4%A2%E8%BD%AF%E4%BB%B6%E7%BB%93%E6%9E%84%E4%B8%8E%E5%8A%A0%E5%AF%86%E6%A8%A1%E5%BC%8F%E7%A0%94%E7%A9%B6/">
                        <i class="iconfont icon-arrowleft"></i>
                        <span class="hidden-mobile">勒索软件结构与加密模式研究</span>
                        <span class="visible-mobile">Previous</span>
                      </a>
                    
                  </article>
                  <article class="post-next col-6">
                    
                    
                      <a href="/2020/07/01/%E5%9F%BA%E4%BA%8E%E5%8C%BA%E5%9D%97%E9%93%BE%E7%9A%84%E5%AE%89%E5%85%A8%E6%97%A5%E5%BF%97%E7%B3%BB%E7%BB%9F/">
                        <span class="hidden-mobile">基于区块链的安全日志系统</span>
                        <span class="visible-mobile">Next</span>
                        <i class="iconfont icon-arrowright"></i>
                      </a>
                    
                  </article>
                </div>
              
            </div>

            
              <!-- Comments -->
              <article class="comments" id="comments">
                
                  
                
                
  <div id="gitalk-container"></div>
  <script type="text/javascript">
    Fluid.utils.loadComments('#gitalk-container', function() {
      Fluid.utils.createCssLink('/css/gitalk.css')
      Fluid.utils.createScript('https://cdn.jsdelivr.net/npm/gitalk@1.7.2/dist/gitalk.min.js', function() {
        var options = Object.assign(
          {"clientID":"1331118797b631adeeb5","clientSecret":"367f791b0ab3489c94cc96bf4096b64f442b6ce3","repo":"gitment-blog","owner":"Mundi-Xu","admin":["Mundi-Xu"],"language":"en","labels":["Gitalk"],"perPage":10,"pagerDirection":"last","distractionFreeMode":false,"createIssueManually":true,"proxy":"https://jolly-silence-2d9d.mundi-xu.workers.dev/?https://github.com/login/oauth/access_token"},
          {
            id: 'a80a178ab7ad5978e22159665874c9f5'
          }
        )
        var gitalk = new Gitalk(options);
        gitalk.render('gitalk-container');
      });
    });
  </script>
  <noscript>Please enable JavaScript to view the comments</noscript>


              </article>
            
          </article>
        </div>
      </div>
    </div>
    
      <div class="d-none d-lg-block col-lg-2 toc-container" id="toc-ctn">
        <div id="toc">
  <p class="toc-header"><i class="iconfont icon-list"></i>&nbsp;TOC</p>
  <div class="toc-body" id="toc-body"></div>
</div>

      </div>
    
  </div>
</div>

<!-- Custom -->


    

    
      <a id="scroll-top-button" href="#" role="button">
        <i class="iconfont icon-arrowup" aria-hidden="true"></i>
      </a>
    

    
      <div class="modal fade" id="modalSearch" tabindex="-1" role="dialog" aria-labelledby="ModalLabel"
     aria-hidden="true">
  <div class="modal-dialog modal-dialog-scrollable modal-lg" role="document">
    <div class="modal-content">
      <div class="modal-header text-center">
        <h4 class="modal-title w-100 font-weight-bold">Search</h4>
        <button type="button" id="local-search-close" class="close" data-dismiss="modal" aria-label="Close">
          <span aria-hidden="true">&times;</span>
        </button>
      </div>
      <div class="modal-body mx-3">
        <div class="md-form mb-5">
          <input type="text" id="local-search-input" class="form-control validate">
          <label data-error="x" data-success="v"
                 for="local-search-input">keyword</label>
        </div>
        <div class="list-group" id="local-search-result"></div>
      </div>
    </div>
  </div>
</div>
    

    
  </main>

  <footer class="text-center mt-5 py-3">
  <div class="footer-content">
     <a href="mailto:mundi.xu@gmail.com"target="_blank"><span>Contact me</span></a> <i class="iconfont icon-love"></i> <a href="mailto:mundi.xu@gmail.com"target="_blank"><span>mundi.xu@gmail.com</span></a> 
  </div>
  
  <div class="statistics">
    
    

    
      
        <!-- 不蒜子统计PV -->
        <span id="busuanzi_container_site_pv" style="display: none">
            总访问量 
            <span id="busuanzi_value_site_pv"></span>
             次
          </span>
      
      
        <!-- 不蒜子统计UV -->
        <span id="busuanzi_container_site_uv" style="display: none">
            总访客数 
            <span id="busuanzi_value_site_uv"></span>
             人
          </span>
      
    
  </div>


  

  
</footer>


  <!-- SCRIPTS -->
  
  <script  src="https://cdn.jsdelivr.net/npm/nprogress@0.2.0/nprogress.min.js" ></script>
  <link  rel="stylesheet" href="https://cdn.jsdelivr.net/npm/nprogress@0.2.0/nprogress.min.css" />

  <script>
    NProgress.configure({"showSpinner":false,"trickleSpeed":100})
    NProgress.start()
    window.addEventListener('load', function() {
      NProgress.done();
    })
  </script>


<script  src="https://cdn.jsdelivr.net/npm/jquery@3.6.0/dist/jquery.min.js" ></script>
<script  src="https://cdn.jsdelivr.net/npm/bootstrap@4.6.0/dist/js/bootstrap.min.js" ></script>
<script  src="/js/events.js" ></script>
<script  src="/js/plugins.js" ></script>

<!-- Plugins -->


  
    
      <script  src="/js/img-lazyload.js" ></script>
    
  



  



  <script  src="https://cdn.jsdelivr.net/npm/tocbot@4.12.3/dist/tocbot.min.js" ></script>



  <script  src="https://cdn.jsdelivr.net/npm/@fancyapps/fancybox@3.5.7/dist/jquery.fancybox.min.js" ></script>



  <script  src="https://cdn.jsdelivr.net/npm/anchor-js@4.3.1/anchor.min.js" ></script>



  <script defer src="https://cdn.jsdelivr.net/npm/clipboard@2.0.8/dist/clipboard.min.js" ></script>



  <script  src="/js/local-search.js" ></script>



  <script defer src="https://busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js" ></script>




  <script  src="https://cdn.jsdelivr.net/npm/typed.js@2.0.12/lib/typed.min.js" ></script>
  <script>
    (function (window, document) {
      var typing = Fluid.plugins.typing;
      var title = document.getElementById('subtitle').title;
      
      typing(title)
      
    })(window, document);
  </script>





  

  
    <!-- MathJax -->
    <script>
      MathJax = {
        tex: {
          inlineMath: [['$', '$'], ['\\(', '\\)']]
        },
        options: {
          renderActions: {
            findScript: [10, doc => {
              document.querySelectorAll('script[type^="math/tex"]').forEach(node => {
                const display = !!node.type.match(/; *mode=display/);
                const math = new doc.options.MathItem(node.textContent, doc.inputJax[0], display);
                const text = document.createTextNode('');
                node.parentNode.replaceChild(text, node);
                math.start = { node: text, delim: '', n: 0 };
                math.end = { node: text, delim: '', n: 0 };
                doc.math.push(math);
              });
            }, '', false],
            insertedScript: [200, () => {
              document.querySelectorAll('mjx-container').forEach(node => {
                let target = node.parentNode;
                if (target.nodeName.toLowerCase() === 'li') {
                  target.parentNode.classList.add('has-jax');
                }
              });
            }, '', false]
          }
        }
      };
    </script>

    <script async src="https://cdn.jsdelivr.net/npm/mathjax@3.1.4/es5/tex-svg.js" ></script>

  





  <script  src="https://cdn.jsdelivr.net/npm/mermaid@8.10.1/dist/mermaid.min.js" ></script>
  <script>
    if (window.mermaid) {
      mermaid.initialize({"theme":"default"});
    }
  </script>







<!-- 主题的启动项 保持在最底部 -->
<script  src="/js/boot.js" ></script>


</body>
</html>
